{"version":3,"sources":["anim/SingleAnimation.js","anim/UndoFunctions.js","anim/AnimatedObject.js","anim/AnimatedBTreeNode.js","anim/AnimatedCircle.js","anim/AnimatedCircularlyLinkedListNode.js","anim/AnimatedDoublyLinkedListNode.js","anim/AnimatedHighlightCircle.js","anim/AnimatedLabel.js","anim/AnimatedLine.js","anim/AnimatedLinkedListNode.js","anim/AnimatedRectangle.js","anim/AnimatedSkipListNode.js","anim/ObjectManager.js","anim/AnimationMain.js","anim/CustomEvents.js","components/Footer.js","components/Header.js","algo/Algorithm.js","algo/AVL.js","algo/util/GraphValues.js","algo/Graph.js","algo/BST.js","algo/BTree.js","algo/BoyerMoore.js","algo/BubbleSort.js","algo/Hash.js","algo/ClosedHash.js","algo/CocktailSort.js","algo/util/PriorityQueue.js","algo/Heap.js","algo/OpenHash.js","algo/SplayTree.js","algo/HeapSort.js","AlgoList.js","algo/ArrayList.js","algo/LinkedList.js","algo/DoublyLinkedList.js","algo/CircularlyLinkedList.js","algo/StackArray.js","algo/StackLL.js","algo/QueueArray.js","algo/QueueLL.js","algo/DequeArray.js","algo/DequeLL.js","algo/SkipList.js","algo/InsertionSort.js","algo/SelectionSort.js","algo/QuickSort.js","algo/QuickSelect.js","algo/MergeSort.js","algo/LSDRadix.js","algo/BruteForce.js","algo/KMP.js","algo/RabinKarp.js","algo/BFS.js","algo/DFS.js","algo/Dijkstras.js","algo/Prims.js","algo/Kruskals.js","algo/LCS.js","algo/Floyd.js","examples/ExampleModals.js","screens/AlgoScreen.js","screens/AboutScreen.js","screens/HomeScreen.js","App.js","index.js"],"names":["SingleAnimation","constructor","id","fromX","fromY","toX","toY","this","objectID","UndoBlock","addUndoAnimation","undoInitialStep","UndoMove","fmX","fmy","tx","ty","super","animationList","nextAnim","push","UndoCreate","world","removeObject","UndoHighlight","val","color","highlightValue","setHighlight","UndoSetHeight","height","setHeight","UndoSetWidth","width","setWidth","UndoSetNumElements","obj","newNumElems","sizeBeforeChange","getNumElements","sizeAfterChange","labels","Array","colors","i","getText","getTextColor","setNumElements","setText","setTextColor","UndoSetAlpha","alph","alphaVal","setAlpha","UndoSetNull","nv","nullVal","setNull","UndoSetPrevNull","setPrevNull","UndoSetNextNull","setNextNull","UndoSetForegroundColor","setForegroundColor","UndoSetBackgroundColor","setBackgroundColor","UndoSetHighlightIndex","index","setHighlightIndex","UndoSetText","str","newText","labelIndex","UndoSetTextColor","UndoHighlightEdge","from","to","fromID","toID","setEdgeHighlight","UndoSetEdgeThickness","thickness","setEdgeThickness","UndoSetEdgeColor","oldColor","setEdgeColor","UndoSetEdgeAlpha","oldAplha","alpha","setEdgeAlpha","UndoSetPosition","x","y","setNodePosition","UndoSetAlwaysOnTop","onTop","setAlwaysOnTop","UndoSetRectangleEdgeThickness","thicknessArray","setRectangleEdgeThickness","AnimatedObject","backgroundColor","foregroundColor","highlighted","label","labelColor","layer","minHeightDiff","range","highlightIndex","highlightIndexDirty","addedToScene","newColor","getNull","newAlpha","getAlpha","getHighlight","getWidth","getHeight","value","highlightColor","centerX","Error","centerY","getAlignLeftPos","otherObject","right","getAlignRightPos","left","getAlignTopPos","top","getAlignBottomPos","bottom","alignLeft","alignRight","alignTop","alignBottom","getClosestCardinalPoint","xDelta","yDelta","xPos","yPos","centered","pulseHighlight","frameNum","frameMod","delta","Math","abs","highlightDiff","getTailPointerAttachPos","getHeadPointerAttachPos","identifier","hlIndex","getHighlightIndex","AnimatedBTreeNode","widthPerElement","h","numLabels","labelColors","newNumElements","draw","context","startX","isNaN","startY","strokeStyle","fillStyle","beginPath","moveTo","lineTo","closePath","stroke","fill","textAlign","textBaseline","labelX","labelY","fillText","anchor","textIndex","createUndoDelete","UndoDeleteBTreeNode","addBTreeNode","setLayer","AnimatedCircle","radius","newWidth","xVec","yVec","len","sqrt","globalAlpha","arc","PI","lineWidth","font","strList","split","length","leftWidth","measureText","substring","centerWidth","textWidth","startingXForHighlight","leftStr","highlightStr","rightStr","mid","UndoDeleteCircle","addCircleObject","AnimatedCircularlyLinkedListNode","w","linkPercent","nullPointer","labelPosX","labelPosY","np","resetTextPosition","UndoDeleteCircularlyLinkedList","addCircularlyLinkedListObject","AnimatedDoublyLinkedListNode","prevNullPointer","nextNullPointer","getLeftNull","getRightNull","closest","UndoDeleteDoublyLinkedList","pnp","nnp","addDoublyLinkedListObject","AnimatedHighlightCircle","UndoDeleteHighlightCircle","addHighlightCircleObject","AnimatedLabel","initialWidth","strokeText","offset","indexOf","UndoDeleteLabel","addLabelObject","AnimatedLine","curve","directed","edgeLabel","anchorPoint","dirty","arrowHeight","arrowWidth","setColor","highlightVal","setThickness","LINE_MAX_HEIGHT_DIFF","hasNode","n","sign","drawArrow","fromPos","toPos","deltaX","deltaY","midX","midY","controlX","controlY","quadraticCurveTo","midLen","createUndoConnect","UndoConnect","createConnection","connectEdge","disconnect","AnimatedLinkedListNode","vertical","linkPosEnd","UndoDeleteLinkedList","addLinkedListObject","AnimatedRectangle","xJustify","yJustify","textColor","getEdgeThickness","UndoDeleteRectangle","addRectangleObject","AnimatedSkipListNode","UndoDeleteSkipList","addSkipListObject","ObjectManager","canvasRef","nodes","edges","backEdges","activeLayers","ctx","current","getContext","framenum","statusReport","j","clearRect","alwaysOnTop","update","setLayers","shown","layers","resetLayers","objectColor","undefined","String","newNode","oldAlpha","nodeID","setAllLayers","nextEdge","clearAllObjects","objectIDfrom","objectIDto","deleted","undo","pop","deleteIncident","undoStack","node2ID","len2","node1ID","oldObject","getObject","objectLabel","getNodeX","getTextWidth","text","max","getNodeY","lab","connectionPoint","fromObj","toObj","l","id1","id2","oldTop","oldHighlight","oldThickness","oldEdgeThickness","centering","newLabel","nodeLabel","linkPer","verticalOrientation","numElems","widthPerElem","newX","newY","getCookie","cookieName","cookies","document","cookie","substr","replace","unescape","setCookie","expireDays","exDate","Date","setDate","getDate","addControlToAnimationBar","animBarRef","type","name","callback","element","createElement","setAttribute","onclick","onkeydown","tableEntry","appendChild","addDivisorToAnimationBar","divisorLeft","divisorRight","AnimationManager","events","removeListener","kind","scope","func","scopeFunctions","functions","splice","addListener","fireEvent","event","objects","functs","call","objectManager","animatedObjects","animationPaused","awaitingStep","currentlyAnimating","animationSteps","currentAnimation","previousAnimationSteps","currFrame","animationBlockLength","currentBlock","doingUndo","undoAnimationStepIndices","undoAnimationStepIndicesStack","paused","canvas","skipBackButton","skipBack","stepBackButton","stepBack","playPauseBackButton","doPlayPause","stepForwardButton","step","skipForwardButton","skipForward","speed","parseInt","CustomSlider","withStyles","root","padding","track","borderRadius","Slider","slider","defaultValue","onChange","e","setSpeed","controlBar","getElementById","newTable","midLevel","bottomLevel","ReactDOM","render","align","txtNode","createTextNode","heightEntry","returnSubmit","field","changeSize","documentElement","clientWidth","intOnly","maxSize","size","keyASCII","window","keyCode","which","controlKey","sizeButton","animStarted","animEnded","animWaiting","animUndoUnavailable","lerp","percent","setPaused","pausedValue","parseBool","uppercase","toUpperCase","parseColor","clr","charAt","newSpeed","floor","startNextBlock","undoBlock","stopTimer","foundBreak","anyAnimations","act","params","startNewAnimation","commands","startTimer","undoLastBlock","clearHistory","keepUndoing","finishUndoBlock","resetAll","runFast","animateNext","disabled","timeout","timer","setTimeout","clearInterval","move","delete","removedEdges","concat","connect","connectNext","connectPrev","connectCurve","connectSkipList","undoConnect","createCircle","createHighlightCircle","createRectangle","createLabel","createLinkedListNode","isArray","map","createDoublyLinkedListNode","createCircularlyLinkedListNode","createSkipListNode","createBTreeNode","oldText","oldThicknessArray","oldHeight","oldWidth","oldNull","oldElem","setPosition","oldX","oldY","oldIndex","bringToTop","moveToAlignRight","newXY","Footer","className","href","Header","React","Component","state","menuVisible","toggleMenu","setState","Fragment","onClick","null","true","false","addLabelToAlgorithmBar","labelName","group","addCheckboxToAlgorithmBar","boxLabel","checked","span","addRadioButtonGroupToAlgorithmBar","buttonNames","groupName","buttonList","button","topLevelTableEntry","addControlToAlgorithmBar","addDivisorToAlgorithmBar","addGroupToAlgorithmBar","horizontal","parentGroup","Algorithm","am","animationManager","disableUI","enableUI","canvasWidth","canvasHeight","actionHistory","recordAnimation","addCodeToCanvasBase","code","start_x","start_y","line_height","standard_color","codeID","nextIndex","cmd","highlight","ind1","ind2","unhighlight","removeCode","setCodeAlpha","reset","implementAction","args","next","retVal","normalizeNumber","input","maxLen","test","funct","maxsize","sizeChanged","newHeight","prototype","returnSubmitFloat","addReturnSubmit","action","AVL","first_print_pos_y","PRINT_VERTICAL_GAP","print_max","startingX","addControls","EXPLANITORY_TEXT_X","EXPLANITORY_TEXT_Y","controls","insertField","insertCallback","bind","insertButton","deleteField","deleteCallback","deleteButton","findField","findCallback","findButton","printButton","printCallback","clearButton","clearCallback","predSuccButtonList","predButton","succButton","predSucc","treeRoot","insertedValue","add","deletedValue","remove","findValue","findElement","printTree","clear","highlightID","firstLabel","HIGHLIGHT_COLOR","xPosOfNextLabel","FIRST_PRINT_POS_X","yPosOfNextLabel","printTreeRec","tree","nextLabelID","data","PRINT_COLOR","PRINT_HORIZONTAL_GAP","doFind","graphicID","remakeTree","curr","LINK_COLOR","addH","resizeTree","treeNodeID","heightLabelID","bfLabelID","STARTING_Y","FOREGROUND_COLOR","BACKGROUND_COLOR","HEIGHT_LABEL_COLOR","AVLNode","parent","connectSmart","balance","some","LINK_OPACITY","updateHeightAndBF","bf","HIGHLIGHT_LABEL_COLOR","singleRotateRight","singleRotateLeft","B","A","t2","isLeftChild","resetHeight","deleteNode","removeH","dummy","removeSucc","removePred","startingPoint","resizeWidths","rightWidth","setNewPositions","animateNewPositions","xPosition","yPosition","side","heightLabelX","bfLabelX","heightLabelY","bfLabelY","HEIGHT_DELTA","WIDTH_DELTA","recClear","hid","bfid","initialX","initialY","node","r","HIGHLIGHT_LINK_COLOR","HIGHLIGHT_CIRCLE_COLOR","LARGE_ALLOWED","LARGE_CURVE","LARGE_X_POS_LOGICAL","LARGE_Y_POS_LOGICAL","SMALL_ALLLOWED","SMALL_CURVE","SMALL_X_POS_LOGICAL","SMALL_Y_POS_LOGICAL","BFS_DFS_ADJ_LIST","row","DIJKSTRAS_ADJ_LIST","Number","PRIMS_KRUSKALS_ADJ_LIST","KRUSKALS_DS_COLORS","Graph","defaultEdges","dir","dag","costs","currentLayer","isDAG","showEdgeCosts","setup_small","addDirection","verticalGroup","newGraphButton","newGraphCallback","defaultGraphButton","defaultGraphCallback","radioButtonList","undirectedGraphButton","directedGraphCallback","directedGraphButton","smallGraphButton","smallGraphCallback","largeGraphButton","largeGraphCallback","logicalButton","graphRepChangedCallback","adjacencyListButton","adjacencyMatrixButton","newDirected","setup","setup_large","newLayer","recolorGraph","adj_matrix","highlightEdge","adj_list_edges","adj_matrixID","circleID","visitVertex","highlightCircleL","x_pos_logical","y_pos_logical","highlightCircleAL","adj_list_x_start","adj_list_width","adj_list_y_start","adj_list_height","highlightCircleAM","adj_matrix_x_start","adj_matrix_width","adj_matrix_y_start","adj_matrix_height","leaveVertex","clearEdges","rebuildEdges","buildEdges","adjustCurveForDirectedEdges","allowed","adj_list_elem_width","adj_list_elem_height","adj_list_spacing_after_list","adj_list_spacing_between_nodes","isLarge","bidirectional","toStr","edgePercent","random","buildAdjList","buildAdjMatrix","adj_matrix_index_x","adj_matrix_index_y","removeAdjList","adj_list_list","adj_list_index","lastElem","nextXPos","hasEdges","vertex","fromCharCode","control","PRE_CODE","IN_CODE","POST_CODE","LEVEL_CODE","BST","toClear","traversalButtonList","preOrderSelect","inOrderSelect","postOrderSelect","levelOrderSelect","traversal","traverseButton","traverseCallback","traverse","preOrderRec","passedCodeID","levelOrder","queue","queueLabelId","queueID","QUEUE_START_X","QUEUE_START_Y","shift","currId","clearOldObjects","postOrderRec","forEach","BSTNode","BTreeNode","widths","keys","children","numKeys","isLeaf","galilRuleEnabled","lastSwapEnabled","Hash","hashingIntegers","keyField","valueField","loadField","changeLoadFactor","loadButton","loadFactorCallBack","hashIntegerButton","changeHashTypeCallback","hashStringButton","newHashingIntegers","changeHashType","newHashingIntegerValue","doHash","labelID1","labelID2","table_size","currHash","HASH_LABEL_X","indexXPos","indexYPos","label1","wordToHashID","wordToHash","digits","hashValue","nextByte","nextByteID","resultDigits","floatingDigits","floatingVals","operatorID","barID","nextChar","charCodeAt","carry","HASH_NUMBER_START_X","label2","HASH_NUMBER_START_Y","insertedKey","insertElement","deleteElement","newLF","MapEntry","key","elem","PriorityQueue","backingArray","enqueue","priority","sort","a","b","dequeue","getIDs","HEAP_X_POSITIONS","HEAP_Y_POSITIONS","LinkedListNode","algoMap","ArrayList","addVerticalGroup","addTopHorizontalGroup","addBottomHorizontalGroup","addValueField","addIndexCallback","addIndexField","addFrontButton","addFrontCallback","addBackButton","addBackCallback","addIndexButton","removeVerticalGroup","removeTopHorizontalGroup","removeBottomHorizontalGroup","removeField","removeIndexCallback","removeIndexButton","removeFrontButton","removeFrontCallback","removeBackButton","removeBackCallback","arrayID","arrayLabelID","arrayData","xpos","ypos","highlight1ID","addVal","resize","clearAll","elemToAdd","labPushID","labPushValID","arrayMoveID","labPopValID","labPushResizeID","arrayIDNew","arrayLabelIDNew","arrayDataNew","xposinit","yposinit","LinkedList","initialIndex","linkedListElemID","topID","topLabelID","leftoverLabelID","resetNodePositions","labPopID","nodePosX","LINKED_LIST_START_Y","nextX","nextY","DoublyLinkedList","tail_pos_y","tail_label_y","headID","headLabelID","tailID","tailLabelID","indexToTraverseTo","CircularlyLinkedList","labCopiedValID","copiedData","firstNodeID","lastX","lastY","LINKED_LIST_ELEM_HEIGHT","secondNodeX","LINKED_LIST_START_X","secondNodeY","removedNodeIndex","StackArray","pushField","pushCallback","pushButton","popButton","popCallback","highlight2ID","pushVal","clearData","elemToPush","popVal","display","StackLL","resetLinkedListPositions","QueueArray","enqueueField","enqueueCallback","enqueueButton","dequeueButton","dequeueCallback","frontID","frontLabelID","sizeID","sizeLabelID","frontPointerID","front","ARRAY_START_Y","elemToEnqueue","labEnqueueID","labEnqueueValID","labIndexID","labIndexValID","newTail","labDequeueID","labDequeueValID","dequeuedVal","frontxpos","frontypos","labEnqueueResizeID","labEnqueueValIDNew","QueueLL","DequeArray","addField","addFirstButton","addFirstCallBack","addLastButton","addLastCallback","removeFirstButton","removeFirstCallback","removeLastButton","removeLastCallback","addLast","removeFirst","removeLast","addFirst","elemToAddLast","labAddLastID","labAddLastValID","addIndex","QUEUE_LABEL_X","labelAddID","labelAddIDVal","labremoveFirstID","labremoveFirstValID","removeFirstdVal","remLabelID","remLabelValID","remIndex","removedVal","isFront","frontOffset","extra","QUEUE_RESIZE_LABEL_X","DequeLL","addFirstCallback","algos","Heap","array_size","order","removeButton","removeCallback","horizontalGroup","buildHeapField","buildHeapCallback","buildHeapButton","minMaxButtonList","minHeapButton","minHeapCallback","maxHeapButton","maxHeapCallback","isMinHeap","createArray","arrayLabels","arrayRects","circleObjs","arrayXPositions","currentHeapSize","swapLabel1","swapLabel2","swapLabel3","swapLabel4","descriptLabel1","descriptLabel2","descriptLabel3","resetIndex","list","filter","buildHeap","swap","index1","index2","tmp","setIndexHighlight","pushDown","childIndex","downheapCheckRightChild","downheapCompare","slice","unshift","min","nextElem","MAX_SIZE","currentIndex","parentIndex","upheapCompare","resizeLabelID","oldSize","newArrayData","newArrayLabels","newArrayRects","newCircleObjs","newArrayXPositions","SkipList","topHorizontalGroup","bottomHorizontalGroup","verticalGroupRandom","topHorizontalGroupRandom","bottomHorizontalGroupRandom","addWithHeadsCallback","headsField","addWithHeadsButton","addValueFieldRandom","addRandomlyCallback","addRandomlyButton","getField","getCallback","getButton","NEGATIVE_INFINITY","POSITIVE_INFINITY","SKIP_LIST_START_X","heads","get","valueLabelId","valueStringId","cfLabelId","cfStringId","expLabelID","headsString","rightPhantomsCol","newCol","col","foundDuplicate","nextCol","getNextCol","shiftColumns","prevCol","getPrevCol","removedCol","maxHeight","leftPhantomID","rightPhantomID","ClosedHash","elements_per_row","linearProblingButton","linearProbeCallback","quadraticProbingButton","quadraticProbeCallback","doubleHashingButton","doubleHashingCallback","currentHashingTypeButtonState","changeProbeType","newProbingType","skipDist","entry","load_factor","ExplainLabel","getEmptyIndex","hashTableValues","labID","hashTableVisual","empty","DelIndexLabel","resetSkipDist","labelID","skipVal","nextLowestPrime","HashID","probes","removedIndex","start","HashIndexID","getElemIndex","foundIndex","candidateIndex","fromCycle","resizeLabel","loadFactorID","oldHashTableVisual","oldHashTableValues","oldskipDist","oldempty","olddeleted","oldIndexXPos","oldIndexYPos","oldindexLabelID","indexLabelID","nextYPos","elementsMoved","oldElement","LF","HASH2_LABEL_X","HASH2_LABEL_Y","newHashTableVisual","newIndexLabelID","resetCallback","OpenHash","POINTER_ARRAY_ELEM_Y","hashTableIndices","nextID","POINTER_ARRAY_ELEM_START_X","old","found","prev","compareIndex","EXPLAIN_LABEL_Y","repositionList","repositionResizeList","RESIZE_POINTER_ARRAY_ELEM_START_X","tmpPrev","oldHashTableIndices","SplayTree","splay","zigZigRight","doubleRotateRight","zigZigLeft","doubleRotateLeft","treeRot","splayUp","insertElem","insert","treeDelete","valueToDelete","inTree","oldGraphicID","largestLeft","findMax","C","t3","BTree","starting_x","preemptiveSplit","max_keys","min_keys","split_index","max_degree","messageID","moveLabel1ID","moveLabel2ID","splitIndexButtonList","splitSecondSelect","splitThirdSelect","predCallback","succCallback","ignoreInputs","maxDegreeChangedHandler","newMaxDegree","changeDegree","clearTree","premtiveSplitCallback","premptiveSplitBox","changePreemtiveSplit","newValue","getLabelX","deleteTree","degree","newDegree","maxDegreeRadioButtons","findInTree","insertNotFull","insertValue","includes","findIndex","insertIndex","newTree","insertRepair","rightNode","risingNode","currentParent","leftNode","doDeleteNotEmpty","doDelete","nextNode","stealFromLeft","mergeRight","stealFromRight","maxNode","minNode","repairAfterDelete","parentNode","rightSib","fromParentIndex","tmpLabel1","tmpLabel2","leftSib","WIDTH_PER_ELEM","leftEdge","priorWidth","treeWidth","BubbleSort","listField","sortCallback","sortButton","lastSwapCheckbox","toggleLastSwap","displayData","iPointerID","jPointerID","comparisonCountID","compCount","console","log","elemCounts","Map","letterMap","count","has","set","toString","currChar","ARRAY_START_X","sorted","end","lastSwapped","movePointers","iXPos","jXPos","iLabelID","jLabelID","temp","CocktailSort","InsertionSort","SelectionSort","minButton","minCallback","maxButton","maxCallback","isMin","circleShift","k","toSwap","compare","lastIndex","QuickSort","pivotButtonList","randomPivotSelect","minPivotSelect","firstPivotSelect","perfectPivotSelect","pivotType","pPointerID","helper","pivot","midIndex","pXPos","swapPivot","other","moveJ","lLabelID","lXPos","pLabelID","QuickSelect","runCallback","kField","run","MergeSort","kPointerID","ceil","leftHelper","rightHelper","merge","prevOffset","tempArrayID","drawArrayAndCopy","extraOffset","copyData","currOffset","leftOffset","rightOffset","currArrayID","tempArray","tempDisplay","bottomYPos","kXPos","topYPos","movePointer","fromIndex","toIndex","fromOffset","toOffset","fromRow","toRow","cellID","pointerID","fromXPos","fromYPos","toXPos","toYPos","LSDRadix","arrayDisplay","bucketsData","bucketsID","bucketsDisplay","infoLabelID","greatest","log10","longData","digit","nthDigit","idBucket","dataBucket","displayBucket","BUCKETS_START_Y","pow","HeapSort","heapArrayData","heapArrayID","heapArrayLabelID","heapTreeObj","displayDataTemp","createHeap","heapArrayXPositions","remData","removedElementID","ARRAY_INITIAL_Y","compareWithLetters","num1","num2","BruteForce","textField","patternField","textRowID","comparisonMatrixID","pattern","find","maxRows","cellSize","labelsX","BoyerMoore","blotButton","buildLastOccurrenceTableCallback","galilButton","toggleGalilRule","patternTableLabelID","patternTableCharacterID","patternTableIndexID","lastTableLabelID","lastTableCharacterID","lastTableValueID","periodLabelID","lastTableCode","failureTableCode","BMCode","GalilCode","period","onlyBuildLastOccurrenceTable","getMaxRows","lastTable","buildLastTable","buildFailureTable","gr","failureTable","textLength","PATTERN_START_Y","LAST_TABLE_START_Y","patternTableStartX","lotStartX","lotPointerID","Object","char","startIndex","failureTableLabelID","failureTableCharacterID","failureTableValueID","FAILURE_TABLE_START_Y","tableStartX","ftPeriodLabel","KMP","bftButton","buildFailureTableCallback","KMPCode","onlyBuildFailureTable","fjPointerID","f0PointerID","f1PointerID","nextAlignment","RabinKarp","baseField","baseButton","baseCallback","baseLabelID","characterValuesLabelID","textHashLabelID","textHashCalculationID","patternHashLabelID","patternHashCalculationID","baseValue","toLowerCase","textCalculation","textHash","patternCalculation","patternHash","base","runningBase","calculationsX","BFS","startField","startCallback","startButton","adjMatrix","visited","listID","visitedID","VISITED_START_X","VISITED_START_Y","LIST_START_X","LIST_START_Y","startvalue","doBFS","startVetex","neighbor","DFS","physicalStack","recursiveStackButton","stackCallback","physicalStackButton","stackID","stackLabelID","recCode","itCode","physical","doDFSStack","doDFSRecursive","startVertex","stack","stackStartY","stackSpacing","vertexID","recursionSpacingX","recursionSpacingY","currentID","dfsVisit","currVertex","messageX","nextMessage","Dijkstra","distance","distanceID","pq","tableEntryHeight","TABLE_START_X","TABLE_START_Y","comparisonMessageID","doDijkstra","pqIDs","curDist","edgDist","newDist","oldDist","oldDistStr","newPqIDs","Prim","doPrim","weight","edge","edgeID","edgeStr","Kruskal","setID","setIndexID","setData","edgesListLeftID","edgesListRightID","SET_ARRAY_START_X","messageLabelID","SET_ARRAY_START_Y","edgesListLeft","edgesListRight","doKruskal","EDGE_LIST_START_X","edgeCount","tmpLeftID","tmpRightID","tmpLeft","tmpRight","findLabelLeft","findLabelRight","highlightCircle1","highlightCircle2","highlightCircle3","edgesAdded","nextListIndex","CURRENT_LABEL_X","CURRENT_LABEL_Y","newPos","leftRoot","rightRoot","minRoot","maxRoot","firstMatch","LCS","S1Field","S2Field","tableButton","oldIDs","string1","string2","str1","str2","clearOldIDs","buildTable","moveID","tableID","tableVals","S1TableID","S2TableID","tableXPos","tableYPos","buildLCSFromTable","currX","currY","sequence","header","SEQUENCE_START_Y","topThick","leftThick","nextSequenceID","Floyd","costTable","pathTable","getCostLabel","alwaysUseINF","cost_table_width","cost_table_height","cost_table_start_x","cost_table_start_y","path_table_width","path_table_height","path_table_start_x","path_table_start_y","node_1_x_pos","node_1_y_pos","node_2_x_pos","node_2_y_pos","node_3_x_pos","node_3_y_pos","message_x","message_y","costTableID","pathTableID","pathIndexXID","pathIndexYID","costIndexXID","costIndexYID","node3ID","costTableHeader","pathTableHeader","doFloydWarshall","algoList","AlgoScreen","props","updateDimensions","animManag","body","toggleExamples","examplesEnabled","algoName","location","pathname","createRef","ReactGA","pageview","componentDidMount","currentAlg","addEventListener","componentWillUnmount","removeEventListener","modals","ref","AboutScreen","HomeScreen","exact","path","idx","App","initialize","basename","component","createRoot","options","theme","save"],"mappings":"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Q,KACbvH,KAAKypB,OAAS,KAGfK,oBACC,MAAMxgB,EAAI0iB,GAAiB,MAARA,GAAgB,EAAIA,EAAKzqB,OACtCoT,EAAIrL,EAAEtJ,KAAKyH,MACXwkB,EAAI3iB,EAAEtJ,KAAKuH,OACjBvH,KAAKuB,OAASqH,KAAKyL,IAAIM,EAAGsX,GAAK,EAC/BjsB,KAAK+pB,GAAKpV,EAAIsX,EAGf3B,cACC,OAAmB,MAAftqB,KAAKypB,QAGFzpB,KAAKypB,OAAOhiB,OAASzH,MAM9B0lB,GAAIsE,sBAAwB,UAC5BtE,GAAIwG,qBAAuB,UAE3BxG,GAAIsC,gBAAkB,UACtBtC,GAAI6D,mBAAqB,UAEzB7D,GAAIoD,WAAa,UACjBpD,GAAImE,aAAe,IACnBnE,GAAIyG,uBAAyB,UAC7BzG,GAAI2D,iBAAmB,UACvB3D,GAAI4D,iBAAmB,UACvB5D,GAAI8C,YAAc9C,GAAI2D,iBAEtB3D,GAAIgG,YAAc,GAClBhG,GAAI+F,aAAe,GACnB/F,GAAI0D,WAAa,GAEjB1D,GAAIwC,kBAAoB,GACxBxC,GAAIE,mBAAqB,GACzBF,GAAI+C,qBAAuB,GAC3B/C,GAAIM,mBAAqB,GACzBN,GAAIO,mBAAqB,GCp1BzB,MAAMmG,GAAgB,CACrB,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA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","file":"static/js/main.0473bc78.chunk.js","sourcesContent":["export default class SingleAnimation {\n\tconstructor(id, fromX, fromY, toX, toY) {\n\t\tthis.objectID = id;\n\t\tthis.fromX = fromX;\n\t\tthis.fromY = fromY;\n\t\tthis.toX = toX;\n\t\tthis.toY = toY;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Base \"class\": UndoBlock\n\nimport SingleAnimation from './SingleAnimation';\n\nexport class UndoBlock {\n\taddUndoAnimation() {\n\t\treturn false;\n\t}\n\n\tundoInitialStep() {}\n}\n\nexport class UndoMove extends UndoBlock {\n\tconstructor(id, fmX, fmy, tx, ty) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.fromX = fmX;\n\t\tthis.fromY = fmy;\n\t\tthis.toX = tx;\n\t\tthis.toY = ty;\n\t}\n\n\taddUndoAnimation(animationList) {\n\t\tconst nextAnim = new SingleAnimation(\n\t\t\tthis.objectID,\n\t\t\tthis.fromX,\n\t\t\tthis.fromY,\n\t\t\tthis.toX,\n\t\t\tthis.toY,\n\t\t);\n\t\tanimationList.push(nextAnim);\n\t\treturn true;\n\t}\n}\n\nexport class UndoCreate extends UndoBlock {\n\tconstructor(id) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.removeObject(this.objectID);\n\t}\n}\n\nexport class UndoHighlight extends UndoBlock {\n\tconstructor(id, val, color) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.highlightValue = val;\n\t\tthis.color = color;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setHighlight(this.objectID, this.highlightValue, this.color);\n\t}\n}\n\nexport class UndoSetHeight extends UndoBlock {\n\tconstructor(id, val) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.height = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setHeight(this.objectID, this.height);\n\t}\n}\n\nexport class UndoSetWidth extends UndoBlock {\n\tconstructor(id, val) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.width = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setWidth(this.objectID, this.width);\n\t}\n}\n\nexport class UndoSetNumElements extends UndoBlock {\n\tconstructor(obj, newNumElems) {\n\t\tsuper();\n\t\tthis.objectID = obj.objectID;\n\t\tthis.sizeBeforeChange = obj.getNumElements();\n\t\tthis.sizeAfterChange = newNumElems;\n\t\tif (this.sizeBeforeChange > this.sizeAfterChange) {\n\t\t\tthis.labels = new Array(this.sizeBeforeChange - this.sizeAfterChange);\n\t\t\tthis.colors = new Array(this.sizeBeforeChange - this.sizeAfterChange);\n\t\t\tfor (let i = 0; i < this.sizeBeforeChange - this.sizeAfterChange; i++) {\n\t\t\t\tthis.labels[i] = obj.getText(i + this.sizeAfterChange);\n\t\t\t\tthis.colors[i] = obj.getTextColor(i + this.sizeAfterChange);\n\t\t\t}\n\t\t}\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNumElements(this.objectID, this.sizeBeforeChange);\n\t\tif (this.sizeBeforeChange > this.sizeAfterChange) {\n\t\t\tfor (let i = 0; i < this.sizeBeforeChange - this.sizeAfterChange; i++) {\n\t\t\t\tworld.setText(this.objectID, this.labels[i], i + this.sizeAfterChange);\n\t\t\t\tworld.setTextColor(this.objectID, this.colors[i], i + this.sizeAfterChange);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class UndoSetAlpha extends UndoBlock {\n\tconstructor(id, alph) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.alphaVal = alph;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setAlpha(this.objectID, this.alphaVal);\n\t}\n}\n\nexport class UndoSetNull extends UndoBlock {\n\tconstructor(id, nv) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.nullVal = nv;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNull(this.objectID, this.nullVal);\n\t}\n}\n\nexport class UndoSetPrevNull extends UndoBlock {\n\tconstructor(id, nv) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.nullVal = nv;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setPrevNull(this.objectID, this.nullVal);\n\t}\n}\n\nexport class UndoSetNextNull extends UndoBlock {\n\tconstructor(id, nv) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.nullVal = nv;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNextNull(this.objectID, this.nullVal);\n\t}\n}\n\nexport class UndoSetForegroundColor extends UndoBlock {\n\tconstructor(id, color) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.color = color;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setForegroundColor(this.objectID, this.color);\n\t}\n}\n\nexport class UndoSetBackgroundColor extends UndoBlock {\n\tconstructor(id, color) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.color = color;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setBackgroundColor(this.objectID, this.color);\n\t}\n}\n\nexport class UndoSetHighlightIndex extends UndoBlock {\n\tconstructor(id, index) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.index = index;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setHighlightIndex(this.objectID, this.index);\n\t}\n}\n\nexport class UndoSetText extends UndoBlock {\n\tconstructor(id, str, index) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.newText = str;\n\t\tthis.labelIndex = index;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setText(this.objectID, this.newText, this.labelIndex);\n\t}\n}\n\nexport class UndoSetTextColor extends UndoBlock {\n\tconstructor(id, color, index) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.color = color;\n\t\tthis.index = index;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setTextColor(this.objectID, this.color, this.index);\n\t}\n}\n\nexport class UndoHighlightEdge extends UndoBlock {\n\tconstructor(from, to, val) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.highlightValue = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeHighlight(this.fromID, this.toID, this.highlightValue);\n\t}\n}\n\nexport class UndoSetEdgeThickness extends UndoBlock {\n\tconstructor(from, to, val) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.thickness = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeThickness(this.fromID, this.toID, this.thickness);\n\t}\n}\n\nexport class UndoSetEdgeColor extends UndoBlock {\n\tconstructor(from, to, oldColor) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.color = oldColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeColor(this.fromID, this.toID, this.color);\n\t}\n}\n\nexport class UndoSetEdgeAlpha extends UndoBlock {\n\tconstructor(from, to, oldAplha) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.alpha = oldAplha;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeAlpha(this.fromID, this.toID, this.alpha);\n\t}\n}\n\nexport class UndoSetPosition extends UndoBlock {\n\tconstructor(id, x, y) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t}\n}\n\nexport class UndoSetAlwaysOnTop extends UndoBlock {\n\tconstructor(id, onTop) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.onTop = onTop;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setAlwaysOnTop(this.objectID, this.onTop);\n\t}\n}\n\nexport class UndoSetRectangleEdgeThickness extends UndoBlock {\n\tconstructor(id, thicknessArray) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.thicknessArray = thicknessArray;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setRectangleEdgeThickness(this.objectID, this.thicknessArray);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nexport default class AnimatedObject {\n\tconstructor() {\n\t\tthis.objectID = -1;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\n\t\tthis.backgroundColor = '#FFFFFF';\n\t\tthis.foregroundColor = '#000000';\n\t\tthis.highlighted = false;\n\n\t\tthis.label = '';\n\t\tthis.labelColor = '#000000';\n\n\t\tthis.layer = 0;\n\t\tthis.alpha = 1.0;\n\t\tthis.minHeightDiff = 3;\n\t\tthis.range = 5;\n\n\t\tthis.highlightIndex = -1;\n\t\tthis.highlightIndexDirty = true;\n\n\t\tthis.addedToScene = true;\n\t}\n\n\tsetBackgroundColor(newColor) {\n\t\tthis.backgroundColor = newColor;\n\t}\n\n\tsetNull() {}\n\n\tgetNull() {\n\t\treturn false;\n\t}\n\n\tsetAlpha(newAlpha) {\n\t\tthis.alpha = newAlpha;\n\t}\n\n\tgetAlpha() {\n\t\treturn this.alpha;\n\t}\n\n\tsetForegroundColor(newColor) {\n\t\tthis.foregroundColor = newColor;\n\t\tthis.labelColor = newColor;\n\t}\n\n\tgetHighlight() {\n\t\treturn this.highlighted;\n\t}\n\n\tgetWidth() {\n\t\t// TODO:  Do we want to throw here?  Should always override this ...\n\t\treturn 0;\n\t}\n\n\tgetHeight() {\n\t\t// TODO:  Do we want to throw here?  Should always override this ...\n\t\treturn 0;\n\t}\n\n\tsetHighlight(value, color) {\n\t\tthis.highlighted = value;\n\t\tthis.highlightColor = color || '#ff0000';\n\t}\n\n\tcenterX() {\n\t\treturn this.x;\n\t}\n\n\tsetWidth() {\n\t\tthrow new Error('setWidth() should be implemented in a base class');\n\t}\n\n\tcenterY() {\n\t\treturn this.y;\n\t}\n\n\tgetAlignLeftPos(otherObject) {\n\t\treturn [otherObject.right() + this.getWidth() / 2, otherObject.centerY()];\n\t}\n\n\tgetAlignRightPos(otherObject) {\n\t\treturn [otherObject.left() - this.getWidth() / 2, otherObject.centerY()];\n\t}\n\n\tgetAlignTopPos(otherObject) {\n\t\treturn [otherObject.centerX(), otherObject.top() - this.getHeight() / 2];\n\t}\n\n\tgetAlignBottomPos(otherObject) {\n\t\treturn [otherObject.centerX(), otherObject.bottom() + this.getHeight() / 2];\n\t}\n\n\talignLeft(otherObject) {\n\t\t// Assuming centering.  Overridden method could modify if not centered\n\t\t//  (See AnimatedLabel, for instance)\n\t\tthis.y = otherObject.centerY();\n\t\tthis.x = otherObject.right() + this.getWidth() / 2;\n\t}\n\n\talignRight(otherObject) {\n\t\t// Assuming centering.  Overridden method could modify if not centered\n\t\t//  (See AnimatedLabel, for instance)\n\t\tthis.y = otherObject.centerY();\n\t\tthis.x = otherObject.left() - this.getWidth() / 2;\n\t}\n\n\talignTop(otherObject) {\n\t\t// Assuming centering.  Overridden method could modify if not centered\n\t\tthis.x = otherObject.centerX();\n\t\tthis.y = otherObject.top() - this.getHeight() / 2;\n\t}\n\n\talignBottom(otherObject) {\n\t\tthis.x = otherObject.centerX();\n\t\tthis.y = otherObject.bottom() + this.getHeight() / 2;\n\t}\n\n\tgetClosestCardinalPoint(fromX, fromY) {\n\t\tlet xDelta;\n\t\tlet yDelta;\n\t\tlet xPos;\n\t\tlet yPos;\n\n\t\tif (fromX < this.left()) {\n\t\t\txDelta = this.left() - fromX;\n\t\t\txPos = this.left();\n\t\t} else if (fromX > this.right()) {\n\t\t\txDelta = fromX - this.right();\n\t\t\txPos = this.right();\n\t\t} else {\n\t\t\txDelta = 0;\n\t\t\txPos = this.centerX();\n\t\t}\n\n\t\tif (fromY < this.top()) {\n\t\t\tyDelta = this.top() - fromY;\n\t\t\tyPos = this.top();\n\t\t} else if (fromY > this.bottom()) {\n\t\t\tyDelta = fromY - this.bottom();\n\t\t\tyPos = this.bottom();\n\t\t} else {\n\t\t\tyDelta = 0;\n\t\t\tyPos = this.centerY();\n\t\t}\n\n\t\tif (yDelta > xDelta) {\n\t\t\txPos = this.centerX();\n\t\t} else {\n\t\t\tyPos = this.centerY();\n\t\t}\n\n\t\treturn [xPos, yPos];\n\t}\n\n\tcentered() {\n\t\treturn false;\n\t}\n\n\tpulseHighlight(frameNum) {\n\t\tif (this.highlighted) {\n\t\t\tconst frameMod = frameNum / 7.0;\n\t\t\tconst delta = Math.abs((frameMod % (2 * this.range - 2)) - this.range + 1);\n\t\t\tthis.highlightDiff = delta + this.minHeightDiff;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos() {\n\t\treturn [this.x, this.y];\n\t}\n\n\tgetHeadPointerAttachPos() {\n\t\treturn [this.x, this.y];\n\t}\n\n\tidentifier() {\n\t\treturn this.objectID;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColor;\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColor = color;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t}\n\n\tsetHighlightIndex(hlIndex) {\n\t\tthis.highlightIndex = hlIndex;\n\t\tthis.highlightIndexDirty = true;\n\t}\n\n\tgetHighlightIndex() {\n\t\treturn this.highlightIndex;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nconst MIN_WIDTH = 10;\nconst EDGE_POINTER_DISPLACEMENT = 5;\n\nexport default class AnimatedBTreeNode extends AnimatedObject {\n\tconstructor(objectID, widthPerElement, h, numLabels, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\n\t\tthis.widthPerElement = widthPerElement;\n\t\tthis.h = h;\n\t\tthis.numLabels = numLabels;\n\t\tthis.labels = [];\n\t\tthis.labelColors = [];\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tthis.labelColors[i] = this.foregroundColor;\n\t\t}\n\t}\n\n\tgetNumElements() {\n\t\treturn this.numLabels;\n\t}\n\n\tgetWidth() {\n\t\tif (this.numLabels > 0) {\n\t\t\treturn this.widthPerElement * this.numLabels;\n\t\t} else {\n\t\t\treturn MIN_WIDTH;\n\t\t}\n\t}\n\n\tsetNumElements(newNumElements) {\n\t\tif (this.numLabels < newNumElements) {\n\t\t\tfor (let i = this.numLabels; i < newNumElements; i++) {\n\t\t\t\tthis.labels[i] = '';\n\t\t\t\tthis.labelColors[i] = this.foregroundColor;\n\t\t\t}\n\t\t\tthis.numLabels = newNumElements;\n\t\t} else if (this.numLabels > newNumElements) {\n\t\t\tfor (let i = newNumElements; i < this.numLabels; i++) {\n\t\t\t\tthis.labels[i] = null;\n\t\t\t}\n\t\t\tthis.numLabels = newNumElements;\n\t\t}\n\t}\n\n\tleft() {\n\t\treturn this.x - this.getWidth() / 2.0;\n\t}\n\n\tright() {\n\t\treturn this.x + this.getWidth() / 2.0;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2.0;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2.0;\n\t}\n\n\tdraw(context) {\n\t\tlet startX;\n\n\t\tstartX = this.left();\n\t\tif (isNaN(startX)) {\n\t\t\tstartX = 0;\n\t\t}\n\t\tconst startY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\tcontext.fillStyle = '#FF0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.getWidth() + this.highlightDiff,\n\t\t\t\tstartY - this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.getWidth() + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.getWidth(), startY);\n\t\tcontext.lineTo(startX + this.getWidth(), startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.textBaseline = 'middle';\n\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tconst labelX =\n\t\t\t\tthis.x -\n\t\t\t\t(this.widthPerElement * this.numLabels) / 2 +\n\t\t\t\tthis.widthPerElement / 2 +\n\t\t\t\ti * this.widthPerElement;\n\t\t\tconst labelY = this.y;\n\n\t\t\tcontext.fillStyle = this.labelColors[i];\n\t\t\tcontext.fillText(this.labels[i], labelX, labelY);\n\t\t}\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tsetForegroundColor(newColor) {\n\t\tthis.foregroundColor = newColor;\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tthis.labelColor[i] = newColor;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tif (anchor === 0) {\n\t\t\treturn [this.left() + EDGE_POINTER_DISPLACEMENT, this.y];\n\t\t} else if (anchor === this.numLabels) {\n\t\t\treturn [this.right() - EDGE_POINTER_DISPLACEMENT, this.y];\n\t\t} else {\n\t\t\treturn [this.left() + anchor * this.widthPerElement, this.y];\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tif (fromY < this.y - this.h / 2) {\n\t\t\treturn [this.x, this.y - this.h / 2];\n\t\t} else if (this.fromY > this.y + this.h / 2) {\n\t\t\treturn [this.x, this.y + this.h / 2];\n\t\t} else if (fromX < this.x - this.getWidth() / 2) {\n\t\t\treturn [this.x - this.getWidth() / 2, this.y];\n\t\t} else {\n\t\t\treturn [this.x + this.getWidth() / 2, this.y];\n\t\t}\n\t}\n\n\tgetTextColor(textIndex) {\n\t\ttextIndex = textIndex || 0;\n\t\treturn this.labelColors[textIndex];\n\t}\n\n\tgetText(index) {\n\t\tindex = index || 0;\n\t\treturn this.labels[index];\n\t}\n\n\tsetTextColor(color, textIndex) {\n\t\ttextIndex = textIndex || 0;\n\t\tthis.labelColors[textIndex] = color;\n\t}\n\n\tsetText(newText, textIndex) {\n\t\ttextIndex = textIndex || 0;\n\t\tthis.labels[textIndex] = newText;\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteBTreeNode(\n\t\t\tthis.objectID,\n\t\t\tthis.numLabels,\n\t\t\tthis.labels,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.widthPerElement,\n\t\t\tthis.h,\n\t\t\tthis.labelColors,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteBTreeNode extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tnumLabels,\n\t\tlabels,\n\t\tx,\n\t\ty,\n\t\twidthPerElement,\n\t\th,\n\t\tlabelColors,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlayer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.numLabels = numLabels;\n\t\tthis.labels = labels;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.widthPerElement = widthPerElement;\n\t\tthis.h = h;\n\t\tthis.labelColors = labelColors;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.layer = layer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addBTreeNode(\n\t\t\tthis.objectID,\n\t\t\tthis.widthPerElement,\n\t\t\tthis.h,\n\t\t\tthis.numLabels,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tworld.setText(this.objectID, this.labels[i], i);\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\n\t\t}\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject';\nimport { UndoBlock } from './UndoFunctions';\n\nexport default class AnimatedCircle extends AnimatedObject {\n\tconstructor(objectID, label) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.label = label;\n\n\t\tthis.radius = 20;\n\t\tthis.thickness = 3;\n\t\tthis.highlightIndex = -1;\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY) {\n\t\treturn this.getHeadPointerAttachPos(fromX, fromY);\n\t}\n\n\tgetWidth() {\n\t\treturn this.radius * 2;\n\t}\n\n\tsetWidth(newWidth) {\n\t\tthis.radius = newWidth / 2;\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tconst xVec = fromX - this.x;\n\t\tconst yVec = fromY - this.y;\n\t\tconst len = Math.sqrt(xVec * xVec + yVec * yVec);\n\t\tif (len === 0) return [this.x, this.y];\n\t\treturn [this.x + (xVec / len) * this.radius, this.y + (yVec / len) * this.radius];\n\t}\n\n\tsetHighlightIndex(hlIndex) {\n\t\tthis.highlightIndex = hlIndex;\n\t\tthis.highlightIndexDirty = true;\n\t}\n\n\tdraw(context) {\n\t\tcontext.globalAlpha = this.alpha;\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.fillStyle = this.highlightColor;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.arc(this.x, this.y, this.radius + this.highlightDiff, 0, Math.PI * 2, true);\n\t\t\tcontext.closePath();\n\t\t\tcontext.fill();\n\t\t}\n\n\t\tcontext.fillStyle = this.backgroundColor;\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.lineWidth = 1.2;\n\t\tcontext.beginPath();\n\t\tcontext.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true);\n\t\tcontext.closePath();\n\t\tcontext.fill();\n\t\tcontext.stroke();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\t\tcontext.fillStyle = this.foregroundColor;\n\t\tconst strList = this.label.split('\\n');\n\t\tif (strList.length === 1) {\n\t\t\tif (this.highlightIndexDirty && this.highlightIndex !== -1) {\n\t\t\t\tthis.leftWidth = context.measureText(\n\t\t\t\t\tthis.label.substring(0, this.highlightIndex),\n\t\t\t\t).width;\n\t\t\t\tthis.centerWidth = context.measureText(\n\t\t\t\t\tthis.label.substring(this.highlightIndex, this.highlightIndex + 1),\n\t\t\t\t).width;\n\t\t\t\tthis.textWidth = context.measureText(this.label).width;\n\t\t\t\tthis.highlightIndexDirty = false;\n\t\t\t}\n\t\t\tif (this.highlightIndex !== -1 && this.highlightIndex < this.label.length) {\n\t\t\t\tconst startingXForHighlight = this.x - this.textWidth / 2;\n\t\t\t\tcontext.textAlign = 'left';\n\t\t\t\tconst leftStr = this.label.substring(0, this.highlightIndex);\n\t\t\t\tconst highlightStr = this.label.substring(\n\t\t\t\t\tthis.highlightIndex,\n\t\t\t\t\tthis.highlightIndex + 1,\n\t\t\t\t);\n\t\t\t\tconst rightStr = this.label.substring(this.highlightIndex + 1);\n\t\t\t\tcontext.fillText(leftStr, startingXForHighlight, this.y);\n\t\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\t\tcontext.fillStyle = '#FF0000';\n\t\t\t\tcontext.fillText(highlightStr, startingXForHighlight + this.leftWidth, this.y);\n\n\t\t\t\tcontext.strokeStyle = this.labelColor;\n\t\t\t\tcontext.fillStyle = this.labelColor;\n\t\t\t\tcontext.fillText(\n\t\t\t\t\trightStr,\n\t\t\t\t\tstartingXForHighlight + this.leftWidth + this.centerWidth,\n\t\t\t\t\tthis.y,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tcontext.fillText(this.label, this.x, this.y);\n\t\t\t}\n\t\t} else if (strList.length % 2 === 0) {\n\t\t\tconst mid = strList.length / 2;\n\t\t\tfor (let i = 0; i < strList.length / 2; i++) {\n\t\t\t\tcontext.fillText(strList[mid - i - 1], this.x, this.y - (i + 0.5) * 12);\n\t\t\t\tcontext.fillText(strList[mid + i], this.x, this.y + (i + 0.5) * 12);\n\t\t\t}\n\t\t} else {\n\t\t\tconst mid = (strList.length - 1) / 2;\n\t\t\tcontext.fillText(strList[mid], this.x, this.y);\n\t\t\tfor (let i = 0; i < mid; i++) {\n\t\t\t\tcontext.fillText(strList[mid - (i + 1)], this.x, this.y - (i + 1) * 12);\n\t\t\t\tcontext.fillText(strList[mid + (i + 1)], this.x, this.y + (i + 1) * 12);\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteCircle(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.radius,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteCircle extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tx,\n\t\ty,\n\t\tforegroundColor,\n\t\tbackgroundColor,\n\t\tlayer,\n\t\tradius,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.layer = layer;\n\t\tthis.radius = radius;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addCircleObject(this.objectID, this.label);\n\t\tworld.setWidth(this.objectID, this.radius * 2);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setForegroundColor(this.objectID, this.foregroundColor);\n\t\tworld.setBackgroundColor(this.objectID, this.backgroundColor);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedCircularlyLinkedListNode extends AnimatedObject {\n\tconstructor(objectID, label, w, h, linkPercent, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.nullPointer = false;\n\n\t\tthis.label = label;\n\t\tthis.labelPosX = 0;\n\t\tthis.labelPosY = 0;\n\t\tthis.labelColor = foregroundColor;\n\t}\n\n\tsetNull(np) {\n\t\tif (this.nullPointer !== np) {\n\t\t\tthis.nullPointer = np;\n\t\t}\n\t}\n\n\tgetNull() {\n\t\treturn this.nullPointer;\n\t}\n\n\tleft() {\n\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\n\t}\n\n\tright() {\n\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2.0;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2.0;\n\t}\n\n\tresetTextPosition() {\n\t\tthis.labelPosX = this.x;\n\t\tthis.labelPosY = this.y;\n\t}\n\n\tgetTailPointerAttachPos() {\n\t\treturn [this.x + this.w / 2.0, this.y];\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tif (fromX < this.x) {\n\t\t\treturn this.getClosestCardinalPoint(fromX, fromY); // Normal anchor\n\t\t} else {\n\t\t\treturn [this.x, this.bottom()]; // Curved pointer coming from the right, connect to bottom\n\t\t}\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t\tthis.resetTextPosition();\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tstartX = this.left();\n\t\tstartY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\tcontext.fillStyle = '#FF0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tstartX = this.right() - this.w * this.linkPercent;\n\t\tstartY = this.top();\n\n\t\tcontext.lineWidth = 1;\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tif (this.nullPointer) {\n\t\t\tcontext.lineTo(this.right(), startY + this.h);\n\t\t}\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\n\t\tthis.resetTextPosition();\n\t\tcontext.fillStyle = this.labelColor;\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColor = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColor;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteCircularlyLinkedList(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.labelColor,\n\t\t\tthis.layer,\n\t\t\tthis.nullPointer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteCircularlyLinkedList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlinkPercent,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlabelColor,\n\t\tlayer,\n\t\tnullPointer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.labelColor = labelColor;\n\t\tthis.layer = layer;\n\t\tthis.nullPointer = nullPointer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addCircularlyLinkedListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setNull(this.objectID, this.nullPointer);\n\t\tworld.setTextColor(this.objectID, this.labelColor);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedDoublyLinkedListNode extends AnimatedObject {\n\tconstructor(objectID, label, w, h, linkPercent, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.prevNullPointer = false;\n\t\tthis.nextNullPointer = false;\n\n\t\tthis.label = label;\n\t\tthis.labelPosX = 0;\n\t\tthis.labelPosY = 0;\n\t\tthis.labelColor = foregroundColor;\n\t}\n\n\tsetPrevNull(np) {\n\t\tif (this.prevNullPointer !== np) {\n\t\t\tthis.prevNullPointer = np;\n\t\t}\n\t}\n\n\tsetNextNull(np) {\n\t\tif (this.nextNullPointer !== np) {\n\t\t\tthis.nextNullPointer = np;\n\t\t}\n\t}\n\n\tgetLeftNull() {\n\t\treturn this.prevNullPointer;\n\t}\n\n\tgetRightNull() {\n\t\treturn this.nextNullPointer;\n\t}\n\n\tleft() {\n\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\n\t}\n\n\tright() {\n\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2.0;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2.0;\n\t}\n\n\tresetTextPosition() {\n\t\tthis.labelPosY = this.y;\n\t\tthis.labelPosX = this.left() + this.w * (this.linkPercent * 2);\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tif (anchor === 0) {\n\t\t\treturn [this.x + this.w / 2.0, this.y - this.h * 0.2];\n\t\t} else {\n\t\t\treturn [this.left() + (this.w * this.linkPercent) / 2, this.y + this.h * 0.2];\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tconst closest = this.getClosestCardinalPoint(fromX, fromY);\n\t\tif (closest[1] === this.y) {\n\t\t\tif (closest[0] === this.left()) {\n\t\t\t\treturn [closest[0], this.y - this.h * 0.2];\n\t\t\t} else {\n\t\t\t\treturn [closest[0], this.y + this.h * 0.2];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [closest[0], closest[1]];\n\t\t}\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t\tthis.resetTextPosition();\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tstartX = this.left();\n\t\tstartY = this.top();\n\n\t\t// Highlighted edges\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\tcontext.fillStyle = '#FF0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\n\t\t// Node edges\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.lineWidth = 1;\n\t\t// Left inner line between node and pointer area\n\t\tstartX = this.left() + this.w * this.linkPercent;\n\t\tstartY = this.top();\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tif (this.prevNullPointer) {\n\t\t\t// Left null marker\n\t\t\tcontext.moveTo(this.left(), startY);\n\t\t\tcontext.lineTo(this.left() + this.w * this.linkPercent, startY + this.h);\n\t\t}\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\n\t\t// Right inner line between node and pointer area\n\t\tstartX = this.right() - this.w * this.linkPercent;\n\t\tstartY = this.top();\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tif (this.nextNullPointer) {\n\t\t\t// Right null marker\n\t\t\tcontext.moveTo(this.right() - this.w * this.linkPercent, startY);\n\t\t\tcontext.lineTo(this.right(), startY + this.h);\n\t\t}\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\n\t\t// Label\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\t\tthis.resetTextPosition();\n\t\tcontext.fillStyle = this.labelColor;\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColors = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColors;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteDoublyLinkedList(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.labelColor,\n\t\t\tthis.layer,\n\t\t\tthis.prevNullPointer,\n\t\t\tthis.nextNullPointer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteDoublyLinkedList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlinkPercent,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlabelColor,\n\t\tlayer,\n\t\tpnp,\n\t\tnnp,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.labelColors = labelColor;\n\t\tthis.layer = layer;\n\t\tthis.prevNullPointer = pnp;\n\t\tthis.nextNullPointer = nnp;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addDoublyLinkedListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setPrevNull(this.objectID, this.prevNullPointer);\n\t\tworld.setNextNull(this.objectID, this.nextNullPointer);\n\t\tworld.setTextColor(this.objectID, this.labelColor);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// \"Class\" animatedCircle\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedHighlightCircle extends AnimatedObject {\n\tconstructor(objectID, foregroundColor, radius) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.radius = radius;\n\t\tthis.thickness = 4;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t}\n\n\tdraw(context) {\n\t\tcontext.globalAlpha = this.alpha;\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.lineWidth = this.thickness;\n\t\tcontext.beginPath();\n\t\tcontext.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteHighlightCircle(\n\t\t\tthis.objectID,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.radius,\n\t\t\tthis.layer,\n\t\t\tthis.alpha,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteHighlightCircle extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tx,\n\t\ty,\n\t\tforegroundColor,\n\t\tradius,\n\t\tlayer,\n\t\talpha,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.radius = radius;\n\t\tthis.layer = layer;\n\t\tthis.alpha = alpha;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addHighlightCircleObject(this.objectID, this.foregroundColor, this.radius);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setAlpha(this.objectID, this.alpha);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedLabel extends AnimatedObject {\n\tconstructor(objectID, label, centered, initialWidth) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.textWidth = initialWidth || 0;\n\n\t\tthis.label = label;\n\t\tthis.labelColor = '#000000';\n\t\tthis.highlighted = false;\n\t\tthis.centered = centered;\n\n\t\tthis.leftWidth = -1;\n\t\tthis.centerWidth = -1;\n\t\tthis.highlightIndex = -1;\n\t}\n\n\tcentered() {\n\t\treturn this.centered;\n\t}\n\n\tdraw(context) {\n\t\tif (!this.addedToScene) return;\n\n\t\tcontext.globalAlpha = this.alpha;\n\t\tcontext.font = '12px Arial';\n\n\t\tlet startingXForHighlight = this.x;\n\n\t\tif (this.highlightIndex >= this.label.length) {\n\t\t\tthis.highlightIndex = -1;\n\t\t}\n\t\tif (this.highlightIndexDirty && this.highlightIndex !== -1) {\n\t\t\tthis.leftWidth = context.measureText(\n\t\t\t\tthis.label.substring(0, this.highlightIndex),\n\t\t\t).width;\n\t\t\tthis.centerWidth = context.measureText(\n\t\t\t\tthis.label.substring(this.highlightIndex, this.highlightIndex + 1),\n\t\t\t).width;\n\t\t\tthis.highlightIndexDirty = false;\n\t\t}\n\n\t\tif (this.centered) {\n\t\t\tif (this.highlightIndex !== -1) {\n\t\t\t\tstartingXForHighlight = this.x - this.width / 2;\n\t\t\t\tcontext.textAlign = 'left';\n\t\t\t\tcontext.textBaseline = 'middle';\n\t\t\t} else {\n\t\t\t\tcontext.textAlign = 'center';\n\t\t\t\tcontext.textBaseline = 'middle';\n\t\t\t}\n\t\t} else {\n\t\t\tcontext.textAlign = 'left';\n\t\t\tcontext.textBaseline = 'top';\n\t\t}\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FFAAAA';\n\t\t\tcontext.fillStyle = '#FF0000';\n\t\t\tcontext.lineWidth = this.highlightDiff;\n\t\t\tcontext.strokeText(this.label, this.x, this.y);\n\t\t}\n\t\tcontext.strokeStyle = this.labelColor;\n\t\tcontext.fillStyle = this.labelColor;\n\t\tcontext.lineWidth = 2;\n\t\tconst strList = this.label.split('\\n');\n\t\tif (strList.length === 1) {\n\t\t\tif (this.highlightIndex === -1) {\n\t\t\t\tcontext.fillText(this.label, this.x, this.y);\n\t\t\t} else {\n\t\t\t\tconst leftStr = this.label.substring(0, this.highlightIndex);\n\t\t\t\tconst highlightStr = this.label.substring(\n\t\t\t\t\tthis.highlightIndex,\n\t\t\t\t\tthis.highlightIndex + 1,\n\t\t\t\t);\n\t\t\t\tconst rightStr = this.label.substring(this.highlightIndex + 1);\n\t\t\t\tcontext.fillText(leftStr, startingXForHighlight, this.y);\n\t\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\t\tcontext.fillStyle = '#FF0000';\n\t\t\t\tcontext.fillText(highlightStr, startingXForHighlight + this.leftWidth, this.y);\n\n\t\t\t\tcontext.strokeStyle = this.labelColor;\n\t\t\t\tcontext.fillStyle = this.labelColor;\n\t\t\t\tcontext.fillText(\n\t\t\t\t\trightStr,\n\t\t\t\t\tstartingXForHighlight + this.leftWidth + this.centerWidth,\n\t\t\t\t\tthis.y,\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tconst offset = this.centered ? (1.0 - strList.length) / 2.0 : 0;\n\t\t\tfor (let i = 0; i < strList.length; i++) {\n\t\t\t\tcontext.fillText(strList[i], this.x, this.y + offset + i * 12);\n\t\t\t}\n\t\t}\n\t\tcontext.closePath();\n\t}\n\n\tgetAlignLeftPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.left() - this.textWidth / 2, (this.y = otherObject.centerY())];\n\t\t} else {\n\t\t\treturn [otherObject.left() - this.textWidth, otherObject.centerY() - 5];\n\t\t}\n\t}\n\n\talignLeft(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.centerY();\n\t\t\tthis.x = otherObject.left() - this.textWidth / 2;\n\t\t} else {\n\t\t\tthis.y = otherObject.centerY() - 5;\n\t\t\tthis.x = otherObject.left() - this.textWidth;\n\t\t}\n\t}\n\n\talignRight(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.centerY();\n\t\t\tthis.x = otherObject.right() + this.textWidth / 2;\n\t\t} else {\n\t\t\tthis.y = otherObject.centerY() - 5;\n\t\t\tthis.x = otherObject.right();\n\t\t}\n\t}\n\n\tgetAlignRightPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.right() + this.textWidth / 2, otherObject.centerY()];\n\t\t} else {\n\t\t\treturn [otherObject.right(), otherObject.centerY() - 5];\n\t\t}\n\t}\n\n\talignTop(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.top() - 5;\n\t\t\tthis.x = otherObject.centerX();\n\t\t} else {\n\t\t\tthis.y = otherObject.top() - 10;\n\t\t\tthis.x = otherObject.centerX() - this.textWidth / 2;\n\t\t}\n\t}\n\n\tgetAlignTopPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.centerX(), otherObject.top() - 5];\n\t\t} else {\n\t\t\treturn [otherObject.centerX() - this.textWidth / 2, otherObject.top() - 10];\n\t\t}\n\t}\n\n\talignBottom(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.bottom() + 5;\n\t\t\tthis.x = otherObject.centerX();\n\t\t} else {\n\t\t\tthis.y = otherObject.bottom();\n\t\t\tthis.x = otherObject.centerX() - this.textWidth / 2;\n\t\t}\n\t}\n\n\tgetAlignBottomPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.centerX(), otherObject.bottom() + 5];\n\t\t} else {\n\t\t\treturn [otherObject.centerX() - this.textWidth / 2, otherObject.bottom()];\n\t\t}\n\t}\n\n\tgetWidth() {\n\t\treturn this.textWidth;\n\t}\n\n\tgetHeight() {\n\t\treturn 10; // HACK!  HACK!  HACK!  HACK!\n\t}\n\n\tsetHighlight(value) {\n\t\tthis.highlighted = value;\n\t}\n\n\tcenterX() {\n\t\tif (this.centered) {\n\t\t\treturn this.x;\n\t\t} else {\n\t\t\treturn this.x + this.textWidth;\n\t\t}\n\t}\n\n\tcenterY() {\n\t\tif (this.centered) {\n\t\t\treturn this.y;\n\t\t} else {\n\t\t\treturn this.y + 5;\n\t\t}\n\t}\n\n\ttop() {\n\t\tif (this.centered) {\n\t\t\treturn this.y - 5; //TODO: Un-Hardwire\n\t\t} else {\n\t\t\treturn this.y;\n\t\t}\n\t}\n\n\tbottom() {\n\t\tif (this.centered) {\n\t\t\treturn this.y + 5; // TODO: + height / 2;\n\t\t} else {\n\t\t\treturn this.y + 10; // TODO: + hieght;\n\t\t}\n\t}\n\n\tright() {\n\t\tif (this.centered) {\n\t\t\treturn this.x + this.textWidth / 2; // TODO: + width / 2;\n\t\t} else {\n\t\t\treturn this.x + this.textWidth; // TODO: + width;\n\t\t}\n\t}\n\n\tleft() {\n\t\tif (this.centered) {\n\t\t\treturn this.x - this.textWidth / 2;\n\t\t} else {\n\t\t\treturn this.x; // TODO:  - a little?\n\t\t}\n\t}\n\n\tsetHighlightIndex(hlIndex) {\n\t\t// Only allow highlight index for labels that don't have End-Of-Line\n\t\tif (this.label.indexOf('\\n') === -1 && this.label.length > hlIndex) {\n\t\t\tthis.highlightIndex = hlIndex;\n\t\t\tthis.highlightIndexDirty = true;\n\t\t} else {\n\t\t\tthis.highlightIndex = -1;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tsetText(newText, textIndex, initialWidth) {\n\t\tthis.label = newText;\n\t\tif (initialWidth != null) {\n\t\t\tthis.textWidth = initialWidth;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteLabel(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.centered,\n\t\t\tthis.labelColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlightIndex,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteLabel extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tx,\n\t\ty,\n\t\tcentered,\n\t\tlabelColor,\n\t\tlayer,\n\t\thighlightIndex,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.centered = centered;\n\t\tthis.labelColor = labelColor;\n\t\tthis.layer = layer;\n\t\tthis.highlightIndex = highlightIndex;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addLabelObject(this.objectID, this.label, this.centered);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setForegroundColor(this.objectID, this.labelColor);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// This class handles links between vertices in graphs, pointers in linked lists, and so on.\n\nconst LINE_MAX_HEIGHT_DIFF = 5;\nconst LINE_MIN_HEIGHT_DIFF = 3;\nconst LINE_RANGE = LINE_MAX_HEIGHT_DIFF - LINE_MIN_HEIGHT_DIFF + 1;\n\nexport default class AnimatedLine {\n\tconstructor(fromID, toID, color, curve, directed, edgeLabel, anchorPoint, thickness) {\n\t\tthis.fromID = fromID;\n\t\tthis.toID = toID;\n\n\t\tthis.foregroundColor = color;\n\t\tthis.edgeLabel = edgeLabel;\n\t\tthis.highlighted = false;\n\t\tthis.highlightDiff = 0;\n\n\t\tthis.dirty = false;\n\t\tthis.directed = directed;\n\t\tthis.anchorPoint = anchorPoint;\n\n\t\tthis.alpha = 1.0;\n\t\tthis.thickness = thickness;\n\t\tthis.arrowHeight = 8;\n\t\tthis.arrowWidth = 4;\n\t\tthis.curve = curve;\n\t}\n\n\tcolor() {\n\t\treturn this.foregroundColor;\n\t}\n\n\tsetColor(newColor) {\n\t\tthis.foregroundColor = newColor;\n\t\tthis.dirty = true;\n\t}\n\n\tsetHighlight(highlightVal, color) {\n\t\tthis.highlighted = highlightVal;\n\t\tthis.highlightColor = color || '#FF0000';\n\t}\n\n\tsetThickness(thickness) {\n\t\tthis.thickness = thickness;\n\t}\n\n\tpulseHighlight(frameNum) {\n\t\tif (this.highlighted) {\n\t\t\tconst frameMod = frameNum / 14.0;\n\t\t\tconst delta = Math.abs((frameMod % (2 * LINE_RANGE - 2)) - LINE_RANGE + 1);\n\t\t\tthis.highlightDiff = delta + this.thickness + LINE_MIN_HEIGHT_DIFF;\n\t\t\tthis.dirty = true;\n\t\t}\n\t}\n\n\thasNode(n) {\n\t\treturn this.fromID === n || this.toID === n;\n\t}\n\n\tsign(n) {\n\t\tif (n > 0) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tdrawArrow(thickness, color, context) {\n\t\tcontext.strokeStyle = color;\n\t\tcontext.fillStyle = color;\n\t\tcontext.lineWidth = thickness;\n\n\t\tconst fromPos = this.fromID.getTailPointerAttachPos(\n\t\t\tthis.toID.x,\n\t\t\tthis.toID.y,\n\t\t\tthis.anchorPoint,\n\t\t);\n\t\tconst toPos = this.toID.getHeadPointerAttachPos(this.fromID.x, this.fromID.y);\n\n\t\tconst deltaX = toPos[0] - fromPos[0];\n\t\tconst deltaY = toPos[1] - fromPos[1];\n\t\tconst midX = deltaX / 2.0 + fromPos[0];\n\t\tconst midY = deltaY / 2.0 + fromPos[1];\n\t\tconst controlX = midX - deltaY * this.curve;\n\n\t\tconst controlY = midY + deltaX * this.curve;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(fromPos[0], fromPos[1]);\n\t\tcontext.quadraticCurveTo(controlX, controlY, toPos[0], toPos[1]);\n\t\tcontext.stroke();\n\n\t\t// Position of the edge label:  First, we will place it right along the\n\t\t// middle of the curve (or the middle of the line, for curve == 0)\n\t\tlet labelPosX = 0.25 * fromPos[0] + 0.5 * controlX + 0.25 * toPos[0];\n\t\tlet labelPosY = 0.25 * fromPos[1] + 0.5 * controlY + 0.25 * toPos[1];\n\n\t\t// Next, we push the edge position label out just a little in the direction of\n\t\t// the curve, so that the label doesn't intersect the cuve (as long as the label\n\t\t// is only a few characters, that is)\n\t\tconst midLen = Math.sqrt(deltaY * deltaY + deltaX * deltaX);\n\t\tif (midLen !== 0) {\n\t\t\tlabelPosX += ((-deltaY * this.sign(this.curve)) / midLen) * 10;\n\t\t\tlabelPosY += ((deltaX * this.sign(this.curve)) / midLen) * 10;\n\t\t}\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.fillText(this.edgeLabel, labelPosX, labelPosY);\n\n\t\tif (this.directed) {\n\t\t\tlet xVec = controlX - toPos[0];\n\t\t\tlet yVec = controlY - toPos[1];\n\t\t\tconst len = Math.sqrt(xVec * xVec + yVec * yVec);\n\n\t\t\tif (len > 0) {\n\t\t\t\txVec = xVec / len;\n\t\t\t\tyVec = yVec / len;\n\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(toPos[0], toPos[1]);\n\t\t\t\tcontext.lineTo(\n\t\t\t\t\ttoPos[0] + xVec * this.arrowHeight - yVec * this.arrowWidth,\n\t\t\t\t\ttoPos[1] + yVec * this.arrowHeight + xVec * this.arrowWidth,\n\t\t\t\t);\n\t\t\t\tcontext.lineTo(\n\t\t\t\t\ttoPos[0] + xVec * this.arrowHeight + yVec * this.arrowWidth,\n\t\t\t\t\ttoPos[1] + yVec * this.arrowHeight - xVec * this.arrowWidth,\n\t\t\t\t);\n\t\t\t\tcontext.lineTo(toPos[0], toPos[1]);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.stroke();\n\t\t\t\tcontext.fill();\n\t\t\t}\n\t\t}\n\t}\n\n\tdraw(context) {\n\t\tcontext.globalAlpha = this.alpha;\n\n\t\tif (this.highlighted) this.drawArrow(this.highlightDiff, this.highlightColor, context);\n\t\tthis.drawArrow(this.thickness, this.foregroundColor, context);\n\t}\n\n\tcreateUndoConnect() {\n\t\treturn new UndoConnect(\n\t\t\tthis.fromID.objectID,\n\t\t\tthis.toID.objectID,\n\t\t\ttrue,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.curve,\n\t\t\tthis.directed,\n\t\t\tthis.edgeLabel,\n\t\t\tthis.anchorPoint,\n\t\t\tthis.thickness,\n\t\t\tthis.highlighted,\n\t\t);\n\t}\n}\n\nexport class UndoConnect {\n\tconstructor(\n\t\tfromID,\n\t\ttoID,\n\t\tcreateConnection,\n\t\tcolor,\n\t\tcurve,\n\t\tdirected,\n\t\tedgeLabel,\n\t\tanchorPoint,\n\t\tthickness,\n\t\thighlighted,\n\t) {\n\t\tthis.fromID = fromID;\n\t\tthis.toID = toID;\n\t\tthis.createConnection = createConnection;\n\t\tthis.color = color;\n\t\tthis.curve = curve;\n\t\tthis.directed = directed;\n\t\tthis.edgeLabel = edgeLabel;\n\t\tthis.anchorPoint = anchorPoint;\n\t\tthis.thickness = thickness;\n\t\tthis.highlighted = highlighted;\n\t}\n\n\tundoInitialStep(world) {\n\t\tif (this.createConnection) {\n\t\t\tworld.connectEdge(\n\t\t\t\tthis.fromID,\n\t\t\t\tthis.toID,\n\t\t\t\tthis.color,\n\t\t\t\tthis.curve,\n\t\t\t\tthis.directed,\n\t\t\t\tthis.edgeLabel,\n\t\t\t\tthis.anchorPoint,\n\t\t\t\tthis.thickness,\n\t\t\t);\n\t\t\tworld.setEdgeHighlight(this.fromID, this.toID, this.highlighted);\n\t\t} else {\n\t\t\tworld.disconnect(this.fromID, this.toID);\n\t\t}\n\t}\n\n\taddUndoAnimation() {\n\t\treturn false;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedLinkedListNode extends AnimatedObject {\n\tconstructor(\n\t\tobjectID,\n\t\tlabels,\n\t\tw,\n\t\th,\n\t\tlinkPercent,\n\t\tvertical,\n\t\tlinkPosEnd,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.vertical = vertical;\n\t\tthis.linkPosEnd = linkPosEnd;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.nullPointer = false;\n\n\t\tthis.labels = labels;\n\t\tthis.labelPosX = [0];\n\t\tthis.labelPosY = [0];\n\t\tthis.labelColors = [foregroundColor];\n\t}\n\n\tleft() {\n\t\tif (this.vertical) {\n\t\t\treturn this.x - this.w / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\n\t\t} else {\n\t\t\treturn this.x - (this.w * (this.linkPercent + 1)) / 2;\n\t\t}\n\t}\n\n\tsetNull(np) {\n\t\tif (this.nullPointer !== np) {\n\t\t\tthis.nullPointer = np;\n\t\t}\n\t}\n\n\tgetNull() {\n\t\treturn this.nullPointer;\n\t}\n\n\tright() {\n\t\tif (this.vertical) {\n\t\t\treturn this.x + this.w / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\n\t\t} else {\n\t\t\treturn this.x + (this.w * (1 - this.linkPercent)) / 2;\n\t\t}\n\t}\n\n\ttop() {\n\t\tif (!this.vertical) {\n\t\t\treturn this.y - this.h / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.y - (this.h * (1 - this.linkPercent)) / 2;\n\t\t} else {\n\t\t\treturn this.y - (this.h * (1 + this.linkPercent)) / 2;\n\t\t}\n\t}\n\n\tbottom() {\n\t\tif (!this.vertical) {\n\t\t\treturn this.y + this.h / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.y + (this.h * (1 + this.linkPercent)) / 2;\n\t\t} else {\n\t\t\treturn this.y + (this.h * (1 - this.linkPercent)) / 2;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tif (this.vertical && this.linkPosEnd) {\n\t\t\treturn [this.x, this.y + this.h / 2.0];\n\t\t} else if (this.vertical && !this.linkPosEnd) {\n\t\t\treturn [this.x, this.y - this.h / 2.0];\n\t\t} else if (!this.vertical && this.linkPosEnd) {\n\t\t\treturn [this.x + this.w / 2.0, this.y];\n\t\t} else {\n\t\t\t// !this.vertical && !this.linkPosEnd\n\t\t\treturn [this.x - this.w / 2.0, this.y];\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tstartX = this.left();\n\t\tstartY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#ff0000';\n\t\t\tcontext.fillStyle = '#ff0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tif (this.vertical) {\n\t\t\tstartX = this.left();\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tstartY = this.y + this.h * (1 - this.linkPercent) * (i / this.labels.length - 0.5);\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(startX, startY);\n\t\t\t\tcontext.lineTo(startX + this.w, startY);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t} else {\n\t\t\tstartY = this.top();\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tstartX = this.x + this.w * (1 - this.linkPercent) * (i / this.labels.length - 0.5);\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(startX, startY);\n\t\t\t\tcontext.lineTo(startX, startY + this.h);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t}\n\n\t\tcontext.lineWidth = 1;\n\t\tif (this.vertical && this.linkPosEnd) {\n\t\t\tstartX = this.left();\n\t\t\tstartY = this.bottom() - this.h * this.linkPercent;\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(this.startX + this.w, this.bottom());\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t} else if (this.vertical && !this.linkPosEnd) {\n\t\t\tstartX = this.left();\n\t\t\tstartY = this.top() + this.h * this.linkPercent;\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(startX + this.w, this.top());\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t} else if (!this.vertical && this.linkPosEnd) {\n\t\t\tstartX = this.right() - this.w * this.linkPercent;\n\t\t\tstartY = this.top();\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(this.right(), startY + this.h);\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t} else {\n\t\t\t// !vertical && !linkPosEnd\n\t\t\tstartX = this.left() + this.w * this.linkPercent;\n\t\t\tstartY = this.top();\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(this.left(), startY);\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t}\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\n\t\tif (this.vertical) {\n\t\t\tthis.labelPosX[0] = this.x;\n\t\t\tthis.labelPosY[0] =\n\t\t\t\tthis.y + ((this.h * (1 - this.linkPercent)) / 2) * (1 / this.labels.length - 1);\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tthis.labelPosX[i] = this.x;\n\t\t\t\tthis.labelPosY[i] =\n\t\t\t\t\tthis.labelPosY[i - 1] + (this.h * (1 - this.linkPercent)) / this.labels.length;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.labelPosY[0] = this.y;\n\t\t\tthis.labelPosX[0] =\n\t\t\t\tthis.x + ((this.w * (1 - this.linkPercent)) / 2) * (1 / this.labels.length - 1);\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tthis.labelPosY[i] = this.y;\n\t\t\t\tthis.labelPosX[i] =\n\t\t\t\t\tthis.labelPosX[i - 1] + (this.w * (1 - this.linkPercent)) / this.labels.length;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this.labels.length; i++) {\n\t\t\tcontext.fillStyle = this.labelColors[i];\n\t\t\tcontext.fillText(this.labels[i], this.labelPosX[i], this.labelPosY[i]);\n\t\t}\n\t}\n\n\tsetTextColor(color, index) {\n\t\tthis.labelColors[index] = color;\n\t}\n\n\tgetTextColor(index) {\n\t\treturn this.labelColors[index];\n\t}\n\n\tgetText(index) {\n\t\treturn this.labels[index];\n\t}\n\n\tsetText(newText, index) {\n\t\tthis.labels[index] = newText;\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteLinkedList(\n\t\t\tthis.objectID,\n\t\t\tthis.labels,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.linkPercent,\n\t\t\tthis.vertical,\n\t\t\tthis.linkPosEnd,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.labelColors,\n\t\t\tthis.layer,\n\t\t\tthis.nullPointer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteLinkedList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabels,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlinkPercent,\n\t\tvertical,\n\t\tlinkPosEnd,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlabelColors,\n\t\tlayer,\n\t\tnullPointer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.labels = labels;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.vertical = vertical;\n\t\tthis.linkPosEnd = linkPosEnd;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.labelColors = labelColors;\n\t\tthis.layer = layer;\n\t\tthis.nullPointer = nullPointer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addLinkedListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.labels,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.linkPercent,\n\t\t\tthis.vertical,\n\t\t\tthis.linkPosEnd,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setNull(this.objectID, this.nullPointer);\n\t\tfor (let i = 0; i < this.labels.length; i++) {\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\n\t\t}\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.a\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Values for xJust / yJust:  \"center\", \"left\", \"right\", \"top\", \"bottom\"\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedRectangle extends AnimatedObject {\n\tconstructor(objectID, label, w, h, xJustify, yJustify, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.xJustify = xJustify;\n\t\tthis.yJustify = yJustify;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.textColor = foregroundColor;\n\t\tthis.highlighted = false;\n\t\tthis.thicknessArray = [false, false, false, false];\n\n\t\tthis.label = label;\n\n\t\tthis.nullPointer = false;\n\t}\n\n\tsetNull(np) {\n\t\tthis.nullPointer = np;\n\t}\n\n\tgetNull() {\n\t\treturn this.nullPointer;\n\t}\n\n\tleft() {\n\t\tif (this.xJustify === 'left') {\n\t\t\treturn this.x;\n\t\t} else if (this.xJustify === 'center') {\n\t\t\treturn this.x - this.w / 2.0;\n\t\t} else {\n\t\t\t// right\n\t\t\treturn this.x - this.w;\n\t\t}\n\t}\n\n\tcenterX() {\n\t\tif (this.xJustify === 'center') {\n\t\t\treturn this.x;\n\t\t} else if (this.xJustify === 'left') {\n\t\t\treturn this.x + this.w / 2.0;\n\t\t} else {\n\t\t\t// right\n\t\t\treturn this.x - this.w / 2.0;\n\t\t}\n\t}\n\n\tcenterY() {\n\t\tif (this.yJustify === 'center') {\n\t\t\treturn this.y;\n\t\t} else if (this.yJustify === 'top') {\n\t\t\treturn this.y + this.h / 2.0;\n\t\t} else {\n\t\t\t// bottom\n\t\t\treturn this.y - this.w / 2.0;\n\t\t}\n\t}\n\n\ttop() {\n\t\tif (this.yJustify === 'top') {\n\t\t\treturn this.y;\n\t\t} else if (this.yJustify === 'center') {\n\t\t\treturn this.y - this.h / 2.0;\n\t\t} else {\n\t\t\t// bottom\n\t\t\treturn this.y - this.h;\n\t\t}\n\t}\n\n\tbottom() {\n\t\tif (this.yJustify === 'top') {\n\t\t\treturn this.y + this.h;\n\t\t} else if (this.yJustify === 'center') {\n\t\t\treturn this.y + this.h / 2.0;\n\t\t} else {\n\t\t\t// bottom\n\t\t\treturn this.y;\n\t\t}\n\t}\n\n\tright() {\n\t\tif (this.xJustify === 'left') {\n\t\t\treturn this.x + this.w;\n\t\t} else if (this.xJustify === 'center') {\n\t\t\treturn this.x + this.w / 2.0;\n\t\t} else {\n\t\t\t// right\n\t\t\treturn this.x;\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tswitch (anchor) {\n\t\t\tcase 0: // Default\n\t\t\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t\t\tcase 1: // Top\n\t\t\t\treturn [this.x, this.top()];\n\t\t\tcase 2: // Bottom\n\t\t\t\treturn [this.x, this.bottom()];\n\t\t\tcase 3: // Left\n\t\t\t\treturn [this.left(), this.y];\n\t\t\tcase 4: // Right\n\t\t\t\treturn [this.right(), this.y];\n\t\t\tdefault:\n\t\t\t\treturn null;\n\t\t}\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tif (!this.addedToScene) return;\n\n\t\tcontext.globalAlpha = this.alpha;\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tif (this.xJustify === 'left') {\n\t\t\tstartX = this.x;\n\t\t} else if (this.xJustify === 'center') {\n\t\t\tstartX = this.x - this.w / 2.0;\n\t\t} else if (this.xJustify === 'right') {\n\t\t\tstartX = this.x - this.w;\n\t\t}\n\t\tif (this.yJustify === 'top') {\n\t\t\tstartY = this.y;\n\t\t} else if (this.yJustify === 'center') {\n\t\t\tstartY = this.y - this.h / 2.0;\n\t\t} else if (this.yJustify === 'bottom') {\n\t\t\tstartY = this.y - this.h;\n\t\t}\n\n\t\tcontext.lineWidth = 2;\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#ff0000';\n\t\t\tcontext.fillStyle = '#ff0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\t// Thick edges\n\t\t// Top edge\n\t\tif (this.thicknessArray[0]) {\n\t\t\tcontext.lineWidth = 3;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY);\n\t\t\tcontext.lineTo(startX + this.w, startY);\n\t\t\tcontext.stroke();\n\t\t\tcontext.closePath();\n\t\t}\n\t\t// Right edge\n\t\tif (this.thicknessArray[1]) {\n\t\t\tcontext.lineWidth = 3;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY);\n\t\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\t\tcontext.stroke();\n\t\t\tcontext.closePath();\n\t\t}\n\t\t// Bottom edge\n\t\tif (this.thicknessArray[2]) {\n\t\t\tcontext.lineWidth = 3;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY + this.h);\n\t\t\tcontext.stroke();\n\t\t\tcontext.closePath();\n\t\t}\n\t\t// Left edge\n\t\tif (this.thicknessArray[3]) {\n\t\t\tcontext.lineWidth = 3;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tcontext.stroke();\n\t\t\tcontext.closePath();\n\t\t}\n\n\t\tcontext.lineWidth = 1.2;\n\t\tif (this.nullPointer) {\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY);\n\t\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t}\n\n\t\tcontext.fillStyle = this.textColor;\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\t\tcontext.fillText(this.label, this.x, this.y);\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.textColor = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.textColor;\n\t}\n\n\tsetHighlight(value) {\n\t\tthis.highlighted = value;\n\t}\n\n\tsetEdgeThickness(thicknessArray) {\n\t\tthis.thicknessArray = thicknessArray;\n\t}\n\n\tgetEdgeThickness() {\n\t\treturn this.thicknessArray;\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteRectangle(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.xJustify,\n\t\t\tthis.yJustify,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteRectangle extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tx,\n\t\ty,\n\t\tw,\n\t\th,\n\t\txJustify,\n\t\tyJustify,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlayer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.xJustify = xJustify;\n\t\tthis.yJustify = yJustify;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.layer = layer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addRectangleObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.xJustify,\n\t\t\tthis.yJustify,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nconst NINF = '\\u2212\\u221E'; // Negative infinity\nconst PINF = '\\u221E'; // Positive infinity\n\nexport default class AnimatedSkipListNode extends AnimatedObject {\n\tconstructor(objectID, label, w, h, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.label = label;\n\t\tthis.labelPosX = 0;\n\t\tthis.labelPosY = 0;\n\t\tthis.labelColor = foregroundColor;\n\t}\n\n\tleft() {\n\t\treturn this.x - this.w / 2;\n\t}\n\n\tright() {\n\t\treturn this.x + this.w / 2;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2;\n\t}\n\n\tresetTextPosition() {\n\t\tthis.labelPosY = this.y;\n\t\tthis.labelPosX = this.x;\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tswitch (anchor) {\n\t\t\tcase 0: // Top\n\t\t\t\treturn [this.x, this.top()];\n\t\t\tcase 1: // Bottom\n\t\t\t\treturn [this.x, this.bottom()];\n\t\t\tcase 2: // Left\n\t\t\t\treturn [this.left(), this.y];\n\t\t\tcase 3: // Right\n\t\t\t\treturn [this.right(), this.y];\n\t\t\tdefault:\n\t\t\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY); // Normal anchor\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t\tthis.resetTextPosition();\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tconst startX = this.left();\n\t\tconst startY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#ff0000';\n\t\t\tcontext.fillStyle = '#ff0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\n\t\tthis.resetTextPosition();\n\t\tcontext.fillStyle = this.labelColor;\n\t\tif (this.label === NINF || this.label === PINF) {\n\t\t\tcontext.font = '18px sans-serif';\n\t\t}\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColor = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColor;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteSkipList(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.labelColor,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteSkipList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlabelColor,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlayer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.labelColor = labelColor;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.layer = layer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addSkipListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setTextColor(this.objectID, this.labelColor);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Object Manager\n//\n// Manage all of our animated objects.  Control any animated object should occur through\n// this interface (not language enforced, because enforcing such things in Javascript is\n// problematic.)\n//\n// This class is only accessed through:\n//\n//  AnimationMain\n//  Undo objects (which are themselves controlled by AnimationMain)\n\nimport AnimatedBTreeNode from './AnimatedBTreeNode';\nimport AnimatedCircle from './AnimatedCircle';\nimport AnimatedCircularlyLinkedListNode from './AnimatedCircularlyLinkedListNode';\nimport AnimatedDoublyLinkedListNode from './AnimatedDoublyLinkedListNode';\nimport AnimatedHighlightCircle from './AnimatedHighlightCircle';\nimport AnimatedLabel from './AnimatedLabel';\nimport AnimatedLine from './AnimatedLine';\nimport AnimatedLinkedListNode from './AnimatedLinkedListNode';\nimport AnimatedRectangle from './AnimatedRectangle';\nimport AnimatedSkipListNode from './AnimatedSkipListNode';\n\nexport default class ObjectManager {\n\tconstructor(canvasRef) {\n\t\tthis.nodes = [];\n\t\tthis.edges = [];\n\t\tthis.backEdges = [];\n\t\tthis.activeLayers = [];\n\t\tthis.activeLayers[0] = true;\n\t\tthis.ctx = canvasRef.current.getContext('2d');\n\t\tthis.framenum = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.statusReport = new AnimatedLabel(-1, 'XXX', false, 30);\n\t\tthis.statusReport.x = 30;\n\t}\n\n\tdraw() {\n\t\tthis.framenum++;\n\t\tif (this.framenum > 1000) this.framenum = 0;\n\n\t\tthis.ctx.clearRect(0, 0, this.width, this.height); // clear canvas\n\t\tthis.statusReport.y = this.height - 15;\n\n\t\tlet i;\n\t\tlet j;\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\t!this.nodes[i].highlighted &&\n\t\t\t\tthis.nodes[i].addedToScene &&\n\t\t\t\t!this.nodes[i].alwaysOnTop\n\t\t\t) {\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\tthis.nodes[i].highlighted &&\n\t\t\t\t!this.nodes[i].alwaysOnTop &&\n\t\t\t\tthis.nodes[i].addedToScene\n\t\t\t) {\n\t\t\t\tthis.nodes[i].pulseHighlight(this.framenum);\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\t!this.nodes[i].highlighted &&\n\t\t\t\tthis.nodes[i].alwaysOnTop &&\n\t\t\t\tthis.nodes[i].addedToScene\n\t\t\t) {\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\tthis.nodes[i].highlighted &&\n\t\t\t\tthis.nodes[i].alwaysOnTop &&\n\t\t\t\tthis.nodes[i].addedToScene\n\t\t\t) {\n\t\t\t\tthis.nodes[i].pulseHighlight(this.framenum);\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.edges.length; i++) {\n\t\t\tif (this.edges[i] != null) {\n\t\t\t\tfor (j = 0; j < this.edges[i].length; j++) {\n\t\t\t\t\tif (this.edges[i][j].addedToScene) {\n\t\t\t\t\t\tthis.edges[i][j].pulseHighlight(this.framenum);\n\t\t\t\t\t\tthis.edges[i][j].draw(this.ctx);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.statusReport.draw(this.ctx);\n\t}\n\n\tupdate() {}\n\n\tsetLayers(shown, layers) {\n\t\tfor (let i = 0; i < layers.length; i++) {\n\t\t\tthis.activeLayers[layers[i]] = shown;\n\t\t}\n\t\tthis.resetLayers();\n\t}\n\n\taddHighlightCircleObject(objectID, objectColor, radius) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error(\n\t\t\t\t'addHighlightCircleObject: object with same ID (' +\n\t\t\t\t\tString(objectID) +\n\t\t\t\t\t') already exists!',\n\t\t\t);\n\t\t}\n\t\tconst newNode = new AnimatedHighlightCircle(objectID, objectColor, radius);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tsetEdgeAlpha(fromID, toID, alphaVal) {\n\t\tlet oldAlpha = 1.0;\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldAlpha = this.edges[fromID][i].alpha;\n\t\t\t\t\tthis.edges[fromID][i].alpha = alphaVal;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldAlpha;\n\t}\n\n\tsetAlpha(nodeID, alphaVal) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tthis.nodes[nodeID].setAlpha(alphaVal);\n\t\t}\n\t}\n\n\tgetAlpha(nodeID) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\treturn this.nodes[nodeID].getAlpha();\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tgetTextColor(nodeID, index) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\treturn this.nodes[nodeID].getTextColor(index);\n\t\t} else {\n\t\t\treturn '#000000';\n\t\t}\n\t}\n\n\tsetTextColor(nodeID, color, index) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tthis.nodes[nodeID].setTextColor(color, index);\n\t\t}\n\t}\n\n\tsetHighlightIndex(nodeID, index) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tthis.nodes[nodeID].setHighlightIndex(index);\n\t\t}\n\t}\n\n\tsetAllLayers(layers) {\n\t\tthis.activeLayers = [];\n\t\tfor (let i = 0; i < layers.length; i++) {\n\t\t\tthis.activeLayers[layers[i]] = true;\n\t\t}\n\t\tthis.resetLayers();\n\t}\n\n\tresetLayers() {\n\t\tlet i;\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (this.nodes[i] != null && this.nodes[i] !== undefined) {\n\t\t\t\tthis.nodes[i].addedToScene = this.activeLayers[this.nodes[i].layer] === true;\n\t\t\t}\n\t\t}\n\t\tfor (i = this.edges.length - 1; i >= 0; i--) {\n\t\t\tif (this.edges[i] != null && this.edges[i] !== undefined) {\n\t\t\t\tfor (let j = 0; j < this.edges[i].length; j++) {\n\t\t\t\t\tif (this.edges[i][j] != null && this.edges[i][j] !== undefined) {\n\t\t\t\t\t\tthis.edges[i][j].addedToScene =\n\t\t\t\t\t\t\tthis.activeLayers[this.edges[i][j].fromID.layer] === true &&\n\t\t\t\t\t\t\tthis.activeLayers[this.edges[i][j].toID.layer] === true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetLayer(objectID, layer) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].layer = layer;\n\t\t\tif (this.activeLayers[layer]) {\n\t\t\t\tthis.nodes[objectID].addedToScene = true;\n\t\t\t} else {\n\t\t\t\tthis.nodes[objectID].addedToScene = false;\n\t\t\t}\n\t\t\tif (this.edges[objectID] != null && this.edges[objectID] !== undefined) {\n\t\t\t\tfor (let i = 0; i < this.edges[objectID].length; i++) {\n\t\t\t\t\tconst nextEdge = this.edges[objectID][i];\n\t\t\t\t\tif (nextEdge != null && nextEdge !== undefined) {\n\t\t\t\t\t\tnextEdge.addedToScene =\n\t\t\t\t\t\t\tnextEdge.fromID.addedToScene && nextEdge.toID.addedToScene;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.backEdges[objectID] != null && this.backEdges[objectID] !== undefined) {\n\t\t\t\tfor (let i = 0; i < this.backEdges[objectID].length; i++) {\n\t\t\t\t\tconst nextEdge = this.backEdges[objectID][i];\n\t\t\t\t\tif (nextEdge != null && nextEdge !== undefined) {\n\t\t\t\t\t\tnextEdge.addedToScene =\n\t\t\t\t\t\t\tnextEdge.fromID.addedToScene && nextEdge.toID.addedToScene;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclearAllObjects() {\n\t\tthis.nodes = [];\n\t\tthis.edges = [];\n\t\tthis.backEdges = [];\n\t}\n\n\tsetForegroundColor(objectID, color) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setForegroundColor(color);\n\t\t}\n\t}\n\n\tsetBackgroundColor(objectID, color) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthis.nodes[objectID].setBackgroundColor(color);\n\t\t}\n\t}\n\n\tsetHighlight(nodeID, val, color) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].setHighlight(val, color);\n\t}\n\n\tgetHighlight(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn false;\n\t\t}\n\t\treturn this.nodes[nodeID].getHighlight();\n\t}\n\n\tgetHighlightIndex(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn false;\n\t\t}\n\t\treturn this.nodes[nodeID].getHighlightIndex();\n\t}\n\n\tsetWidth(nodeID, val) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].setWidth(val);\n\t}\n\n\tsetHeight(nodeID, val) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].setHeight(val);\n\t}\n\n\tgetHeight(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn -1;\n\t\t}\n\t\treturn this.nodes[nodeID].getHeight();\n\t}\n\n\tgetWidth(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn -1;\n\t\t}\n\t\treturn this.nodes[nodeID].getWidth();\n\t}\n\n\tbackgroundColor(objectID) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\treturn this.nodes[objectID].backgroundColor;\n\t\t} else {\n\t\t\treturn '#000000';\n\t\t}\n\t}\n\n\tforegroundColor(objectID) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\treturn this.nodes[objectID].foregroundColor;\n\t\t} else {\n\t\t\treturn '#000000';\n\t\t}\n\t}\n\n\tdisconnect(objectIDfrom, objectIDto) {\n\t\tlet undo = null;\n\t\tlet len;\n\t\tlet deleted;\n\t\tif (this.edges[objectIDfrom] != null) {\n\t\t\tlen = this.edges[objectIDfrom].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[objectIDfrom][i] != null &&\n\t\t\t\t\tthis.edges[objectIDfrom][i].toID === this.nodes[objectIDto]\n\t\t\t\t) {\n\t\t\t\t\tdeleted = this.edges[objectIDfrom][i];\n\t\t\t\t\tundo = deleted.createUndoConnect();\n\t\t\t\t\tthis.edges[objectIDfrom][i] = this.edges[objectIDfrom][len - 1];\n\t\t\t\t\tlen -= 1;\n\t\t\t\t\tthis.edges[objectIDfrom].pop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.backEdges[objectIDto] != null) {\n\t\t\tlen = this.backEdges[objectIDto].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.backEdges[objectIDto][i] != null &&\n\t\t\t\t\tthis.backEdges[objectIDto][i].fromID === this.nodes[objectIDfrom]\n\t\t\t\t) {\n\t\t\t\t\tdeleted = this.backEdges[objectIDto][i];\n\t\t\t\t\t// Note:  Don't need to remove this child, did it above on the regular edge\n\t\t\t\t\tthis.backEdges[objectIDto][i] = this.backEdges[objectIDto][len - 1];\n\t\t\t\t\tlen -= 1;\n\t\t\t\t\tthis.backEdges[objectIDto].pop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undo;\n\t}\n\n\tdeleteIncident(objectID) {\n\t\tconst undoStack = [];\n\t\tlet len;\n\t\tlet deleted;\n\t\tif (this.edges[objectID] != null) {\n\t\t\tlen = this.edges[objectID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tdeleted = this.edges[objectID][i];\n\t\t\t\tconst node2ID = deleted.toID.identifier();\n\t\t\t\tundoStack.push(deleted.createUndoConnect());\n\n\t\t\t\tlet len2 = this.backEdges[node2ID].length;\n\t\t\t\tfor (let j = len2 - 1; j >= 0; j--) {\n\t\t\t\t\tif (this.backEdges[node2ID][j] === deleted) {\n\t\t\t\t\t\tthis.backEdges[node2ID][j] = this.backEdges[node2ID][len2 - 1];\n\t\t\t\t\t\tlen2 -= 1;\n\t\t\t\t\t\tthis.backEdges[node2ID].pop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.edges[objectID] = null;\n\t\t}\n\t\tif (this.backEdges[objectID] != null) {\n\t\t\tlen = this.backEdges[objectID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tdeleted = this.backEdges[objectID][i];\n\t\t\t\tconst node1ID = deleted.fromID.identifier();\n\t\t\t\tundoStack.push(deleted.createUndoConnect());\n\n\t\t\t\tlet len2 = this.edges[node1ID].length;\n\t\t\t\tfor (let j = len2 - 1; j >= 0; j--) {\n\t\t\t\t\tif (this.edges[node1ID][j] === deleted) {\n\t\t\t\t\t\tthis.edges[node1ID][j] = this.edges[node1ID][len2 - 1];\n\t\t\t\t\t\tlen2 -= 1;\n\t\t\t\t\t\tthis.edges[node1ID].pop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.backEdges[objectID] = null;\n\t\t}\n\t\treturn undoStack;\n\t}\n\n\tremoveObject(objectID) {\n\t\tconst oldObject = this.nodes[objectID];\n\t\tif (objectID === this.nodes.length - 1) {\n\t\t\tthis.nodes.pop();\n\t\t} else {\n\t\t\tthis.nodes[objectID] = null;\n\t\t}\n\t\treturn oldObject;\n\t}\n\n\tgetObject(objectID) {\n\t\tif (this.nodes[objectID] == null || this.nodes[objectID] === undefined) {\n\t\t\tthrow new Error('getObject:Object with ID (' + String(objectID) + ') does not exist');\n\t\t}\n\t\treturn this.nodes[objectID];\n\t}\n\n\taddCircleObject(objectID, objectLabel) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error(\n\t\t\t\t'addCircleObject: object with same ID (' + String(objectID) + ') already exists!',\n\t\t\t);\n\t\t}\n\t\tconst newNode = new AnimatedCircle(objectID, objectLabel);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tgetNodeX(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('Getting x position of an object that does not exist');\n\t\t}\n\t\treturn this.nodes[nodeID].x;\n\t}\n\n\tgetTextWidth(text) {\n\t\t// TODO:  Need to make fonts more flexible, and less hardwired.\n\t\tthis.ctx.font = '12px Arial';\n\t\tconst strList = text.split('\\n');\n\t\tlet width = 0;\n\t\tif (strList.length === 1) {\n\t\t\twidth = this.ctx.measureText(text).width;\n\t\t} else {\n\t\t\tfor (let i = 0; i < strList.length; i++) {\n\t\t\t\twidth = Math.max(width, this.ctx.measureText(strList[i]).width);\n\t\t\t}\n\t\t}\n\n\t\treturn width;\n\t}\n\n\tsetText(nodeID, text, index) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('setting text of an object that does not exist');\n\t\t}\n\t\tthis.nodes[nodeID].setText(text, index, this.getTextWidth(text));\n\t}\n\n\tgetText(nodeID, index) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('getting text of an object that does not exist');\n\t\t}\n\t\treturn this.nodes[nodeID].getText(index);\n\t}\n\n\tgetNodeY(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('getting y position of an object that does not exist');\n\t\t}\n\t\treturn this.nodes[nodeID].y;\n\t}\n\n\tconnectEdge(objectIDfrom, objectIDto, color, curve, directed, lab, connectionPoint, thickness) {\n\t\tconst fromObj = this.nodes[objectIDfrom];\n\t\tconst toObj = this.nodes[objectIDto];\n\t\tif (fromObj == null || toObj == null) {\n\t\t\tthrow new Error(\"Tried to connect two nodes, one didn't exist!\");\n\t\t}\n\t\tconst l = new AnimatedLine(\n\t\t\tfromObj,\n\t\t\ttoObj,\n\t\t\tcolor,\n\t\t\tcurve,\n\t\t\tdirected,\n\t\t\tlab,\n\t\t\tconnectionPoint,\n\t\t\tthickness,\n\t\t);\n\t\tif (this.edges[objectIDfrom] == null) {\n\t\t\tthis.edges[objectIDfrom] = [];\n\t\t}\n\t\tif (this.backEdges[objectIDto] == null) {\n\t\t\tthis.backEdges[objectIDto] = [];\n\t\t}\n\t\tl.addedToScene = fromObj.addedToScene && toObj.addedToScene;\n\t\tthis.edges[objectIDfrom].push(l);\n\t\tthis.backEdges[objectIDto].push(l);\n\t}\n\n\tsetNull(objectID, nullVal) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setNull(nullVal);\n\t\t}\n\t}\n\n\tsetPrevNull(objectID, nullVal) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setPrevNull(nullVal);\n\t\t}\n\t}\n\n\tsetNextNull(objectID, nullVal) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setNextNull(nullVal);\n\t\t}\n\t}\n\n\tgetNull(objectID) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\treturn this.nodes[objectID].getNull();\n\t\t}\n\t\treturn false; // TODO:  Error here?\n\t}\n\n\tgetLeftNull(objectID) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\treturn this.nodes[objectID].getLeftNull();\n\t\t}\n\t\treturn false; // TODO:  Error here?\n\t}\n\n\tgetRightNull(objectID) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\treturn this.nodes[objectID].getRightNull();\n\t\t}\n\t\treturn false; // TODO:  Error here?\n\t}\n\n\tsetEdgeColor(\n\t\tfromID,\n\t\ttoID,\n\t\tcolor, // returns old color\n\t) {\n\t\tlet oldColor = '#000000';\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldColor = this.edges[fromID][i].color();\n\t\t\t\t\tthis.edges[fromID][i].setColor(color);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldColor;\n\t}\n\n\talignTop(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignTop(this.nodes[id2]);\n\t}\n\n\talignLeft(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignLeft(this.nodes[id2]);\n\t}\n\n\talignRight(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignRight(this.nodes[id2]);\n\t}\n\n\tgetAlignRightPos(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\treturn this.nodes[id1].getAlignRightPos(this.nodes[id2]);\n\t}\n\n\tgetAlignLeftPos(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\treturn this.nodes[id1].getAlignLeftPos(this.nodes[id2]);\n\t}\n\n\talignBottom(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignBottom(this.nodes[id2]);\n\t}\n\n\tsetAlwaysOnTop(nodeID, onTop) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tconst oldTop = this.nodes[nodeID].alwaysOnTop;\n\t\t\tthis.nodes[nodeID].alwaysOnTop = onTop;\n\t\t\treturn oldTop;\n\t\t} else {\n\t\t\tthrow new Error(\"Trying to bring node that doesn't exist to top\");\n\t\t}\n\t}\n\n\tsetEdgeHighlight(fromID, toID, val, color) {\n\t\tlet oldHighlight = false;\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldHighlight = this.edges[fromID][i].highlighted;\n\t\t\t\t\tthis.edges[fromID][i].setHighlight(val, color);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldHighlight;\n\t}\n\n\tsetEdgeThickness(fromID, toID, val) {\n\t\tlet oldThickness = 1;\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldThickness = this.edges[fromID][i].thickness;\n\t\t\t\t\tthis.edges[fromID][i].setThickness(val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldThickness;\n\t}\n\n\tsetRectangleEdgeThickness(nodeID, thicknessArray) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tconst oldEdgeThickness = this.nodes[nodeID].getEdgeThickness();\n\t\t\tthis.nodes[nodeID].setEdgeThickness(thicknessArray);\n\t\t\treturn oldEdgeThickness;\n\t\t} else {\n\t\t\tthrow new Error(\"Trying to bring node that doesn't exist to top\");\n\t\t}\n\t}\n\n\taddLabelObject(objectID, objectLabel, centering) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error('addLabelObject: object already exists!');\n\t\t}\n\n\t\tconst newLabel = new AnimatedLabel(\n\t\t\tobjectID,\n\t\t\tobjectLabel,\n\t\t\tcentering,\n\t\t\tthis.getTextWidth(objectLabel),\n\t\t);\n\t\tthis.nodes[objectID] = newLabel;\n\t}\n\n\taddLinkedListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tlinkPer,\n\t\tverticalOrientation,\n\t\tlinkPosEnd,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addLinkedListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedLinkedListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkPer,\n\t\t\tverticalOrientation,\n\t\t\tlinkPosEnd,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddDoublyLinkedListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tlinkPer,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addDoublyLinkedListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedDoublyLinkedListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkPer,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddCircularlyLinkedListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tlinkPer,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addCircularlyLinkedListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedCircularlyLinkedListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkPer,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddSkipListObject(objectID, nodeLabel, width, height, backgroundColor, foregroundColor) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addSkipListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedSkipListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tgetNumElements(objectID) {\n\t\treturn this.nodes[objectID].getNumElements();\n\t}\n\n\tsetNumElements(objectID, numElems) {\n\t\tthis.nodes[objectID].setNumElements(numElems);\n\t}\n\n\taddBTreeNode(objectID, widthPerElem, height, numElems, backgroundColor, foregroundColor) {\n\t\tbackgroundColor = backgroundColor === undefined ? '#FFFFFF' : backgroundColor;\n\t\tforegroundColor = foregroundColor === undefined ? '#FFFFFF' : foregroundColor;\n\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error('addBTreeNode: object with same ID already exists!');\n\t\t}\n\n\t\tconst newNode = new AnimatedBTreeNode(\n\t\t\tobjectID,\n\t\t\twidthPerElem,\n\t\t\theight,\n\t\t\tnumElems,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddRectangleObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\txJustify,\n\t\tyJustify,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error('addRectangleObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedRectangle(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\txJustify,\n\t\t\tyJustify,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tsetNodePosition(nodeID, newX, newY) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tif (newX === undefined || newY === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].x = newX;\n\t\tthis.nodes[nodeID].y = newY;\n\t\t/* Don't need to dirty anything, since we repaint everything every frame\n\t\t (TODO:  Revisit if we do conditional redraws) */\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Global timer used for doing animation callbacks.\n//  TODO:  Make this an instance variable of Animation Manager.\n\n/* global canvas */\n\nimport {\n\tUndoCreate,\n\tUndoHighlight,\n\tUndoHighlightEdge,\n\tUndoMove,\n\tUndoSetAlpha,\n\tUndoSetAlwaysOnTop,\n\tUndoSetBackgroundColor,\n\tUndoSetEdgeAlpha,\n\tUndoSetEdgeColor,\n\tUndoSetEdgeThickness,\n\tUndoSetForegroundColor,\n\tUndoSetHeight,\n\tUndoSetHighlightIndex,\n\tUndoSetNextNull,\n\tUndoSetNull,\n\tUndoSetNumElements,\n\tUndoSetPosition,\n\tUndoSetPrevNull,\n\tUndoSetRectangleEdgeThickness,\n\tUndoSetText,\n\tUndoSetTextColor,\n\tUndoSetWidth,\n} from './UndoFunctions.js';\nimport EventListener from './CustomEvents.js';\nimport ObjectManager from './ObjectManager.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport SingleAnimation from './SingleAnimation.js';\nimport { Slider, withStyles } from '@material-ui/core';\nimport { UndoConnect } from './AnimatedLine.js';\n\n// Utility function to read a cookie\nfunction getCookie(cookieName) {\n\tlet i, x, y;\n\tconst cookies = document.cookie.split(';');\n\tfor (i = 0; i < cookies.length; i++) {\n\t\tx = cookies[i].substr(0, cookies[i].indexOf('='));\n\t\ty = cookies[i].substr(cookies[i].indexOf('=') + 1);\n\t\tx = x.replace(/^\\s+|\\s+$/g, '');\n\t\tif (x === cookieName) {\n\t\t\treturn unescape(y);\n\t\t}\n\t}\n}\n\n// Utility function to write a cookie\nfunction setCookie(cookieName, value, expireDays) {\n\tconst exDate = new Date();\n\texDate.setDate(exDate.getDate() + expireDays);\n\tdocument.cookie = cookieName + '=' + value;\n}\n\nconst ANIMATION_SPEED_DEFAULT = 75;\n\n// TODO:  Move these out of global space into animation manager?\n\nfunction controlKey(keyASCII) {\n\treturn (\n\t\tkeyASCII === 8 ||\n\t\tkeyASCII === 9 ||\n\t\tkeyASCII === 37 ||\n\t\tkeyASCII === 38 ||\n\t\tkeyASCII === 39 ||\n\t\tkeyASCII === 40 ||\n\t\tkeyASCII === 46\n\t);\n}\n\nfunction returnSubmit(field, func, maxSize, intOnly) {\n\tif (maxSize !== undefined) {\n\t\tfield.size = maxSize;\n\t}\n\treturn function (event) {\n\t\tlet keyASCII = 0;\n\t\tif (window.event) {\n\t\t\t// IE\n\t\t\tkeyASCII = event.keyCode;\n\t\t} else if (event.which) {\n\t\t\t// Netscape/Firefox/Opera\n\t\t\tkeyASCII = event.which;\n\t\t}\n\n\t\tif (keyASCII === 13) {\n\t\t\tfunc();\n\t\t\treturn false;\n\t\t} else if (\n\t\t\tkeyASCII === 59 ||\n\t\t\tkeyASCII === 45 ||\n\t\t\tkeyASCII === 46 ||\n\t\t\tkeyASCII === 190 ||\n\t\t\tkeyASCII === 173\n\t\t) {\n\t\t\treturn false;\n\t\t} else if (\n\t\t\t(maxSize !== undefined && field.value.length >= maxSize) ||\n\t\t\t(intOnly && (keyASCII < 48 || keyASCII > 57))\n\t\t) {\n\t\t\tif (!controlKey(keyASCII)) return false;\n\t\t}\n\t\treturn true;\n\t};\n}\n\nfunction addControlToAnimationBar(animBarRef, type, name, callback) {\n\tconst element = document.createElement('input');\n\n\telement.setAttribute('type', type);\n\telement.setAttribute('value', name);\n\tif (type === 'Button') {\n\t\telement.onclick = callback;\n\t} else if (type === 'Text') {\n\t\telement.onkeydown = callback;\n\t}\n\n\tconst tableEntry = document.createElement('td');\n\n\ttableEntry.appendChild(element);\n\n\tanimBarRef.current.appendChild(tableEntry);\n\treturn element;\n}\n\nfunction addDivisorToAnimationBar(animBarRef) {\n\tconst divisorLeft = document.createElement('td');\n\tdivisorLeft.setAttribute('class', 'divisorLeft');\n\n\tconst divisorRight = document.createElement('td');\n\tdivisorRight.setAttribute('class', 'divisorRight');\n\n\tanimBarRef.current.appendChild(divisorLeft);\n\tanimBarRef.current.appendChild(divisorRight);\n}\n\nexport default class AnimationManager extends EventListener {\n\tconstructor(canvasRef, animBarRef) {\n\t\tsuper();\n\n\t\tthis.objectManager = new ObjectManager(canvasRef);\n\t\t// Holder for all animated objects.\n\t\t// All animation is done by manipulating objects in\n\t\t// this container\n\t\tthis.animatedObjects = this.objectManager;\n\n\t\t// Control variables for stopping / starting animation\n\t\tthis.animationPaused = false;\n\t\tthis.awaitingStep = false;\n\t\tthis.currentlyAnimating = false;\n\n\t\t// Array holding the code for the animation.  This is\n\t\t// an array of strings, each of which is an animation command\n\t\t// currentAnimation is an index into this array\n\t\tthis.animationSteps = [];\n\t\tthis.currentAnimation = 0;\n\n\t\tthis.previousAnimationSteps = [];\n\n\t\t// Control variables for where we are in the current animation block.\n\t\t// currFrame holds the frame number of the current animation block,\n\t\t// while animationBlockLength holds the length of the current animation\n\t\t// block (in frame numbers).\n\t\tthis.currFrame = 0;\n\t\tthis.animationBlockLength = 0;\n\n\t\t//  The animation block that is currently running.  Array of singleAnimations\n\t\tthis.currentBlock = null;\n\n\t\t////////////////////////////////////\n\t\t// Variables for handling undo.\n\t\t////////////////////////////////////\n\t\t//  A stack of UndoBlock objects (subclassed, UndoBlock is an abstract base class)\n\t\t//  each of which can undo a single animation element\n\t\tthis.undoStack = [];\n\t\tthis.doingUndo = false;\n\n\t\t// A stack containing the beginning of each animation block, as an index\n\t\t// into the animationSteps array\n\t\tthis.undoAnimationStepIndices = [];\n\t\tthis.undoAnimationStepIndicesStack = [];\n\n\t\tthis.animationBlockLength = 10;\n\n\t\tthis.paused = false;\n\n\t\tthis.canvas = canvasRef;\n\n\t\tthis.skipBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Skip Back', () =>\n\t\t\tthis.skipBack(),\n\t\t);\n\t\tthis.stepBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Step Back', () =>\n\t\t\tthis.stepBack(),\n\t\t);\n\t\tthis.playPauseBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Pause', () =>\n\t\t\tthis.doPlayPause(),\n\t\t);\n\t\tthis.playPauseBackButton.setAttribute('style', 'width: 80px');\n\t\tthis.stepForwardButton = addControlToAnimationBar(\n\t\t\tanimBarRef,\n\t\t\t'Button',\n\t\t\t'Step Forward',\n\t\t\t() => this.step(),\n\t\t);\n\t\tthis.skipForwardButton = addControlToAnimationBar(\n\t\t\tanimBarRef,\n\t\t\t'Button',\n\t\t\t'Skip Forward',\n\t\t\t() => this.skipForward(),\n\t\t);\n\n\t\taddDivisorToAnimationBar(animBarRef);\n\n\t\tconst element = document.createElement('div');\n\t\telement.setAttribute('display', 'inline-block');\n\t\telement.setAttribute('float', 'left');\n\n\t\tlet speed = getCookie('VisualizationSpeed');\n\t\tif (speed == null || speed === '') {\n\t\t\tspeed = ANIMATION_SPEED_DEFAULT;\n\t\t} else {\n\t\t\tspeed = parseInt(speed);\n\t\t}\n\n\t\tconst CustomSlider = withStyles({\n\t\t\troot: {\n\t\t\t\tcolor: \"#F9C333\",\n\t\t\t\theight: 3,\n\t\t\t\tpadding: \"13px 0\",\n\t\t\t},\n\t\t\ttrack: {\n\t\t\t\theight: 4,\n\t\t\t\tborderRadius: 2,\n\t\t\t}\n\t\t})(Slider);\n\t\t\n\t\tconst slider = (\n\t\t\t<CustomSlider\n\t\t\t\tdefaultValue={speed}\n\t\t\t\tonChange={(e, val) => {\n\t\t\t\t\tthis.setSpeed(val);\n\t\t\t\t\tsetCookie('VisualizationSpeed', String(val), 30);\n\t\t\t\t}}\n\n\t\t\t/>\n\t\t);\n\n\t\tlet tableEntry = document.createElement('td');\n\n\t\tconst controlBar = document.getElementById('GeneralAnimationControls');\n\n\t\tconst newTable = document.createElement('table');\n\n\t\tlet midLevel = document.createElement('tr');\n\t\tlet bottomLevel = document.createElement('td');\n\t\tmidLevel.appendChild(bottomLevel);\n\t\tReactDOM.render(slider, bottomLevel);\n\t\tnewTable.appendChild(midLevel);\n\n\t\tmidLevel = document.createElement('tr');\n\t\tbottomLevel = document.createElement('td');\n\t\tbottomLevel.align = 'center';\n\t\tlet txtNode = document.createTextNode('Animation Speed');\n\t\tmidLevel.appendChild(bottomLevel);\n\t\tbottomLevel.appendChild(txtNode);\n\t\tnewTable.appendChild(midLevel);\n\n\t\ttableEntry.appendChild(newTable);\n\n\t\t// Append the element in page (in span)\n\t\tcontrolBar.appendChild(tableEntry);\n\n\t\tthis.setSpeed(speed);\n\n\t\telement.setAttribute('style', 'width:200px');\n\n\t\taddDivisorToAnimationBar(animBarRef);\n\n\t\tlet width = getCookie('VisualizationWidth');\n\t\twidth = width == null || width === '' ? 1500 : parseInt(width);\n\n\t\tlet height = getCookie('VisualizationHeight');\n\t\theight = height == null || height === '' ? 505 : parseInt(height);\n\n\t\tcanvas.width = width;\n\t\tcanvas.height = height;\n\n\t\ttableEntry = document.createElement('td');\n\t\ttxtNode = document.createTextNode('h:');\n\t\ttableEntry.appendChild(txtNode);\n\t\tcontrolBar.appendChild(tableEntry);\n\n\t\tthis.heightEntry = addControlToAnimationBar(animBarRef, 'Text', canvas.height, () =>\n\t\t\treturnSubmit(\n\t\t\t\tthis.heightEntry,\n\t\t\t\t() =>\n\t\t\t\t\tthis.changeSize(\n\t\t\t\t\t\tdocument.documentElement.clientWidth,\n\t\t\t\t\t\tparseInt(this.heightEntry.value),\n\t\t\t\t\t),\n\t\t\t\t4,\n\t\t\t\ttrue,\n\t\t\t),\n\t\t);\n\n\t\tthis.heightEntry.size = 4;\n\t\tthis.sizeButton = addControlToAnimationBar(animBarRef, 'Button', 'Change Canvas Size', () =>\n\t\t\tthis.changeSize(),\n\t\t);\n\n\t\tthis.addListener('AnimationStarted', this, this.animStarted);\n\t\tthis.addListener('AnimationEnded', this, this.animEnded);\n\t\tthis.addListener('AnimationWaiting', this, this.animWaiting);\n\t\tthis.addListener('AnimationUndoUnavailable', this, this.animUndoUnavailable);\n\t\tthis.objectManager.width = canvas.width;\n\t\tthis.objectManager.height = canvas.height;\n\t}\n\n\tlerp(from, to, percent) {\n\t\treturn (to - from) * percent + from;\n\t}\n\n\t// Pause / unpause animation\n\tsetPaused(pausedValue) {\n\t\tthis.animationPaused = pausedValue;\n\t\tif (!this.animationPaused) {\n\t\t\tthis.step();\n\t\t}\n\t}\n\n\tparseBool(str) {\n\t\tconst uppercase = str.toUpperCase();\n\t\tconst returnVal = !(\n\t\t\tuppercase === 'False' ||\n\t\t\tuppercase === 'f' ||\n\t\t\tuppercase === ' 0' ||\n\t\t\tuppercase === '0' ||\n\t\t\tuppercase === ''\n\t\t);\n\t\treturn returnVal;\n\t}\n\n\tparseColor(clr) {\n\t\tif (clr.charAt(0) === '#') {\n\t\t\treturn clr;\n\t\t} else if (clr.substring(0, 2) === '0x') {\n\t\t\treturn '#' + clr.substring(2);\n\t\t}\n\t}\n\n\t// Set the speed of the animation, from 0 (slow) to 100 (fast)\n\tsetSpeed(newSpeed) {\n\t\tthis.animationBlockLength = Math.floor((100 - newSpeed) / 2);\n\t}\n\n\tchangeSize(\n\t\twidth = document.documentElement.clientWidth,\n\t\theight = parseInt(this.heightEntry.value),\n\t) {\n\t\tif (width > 100) {\n\t\t\tcanvas.width = width;\n\t\t\tthis.animatedObjects.width = width;\n\t\t\tsetCookie('VisualizationWidth', String(width), 30);\n\t\t}\n\t\tif (height > 100) {\n\t\t\tcanvas.height = height;\n\t\t\tthis.animatedObjects.height = height;\n\t\t\tsetCookie('VisualizationHeight', String(height), 30);\n\t\t}\n\t\tthis.heightEntry.value = canvas.height;\n\n\t\tthis.animatedObjects.draw();\n\t\tthis.fireEvent('CanvasSizeChanged', { width: canvas.width, height: canvas.height });\n\t}\n\n\tstartNextBlock() {\n\t\tthis.awaitingStep = false;\n\t\tthis.currentBlock = [];\n\t\tthis.undoBlock = [];\n\t\tif (this.currentAnimation === this.animationSteps.length) {\n\t\t\tthis.currentlyAnimating = false;\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\t\t\treturn;\n\t\t}\n\t\tthis.undoAnimationStepIndices.push(this.currentAnimation);\n\n\t\tthis.foundBreak = false;\n\t\tthis.anyAnimations = false;\n\n\t\twhile (this.currentAnimation < this.animationSteps.length && !this.foundBreak) {\n\t\t\tconst [act, params] = this.animationSteps[this.currentAnimation];\n\t\t\tact.call(this, params);\n\t\t\tthis.currentAnimation++;\n\t\t}\n\t\tthis.currFrame = 0;\n\n\t\t// Hack:  If there are not any animations, and we are currently paused,\n\t\t// then set the current frame to the end of the animation, so that we will\n\t\t// advance immediately upon the next step button.  If we are not paused, then\n\t\t// animate as normal.\n\t\tif (\n\t\t\t(!this.anyAnimations && this.animationPaused) ||\n\t\t\t(!this.anyAnimations && this.currentAnimation === this.animationSteps.length)\n\t\t) {\n\t\t\tthis.currFrame = this.animationBlockLength;\n\t\t}\n\n\t\tthis.undoStack.push(this.undoBlock);\n\t}\n\n\t//  Start a new animation.  The input parameter commands is an array of strings,\n\t//  which represents the animation to start\n\tstartNewAnimation(commands) {\n\t\tthis.stopTimer();\n\t\tif (this.animationSteps !== null) {\n\t\t\tthis.previousAnimationSteps.push(this.animationSteps);\n\t\t\tthis.undoAnimationStepIndicesStack.push(this.undoAnimationStepIndices);\n\t\t}\n\t\tif (commands === undefined || commands.length === 0) {\n\t\t\tthis.animationSteps = [[act.step, []]];\n\t\t} else {\n\t\t\tthis.animationSteps = commands;\n\t\t}\n\t\tthis.undoAnimationStepIndices = [];\n\t\tthis.currentAnimation = 0;\n\t\tthis.startNextBlock();\n\t\tthis.currentlyAnimating = true;\n\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\tthis.startTimer();\n\t}\n\n\t// Step backwards one step.  A no-op if the animation is not currently paused\n\tstepBack() {\n\t\tif (this.awaitingStep && this.undoStack !== null && this.undoStack.length !== 0) {\n\t\t\t//  TODO:  Get events working correctly!\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\t\tthis.stopTimer();\n\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.undoLastBlock();\n\t\t\t// Re-kick the timer.  The timer may or may not be running at this point,\n\t\t\t// so to be safe we'll kill it and start it again.\n\t\t\tthis.stopTimer();\n\t\t\tthis.startTimer();\n\t\t} else if (\n\t\t\t!this.currentlyAnimating &&\n\t\t\tthis.animationPaused &&\n\t\t\tthis.undoAnimationStepIndices !== null\n\t\t) {\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\t\tthis.currentlyAnimating = true;\n\t\t\tthis.undoLastBlock();\n\t\t\t// Re-kick the timer.  The timer may or may not be running at this point,\n\t\t\t// so to be safe we'll kill it and start it again.\n\t\t\tthis.stopTimer();\n\t\t\tthis.startTimer();\n\t\t}\n\t}\n\n\t// Step forwards one step.  A no-op if the animation is not currently paused\n\tstep() {\n\t\tif (this.awaitingStep) {\n\t\t\tthis.startNextBlock();\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\t\tthis.currentlyAnimating = true;\n\t\t\t// Re-kick the timer.  The timer should be going now, but we've had some difficulty with\n\t\t\t// it timing itself out, so we'll be safe and kick it now.\n\t\t\tthis.stopTimer();\n\t\t\tthis.startTimer();\n\t\t}\n\t}\n\n\t/// WARNING:  Could be dangerous to call while an animation is running ...\n\tclearHistory() {\n\t\tthis.undoStack = [];\n\t\tthis.undoAnimationStepIndices = null;\n\t\tthis.previousAnimationSteps = [];\n\t\tthis.undoAnimationStepIndicesStack = [];\n\t\tthis.animationSteps = null;\n\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\n\t\tthis.stopTimer();\n\t\tthis.animatedObjects.update();\n\t\tthis.animatedObjects.draw();\n\t}\n\n\tskipBack() {\n\t\tlet keepUndoing =\n\t\t\tthis.undoAnimationStepIndices !== null && this.undoAnimationStepIndices.length !== 0;\n\t\tif (keepUndoing) {\n\t\t\tlet i;\n\t\t\tfor (i = 0; this.currentBlock !== null && i < this.currentBlock.length; i++) {\n\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\tobjectID,\n\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (this.doingUndo) {\n\t\t\t\tthis.finishUndoBlock(this.undoStack.pop());\n\t\t\t}\n\t\t\twhile (keepUndoing) {\n\t\t\t\tthis.undoLastBlock();\n\t\t\t\tfor (i = 0; i < this.currentBlock.length; i++) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tobjectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tkeepUndoing = this.finishUndoBlock(this.undoStack.pop());\n\t\t\t}\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\t\t\tif (this.undoStack == null || this.undoStack.length === 0) {\n\t\t\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\n\t\t\t}\n\t\t}\n\t}\n\n\tresetAll() {\n\t\tthis.clearHistory();\n\t\tthis.animatedObjects.clearAllObjects();\n\t\tthis.animatedObjects.draw();\n\t\tthis.stopTimer();\n\t}\n\n\tskipForward() {\n\t\tif (this.currentlyAnimating) {\n\t\t\tthis.animatedObjects.runFast = true;\n\t\t\twhile (\n\t\t\t\tthis.animationSteps !== null &&\n\t\t\t\tthis.currentAnimation < this.animationSteps.length\n\t\t\t) {\n\t\t\t\tfor (let i = 0; this.currentBlock !== null && i < this.currentBlock.length; i++) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tobjectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (this.doingUndo) {\n\t\t\t\t\tthis.finishUndoBlock(this.undoStack.pop());\n\t\t\t\t}\n\t\t\t\tthis.startNextBlock();\n\t\t\t\tfor (let i = 0; i < this.currentBlock.length; i++) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tobjectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.currentlyAnimating = false;\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.doingUndo = false;\n\n\t\t\tthis.animatedObjects.runFast = false;\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\t\t}\n\t}\n\n\tfinishUndoBlock(undoBlock) {\n\t\tfor (let i = undoBlock.length - 1; i >= 0; i--) {\n\t\t\tundoBlock[i].undoInitialStep(this.animatedObjects);\n\t\t}\n\t\tthis.doingUndo = false;\n\n\t\t// If we are at the final end of the animation ...\n\t\tif (this.undoAnimationStepIndices.length === 0) {\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.currentlyAnimating = false;\n\t\t\tthis.undoAnimationStepIndices = this.undoAnimationStepIndicesStack.pop();\n\t\t\tthis.animationSteps = this.previousAnimationSteps.pop();\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\n\t\t\tthis.fireEvent('AnimationUndo', 'NoData');\n\t\t\tthis.currentBlock = [];\n\t\t\tif (this.undoStack == null || this.undoStack.length === 0) {\n\t\t\t\tthis.currentlyAnimating = false;\n\t\t\t\tthis.awaitingStep = false;\n\t\t\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\n\t\t\t}\n\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tundoLastBlock() {\n\t\tif (this.undoAnimationStepIndices.length === 0) {\n\t\t\t// Nothing on the undo stack.  Return\n\t\t\treturn;\n\t\t}\n\t\tif (this.undoAnimationStepIndices.length > 0) {\n\t\t\tthis.doingUndo = true;\n\t\t\tlet anyAnimations = false;\n\t\t\tthis.currentAnimation = this.undoAnimationStepIndices.pop();\n\t\t\tthis.currentBlock = [];\n\t\t\tconst undo = this.undoStack[this.undoStack.length - 1];\n\t\t\tlet i;\n\t\t\tfor (i = undo.length - 1; i >= 0; i--) {\n\t\t\t\tconst animateNext = undo[i].addUndoAnimation(this.currentBlock);\n\t\t\t\tanyAnimations = anyAnimations || animateNext;\n\t\t\t}\n\t\t\tthis.currFrame = 0;\n\n\t\t\t// Hack:  If there are not any animations, and we are currently paused,\n\t\t\t// then set the current frame to the end of the animation, so that we will\n\t\t\t// advance immediately upon the next step button.  If we are not paused, then\n\t\t\t// animate as normal.\n\t\t\tif (!anyAnimations && this.animationPaused) {\n\t\t\t\tthis.currFrame = this.animationBlockLength;\n\t\t\t}\n\t\t\tthis.currentlyAnimating = true;\n\t\t}\n\t}\n\n\tsetLayer(shown, layers) {\n\t\tthis.animatedObjects.setLayer(shown, layers);\n\t\t// Drop in an extra draw call here, just in case we are not\n\t\t// in the middle of an update loop when this changes\n\t\tthis.animatedObjects.draw();\n\t}\n\n\tsetAllLayers(layers) {\n\t\tthis.animatedObjects.setAllLayers(layers);\n\t\t// Drop in an extra draw call here, just in case we are not\n\t\t// in the middle of an update loop when this changes\n\t\tthis.animatedObjects.draw();\n\t}\n\n\tupdate() {\n\t\tif (this.currentlyAnimating) {\n\t\t\tthis.currFrame = this.currFrame + 1;\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < this.currentBlock.length; i++) {\n\t\t\t\tif (\n\t\t\t\t\tthis.currFrame === this.animationBlockLength ||\n\t\t\t\t\t(this.currFrame === 1 && this.animationBlockLength === 0)\n\t\t\t\t) {\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tthis.currentBlock[i].objectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t);\n\t\t\t\t} else if (this.currFrame < this.animationBlockLength) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tconst percent = 1 / (this.animationBlockLength - this.currFrame);\n\t\t\t\t\tconst newX = this.lerp(\n\t\t\t\t\t\tthis.animatedObjects.getNodeX(objectID),\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tpercent,\n\t\t\t\t\t);\n\t\t\t\t\tconst newY = this.lerp(\n\t\t\t\t\t\tthis.animatedObjects.getNodeY(objectID),\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t\tpercent,\n\t\t\t\t\t);\n\t\t\t\t\tthis.animatedObjects.setNodePosition(objectID, newX, newY);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.currFrame >= this.animationBlockLength) {\n\t\t\t\tif (this.doingUndo) {\n\t\t\t\t\tif (this.finishUndoBlock(this.undoStack.pop())) {\n\t\t\t\t\t\tthis.awaitingStep = true;\n\t\t\t\t\t\tthis.fireEvent('AnimationWaiting', 'NoData');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.animationPaused &&\n\t\t\t\t\t\tthis.currentAnimation < this.animationSteps.length\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.awaitingStep = true;\n\t\t\t\t\t\tthis.fireEvent('AnimationWaiting', 'NoData');\n\t\t\t\t\t\tthis.currentBlock = [];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.startNextBlock();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.animatedObjects.update();\n\t\t}\n\t}\n\n\tanimWaiting() {\n\t\tthis.stepForwardButton.disabled = false;\n\t\tif (this.skipBackButton.disabled === false) {\n\t\t\tthis.stepBackButton.disabled = false;\n\t\t}\n\t\tthis.objectManager.statusReport.setText('Animation Paused');\n\t\tthis.objectManager.statusReport.setForegroundColor('#FF0000');\n\t}\n\n\tanimStarted() {\n\t\tthis.skipForwardButton.disabled = false;\n\t\tthis.skipBackButton.disabled = false;\n\t\tthis.stepForwardButton.disabled = true;\n\t\tthis.stepBackButton.disabled = true;\n\t\tthis.objectManager.statusReport.setText('Animation Running');\n\t\tthis.objectManager.statusReport.setForegroundColor('#009900');\n\t}\n\n\tanimEnded() {\n\t\tthis.skipForwardButton.disabled = true;\n\t\tthis.stepForwardButton.disabled = true;\n\t\tif (this.skipBackButton.disabled === false && this.paused) {\n\t\t\tthis.stepBackButton.disabled = false;\n\t\t}\n\t\tthis.objectManager.statusReport.setText('Animation Completed');\n\t\tthis.objectManager.statusReport.setForegroundColor('#000000');\n\t}\n\n\tanimUndoUnavailable() {\n\t\tthis.skipBackButton.disabled = true;\n\t\tthis.stepBackButton.disabled = true;\n\t}\n\n\ttimeout() {\n\t\t// We need to set the timeout *first*, otherwise if we\n\t\t// try to clear it later, we get behavior we don't want ...\n\t\tthis.timer = setTimeout(() => this.timeout(), 30);\n\t\tthis.update();\n\t\tthis.objectManager.draw();\n\t}\n\n\tdoPlayPause() {\n\t\tthis.paused = !this.paused;\n\t\tif (this.paused) {\n\t\t\tthis.playPauseBackButton.setAttribute('value', 'Play');\n\t\t\tif (this.skipBackButton.disabled === false) {\n\t\t\t\tthis.stepBackButton.disabled = false;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.playPauseBackButton.setAttribute('value', 'Pause');\n\t\t}\n\t\tthis.setPaused(this.paused);\n\t}\n\n\tstartTimer() {\n\t\tthis.timer = setTimeout(() => this.timeout(), 30);\n\t}\n\n\tstopTimer() {\n\t\tclearInterval(this.timer);\n\t}\n}\n\nexport const act = {\n\tstep() {\n\t\tthis.foundBreak = true;\n\t},\n\tmove(params) {\n\t\t// id, x, y\n\t\tconst nextAnim = new SingleAnimation(\n\t\t\tparams[0],\n\t\t\tthis.animatedObjects.getNodeX(params[0]),\n\t\t\tthis.animatedObjects.getNodeY(params[0]),\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t);\n\t\tthis.currentBlock.push(nextAnim);\n\t\tthis.undoBlock.push(\n\t\t\tnew UndoMove(\n\t\t\t\tnextAnim.objectID,\n\t\t\t\tnextAnim.toX,\n\t\t\t\tnextAnim.toY,\n\t\t\t\tnextAnim.fromX,\n\t\t\t\tnextAnim.fromY,\n\t\t\t),\n\t\t);\n\t\tthis.anyAnimations = true;\n\t},\n\tdelete(params) {\n\t\t// id\n\t\tconst removedEdges = this.animatedObjects.deleteIncident(params[0]);\n\t\tif (removedEdges.length > 0) {\n\t\t\tthis.undoBlock = this.undoBlock.concat(removedEdges);\n\t\t}\n\t\tconst obj = this.animatedObjects.getObject(params[0]);\n\t\tif (obj !== null) {\n\t\t\tthis.undoBlock.push(obj.createUndoDelete());\n\t\t\tthis.animatedObjects.removeObject(params[0]);\n\t\t}\n\t},\n\tconnect(params) {\n\t\t// fromID, toID | color, curve, directed, label, anchorPos, thickness\n\t\tparams[2] = params[2] || '#000000';\n\t\tparams[3] = params[3] || 0.0;\n\t\tparams[4] = params[4] !== false && params[4] !== 0;\n\t\tparams[5] = params[5] === undefined ? '' : params[5];\n\t\tparams[6] = params[6] || 0;\n\t\tparams[7] = params[7] === undefined ? 1 : params[7];\n\t\tthis.animatedObjects.connectEdge(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[4],\n\t\t\tString(params[5]),\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectNext(params) {\n\t\t// fromID, toID\n\t\tthis.animatedObjects.connectEdge(params[0], params[1], '#000000', 0.0, true, '', 0);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectPrev(params) {\n\t\t// fromID, toID\n\t\tthis.animatedObjects.connectEdge(params[0], params[1], '#000000', 0.0, true, '', 1);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectCurve(params) {\n\t\t// fromID, toID, curve\n\t\tthis.animatedObjects.connectEdge(params[0], params[1], '#000000', params[2], true, '', 1);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectSkipList(params) {\n\t\t// fromID, toID, anchorPos\n\t\tthis.animatedObjects.connectEdge(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\t'#000000',\n\t\t\t0.0,\n\t\t\tfalse,\n\t\t\t'',\n\t\t\tparams[2],\n\t\t);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tdisconnect(params) {\n\t\t// fromID, toID\n\t\tconst undoConnect = this.animatedObjects.disconnect(params[0], params[1]);\n\t\tif (undoConnect !== null) this.undoBlock.push(undoConnect);\n\t},\n\tcreateCircle(params) {\n\t\t// id, label | x, y\n\t\tparams[2] = params[2] || 0;\n\t\tparams[3] = params[3] || 0;\n\t\tthis.animatedObjects.addCircleObject(params[0], String(params[1]));\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparseInt(params[0]),\n\t\t\tparseInt(params[2]),\n\t\t\tparseInt(params[3]),\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateHighlightCircle(params) {\n\t\t// id, color | x, y, radius\n\t\tparams[2] = params[2] || 0;\n\t\tparams[3] = params[3] || 0;\n\t\tparams[4] = params[4] === undefined ? 20 : params[4];\n\t\tthis.animatedObjects.addHighlightCircleObject(params[0], params[1], params[4]);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparseInt(params[0]),\n\t\t\tparseInt(params[2]),\n\t\t\tparseInt(params[3]),\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateRectangle(params) {\n\t\t// id, label, w, h | x, y, xJustify, yJustify, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] || 'center';\n\t\tparams[7] = params[7] || 'center';\n\t\tparams[8] = params[8] || '#FFFFFF';\n\t\tparams[9] = params[9] || '#000000';\n\t\tthis.animatedObjects.addRectangleObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t\tparams[9],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateLabel(params) {\n\t\t// id, label | x, y, centered\n\t\tparams[2] = params[2] || 0;\n\t\tparams[3] = params[3] || 0;\n\t\tparams[4] = params[4] !== false && params[4] !== 0;\n\t\tthis.animatedObjects.addLabelObject(params[0], String(params[1]), params[4]);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[2], params[3]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateLinkedListNode(params) {\n\t\t// id, label, w, h | x, y, linkPercent, vertical, linkPosEnd, bgColor, fgColor\n\t\tparams[1] = Array.isArray(params[1]) ? params[1].map(x => String(x)) : [String(params[1])];\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] === undefined ? 0.25 : params[6];\n\t\tparams[7] = params[7] !== false && params[7] !== 0;\n\t\tparams[8] = params[8] || false;\n\t\tparams[9] = params[9] || '#FFFFFF';\n\t\tparams[10] = params[10] || '#000000';\n\t\tthis.animatedObjects.addLinkedListObject(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t\tparams[9],\n\t\t\tparams[10],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateDoublyLinkedListNode(params) {\n\t\t// id, label, w, h | x, y, linkPercent, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] === undefined ? 0.25 : params[6];\n\t\tparams[7] = params[7] || '#FFFFFF';\n\t\tparams[8] = params[8] || '#000000';\n\t\tthis.animatedObjects.addDoublyLinkedListObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateCircularlyLinkedListNode(params) {\n\t\t// id, label, w, h | x, y, linkPercent, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] === undefined ? 0.25 : params[6];\n\t\tparams[7] = params[7] || '#FFFFFF';\n\t\tparams[8] = params[8] || '#000000';\n\t\tthis.animatedObjects.addCircularlyLinkedListObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateSkipListNode(params) {\n\t\t// id, label, w, h | x, y, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] || '#FFFFFF';\n\t\tparams[7] = params[7] || '#000000';\n\t\tthis.animatedObjects.addSkipListObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateBTreeNode(params) {\n\t\t// id, widthPerElement, height, numLabels, x, y, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] || '#FFFFFF';\n\t\tparams[7] = params[7] || '#000000';\n\t\tthis.animatedObjects.addBTreeNode(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tsetText(params) {\n\t\t// id, text | textIndex\n\t\tparams[2] = params[2] || 0;\n\t\tconst oldText = this.animatedObjects.getText(params[0], params[2]);\n\t\tthis.animatedObjects.setText(params[0], String(params[1]), params[2]);\n\t\tif (oldText !== undefined) {\n\t\t\tthis.undoBlock.push(new UndoSetText(params[0], oldText, params[2]));\n\t\t}\n\t},\n\tsetTextColor(params) {\n\t\t// id, color, textIndex\n\t\tparams[2] = params[2] || 0;\n\t\tconst oldColor = this.animatedObjects.getTextColor(params[0], params[2]);\n\t\tthis.animatedObjects.setTextColor(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetTextColor(params[0], oldColor, params[2]));\n\t},\n\tsetForegroundColor(params) {\n\t\t// id, color\n\t\tconst oldColor = this.animatedObjects.foregroundColor(params[0]);\n\t\tthis.animatedObjects.setForegroundColor(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetForegroundColor(params[0], oldColor));\n\t},\n\tsetBackgroundColor(params) {\n\t\t// id, color\n\t\tconst oldColor = this.animatedObjects.backgroundColor(params[0]);\n\t\tthis.animatedObjects.setBackgroundColor(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetBackgroundColor(params[0], oldColor));\n\t},\n\tsetHighlight(params) {\n\t\t// id, highlight, color\n\t\tthis.animatedObjects.setHighlight(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoHighlight(params[0], !params[1], params[2]));\n\t},\n\tsetAlpha(params) {\n\t\t// id, alpha\n\t\tconst oldAlpha = this.animatedObjects.getAlpha(params[0]);\n\t\tthis.animatedObjects.setAlpha(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetAlpha(params[0], oldAlpha));\n\t},\n\tsetEdgeColor(params) {\n\t\t// fromID, toID, newColor\n\t\tconst oldColor = this.animatedObjects.setEdgeColor(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetEdgeColor(params[0], params[1], oldColor));\n\t},\n\tsetEdgeAlpha(params) {\n\t\t// fromID, toID, alpha\n\t\tconst oldAlpha = this.animatedObjects.setEdgeAlpha(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetEdgeAlpha(params[0], params[1], oldAlpha));\n\t},\n\tsetEdgeHighlight(params) {\n\t\t// fromID, toID, highlight\n\t\tconst oldHighlight = this.animatedObjects.setEdgeHighlight(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t);\n\t\tthis.undoBlock.push(new UndoHighlightEdge(params[0], params[1], oldHighlight));\n\t},\n\tsetEdgeThickness(params) {\n\t\t// fromID, toID, thickness\n\t\tconst oldThickness = this.animatedObjects.setEdgeThickness(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetEdgeThickness(params[0], params[1], oldThickness));\n\t},\n\tsetRectangleEdgeThickness(params) {\n\t\t//id, thicknessArray\n\t\tconst oldThicknessArray = this.animatedObjects.setRectangleEdgeThickness(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t);\n\t\tthis.undoBlock.push(new UndoSetRectangleEdgeThickness(params[0], oldThicknessArray));\n\t},\n\tsetHeight(params) {\n\t\t// id, height\n\t\tconst oldHeight = this.animatedObjects.getHeight(params[0]);\n\t\tthis.animatedObjects.setHeight(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetHeight(params[0], oldHeight));\n\t},\n\tsetWidth(params) {\n\t\t// id, width\n\t\tconst oldWidth = this.animatedObjects.getWidth(params[0]);\n\t\tthis.animatedObjects.setWidth(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetWidth(params[0], oldWidth));\n\t},\n\tsetLayer(params) {\n\t\t// id, height\n\t\tthis.animatedObjects.setLayer(params[0], params[1]);\n\t\t//TODO: Add undo information here\n\t},\n\tsetNull(params) {\n\t\t// id, null\n\t\tconst oldNull = this.animatedObjects.getNull(params[0]);\n\t\tthis.animatedObjects.setNull(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetNull(params[0], oldNull));\n\t},\n\tsetPrevNull(params) {\n\t\t// id, null\n\t\tconst oldNull = this.animatedObjects.getLeftNull(params[0]);\n\t\tthis.animatedObjects.setPrevNull(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPrevNull(params[0], oldNull));\n\t},\n\tsetNextNull(params) {\n\t\t// id, null\n\t\tconst oldNull = this.animatedObjects.getRightNull(params[0]);\n\t\tthis.animatedObjects.setNextNull(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetNextNull(params[0], oldNull));\n\t},\n\tsetNumElements(params) {\n\t\t// id, numElements\n\t\tconst oldElem = this.animatedObjects.getObject(params[0]);\n\t\tthis.undoBlock.push(new UndoSetNumElements(oldElem, params[1]));\n\t\tthis.animatedObjects.setNumElements(params[0], params[1]);\n\t},\n\tsetPosition(params) {\n\t\t// id, x, y\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\tsetHighlightIndex(params) {\n\t\tconst oldIndex = this.animatedObjects.getHighlightIndex(params[0]);\n\t\tthis.undoBlock.push(new UndoSetHighlightIndex(params[0], oldIndex));\n\t\tthis.animatedObjects.setHighlightIndex(params[0], params[1]);\n\t},\n\talignRight(params) {\n\t\t// id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignRight(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\talignLeft(params) {\n\t\t// id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignLeft(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\talignTop(params) {\n\t\t// id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignTop(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\talignBottom(params) {\n\t\t// id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignBottom(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\tbringToTop(params) {\n\t\tconst oldTop = this.animatedObjects.setAlwaysOnTop(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetAlwaysOnTop(params[0], oldTop));\n\t},\n\tmoveToAlignRight(params) {\n\t\t// id, otherID\n\t\tconst newXY = this.animatedObjects.getAlignRightPos(params[0], params[1]);\n\t\tconst nextAnim = new SingleAnimation(\n\t\t\tparams[0],\n\t\t\tthis.animatedObjects.getNodeX(params[0]),\n\t\t\tthis.animatedObjects.getNodeY(params[0]),\n\t\t\tnewXY[0],\n\t\t\tnewXY[1],\n\t\t);\n\t\tthis.currentBlock.push(nextAnim);\n\t\tthis.undoBlock.push(\n\t\t\tnew UndoMove(\n\t\t\t\tnextAnim.objectID,\n\t\t\t\tnextAnim.toX,\n\t\t\t\tnextAnim.toY,\n\t\t\t\tnextAnim.fromX,\n\t\t\t\tnextAnim.fromY,\n\t\t\t),\n\t\t);\n\t\tthis.anyAnimations = true;\n\t},\n};\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nexport default class EventListener {\n\tconstructor() {\n\t\tthis.events = [];\n\t}\n\n\tremoveListener(kind, scope, func) {\n\t\tif (this.events[kind] == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet scopeFunctions = null;\n\t\tlet i;\n\t\tfor (i = 0; i < this.events[kind].length; i++) {\n\t\t\tif (this.events[kind][i].scope === scope) {\n\t\t\t\tscopeFunctions = this.events[kind][i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (scopeFunctions == null) {\n\t\t\treturn;\n\t\t}\n\t\tfor (i = 0; i < scopeFunctions.functions.length; i++) {\n\t\t\tif (scopeFunctions.functions[i] === func) {\n\t\t\t\tscopeFunctions.functions.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\taddListener(kind, scope, func) {\n\t\tif (this.events[kind] === undefined) {\n\t\t\tthis.events[kind] = [];\n\t\t}\n\t\tlet i;\n\t\tlet scopeFunctions = null;\n\t\tfor (i = 0; i < this.events[kind].length; i++) {\n\t\t\tif (this.events[kind][i].scope === scope) {\n\t\t\t\tscopeFunctions = this.events[kind][i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (scopeFunctions === null) {\n\t\t\tthis.events[kind].push({ scope: scope, functions: [] });\n\t\t\tscopeFunctions = this.events[kind][this.events[kind].length - 1];\n\t\t}\n\t\tfor (i = 0; i < scopeFunctions.functions.length; i++) {\n\t\t\tif (scopeFunctions.functions[i] === func) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tscopeFunctions.functions.push(func);\n\t}\n\n\tfireEvent(kind, event) {\n\t\t// TODO:  Should add a deep clone here ...\n\t\tif (this.events[kind] !== undefined) {\n\t\t\tfor (let i = 0; i < this.events[kind].length; i++) {\n\t\t\t\tconst objects = this.events[kind][i];\n\t\t\t\tconst functs = objects.functions;\n\t\t\t\tconst scope = objects.scope;\n\t\t\t\tfor (let j = 0; j < functs.length; j++) {\n\t\t\t\t\tconst func = functs[j];\n\t\t\t\t\tfunc.call(scope, event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","import React from 'react';\n\nconst Footer = () => (\n\t<div className=\"footer\">\n\t\t&copy; Copyright 2019 <a href=\"https://rodrigodlpontes.github.io/website/\">Rodrigo Pontes</a>,\n\t\tunder the direction of Mary Hudachek-Buswell, &copy; Copyright 2011&nbsp;\n\t\t<a href=\"http://www.cs.usfca.edu/galles\">David Galles</a>\n\t</div>\n);\n\nexport default Footer;\n","import { Link } from 'react-router-dom';\nimport React from 'react';\nimport { Toggle } from 'react-hook-theme';\nimport 'react-hook-theme/dist/styles/style.css';\n\nclass Header extends React.Component {\n\tstate = { menuVisible: null };\n\n\trender() {\n\t\tconst menuClass = { null: '', true: 'show', false: 'hide' };\n\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<div className=\"header\">\n\t\t\t\t\t<div id=\"left\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={this.state.menuVisible ? 'selected' : ''}\n\t\t\t\t\t\t\tonClick={this.toggleMenu}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"center\">\n\t\t\t\t\t\t<h1>CS 1332 Data Structures and Algorithms Visualizations</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"right\">\n\t\t\t\t\t\t<Toggle />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className={`menu ${menuClass[this.state.menuVisible]}`}>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<Link to=\"/\" onClick={this.toggleMenu}>\n\t\t\t\t\t\t\t\tHome\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<Link to=\"/about\" onClick={this.toggleMenu}>\n\t\t\t\t\t\t\t\tAbout\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href=\"https://github.com/RodrigoDLPontes/visualization-tool\">\n\t\t\t\t\t\t\t\tSource Code\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n\n\ttoggleMenu = () => this.setState(state => ({ menuVisible: !state.menuVisible }));\n}\n\nexport default Header;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport { act } from '../anim/AnimationMain';\n\nexport function addLabelToAlgorithmBar(labelName, group) {\n\tconst element = document.createElement('p');\n\telement.appendChild(document.createTextNode(labelName));\n\n\tif (!group) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(element);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\t// Append the element in page (in span)\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tgroup.appendChild(element);\n\t\telement.setAttribute('class', 'groupChild');\n\t}\n\n\treturn element;\n}\n\nexport function addCheckboxToAlgorithmBar(boxLabel, checked, group) {\n\tconst element = document.createElement('input');\n\n\telement.setAttribute('type', 'checkbox');\n\telement.setAttribute('id', boxLabel);\n\telement.setAttribute('name', boxLabel);\n\telement.setAttribute('value', boxLabel);\n\tchecked && element.setAttribute('checked', 'true');\n\n\tconst label = document.createElement('label');\n\tlabel.setAttribute('for', boxLabel);\n\tconst txtNode = document.createTextNode(boxLabel);\n\tlabel.appendChild(txtNode);\n\n\tif (!group) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(element);\n\t\ttableEntry.appendChild(label);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tconst span = document.createElement('span');\n\t\tspan.appendChild(element);\n\t\tspan.appendChild(label);\n\n\t\tgroup.appendChild(span);\n\t\tspan.setAttribute('class', 'groupChild');\n\t}\n\n\treturn element;\n}\n\nexport function addRadioButtonGroupToAlgorithmBar(buttonNames, groupName, group) {\n\tconst buttonList = [];\n\tconst newTable = document.createElement('table');\n\n\tfor (let i = 0; i < buttonNames.length; i++) {\n\t\tconst midLevel = document.createElement('tr');\n\t\tconst bottomLevel = document.createElement('td');\n\n\t\tconst button = document.createElement('input');\n\t\tbutton.setAttribute('type', 'radio');\n\t\tbutton.setAttribute('name', groupName);\n\t\tbutton.setAttribute('id', buttonNames[i]);\n\t\tbutton.setAttribute('value', buttonNames[i]);\n\t\tbottomLevel.appendChild(button);\n\t\tmidLevel.appendChild(bottomLevel);\n\t\tconst label = document.createElement('label');\n\t\tlabel.setAttribute('for', buttonNames[i]);\n\t\tconst txtNode = document.createTextNode(' ' + buttonNames[i]);\n\t\tlabel.appendChild(txtNode);\n\t\tbottomLevel.appendChild(label);\n\t\tnewTable.appendChild(midLevel);\n\t\tbuttonList.push(button);\n\t}\n\n\tif (!group) {\n\t\tconst topLevelTableEntry = document.createElement('td');\n\t\ttopLevelTableEntry.appendChild(newTable);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(topLevelTableEntry);\n\t} else {\n\t\tgroup.appendChild(newTable);\n\t\tnewTable.setAttribute('class', 'groupChild');\n\t}\n\n\treturn buttonList;\n}\n\nexport function addControlToAlgorithmBar(type, value, group) {\n\tconst element = document.createElement('input');\n\n\telement.setAttribute('type', type);\n\telement.setAttribute('value', value);\n\n\tif (!group) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(element);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tgroup.appendChild(element);\n\t\telement.setAttribute('class', 'groupChild');\n\t}\n\n\treturn element;\n}\n\nexport function addDivisorToAlgorithmBar() {\n\tconst divisorLeft = document.createElement('td');\n\tdivisorLeft.setAttribute('class', 'divisorLeft');\n\n\tconst divisorRight = document.createElement('td');\n\tdivisorRight.setAttribute('class', 'divisorRight');\n\n\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\tcontrolBar.appendChild(divisorLeft);\n\tcontrolBar.appendChild(divisorRight);\n}\n\nexport function addGroupToAlgorithmBar(horizontal, parentGroup) {\n\tconst group = document.createElement('div');\n\n\tgroup.setAttribute('class', horizontal ? 'hgroup' : 'vgroup');\n\n\tif (!parentGroup) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(group);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tparentGroup.appendChild(group);\n\t}\n\n\treturn group;\n}\n\nconst CODE_LINE_HEIGHT = 14;\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\nconst CODE_STANDARD_COLOR = '#000000';\n\nexport default class Algorithm {\n\tconstructor(am, w, h) {\n\t\tif (am == null) {\n\t\t\treturn;\n\t\t}\n\t\tthis.animationManager = am;\n\t\tam.addListener('AnimationStarted', this, this.disableUI);\n\t\tam.addListener('AnimationEnded', this, this.enableUI);\n\t\tam.addListener('AnimationUndo', this, this.undo);\n\t\tthis.canvasWidth = w;\n\t\tthis.canvasHeight = h;\n\n\t\tthis.actionHistory = [];\n\t\tthis.recordAnimation = true;\n\t\tthis.commands = [];\n\t}\n\n\taddCodeToCanvasBase(code, start_x, start_y, line_height, standard_color, layer) {\n\t\tline_height = typeof line_height !== 'undefined' ? line_height : CODE_LINE_HEIGHT;\n\t\tstandard_color =\n\t\t\ttypeof standard_color !== 'undefined' ? standard_color : CODE_STANDARD_COLOR;\n\t\tlayer = typeof layer !== 'undefined' ? layer : 0;\n\t\tconst codeID = Array(code.length);\n\t\t//console.log(this.nextIndex);\n\t\tlet i, j;\n\t\tfor (i = 0; i < code.length; i++) {\n\t\t\tcodeID[i] = new Array(code[i].length);\n\t\t\tfor (j = 0; j < code[i].length; j++) {\n\t\t\t\tcodeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tcodeID[i][j],\n\t\t\t\t\tcode[i][j],\n\t\t\t\t\tstart_x,\n\t\t\t\t\tstart_y + i * line_height,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, codeID[i][j], standard_color);\n\t\t\t\tthis.cmd(act.setLayer, codeID[i][j], layer);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, codeID[i][j], codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn codeID;\n\t}\n\n\thighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\n\t}\n\n\tunhighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\n\t}\n\n\tremoveCode(codeID) {\n\t\tfor (let i = 0; i < codeID.length; i++) {\n\t\t\tfor (let j = 0; j < codeID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, codeID[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetCodeAlpha(code, newAlpha) {\n\t\tfor (let i = 0; i < code.length; i++) {\n\t\t\tfor (let j = 0; j < code[i].length; j++) {\n\t\t\t\tthis.cmd(act.setAlpha, code[i][j], newAlpha);\n\t\t\t}\n\t\t}\n\t}\n\n\tcmd(act, ...params) {\n\t\t// Helper method to add command to stack\n\t\tif (this.recordAnimation) {\n\t\t\tthis.commands.push([act, params]);\n\t\t}\n\t}\n\n\tclearHistory() {\n\t\tthis.actionHistory = [];\n\t}\n\n\tundo() {\n\t\t// Remove the last action (the one that we are going to undo)\n\t\tthis.actionHistory.pop();\n\t\t// Clear out our data structure.  Be sure to implement reset in\n\t\t// every AlgorithmAnimation subclass!\n\t\tthis.reset();\n\t\t//  Redo all actions from the beginning, throwing out the animation\n\t\t//  commands (the animation manager will update the animation on its own).\n\t\t//  Note that if you do something non-deterministic, you might cause problems!\n\t\t//  Be sure if you do anything non-deterministic (that is, calls to a random\n\t\t//  number generator) you clear out the undo stack here and in the animation\n\t\t//  manager.\n\n\t\t//  If this seems horribly inefficient -- it is! However, it seems to work well\n\t\t//  in practice, and you get undo for free for all algorithms, which is a non-trivial\n\t\t//  gain.\n\t\tconst len = this.actionHistory.length;\n\t\tthis.recordAnimation = false;\n\t\tfor (let i = 0; i < len; i++) {\n\t\t\tthis.actionHistory[i][0](...this.actionHistory[i][1]);\n\t\t}\n\t\tthis.recordAnimation = true;\n\t}\n\n\timplementAction(func, ...args) {\n\t\tconst next = [func, args];\n\t\tthis.actionHistory.push(next);\n\t\tconst retVal = func(...args);\n\t\tthis.animationManager.startNewAnimation(retVal);\n\t}\n\n\tnormalizeNumber(input, maxLen) {\n\t\tconst isAllDigits = str => !/\\D/.test(str);\n\t\tif (!isAllDigits(input) || input === '') {\n\t\t\treturn input;\n\t\t}\n\t\treturn input.substr(-maxLen);\n\t}\n\n\treturnSubmit(field, funct, maxsize, intOnly) {\n\t\tif (maxsize !== undefined) {\n\t\t\tfield.size = maxsize;\n\t\t}\n\t\treturn function (event) {\n\t\t\tlet keyASCII = 0;\n\t\t\tif (window.event) {\n\t\t\t\t// IE\n\t\t\t\tkeyASCII = event.keyCode;\n\t\t\t} else if (event.which) {\n\t\t\t\t// Netscape/Firefox/Opera\n\t\t\t\tkeyASCII = event.which;\n\t\t\t}\n\n\t\t\tif (keyASCII === 13 && funct != null) {\n\t\t\t\tfunct();\n\t\t\t} else if (\n\t\t\t\tkeyASCII === 190 ||\n\t\t\t\tkeyASCII === 59 ||\n\t\t\t\tkeyASCII === 173 ||\n\t\t\t\tkeyASCII === 189\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t} else if (\n\t\t\t\t(maxsize !== undefined && field.value.length >= maxsize) ||\n\t\t\t\t(intOnly && (keyASCII < 48 || keyASCII > 57))\n\t\t\t) {\n\t\t\t\tif (!controlKey(keyASCII)) return false;\n\t\t\t}\n\t\t};\n\t}\n\n\t// Abstract methods - these should be implemented in the base class\n\n\t// eslint-disable-next-line no-unused-vars\n\tsizeChanged(newWidth, newHeight) {\n\t\tthrow new Error('sizeChanged() should be implemented in base class');\n\t}\n\n\t// eslint-disable-next-line no-unused-vars\n\tdisableUI(event) {\n\t\tthrow new Error('disableUI() should be implemented in base class');\n\t}\n\n\t// eslint-disable-next-line no-unused-vars\n\tenableUI(event) {\n\t\tthrow new Error('enableUI() should be implemented in base class');\n\t}\n\n\treset() {\n\t\tthrow new Error('reset() should be implemented in base class');\n\t}\n}\n\nexport function controlKey(keyASCII) {\n\treturn (\n\t\tkeyASCII === 8 ||\n\t\tkeyASCII === 9 ||\n\t\tkeyASCII === 37 ||\n\t\tkeyASCII === 38 ||\n\t\tkeyASCII === 39 ||\n\t\tkeyASCII === 40 ||\n\t\tkeyASCII === 46\n\t);\n}\n\nAlgorithm.prototype.returnSubmitFloat = function (field, funct, maxsize) {\n\tif (maxsize !== undefined) {\n\t\tfield.size = maxsize;\n\t}\n\treturn function (event) {\n\t\tlet keyASCII = 0;\n\t\tif (window.event) {\n\t\t\t// IE\n\t\t\tkeyASCII = event.keyCode;\n\t\t} else if (event.which) {\n\t\t\t// Netscape/Firefox/Opera\n\t\t\tkeyASCII = event.which;\n\t\t}\n\t\t// Submit on return\n\t\tif (keyASCII === 13) {\n\t\t\tfunct();\n\t\t}\n\t\t// Control keys (arrows, del, etc) are always OK\n\t\telse if (controlKey(keyASCII)) {\n\t\t\treturn;\n\t\t}\n\t\t// - (minus sign) only OK at beginning of number\n\t\t//  (For now we will allow anywhere -- hard to see where the beginning of the\n\t\t//   number is ...)\n\t\t//else if (keyASCII == 109 && field.value.length  == 0)\n\t\telse if (keyASCII === 109) {\n\t\t\treturn;\n\t\t}\n\t\t// Digis are OK if we have enough space\n\t\telse if (\n\t\t\t(maxsize !== undefined || field.value.length < maxsize) &&\n\t\t\tkeyASCII >= 48 &&\n\t\t\tkeyASCII <= 57\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\t// . (Decimal point) is OK if we haven't had one yet, and there is space\n\t\telse if (\n\t\t\t(maxsize !== undefined || field.value.length < maxsize) &&\n\t\t\tkeyASCII === 190 &&\n\t\t\tfield.value.indexOf('.') === -1\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\t// Nothing else is OK\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t};\n};\n\nAlgorithm.prototype.addReturnSubmit = function (field, action) {\n\tfield.onkeydown = this.returnSubmit(field, action, 4, false);\n};\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nexport default class AVL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.first_print_pos_y = h - 2 * AVL.PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\t\tthis.startingX = w / 2;\n\t\tthis.addControls();\n\t\tthis.nextIndex = 1;\n\t\tthis.commands = [];\n\t\tthis.edges = [];\n\t\tthis.cmd(act.createLabel, 0, '', AVL.EXPLANITORY_TEXT_X, AVL.EXPLANITORY_TEXT_Y, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst predSuccButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Predecessor', 'Successor'],\n\t\t\t'Predecessor/Successor',\n\t\t);\n\n\t\tthis.predButton = predSuccButtonList[0];\n\t\tthis.succButton = predSuccButtonList[1];\n\t\tthis.predButton.onclick = () => (this.predSucc = 'pred');\n\t\tthis.succButton.onclick = () => (this.predSucc = 'succ');\n\t\tthis.succButton.checked = true;\n\t\tthis.predSucc = 'succ';\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t\tthis.edges = [];\n\t}\n\n\tinsertCallback() {\n\t\tlet insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tlet findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tfindValue = this.normalizeNumber(findValue, 4);\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t\t}\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tsizeChanged(newWidth) {\n\t\tthis.startingX = newWidth / 2;\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tAVL.HIGHLIGHT_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y,\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = AVL.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.cmd(act.delete, i);\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, AVL.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += AVL.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = AVL.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += AVL.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tif (tree.right != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\treturn;\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tthis.doFind(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searchiing for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Found:' + value);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tAVL.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.left, value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t' Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tAVL.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.right, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t' Searching for ' + value + ' : < Empty Tree > (Element not found)',\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, ' Searching for ' + value + ' :  (Element not found)');\n\t\t}\n\t}\n\n\tremakeTree(curr) {\n\t\tif (curr == null) return;\n\t\tif (curr.left != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.left.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.left);\n\t\t}\n\t\tif (curr.right != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.right.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.right);\n\t\t}\n\t}\n\n\tadd(data) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, ' Inserting ' + data);\n\t\tthis.treeRoot = this.addH(data, this.treeRoot);\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\taddH(data, curr) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, 'Null found, inserting new node');\n\t\t\tconst treeNodeID = this.nextIndex++;\n\t\t\tconst heightLabelID = this.nextIndex++;\n\t\t\tconst bfLabelID = this.nextIndex++;\n\t\t\tthis.cmd(act.createCircle, treeNodeID, data, 30, AVL.STARTING_Y);\n\n\t\t\tthis.cmd(act.setForegroundColor, treeNodeID, AVL.FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, treeNodeID, AVL.BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.createLabel, heightLabelID, 0, 30 - 20, AVL.STARTING_Y - 20);\n\t\t\tthis.cmd(act.setForegroundColor, heightLabelID, AVL.HEIGHT_LABEL_COLOR);\n\n\t\t\tthis.cmd(act.createLabel, bfLabelID, 0, 30 + 20, AVL.STARTING_Y - 20);\n\t\t\tthis.cmd(act.setForegroundColor, bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn new AVLNode(data, treeNodeID, heightLabelID, bfLabelID, 0, 0);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking at left subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.addH(data, curr.left);\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking at right subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.addH(data, curr.right);\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, `${data} == ${curr.data}. Ignoring duplicate!`);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tconnectSmart(id1, id2) {\n\t\tif (!this.edges.some(e => e[0] === id1 && e[1] === id2)) {\n\t\t\tthis.cmd(act.connect, id1, id2, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, id1, id2, AVL.LINK_OPACITY);\n\t\t\tthis.edges.push([id1, id2]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tbalance(curr) {\n\t\tcurr.updateHeightAndBF();\n\t\tthis.cmd(act.setText, curr.heightLabelID, curr.height);\n\t\tthis.cmd(act.setText, curr.bfLabelID, curr.bf);\n\t\tthis.cmd(act.setText, 0, 'Adjusting height and balance factor after recursive call');\n\t\tthis.cmd(act.step);\n\n\t\tif (curr.bf < -1) {\n\t\t\tthis.cmd(act.setText, 0, 'Balance factor < -1');\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (curr.right != null && curr.right.bf > 0) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Right child balance factor > 0');\n\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Right-left rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\t\tcurr.right = this.singleRotateRight(curr.right);\n\t\t\t} else {\n\t\t\t\tif (curr.right != null) {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'Right child balance factor <= 0');\n\t\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'No right child');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setText, 0, 'Left rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tcurr = this.singleRotateLeft(curr);\n\t\t} else if (curr.bf > 1) {\n\t\t\tthis.cmd(act.setText, 0, 'Balance factor > 1');\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (curr.left != null && curr.left.bf < 0) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Left child balance factor < 0');\n\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Left-right rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\t\tcurr.left = this.singleRotateLeft(curr.left);\n\t\t\t} else {\n\t\t\t\tif (curr.left != null) {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'Left child balance factor >= 0');\n\t\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'No left child');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setText, 0, 'Right rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\t}\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tcurr = this.singleRotateRight(curr);\n\t\t}\n\t\treturn curr;\n\t}\n\n\tsingleRotateRight(tree) {\n\t\tconst B = tree;\n\t\tconst A = tree.left;\n\t\tconst t2 = A.right;\n\n\t\t// this.cmd(act.setText, 0, 'Single Rotate Right');\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, B.graphicID, t2.graphicID, AVL.LINK_OPACITY);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, AVL.LINK_COLOR);\n\t\tthis.cmd(act.setEdgeAlpha, A.graphicID, B.graphicID, AVL.LINK_OPACITY);\n\t\tA.parent = B.parent;\n\t\tif (this.treeRoot === B) {\n\t\t\tthis.treeRoot = A;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, B.parent.graphicID, B.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.connect, B.parent.graphicID, A.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, B.parent.graphicID, A.graphicID, AVL.LINK_OPACITY);\n\n\t\t\tif (B.isLeftChild()) {\n\t\t\t\tB.parent.left = A;\n\t\t\t} else {\n\t\t\t\tB.parent.right = A;\n\t\t\t}\n\t\t}\n\t\tA.right = B;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tthis.cmd(act.setHighlight, A.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, B.graphicID, 0);\n\t\tB.updateHeightAndBF();\n\t\tthis.cmd(act.setText, B.heightLabelID, B.height);\n\t\tthis.cmd(act.setText, B.bfLabelID, B.bf);\n\t\tA.updateHeightAndBF();\n\t\tthis.cmd(act.setText, A.heightLabelID, A.height);\n\t\tthis.cmd(act.setText, A.bfLabelID, A.bf);\n\t\tthis.resizeTree();\n\t\treturn A;\n\t}\n\n\tsingleRotateLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\tconst t2 = B.left;\n\n\t\t// this.cmd(act.setText, 0, 'Single Rotate Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, A.graphicID, t2.graphicID, AVL.LINK_OPACITY);\n\n\t\t\tt2.parent = A;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, AVL.LINK_COLOR);\n\t\tthis.cmd(act.setEdgeAlpha, B.graphicID, A.graphicID, AVL.LINK_OPACITY);\n\n\t\tB.parent = A.parent;\n\t\tif (this.treeRoot === A) {\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, A.parent.graphicID, B.graphicID, AVL.LINK_OPACITY);\n\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t}\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tA.right = t2;\n\t\tthis.cmd(act.setHighlight, A.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, B.graphicID, 0);\n\t\tA.updateHeightAndBF();\n\t\tthis.cmd(act.setText, A.heightLabelID, A.height);\n\t\tthis.cmd(act.setText, A.bfLabelID, A.bf);\n\t\tB.updateHeightAndBF();\n\t\tthis.cmd(act.setText, B.heightLabelID, B.height);\n\t\tthis.cmd(act.setText, B.bfLabelID, B.bf);\n\n\t\tthis.resizeTree();\n\t\treturn B;\n\t}\n\n\tgetHeight(tree) {\n\t\tif (tree == null) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn tree.height;\n\t}\n\n\tresetHeight(tree) {\n\t\tif (tree != null) {\n\t\t\tconst newHeight = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\n\t\t\tif (tree.height !== newHeight) {\n\t\t\t\ttree.height = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\n\t\t\t\tthis.cmd(act.setText, tree.heightLabelID, newHeight);\n\t\t\t}\n\t\t}\n\t}\n\n\tdeleteNode(curr) {\n\t\tthis.cmd(act.delete, curr.graphicID);\n\t\tthis.cmd(act.delete, curr.heightLabelID);\n\t\tthis.cmd(act.delete, curr.bfLabelID);\n\t}\n\n\tremove(data) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, 0, `Deleting ${data}`);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, ' ');\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeRoot = this.removeH(this.treeRoot, data);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\tremoveH(curr, data) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, `${data} not found in the tree`);\n\t\t\treturn;\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking left`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.removeH(curr.left, data);\n\t\t\tif (curr.left != null) {\n\t\t\t\tcurr.left.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking right`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.removeH(curr.right, data);\n\t\t\tif (curr.right != null) {\n\t\t\t\tcurr.right.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else {\n\t\t\tif (curr.left == null && curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Element to delete is a leaf node');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn null;\n\t\t\t} else if (curr.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with right child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.right;\n\t\t\t} else if (curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with left child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.left;\n\t\t\t} else {\n\t\t\t\tconst dummy = [];\n\t\t\t\tif (this.predSucc === 'succ') {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with successor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.right = this.removeSucc(curr.right, dummy);\n\t\t\t\t\tcurr.right && this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with predecessor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.left = this.removePred(curr.left, dummy);\n\t\t\t\t\tcurr.left && this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\t}\n\t\t\t\tthis.resizeTree();\n\t\t\t\tcurr.data = dummy[0];\n\t\t\t\tthis.cmd(act.setText, curr.graphicID, curr.data);\n\t\t\t}\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tremoveSucc(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.left == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No left child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.right;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Left child exists, look left');\n\t\tthis.cmd(act.step);\n\t\tcurr.left = this.removeSucc(curr.left, dummy);\n\t\tif (curr.left != null) {\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\treturn curr;\n\t}\n\n\tremovePred(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.right == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No right child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.left;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Right child exists, look right');\n\t\tthis.cmd(act.step);\n\t\tcurr.right = this.removePred(curr.right, dummy);\n\t\tif (curr.right != null) {\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\treturn curr;\n\t}\n\n\tresizeTree() {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, AVL.STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t} else {\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\ttree.heightLabelY = tree.y - 20;\n\t\t\ttree.bfLabelY = tree.y - 20;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + AVL.HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + AVL.HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.cmd(act.move, tree.heightLabelID, tree.heightLabelX, tree.heightLabelY);\n\t\t\tthis.cmd(act.move, tree.bfLabelID, tree.bfLabelX, tree.bfLabelY);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), AVL.WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), AVL.WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.cmd(act.delete, curr.heightLabelID);\n\t\t\tthis.cmd(act.delete, curr.bfLabelID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n\nclass AVLNode {\n\tconstructor(val, id, hid, bfid, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.heightLabelID = hid;\n\t\tthis.bfLabelID = bfid;\n\t\tthis.height = 0;\n\t\tthis.bf = 0;\n\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n\n\tupdateHeightAndBF() {\n\t\tconst h = node => (node == null ? -1 : node.height);\n\t\tconst l = h(this.left);\n\t\tconst r = h(this.right);\n\t\tthis.height = Math.max(l, r) + 1;\n\t\tthis.bf = l - r;\n\t}\n\n\tisLeftChild() {\n\t\tif (this.parent == null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.parent.left === this;\n\t}\n}\n\n// Various constants\n\nAVL.HIGHLIGHT_LABEL_COLOR = '#FF0000';\nAVL.HIGHLIGHT_LINK_COLOR = '#FF0000';\n\nAVL.HIGHLIGHT_COLOR = '#007700';\nAVL.HEIGHT_LABEL_COLOR = '#065e9d';\n\nAVL.LINK_COLOR = '#00B000';\nAVL.LINK_OPACITY = 0.25;\nAVL.HIGHLIGHT_CIRCLE_COLOR = '#007700';\nAVL.FOREGROUND_COLOR = '#007700';\nAVL.BACKGROUND_COLOR = '#DDFFDD';\nAVL.PRINT_COLOR = AVL.FOREGROUND_COLOR;\n\nAVL.WIDTH_DELTA = 50;\nAVL.HEIGHT_DELTA = 50;\nAVL.STARTING_Y = 50;\n\nAVL.FIRST_PRINT_POS_X = 50;\nAVL.PRINT_VERTICAL_GAP = 20;\nAVL.PRINT_HORIZONTAL_GAP = 50;\nAVL.EXPLANITORY_TEXT_X = 10;\nAVL.EXPLANITORY_TEXT_Y = 10;\n","// General\n\nconst LARGE_ALLOWED = [\n\t[\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t],\n\t[\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t],\n];\n\nconst LARGE_CURVE = [\n\t[0, 0, -0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.25, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[-0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.4],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.4, 0, 0],\n];\n\nconst LARGE_X_POS_LOGICAL = [\n\t600, 700, 800, 900, 650, 750, 850, 600, 700, 800, 900, 650, 750, 850, 600, 700, 800, 900,\n];\n\nconst LARGE_Y_POS_LOGICAL = [\n\t50, 50, 50, 50, 150, 150, 150, 250, 250, 250, 250, 350, 350, 350, 450, 450, 450, 450,\n];\n\nconst SMALL_ALLLOWED = [\n\t[false, true, true, true, true, false, false, false],\n\t[true, false, true, true, false, true, true, false],\n\t[true, true, false, false, true, true, true, false],\n\t[true, true, false, false, false, true, false, true],\n\t[true, false, true, false, false, false, true, true],\n\t[false, true, true, true, false, false, true, true],\n\t[false, true, true, false, true, true, false, true],\n\t[false, false, false, true, true, true, true, false],\n];\n\nconst SMALL_CURVE = [\n\t[0, 0.001, 0, 0.5, -0.5, 0, 0, 0],\n\t[0, 0, 0, 0.001, 0, 0.001, -0.2, 0],\n\t[0, 0.001, 0, 0, 0, 0.2, 0, 0],\n\t[-0.5, 0, 0, 0, 0, 0.001, 0, 0.5],\n\t[0.5, 0, 0, 0, 0, 0, 0, -0.5],\n\t[0, 0, -0.2, 0, 0, 0, 0.001, 0.001],\n\t[0, 0.2, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, -0.5, 0.5, 0, 0, 0],\n];\n\nconst SMALL_X_POS_LOGICAL = [800, 725, 875, 650, 950, 725, 875, 800];\nconst SMALL_Y_POS_LOGICAL = [25, 125, 125, 225, 225, 325, 325, 425];\n\n// BFS / DFS\n\nconst BFS_DFS_ADJ_LIST =\n\t//A     B      C     D      E     F      G      H\n\t/*A*/ [\n\t\t[0, 1, 1, 1, 1, 0, 0, 0],\n\t\t/*B*/ [1, 0, 0, 0, 0, 0, 1, 0],\n\t\t/*C*/ [1, 0, 0, 0, 0, 0, 0, 0],\n\t\t/*D*/ [1, 0, 0, 0, 0, 1, 0, 0],\n\t\t/*E*/ [1, 0, 0, 0, 0, 0, 1, 0],\n\t\t/*F*/ [0, 0, 0, 1, 0, 0, 1, 0],\n\t\t/*G*/ [0, 1, 0, 0, 1, 1, 0, 1],\n\t\t/*H*/ [0, 0, 0, 0, 0, 0, 1, 0],\n\t].map(row => row.map(x => x || -1)); // Turn 0s to -1s\n\n// Dijkstra's\n\nconst DIJKSTRAS_ADJ_LIST =\n\t//A     B      C     D      E     F      G      H\n\t/*A*/ [\n\t\t[0, 8, 2, 5, 0, 0, 0, 0],\n\t\t/*B*/ [8, 0, 1, 1, 0, 0, 7, 0],\n\t\t/*C*/ [2, 1, 0, 0, 3, 0, 0, 0],\n\t\t/*D*/ [5, 1, 0, 0, 0, 4, 0, 0],\n\t\t/*E*/ [0, 0, 3, 0, 0, 0, 2, 0],\n\t\t/*F*/ [0, 0, 0, 4, 0, 0, '0', 1], // Hacky way to get actual 0 in final matrix\n\t\t/*G*/ [0, 7, 0, 0, 2, '0', 0, 1],\n\t\t/*H*/ [0, 0, 0, 0, 0, 1, 1, 0],\n\t].map(row => row.map(x => Number(x || -1))); // '0' is truthy, so we can cast it after the ||\n\n// Prim's / Kruskal's\n\nconst PRIMS_KRUSKALS_ADJ_LIST =\n\t//A     B      C     D      E     F      G      H\n\t/*A*/ [\n\t\t[0, 1, 5, 0, 0, 0, 0, 0],\n\t\t/*B*/ [1, 0, 7, 9, 0, 0, 1, 0],\n\t\t/*C*/ [5, 7, 0, 0, 0, 0, 13, 0],\n\t\t/*D*/ [0, 9, 0, 0, 0, 4, 0, 0],\n\t\t/*E*/ [0, 0, 0, 0, 0, 0, 10, 0],\n\t\t/*F*/ [0, 0, 0, 4, 0, 0, 2, '0'],\n\t\t/*G*/ [0, 1, 13, 0, 10, 2, 0, 3],\n\t\t/*H*/ [0, 0, 0, 0, 0, '0', 3, 0],\n\t].map(row => row.map(x => Number(x || -1)));\n\n// Color coding for Disjoint Set in Kruskal's\n\nconst KRUSKALS_DS_COLORS = [\n\t'#9b9bd4',\n\t'#6aaf6a',\n\t'#f07575',\n\t'#ffe866',\n\t'#b8f9b8',\n\t'#ff99ff',\n\t'#99ffff',\n\t'#ffccd4',\n];\n\nexport {\n\tLARGE_ALLOWED,\n\tLARGE_CURVE,\n\tLARGE_X_POS_LOGICAL,\n\tLARGE_Y_POS_LOGICAL,\n\tSMALL_X_POS_LOGICAL,\n\tSMALL_Y_POS_LOGICAL,\n\tSMALL_ALLLOWED,\n\tSMALL_CURVE,\n\tBFS_DFS_ADJ_LIST,\n\tDIJKSTRAS_ADJ_LIST,\n\tPRIMS_KRUSKALS_ADJ_LIST,\n\tKRUSKALS_DS_COLORS,\n};\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// TODO:  UNDO (all the way) is BROKEN.  Redo reset ...\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport {\n\tLARGE_ALLOWED,\n\tLARGE_CURVE,\n\tLARGE_X_POS_LOGICAL,\n\tLARGE_Y_POS_LOGICAL,\n\tSMALL_ALLLOWED,\n\tSMALL_CURVE,\n\tSMALL_X_POS_LOGICAL,\n\tSMALL_Y_POS_LOGICAL,\n} from './util/GraphValues.js';\nimport { act } from '../anim/AnimationMain';\n\nconst SMALL_ADJ_MATRIX_X_START = 700;\nconst SMALL_ADJ_MATRIX_Y_START = 45;\nconst SMALL_ADJ_MATRIX_WIDTH = 30;\nconst SMALL_ADJ_MATRIX_HEIGHT = 30;\n\nconst SMALL_ADJ_LIST_X_START = 600;\nconst SMALL_ADJ_LIST_Y_START = 30;\n\nconst SMALL_ADJ_LIST_ELEM_WIDTH = 80;\nconst SMALL_ADJ_LIST_ELEM_HEIGHT = 30;\n\nconst SMALL_ADJ_LIST_HEIGHT = 36;\nconst SMALL_ADJ_LIST_WIDTH = 36;\n\nconst SMALL_ADJ_LIST_SPACING_AFTER_LIST = 15;\nconst SMALL_ADJ_LIST_SPACING_BETWEEN_NODES = 15;\n\nconst LARGE_ADJ_MATRIX_X_START = 575;\nconst LARGE_ADJ_MATRIX_Y_START = 40;\nconst LARGE_ADJ_MATRIX_WIDTH = 23;\nconst LARGE_ADJ_MATRIX_HEIGHT = 23;\n\nconst LARGE_ADJ_LIST_X_START = 550;\nconst LARGE_ADJ_LIST_Y_START = 30;\n\nconst LARGE_ADJ_LIST_ELEM_WIDTH = 80;\nconst LARGE_ADJ_LIST_ELEM_HEIGHT = 20;\n\nconst LARGE_ADJ_LIST_HEIGHT = 25;\nconst LARGE_ADJ_LIST_WIDTH = 20;\n\nconst LARGE_ADJ_LIST_SPACING_AFTER_LIST = 25;\nconst LARGE_ADJ_LIST_SPACING_BETWEEN_NODES = 15;\n\nexport const VERTEX_INDEX_COLOR = '#0000FF';\nexport const EDGE_COLOR = '#000000';\n\nconst HIGHLIGHT_CIRCLE_COLOR = '#000000';\n\nexport const SMALL_SIZE = 8;\nexport const LARGE_SIZE = 18;\n\nexport default class Graph extends Algorithm {\n\tconstructor(am, w, h, defaultEdges, dir, dag, costs) {\n\t\tsuper(am, w, h);\n\t\tthis.controls = [];\n\t\tdefaultEdges = defaultEdges === [] ? undefined : defaultEdges;\n\t\tdir = dir === undefined ? false : dir;\n\t\tdag = dag === undefined ? false : dag;\n\t\tcosts = costs === undefined ? false : costs;\n\n\t\tthis.nextIndex = 0;\n\n\t\tthis.currentLayer = 1;\n\t\tthis.defaultEdges = defaultEdges;\n\t\tthis.directed = dir;\n\t\tthis.isDAG = dag;\n\t\tthis.showEdgeCosts = costs;\n\t\tthis.currentLayer = 1;\n\n\t\tthis.setup_small(this.defaultEdges);\n\t}\n\n\taddControls(addDirection) {\n\t\tif (addDirection == null) {\n\t\t\taddDirection = true;\n\t\t}\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\t\tthis.newGraphButton = addControlToAlgorithmBar('Button', 'New Graph', verticalGroup);\n\t\tthis.newGraphButton.onclick = this.newGraphCallback.bind(this);\n\t\tthis.controls.push(this.newGraphButton);\n\t\tthis.defaultGraphButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Default Graph',\n\t\t\tverticalGroup,\n\t\t);\n\t\tthis.defaultGraphButton.onclick = this.defaultGraphCallback.bind(this);\n\t\tthis.defaultGraphButton.disabled = true;\n\t\tthis.controls.push(this.defaultGraphButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tif (addDirection) {\n\t\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t\t['Undirected Graph', 'Directed Graph'],\n\t\t\t\t'GraphType',\n\t\t\t);\n\n\t\t\tthis.undirectedGraphButton = radioButtonList[0];\n\t\t\tthis.undirectedGraphButton.onclick = this.directedGraphCallback.bind(this, false);\n\t\t\tthis.undirectedGraphButton.checked = !this.directed;\n\t\t\tthis.controls.push(this.undirectedGraphButton);\n\n\t\t\tthis.directedGraphButton = radioButtonList[1];\n\t\t\tthis.directedGraphButton.onclick = this.directedGraphCallback.bind(this, true);\n\t\t\tthis.directedGraphButton.checked = this.directed;\n\t\t\tthis.controls.push(this.directedGraphButton);\n\n\t\t\taddDivisorToAlgorithmBar();\n\t\t}\n\n\t\tlet radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Small Graph', 'Large Graph'],\n\t\t\t'GraphSize',\n\t\t);\n\n\t\tthis.smallGraphButton = radioButtonList[0];\n\t\tthis.smallGraphButton.onclick = this.smallGraphCallback.bind(this);\n\t\tthis.smallGraphButton.checked = true;\n\t\tthis.controls.push(this.smallGraphButton);\n\n\t\tthis.largeGraphButton = radioButtonList[1];\n\t\tthis.largeGraphButton.onclick = this.largeGraphCallback.bind(this);\n\t\tthis.controls.push(this.largeGraphButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// We are explicitly not adding the buttons below to this.controls\n\t\t// since we don't want them to be disabled\n\t\tradioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t[\n\t\t\t\t'Logical Representation',\n\t\t\t\t'Adjacency List Representation',\n\t\t\t\t'Adjacency Matrix Representation',\n\t\t\t],\n\t\t\t'GraphRepresentation',\n\t\t);\n\n\t\tthis.logicalButton = radioButtonList[0];\n\t\tthis.logicalButton.onclick = this.graphRepChangedCallback.bind(this, 1);\n\n\t\tthis.adjacencyListButton = radioButtonList[1];\n\t\tthis.adjacencyListButton.onclick = this.graphRepChangedCallback.bind(this, 2);\n\n\t\tthis.adjacencyMatrixButton = radioButtonList[2];\n\t\tthis.adjacencyMatrixButton.onclick = this.graphRepChangedCallback.bind(this, 3);\n\t\tthis.logicalButton.checked = true;\n\t}\n\n\tdirectedGraphCallback(newDirected) {\n\t\tif (newDirected !== this.directed) {\n\t\t\tthis.defaultGraphButton.disabled = newDirected;\n\t\t\tthis.directed = newDirected;\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup();\n\t\t}\n\t}\n\n\tsmallGraphCallback() {\n\t\tif (this.size !== SMALL_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup_small();\n\t\t}\n\t}\n\n\tlargeGraphCallback() {\n\t\tif (this.size !== LARGE_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup_large();\n\t\t}\n\t}\n\n\tnewGraphCallback() {\n\t\tthis.animationManager.resetAll();\n\t\tthis.setup();\n\t}\n\n\tdefaultGraphCallback() {\n\t\tthis.animationManager.resetAll();\n\t\tthis.setup(this.defaultEdges);\n\t}\n\n\tgraphRepChangedCallback(newLayer) {\n\t\tthis.animationManager.setAllLayers([0, newLayer]);\n\t\tthis.currentLayer = newLayer;\n\t}\n\n\trecolorGraph() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tthis.setEdgeColor(i, j, EDGE_COLOR);\n\t\t\t\t\tthis.setEdgeThickness(i, j, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thighlightEdge(i, j, highlightVal, color) {\n\t\tthis.cmd(act.setHighlight, this.adj_list_edges[i][j], highlightVal, color);\n\t\tthis.cmd(act.setHighlight, this.adj_matrixID[i][j], highlightVal, color);\n\t\tthis.cmd(act.setEdgeHighlight, this.circleID[i], this.circleID[j], highlightVal, color);\n\t\tif (!this.directed) {\n\t\t\tthis.cmd(act.setEdgeHighlight, this.circleID[j], this.circleID[i], highlightVal, color);\n\t\t}\n\t}\n\n\tvisitVertex(i) {\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightCircleL,\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\tthis.x_pos_logical[i],\n\t\t\tthis.y_pos_logical[i],\n\t\t);\n\t\tthis.cmd(act.setLayer, this.highlightCircleL, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightCircleAL,\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\n\t\t);\n\t\tthis.cmd(act.setLayer, this.highlightCircleAL, 2);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightCircleAM,\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height,\n\t\t);\n\t\tthis.cmd(act.setLayer, this.highlightCircleAM, 3);\n\t}\n\n\tleaveVertex() {\n\t\tthis.cmd(act.delete, this.highlightCircleL);\n\t\tthis.cmd(act.delete, this.highlightCircleAM);\n\t\tthis.cmd(act.delete, this.highlightCircleAL);\n\t}\n\n\tsetEdgeColor(i, j, color) {\n\t\tthis.cmd(act.setForegroundColor, this.adj_list_edges[i][j], color);\n\t\tthis.cmd(act.setTextColor, this.adj_matrixID[i][j], color);\n\t\tthis.cmd(act.setEdgeColor, this.circleID[i], this.circleID[j], color);\n\t\tif (!this.directed) {\n\t\t\tthis.cmd(act.setEdgeColor, this.circleID[j], this.circleID[i], color);\n\t\t}\n\t}\n\n\tsetEdgeThickness(i, j, thickness) {\n\t\tthis.cmd(act.setEdgeThickness, this.circleID[i], this.circleID[j], thickness);\n\t\tif (!this.directed) {\n\t\t\tthis.cmd(act.setEdgeThickness, this.circleID[j], this.circleID[i], thickness);\n\t\t}\n\t}\n\n\tclearEdges() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tthis.cmd(act.disconnect, this.circleID[i], this.circleID[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trebuildEdges() {\n\t\tthis.clearEdges();\n\t\tthis.buildEdges();\n\t}\n\n\tbuildEdges() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tconst edgeLabel = this.showEdgeCosts ? String(this.adj_matrix[i][j]) : '';\n\t\t\t\t\tif (this.directed) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[i],\n\t\t\t\t\t\t\tthis.circleID[j],\n\t\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t\tthis.adjustCurveForDirectedEdges(\n\t\t\t\t\t\t\t\tthis.curve[i][j],\n\t\t\t\t\t\t\t\tthis.adj_matrix[j][i] >= 0,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tedgeLabel,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (i < j) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[i],\n\t\t\t\t\t\t\tthis.circleID[j],\n\t\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t\tthis.curve[i][j],\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tedgeLabel,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetup_small(adj_matrix) {\n\t\tthis.allowed = SMALL_ALLLOWED;\n\t\tthis.curve = SMALL_CURVE;\n\t\tthis.x_pos_logical = SMALL_X_POS_LOGICAL;\n\t\tthis.y_pos_logical = SMALL_Y_POS_LOGICAL;\n\t\tthis.adj_matrix_x_start = SMALL_ADJ_MATRIX_X_START;\n\t\tthis.adj_matrix_y_start = SMALL_ADJ_MATRIX_Y_START;\n\t\tthis.adj_matrix_width = SMALL_ADJ_MATRIX_WIDTH;\n\t\tthis.adj_matrix_height = SMALL_ADJ_MATRIX_HEIGHT;\n\t\tthis.adj_list_x_start = SMALL_ADJ_LIST_X_START;\n\t\tthis.adj_list_y_start = SMALL_ADJ_LIST_Y_START;\n\t\tthis.adj_list_elem_width = SMALL_ADJ_LIST_ELEM_WIDTH;\n\t\tthis.adj_list_elem_height = SMALL_ADJ_LIST_ELEM_HEIGHT;\n\t\tthis.adj_list_height = SMALL_ADJ_LIST_HEIGHT;\n\t\tthis.adj_list_width = SMALL_ADJ_LIST_WIDTH;\n\t\tthis.adj_list_spacing_after_list = SMALL_ADJ_LIST_SPACING_AFTER_LIST;\n\t\tthis.adj_list_spacing_between_nodes = SMALL_ADJ_LIST_SPACING_BETWEEN_NODES;\n\t\tthis.size = SMALL_SIZE;\n\t\tthis.isLarge = false;\n\t\tthis.highlightCircleL = this.nextIndex++;\n\t\tthis.highlightCircleAL = this.nextIndex++;\n\t\tthis.highlightCircleAM = this.nextIndex++;\n\t\tthis.setup(adj_matrix);\n\t}\n\n\tsetup_large() {\n\t\tthis.allowed = LARGE_ALLOWED;\n\t\tthis.curve = LARGE_CURVE;\n\t\tthis.x_pos_logical = LARGE_X_POS_LOGICAL;\n\t\tthis.y_pos_logical = LARGE_Y_POS_LOGICAL;\n\t\tthis.adj_matrix_x_start = LARGE_ADJ_MATRIX_X_START;\n\t\tthis.adj_matrix_y_start = LARGE_ADJ_MATRIX_Y_START;\n\t\tthis.adj_matrix_width = LARGE_ADJ_MATRIX_WIDTH;\n\t\tthis.adj_matrix_height = LARGE_ADJ_MATRIX_HEIGHT;\n\t\tthis.adj_list_x_start = LARGE_ADJ_LIST_X_START;\n\t\tthis.adj_list_y_start = LARGE_ADJ_LIST_Y_START;\n\t\tthis.adj_list_elem_width = LARGE_ADJ_LIST_ELEM_WIDTH;\n\t\tthis.adj_list_elem_height = LARGE_ADJ_LIST_ELEM_HEIGHT;\n\t\tthis.adj_list_height = LARGE_ADJ_LIST_HEIGHT;\n\t\tthis.adj_list_width = LARGE_ADJ_LIST_WIDTH;\n\t\tthis.adj_list_spacing_after_list = LARGE_ADJ_LIST_SPACING_AFTER_LIST;\n\t\tthis.adj_list_spacing_between_nodes = LARGE_ADJ_LIST_SPACING_BETWEEN_NODES;\n\t\tthis.size = LARGE_SIZE;\n\t\tthis.isLarge = true;\n\t\tthis.highlightCircleL = this.nextIndex++;\n\t\tthis.highlightCircleAL = this.nextIndex++;\n\t\tthis.highlightCircleAM = this.nextIndex++;\n\t\tthis.setup();\n\t}\n\n\tadjustCurveForDirectedEdges(curve, bidirectional) {\n\t\tif (!this.directed || !bidirectional || Math.abs(curve) > 0.01) {\n\t\t\treturn curve;\n\t\t} else {\n\t\t\treturn 0.1;\n\t\t}\n\t}\n\n\tsetup(adj_matrix) {\n\t\tthis.commands = [];\n\t\tthis.circleID = new Array(this.size);\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.circleID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircle,\n\t\t\t\tthis.circleID[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tthis.x_pos_logical[i],\n\t\t\t\tthis.y_pos_logical[i],\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.circleID[i], VERTEX_INDEX_COLOR, 0);\n\n\t\t\tthis.cmd(act.setLayer, this.circleID[i], 1);\n\t\t}\n\n\t\tif (adj_matrix) {\n\t\t\tthis.adj_matrix = adj_matrix;\n\t\t\tthis.adj_matrixID = new Array(this.size);\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tthis.adj_matrixID[i] = new Array(this.size);\n\t\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.buildEdges();\n\t\t} else {\n\t\t\tthis.adj_matrix = new Array(this.size);\n\t\t\tthis.adj_matrixID = new Array(this.size);\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tthis.adj_matrix[i] = new Array(this.size);\n\t\t\t\tthis.adj_matrixID[i] = new Array(this.size);\n\t\t\t}\n\n\t\t\tlet edgePercent;\n\t\t\tif (this.size === SMALL_SIZE) {\n\t\t\t\tif (this.directed) {\n\t\t\t\t\tedgePercent = 0.4;\n\t\t\t\t} else {\n\t\t\t\t\tedgePercent = 0.5;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.directed) {\n\t\t\t\t\tedgePercent = 0.35;\n\t\t\t\t} else {\n\t\t\t\t\tedgePercent = 0.6;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.directed) {\n\t\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tthis.allowed[i][j] &&\n\t\t\t\t\t\t\tMath.random() <= edgePercent &&\n\t\t\t\t\t\t\t(i < j ||\n\t\t\t\t\t\t\t\tMath.abs(this.curve[i][j]) < 0.01 ||\n\t\t\t\t\t\t\t\tthis.adj_matrixID[j][i] === -1) &&\n\t\t\t\t\t\t\t(!this.isDAG || i < j)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (this.showEdgeCosts) {\n\t\t\t\t\t\t\t\tthis.adj_matrix[i][j] = Math.floor(Math.random() * 9) + 1;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.adj_matrix[i][j] = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.buildEdges();\n\t\t\t} else {\n\t\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\t\tfor (let j = i + 1; j < this.size; j++) {\n\t\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\t\t\tthis.adj_matrixID[j][i] = this.nextIndex++;\n\n\t\t\t\t\t\tif (this.allowed[i][j] && Math.random() <= edgePercent) {\n\t\t\t\t\t\t\tif (this.showEdgeCosts) {\n\t\t\t\t\t\t\t\tthis.adj_matrix[i][j] = Math.floor(Math.random() * 9) + 1;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.adj_matrix[i][j] = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.adj_matrix[j][i] = this.adj_matrix[i][j];\n\t\t\t\t\t\t\tlet edgeLabel;\n\t\t\t\t\t\t\tif (this.showEdgeCosts) {\n\t\t\t\t\t\t\t\tedgeLabel = String(this.adj_matrix[i][j]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tedgeLabel = '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\t\tthis.circleID[i],\n\t\t\t\t\t\t\t\tthis.circleID[j],\n\t\t\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t\t\tthis.curve[i][j],\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\tedgeLabel,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = -1;\n\t\t\t\t\t\t\tthis.adj_matrix[j][i] = -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.buildEdges();\n\n\t\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\t\tthis.adj_matrix[i][i] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Create Adj List\n\n\t\tthis.buildAdjList();\n\n\t\t// Create Adj Matrix\n\n\t\tthis.buildAdjMatrix();\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.clearHistory();\n\t}\n\n\tresetAll() {}\n\n\tbuildAdjMatrix() {\n\t\tthis.adj_matrix_index_x = new Array(this.size);\n\t\tthis.adj_matrix_index_y = new Array(this.size);\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.adj_matrix_index_x[i] = this.nextIndex++;\n\t\t\tthis.adj_matrix_index_y[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.adj_matrix_index_x[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tthis.adj_matrix_x_start + i * this.adj_matrix_width,\n\t\t\t\tthis.adj_matrix_y_start - this.adj_matrix_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.adj_matrix_index_x[i], VERTEX_INDEX_COLOR);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.adj_matrix_index_y[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.adj_matrix_index_y[i], VERTEX_INDEX_COLOR);\n\t\t\tthis.cmd(act.setLayer, this.adj_matrix_index_x[i], 3);\n\t\t\tthis.cmd(act.setLayer, this.adj_matrix_index_y[i], 3);\n\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\tlet lab;\n\t\t\t\tif (this.adj_matrix[i][j] < 0) {\n\t\t\t\t\tlab = '';\n\t\t\t\t} else {\n\t\t\t\t\tlab = String(this.adj_matrix[i][j]);\n\t\t\t\t}\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.adj_matrixID[i][j],\n\t\t\t\t\tlab,\n\t\t\t\t\tthis.adj_matrix_width,\n\t\t\t\t\tthis.adj_matrix_height,\n\t\t\t\t\tthis.adj_matrix_x_start + j * this.adj_matrix_width,\n\t\t\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setLayer, this.adj_matrixID[i][j], 3);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveAdjList() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.adj_list_list[i], 'RAL1');\n\t\t\tthis.cmd(act.delete, this.adj_list_index[i], 'RAL2');\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] > 0) {\n\t\t\t\t\tthis.cmd(act.delete, this.adj_list_edges[i][j], 'RAL3');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildAdjList() {\n\t\tthis.adj_list_index = new Array(this.size);\n\t\tthis.adj_list_list = new Array(this.size);\n\t\tthis.adj_list_edges = new Array(this.size);\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.adj_list_index[i] = this.nextIndex++;\n\t\t\tthis.adj_list_edges[i] = new Array(this.size);\n\t\t\tthis.adj_list_index[i] = this.nextIndex++;\n\t\t\tthis.adj_list_list[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.adj_list_list[i],\n\t\t\t\t'',\n\t\t\t\tthis.adj_list_width,\n\t\t\t\tthis.adj_list_height,\n\t\t\t\tthis.adj_list_x_start,\n\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setLayer, this.adj_list_list[i], 2);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.adj_list_index[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.adj_list_index[i], VERTEX_INDEX_COLOR);\n\t\t\tthis.cmd(act.setLayer, this.adj_list_index[i], 2);\n\t\t\tlet lastElem = this.adj_list_list[i];\n\t\t\tlet nextXPos =\n\t\t\t\tthis.adj_list_x_start +\n\t\t\t\tthis.adj_list_width +\n\t\t\t\tthis.adj_list_spacing_after_list +\n\t\t\t\tthis.adj_list_spacing_between_nodes;\n\t\t\tlet hasEdges = false;\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\thasEdges = true;\n\t\t\t\t\tthis.adj_list_edges[i][j] = this.nextIndex++;\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLinkedListNode,\n\t\t\t\t\t\tthis.adj_list_edges[i][j],\n\t\t\t\t\t\t[this.toStr(j), this.adj_matrix[i][j]],\n\t\t\t\t\t\tthis.adj_list_elem_width,\n\t\t\t\t\t\tthis.adj_list_elem_height,\n\t\t\t\t\t\tnextXPos,\n\t\t\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\n\t\t\t\t\t\t0.25,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t1,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.setNull, this.adj_list_edges[i][j], 1);\n\t\t\t\t\tthis.cmd(act.setTextColor, this.adj_list_edges[i][j], VERTEX_INDEX_COLOR, 0);\n\t\t\t\t\tthis.cmd(act.setLayer, this.adj_list_edges[i][j], 2);\n\n\t\t\t\t\tnextXPos =\n\t\t\t\t\t\tnextXPos + this.adj_list_elem_width + this.adj_list_spacing_between_nodes;\n\t\t\t\t\tthis.cmd(act.connect, lastElem, this.adj_list_edges[i][j]);\n\t\t\t\t\tthis.cmd(act.setNull, lastElem, 0);\n\t\t\t\t\tlastElem = this.adj_list_edges[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!hasEdges) {\n\t\t\t\tthis.cmd(act.setNull, this.adj_list_list[i], 1);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Should be overwritten in child\n\treset() {\n\t\tthrow new Error('reset() should be implemented in child');\n\t}\n\n\ttoStr(vertex) {\n\t\treturn String.fromCharCode(65 + vertex);\n\t}\n\n\tenableUI() {\n\t\tfor (const control of this.controls) {\n\t\t\tif (\n\t\t\t\tcontrol === this.defaultGraphButton &&\n\t\t\t\t(this.directed || this.isLarge || this.adj_matrix === this.defaultEdges)\n\t\t\t) {\n\t\t\t\tcontrol.disabled = true;\n\t\t\t} else {\n\t\t\t\tcontrol.disabled = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (const control of this.controls) {\n\t\t\tcontrol.disabled = true;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst CODE_START_X = 25;\nconst CODE_START_Y = 35;\nconst CODE_LINE_HEIGHT = 14;\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\nconst CODE_STANDARD_COLOR = '#000000';\nconst QUEUE_START_X = 35;\nconst QUEUE_START_Y = 250;\nconst QUEUE_SPACING = 40;\n\nconst PRE_CODE = [\n\t['procedure preOrder(Node node)'],\n\t['     if node is not null:'],\n\t['          look at data in the node'],\n\t['          recurse left'],\n\t['          recurse right'],\n\t['end procedure'],\n];\nconst IN_CODE = [\n\t['procedure inOrder(Node node)'],\n\t['     if node is not null:'],\n\t['          recurse left'],\n\t['          look at data in the node'],\n\t['          recurse right'],\n\t['end procedure'],\n];\nconst POST_CODE = [\n\t['procedure postOrder(Node node)'],\n\t['     if node is not null:'],\n\t['          recurse left'],\n\t['          recurse right'],\n\t['          look at data in the node'],\n\t['end procedure'],\n];\nconst LEVEL_CODE = [\n\t['procedure levelOrder()'],\n\t['     create Queue q'],\n\t['     add root to q'],\n\t['     while q is not empty'],\n\t['          Node curr <- remove from q'],\n\t['          record data from curr'],\n\t['          if curr.left is not null:'],\n\t['               add curr.left to q'],\n\t['          if curr.right is not null:'],\n\t['               add curr.right to q'],\n\t['end procedure'],\n];\n\nexport default class BST extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.first_print_pos_y = h - 2 * BST.PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\t\tthis.startingX = w / 2;\n\t\tthis.addControls();\n\t\tthis.nextIndex = 1;\n\t\tthis.commands = [];\n\t\tthis.edges = [];\n\t\tthis.toClear = [];\n\t\tthis.cmd(act.createLabel, 0, '', BST.EXPLANITORY_TEXT_X, BST.EXPLANITORY_TEXT_Y, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst traversalButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Pre-order', 'In-order', 'Post-order', 'Level order'],\n\t\t\t'Traversals',\n\t\t);\n\n\t\tthis.preOrderSelect = traversalButtonList[0];\n\t\tthis.inOrderSelect = traversalButtonList[1];\n\t\tthis.postOrderSelect = traversalButtonList[2];\n\t\tthis.levelOrderSelect = traversalButtonList[3];\n\t\tthis.preOrderSelect.onclick = () => (this.traversal = 'pre');\n\t\tthis.inOrderSelect.onclick = () => (this.traversal = 'in');\n\t\tthis.postOrderSelect.onclick = () => (this.traversal = 'post');\n\t\tthis.levelOrderSelect.onclick = () => (this.traversal = 'level');\n\t\tthis.preOrderSelect.checked = true;\n\t\tthis.traversal = 'pre';\n\n\t\tthis.traverseButton = addControlToAlgorithmBar('Button', 'Traverse');\n\t\tthis.traverseButton.onclick = this.traverseCallback.bind(this);\n\t\tthis.controls.push(this.traverseButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst predSuccButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Predecessor', 'Successor'],\n\t\t\t'Predecessor/Successor',\n\t\t);\n\n\t\tthis.predButton = predSuccButtonList[0];\n\t\tthis.succButton = predSuccButtonList[1];\n\t\tthis.predButton.onclick = () => (this.predSucc = 'pred');\n\t\tthis.succButton.onclick = () => (this.predSucc = 'succ');\n\t\tthis.succButton.checked = true;\n\t\tthis.predSucc = 'succ';\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t\tthis.edges = [];\n\t\tthis.toClear = [];\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tconst deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t\t}\n\t}\n\n\ttraverseCallback() {\n\t\tthis.implementAction(this.traverse.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tsizeChanged(newWidth) {\n\t\tthis.startingX = newWidth / 2;\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y,\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.cmd(act.delete, i);\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tpreOrderRec(tree, passedCodeID) {\n\t\tthis.codeID = passedCodeID;\n\t\tthis.cmd(act.step);\n\n\t\tconst nextLabelID = this.nextIndex++;\n\n\t\tthis.unhighlight(3, 0);\n\t\tthis.unhighlight(4, 0);\n\t\tthis.highlight(2, 0);\n\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, BST.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += BST.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += BST.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tthis.unhighlight(2, 0);\n\n\t\tif (tree.left != null) {\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.preOrderRec(tree.left, passedCodeID);\n\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(3, 0);\n\n\t\tif (tree.right != null) {\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.preOrderRec(tree.right, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(4, 0);\n\n\t\treturn;\n\t}\n\n\tlevelOrder(tree, passedCodeID) {\n\t\tthis.codeID = passedCodeID;\n\t\tconst queue = [tree];\n\t\tconst queueLabelId = this.nextIndex++;\n\n\t\tconst queueID = [this.nextIndex];\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tqueueLabelId,\n\t\t\t'Queue: ',\n\t\t\tQUEUE_START_X - 5,\n\t\t\tQUEUE_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createLabel, this.nextIndex, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, this.nextIndex, BST.PRINT_COLOR);\n\t\tthis.cmd(act.move, this.nextIndex++, QUEUE_START_X, QUEUE_START_Y, 0);\n\t\tthis.highlight(2, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(2, 0);\n\n\t\tthis.highlight(3, 0);\n\t\tthis.cmd(act.step);\n\n\t\twhile (queue.length !== 0) {\n\t\t\tconst curr = queue.shift();\n\n\t\t\tthis.cmd(act.move, this.highlightID, curr.x, curr.y);\n\t\t\tthis.unhighlight(3, 0);\n\n\t\t\tconst currId = queueID.shift();\n\t\t\tthis.cmd(act.move, currId, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tfor (let i = 0; i < queueID.length; i++) {\n\t\t\t\tthis.cmd(act.move, queueID[i], QUEUE_START_X + i * QUEUE_SPACING, QUEUE_START_Y);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.unhighlight(5, 0);\n\n\t\t\tthis.xPosOfNextLabel += BST.PRINT_HORIZONTAL_GAP;\n\t\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\t\tthis.yPosOfNextLabel += BST.PRINT_VERTICAL_GAP;\n\t\t\t}\n\n\t\t\tthis.highlight(6, 0);\n\t\t\tif (curr.left != null) {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\tqueue.push(curr.left);\n\t\t\t\tqueueID.push(this.nextIndex);\n\t\t\t\tthis.cmd(act.createLabel, this.nextIndex, curr.left.data, curr.left.x, curr.left.y);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.nextIndex, BST.PRINT_COLOR);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\tQUEUE_START_X + (queue.length - 1) * QUEUE_SPACING,\n\t\t\t\t\tQUEUE_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t}\n\n\t\t\tthis.highlight(8, 0);\n\t\t\tif (curr.right != null) {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t\tthis.highlight(9, 0);\n\t\t\t\tqueue.push(curr.right);\n\t\t\t\tqueueID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\tcurr.right.data,\n\t\t\t\t\tcurr.right.x,\n\t\t\t\t\tcurr.right.y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.nextIndex, BST.PRINT_COLOR);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\tQUEUE_START_X + (queue.length - 1) * QUEUE_SPACING,\n\t\t\t\t\tQUEUE_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(9, 0);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t}\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(3, 0);\n\t}\n\n\ttraverse() {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\n\t\tif (this.treeRoot == null) {\n\t\t\treturn this.commands;\n\t\t}\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\tconst firstLabel = this.nextIndex;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightID,\n\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\tthis.treeRoot.x,\n\t\t\tthis.treeRoot.y,\n\t\t);\n\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\n\t\tif (this.traversal === 'pre') {\n\t\t\tthis.codeID = this.addCodeToCanvasBase(\n\t\t\t\tPRE_CODE,\n\t\t\t\tCODE_START_X,\n\t\t\t\tCODE_START_Y,\n\t\t\t\tCODE_LINE_HEIGHT,\n\t\t\t);\n\t\t\tthis.preOrderRec(this.treeRoot, this.codeID);\n\t\t} else if (this.traversal === 'in') {\n\t\t\tthis.codeID = this.addCodeToCanvasBase(\n\t\t\t\tIN_CODE,\n\t\t\t\tCODE_START_X,\n\t\t\t\tCODE_START_Y,\n\t\t\t\tCODE_LINE_HEIGHT,\n\t\t\t);\n\t\t\tthis.printTreeRec(this.treeRoot, this.codeID);\n\t\t} else if (this.traversal === 'post') {\n\t\t\tthis.codeID = this.addCodeToCanvasBase(\n\t\t\t\tPOST_CODE,\n\t\t\t\tCODE_START_X,\n\t\t\t\tCODE_START_Y,\n\t\t\t\tCODE_LINE_HEIGHT,\n\t\t\t);\n\t\t\tthis.postOrderRec(this.treeRoot, this.codeID);\n\t\t} else if (this.traversal === 'level') {\n\t\t\tthis.codeID = this.addCodeToCanvasBase(\n\t\t\t\tLEVEL_CODE,\n\t\t\t\tCODE_START_X,\n\t\t\t\tCODE_START_Y,\n\t\t\t\tCODE_LINE_HEIGHT,\n\t\t\t);\n\t\t\tthis.levelOrder(this.treeRoot, this.codeID);\n\t\t}\n\n\t\tthis.cmd(act.delete, this.highlightID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.toClear.push(i);\n\t\t// this.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\n\t\treturn this.commands;\n\t}\n\n\tpostOrderRec(tree, passedCodeID) {\n\t\tthis.codeID = passedCodeID;\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.postOrderRec(tree.left, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(2, 0);\n\n\t\tif (tree.right != null) {\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.postOrderRec(tree.right, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(3, 0);\n\n\t\tthis.highlight(4, 0);\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, BST.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += BST.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += BST.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tthis.unhighlight(4, 0);\n\n\t\treturn;\n\t}\n\n\tprintTreeRec(tree, passedCodeID) {\n\t\tthis.codeID = passedCodeID;\n\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(2, 0);\n\n\t\tthis.unhighlight(4, 0);\n\t\tthis.highlight(3, 0);\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, BST.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += BST.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += BST.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tthis.unhighlight(3, 0);\n\n\t\tif (tree.right != null) {\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(4, 0);\n\n\t\treturn;\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tthis.doFind(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searching for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Found:' + value);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.left, value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t' Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.right, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t'Searching for ' + value + ' : < Empty Tree > (Element not found)',\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, 'Searching for ' + value + ' :  (Element not found)');\n\t\t}\n\t}\n\n\tremakeTree(curr) {\n\t\tif (curr == null) return;\n\t\tif (curr.left != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.left.graphicID, BST.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.left);\n\t\t}\n\t\tif (curr.right != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.right.graphicID, BST.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.right);\n\t\t}\n\t}\n\n\tclearOldObjects() {\n\t\tthis.toClear.forEach(i => this.cmd(act.delete, i));\n\t\tthis.toClear = [];\n\t}\n\n\tadd(data) {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\t\tthis.cmd(act.setText, 0, 'Inserting ' + data);\n\t\tthis.treeRoot = this.addH(data, this.treeRoot);\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\taddH(data, curr) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, 'Null found, inserting new node');\n\t\t\tconst treeNodeID = this.nextIndex++;\n\t\t\tthis.cmd(act.createCircle, treeNodeID, data, 30, BST.STARTING_Y);\n\n\t\t\tthis.cmd(act.setForegroundColor, treeNodeID, BST.FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, treeNodeID, BST.BACKGROUND_COLOR);\n\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn new BSTNode(data, treeNodeID, 0, 0);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking at left subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.addH(data, curr.left);\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking at right subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.addH(data, curr.right);\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, `${data} == ${curr.data}. Ignoring duplicate!`);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tconnectSmart(id1, id2) {\n\t\tif (!this.edges.some(e => e[0] === id1 && e[1] === id2)) {\n\t\t\tthis.cmd(act.connect, id1, id2, BST.LINK_COLOR);\n\t\t\tthis.edges.push([id1, id2]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tdeleteNode(curr) {\n\t\tthis.cmd(act.delete, curr.graphicID);\n\t}\n\n\tremove(data) {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\n\t\tthis.cmd(act.setText, 0, `Deleting ${data}`);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, ' ');\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeRoot = this.removeH(this.treeRoot, data);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\tremoveH(curr, data) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, `${data} not found in the tree`);\n\t\t\treturn;\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking left`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.removeH(curr.left, data);\n\t\t\tif (curr.left != null) {\n\t\t\t\tcurr.left.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking right`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.removeH(curr.right, data);\n\t\t\tif (curr.right != null) {\n\t\t\t\tcurr.right.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else {\n\t\t\tif (curr.left == null && curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Element to delete is a leaf node');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn null;\n\t\t\t} else if (curr.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with right child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.right;\n\t\t\t} else if (curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with left child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.left;\n\t\t\t} else {\n\t\t\t\tconst dummy = [];\n\t\t\t\tif (this.predSucc === 'succ') {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with successor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.right = this.removeSucc(curr.right, dummy);\n\t\t\t\t\tcurr.right && this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with predecessor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.left = this.removePred(curr.left, dummy);\n\t\t\t\t\tcurr.left && this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\t}\n\t\t\t\tthis.resizeTree();\n\t\t\t\tcurr.data = dummy[0];\n\t\t\t\tthis.cmd(act.setText, curr.graphicID, curr.data);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tremoveSucc(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.left == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No left child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.right;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Left child exists, look left');\n\t\tcurr.left = this.removeSucc(curr.left, dummy);\n\t\tif (curr.left != null) {\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0, '#0000ff');\n\t\treturn curr;\n\t}\n\n\tremovePred(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.right == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No right child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.left;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Right child exists, look right');\n\t\tthis.cmd(act.step);\n\t\tcurr.right = this.removePred(curr.right, dummy);\n\t\tif (curr.right != null) {\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0, '#0000ff');\n\t\treturn curr;\n\t}\n\n\tresizeTree() {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, BST.STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + BST.HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + BST.HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), BST.WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), BST.WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\t// Refactored to superclass\n\n\t// setUpPseudocode(tailoredCode) {\n\t// \tthis.code = tailoredCode;\n\n\t// \tthis.codeID = Array(this.code.length);\n\t// \tlet i, j;\n\t// \tfor (i = 0; i < this.code.length; i++) {\n\t// \t\tthis.codeID[i] = new Array(this.code[i].length);\n\t// \t\tfor (j = 0; j < this.code[i].length; j++) {\n\t// \t\t\tthis.codeID[i][j] = this.nextIndex++;\n\t// \t\t\tthis.cmd(\n\t// \t\t\t\tact.createLabel,\n\t// \t\t\t\tthis.codeID[i][j],\n\t// \t\t\t\tthis.code[i][j],\n\t// \t\t\t\tCODE_START_X,\n\t// \t\t\t\tCODE_START_Y + i * CODE_LINE_HEIGHT,\n\t// \t\t\t\t0,\n\t// \t\t\t);\n\t// \t\t\tthis.cmd(act.setForegroundColor, this.codeID[i][j], CODE_STANDARD_COLOR);\n\t// \t\t\tif (j > 0) {\n\t// \t\t\t\tthis.cmd(act.alignRight, this.codeID[i][j], this.codeID[i][j - 1]);\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\n\t// \treturn this.codeID;\n\t// }\n\n\thighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\n\t}\n\n\tunhighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\n\t}\n}\n\nclass BSTNode {\n\tconstructor(val, id, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n}\n\n// Various constants\n\nBST.HIGHLIGHT_LABEL_COLOR = '#FF0000';\nBST.HIGHLIGHT_LINK_COLOR = '#FF0000';\n\nBST.HIGHLIGHT_COLOR = '#007700';\nBST.HEIGHT_LABEL_COLOR = '#007700';\n\nBST.LINK_COLOR = '#00B000';\nBST.HIGHLIGHT_CIRCLE_COLOR = '#007700';\nBST.FOREGROUND_COLOR = '#007700';\nBST.BACKGROUND_COLOR = '#DDFFDD';\nBST.PRINT_COLOR = BST.FOREGROUND_COLOR;\n\nBST.WIDTH_DELTA = 50;\nBST.HEIGHT_DELTA = 50;\nBST.STARTING_Y = 50;\n\nBST.FIRST_PRINT_POS_X = 50;\nBST.PRINT_VERTICAL_GAP = 20;\nBST.PRINT_HORIZONTAL_GAP = 50;\nBST.EXPLANITORY_TEXT_X = 10;\nBST.EXPLANITORY_TEXT_Y = 10;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst FIRST_PRINT_POS_X = 50;\nconst PRINT_VERTICAL_GAP = 20;\nconst PRINT_MAX = 990;\nconst PRINT_HORIZONTAL_GAP = 50;\n\nconst MIN_MAX_DEGREE = 4;\n\nconst HEIGHT_DELTA = 50;\nconst NODE_SPACING = 3;\nconst STARTING_Y = 30;\nconst WIDTH_PER_ELEM = 40;\nconst NODE_HEIGHT = 20;\n\nconst MESSAGE_X = 5;\nconst MESSAGE_Y = 10;\n\nconst FOREGROUND_COLOR = '#007700';\nconst BACKGROUND_COLOR = '#EEFFEE';\nconst PRINT_COLOR = FOREGROUND_COLOR;\n\nexport default class BTree extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.nextIndex = 0;\n\n\t\tthis.starting_x = w / 2;\n\n\t\tthis.preemptiveSplit = false;\n\n\t\tthis.addControls();\n\n\t\tthis.max_keys = 3;\n\t\tthis.min_keys = 1;\n\t\tthis.split_index = 1;\n\n\t\tthis.max_degree = 4;\n\n\t\tthis.messageID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.messageID, '', MESSAGE_X, MESSAGE_Y, 0);\n\t\tthis.moveLabel1ID = this.nextIndex++;\n\t\tthis.moveLabel2ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.commands = [];\n\n\t\tthis.first_print_pos_y = h - 3 * PRINT_VERTICAL_GAP;\n\n\t\tthis.xPosOfNextLabel = 100;\n\t\tthis.yPosOfNextLabel = 200;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\t\taddLabelToAlgorithmBar('Promote with');\n\t\tconst splitIndexButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['second data', 'third data'],\n\t\t\t'Split Index',\n\t\t);\n\n\t\tthis.splitSecondSelect = splitIndexButtonList[0];\n\t\tthis.splitThirdSelect = splitIndexButtonList[1];\n\t\tthis.splitSecondSelect.onclick = () => (this.split_index = 1);\n\t\tthis.splitThirdSelect.onclick = () => (this.split_index = 2);\n\t\tthis.splitSecondSelect.checked = true;\n\t\tthis.split_index = 1;\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst predSuccButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Predecessor', 'Successor'],\n\t\t\t'Predecessor/Successor',\n\t\t);\n\n\t\tthis.predButton = predSuccButtonList[0];\n\t\tthis.succButton = predSuccButtonList[1];\n\n\t\tthis.predButton.onclick = this.predCallback.bind(this);\n\t\tthis.succButton.onclick = this.succCallback.bind(this);\n\t\tthis.succButton.checked = true;\n\t\tthis.predSucc = 'succ';\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 3;\n\t\tthis.max_degree = 4;\n\t\tthis.max_keys = 3;\n\t\tthis.min_keys = 1;\n\t\tthis.split_index = 1;\n\t\t// NOTE: The order of these last two this.commands matters!\n\t\tthis.treeRoot = null;\n\t\tthis.ignoreInputs = true;\n\t\tthis.ignoreInputs = false;\n\t}\n\n\tenableUI() {\n\t\tlet i;\n\t\tfor (i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tmaxDegreeChangedHandler(newMaxDegree) {\n\t\tif (this.max_degree !== newMaxDegree) {\n\t\t\tthis.implementAction(this.changeDegree.bind(this), newMaxDegree);\n\t\t\tthis.animationManager.skipForward();\n\t\t\tthis.animationManager.clearHistory();\n\t\t}\n\t}\n\n\tpredCallback() {\n\t\tif (this.predSucc !== 'pred') {\n\t\t\tthis.predSucc = 'pred';\n\t\t\t//this.commands = this.clearCallback();  maybe this isn't necessary?\n\t\t}\n\t}\n\n\tsuccCallback() {\n\t\tif (this.predSucc !== 'succ') {\n\t\t\tthis.predSucc = 'succ';\n\t\t\t//this.commands = this.clearCallback();\n\t\t}\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.normalizeNumber(this.insertField.value, 4);\n\t\tif (insertedValue !== '') {\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(this.deleteField.value, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.deleteElement.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearTree.bind(this));\n\t}\n\n\tpremtiveSplitCallback() {\n\t\tif (this.preemptiveSplit !== this.premptiveSplitBox.checked) {\n\t\t\tthis.implementAction(\n\t\t\t\tthis.changePreemtiveSplit.bind(this),\n\t\t\t\tthis.premptiveSplitBox.checked,\n\t\t\t);\n\t\t}\n\t}\n\n\tchangePreemtiveSplit(newValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.step);\n\t\tthis.preemptiveSplit = newValue;\n\t\tif (this.premptiveSplitBox.checked !== this.preemptiveSplit) {\n\t\t\tthis.premptiveSplitBox.checked = this.preemptiveSplit;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.messageID, 'Printing tree');\n\t\tconst firstLabel = this.nextIndex;\n\n\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\n\t\tthis.printTreeRec(this.treeRoot);\n\t\tthis.cmd(act.step);\n\t\tfor (let i = firstLabel; i < this.nextIndex; i++) {\n\t\t\tthis.cmd(act.delete, i);\n\t\t}\n\t\tthis.nextIndex = firstLabel;\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tlet nextLabelID;\n\t\tif (tree.isLeaf) {\n\t\t\tfor (let i = 0; i < tree.numKeys; i++) {\n\t\t\t\tnextLabelID = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tnextLabelID,\n\t\t\t\t\ttree.keys[i],\n\t\t\t\t\tthis.getLabelX(tree, i),\n\t\t\t\t\ttree.y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, nextLabelID, PRINT_COLOR);\n\t\t\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\n\t\t\t\tif (this.xPosOfNextLabel > PRINT_MAX) {\n\t\t\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t} else {\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[0].graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[0].graphicID, 0);\n\t\t\tthis.printTreeRec(tree.children[0]);\n\t\t\tfor (let i = 0; i < tree.numKeys; i++) {\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\t\tnextLabelID = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tnextLabelID,\n\t\t\t\t\ttree.keys[i],\n\t\t\t\t\tthis.getLabelX(tree, i),\n\t\t\t\t\ttree.y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, nextLabelID, PRINT_COLOR);\n\t\t\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\n\t\t\t\tif (this.xPosOfNextLabel > PRINT_MAX) {\n\t\t\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i + 1].graphicID, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i + 1].graphicID, 0);\n\t\t\t\tthis.printTreeRec(tree.children[i + 1]);\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t}\n\t}\n\n\tclearTree() {\n\t\tthis.commands = [];\n\t\tthis.deleteTree(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\tthis.nextIndex = 3;\n\t\treturn this.commands;\n\t}\n\n\tdeleteTree(tree) {\n\t\tif (tree != null) {\n\t\t\tif (!tree.isLeaf) {\n\t\t\t\tfor (let i = 0; i <= tree.numKeys; i++) {\n\t\t\t\t\tthis.cmd(act.disconnect, tree.graphicID, tree.children[i].graphicID);\n\t\t\t\t\tthis.deleteTree(tree.children[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.delete, tree.graphicID);\n\t\t}\n\t}\n\n\tchangeDegree(degree) {\n\t\tthis.commands = [];\n\t\tthis.deleteTree(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\tthis.nextIndex = 3;\n\t\tconst newDegree = degree;\n\t\tthis.ignoreInputs = true;\n\t\tthis.maxDegreeRadioButtons[newDegree - MIN_MAX_DEGREE].checked = true;\n\n\t\tthis.ignoreInputs = false;\n\t\tthis.max_degree = newDegree;\n\t\tthis.max_keys = newDegree - 1;\n\t\tthis.min_keys = Math.floor((newDegree + 1) / 2) - 1;\n\t\tthis.split_index = Math.floor((newDegree - 1) / 2);\n\t\tif (this.commands.length === 0) {\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tif (newDegree % 2 !== 0 && this.preemptiveSplit) {\n\t\t\tthis.preemptiveSplit = false;\n\t\t\tthis.premptiveSplitBox.checked = false;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.normalizeNumber(this.findField.value, 4);\n\t\tthis.findField.value = '';\n\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.messageID, 'Finding ' + findValue);\n\t\tthis.findInTree(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tfindInTree(tree, val) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\n\t\t\tif (i === tree.numKeys) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t1,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t\tthis.findInTree(tree.children[tree.numKeys], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' is not in the tree');\n\t\t\t\t}\n\t\t\t} else if (tree.keys[i] > val) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\t\t\t\t\tthis.findInTree(tree.children[i], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' is not in the tree');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, '#FF0000', i);\n\t\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' found');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' is not in the tree');\n\t\t}\n\t}\n\n\tinsertElement(insertedValue) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.messageID, 'Inserting ' + insertedValue);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.treeRoot == null) {\n\t\t\tthis.treeRoot = new BTreeNode(this.nextIndex++, this.starting_x, STARTING_Y);\n\t\t\tthis.cmd(\n\t\t\t\tact.createBTreeNode,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\tWIDTH_PER_ELEM,\n\t\t\t\tNODE_HEIGHT,\n\t\t\t\t1,\n\t\t\t\tthis.starting_x,\n\t\t\t\tSTARTING_Y,\n\t\t\t\tBACKGROUND_COLOR,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t);\n\t\t\tthis.treeRoot.keys[0] = insertedValue;\n\t\t\tthis.cmd(act.setText, this.treeRoot.graphicID, insertedValue, 0);\n\t\t} else {\n\t\t\tif (this.preemptiveSplit) {\n\t\t\t\tif (this.treeRoot.numKeys === this.max_keys) {\n\t\t\t\t\tthis.split(this.treeRoot);\n\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.insertNotFull(this.treeRoot, insertedValue);\n\t\t\t} else {\n\t\t\t\tthis.insert(this.treeRoot, insertedValue);\n\t\t\t}\n\t\t\tif (!this.treeRoot.isLeaf) {\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.setText, this.messageID, '');\n\n\t\treturn this.commands;\n\t}\n\n\tinsertNotFull(tree, insertValue) {\n\t\tif (\n\t\t\ttree.keys.includes(insertValue) &&\n\t\t\ttree.keys.findIndex(e => e === insertValue) < tree.numKeys\n\t\t) {\n\t\t\tthis.cmd(act.setText, 0, `${insertValue} == ${insertValue}. Ignoring duplicate!`);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tif (tree.isLeaf) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.messageID,\n\t\t\t\t'Inserting ' + insertValue + '.  Inserting into a leaf',\n\t\t\t);\n\t\t\ttree.numKeys++;\n\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\tlet insertIndex = tree.numKeys - 1;\n\t\t\twhile (insertIndex > 0 && tree.keys[insertIndex - 1] > insertValue) {\n\t\t\t\ttree.keys[insertIndex] = tree.keys[insertIndex - 1];\n\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\t\tinsertIndex--;\n\t\t\t}\n\t\t\ttree.keys[insertIndex] = insertValue;\n\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.resizeTree();\n\t\t} else {\n\t\t\tlet findIndex = 0;\n\t\t\twhile (findIndex < tree.numKeys && tree.keys[findIndex] < insertValue) {\n\t\t\t\tfindIndex++;\n\t\t\t}\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 0);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tif (tree.children[findIndex].numKeys === this.max_keys) {\n\t\t\t\tconst newTree = this.split(tree.children[findIndex]);\n\t\t\t\tthis.resizeTree();\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.insertNotFull(newTree, insertValue);\n\t\t\t} else {\n\t\t\t\tthis.insertNotFull(tree.children[findIndex], insertValue);\n\t\t\t}\n\t\t}\n\t}\n\n\tinsert(tree, insertValue) {\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (\n\t\t\ttree.keys.includes(insertValue) &&\n\t\t\ttree.keys.findIndex(e => e === insertValue) < tree.numKeys\n\t\t) {\n\t\t\tthis.cmd(act.setText, 0, `${insertValue} == ${insertValue}. Ignoring duplicate!`);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\treturn;\n\t\t}\n\n\t\tif (tree.isLeaf) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.messageID,\n\t\t\t\t'Inserting ' + insertValue + '.  Inserting into a leaf',\n\t\t\t);\n\t\t\ttree.numKeys++;\n\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\tlet insertIndex = tree.numKeys - 1;\n\t\t\twhile (insertIndex > 0 && tree.keys[insertIndex - 1] > insertValue) {\n\t\t\t\ttree.keys[insertIndex] = tree.keys[insertIndex - 1];\n\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\t\tinsertIndex--;\n\t\t\t}\n\t\t\ttree.keys[insertIndex] = insertValue;\n\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.resizeTree();\n\t\t\tthis.insertRepair(tree);\n\t\t} else {\n\t\t\tlet findIndex = 0;\n\t\t\twhile (findIndex < tree.numKeys && tree.keys[findIndex] < insertValue) {\n\t\t\t\tfindIndex++;\n\t\t\t}\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 0);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.insert(tree.children[findIndex], insertValue);\n\t\t}\n\t}\n\n\tinsertRepair(tree) {\n\t\tif (tree.numKeys <= this.max_keys) {\n\t\t\treturn;\n\t\t} else if (tree.parent == null) {\n\t\t\tthis.treeRoot = this.split(tree);\n\t\t\treturn;\n\t\t} else {\n\t\t\tconst newNode = this.split(tree);\n\t\t\tthis.insertRepair(newNode);\n\t\t}\n\t}\n\n\tsplit(tree) {\n\t\tthis.cmd(act.setText, this.messageID, 'Node now contains too many keys.  Splittig ...');\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\tconst rightNode = new BTreeNode(this.nextIndex++, tree.x + 100, tree.y);\n\t\trightNode.numKeys = tree.numKeys - this.split_index - 1;\n\t\tconst risingNode = tree.keys[this.split_index];\n\t\tlet currentParent;\n\t\tlet parentIndex;\n\t\tif (tree.parent != null) {\n\t\t\tcurrentParent = tree.parent;\n\t\t\tfor (\n\t\t\t\tparentIndex = 0;\n\t\t\t\tparentIndex < currentParent.numKeys + 1 &&\n\t\t\t\tcurrentParent.children[parentIndex] !== tree;\n\t\t\t\tparentIndex++\n\t\t\t);\n\t\t\tif (parentIndex === currentParent.numKeys + 1) {\n\t\t\t\tthrow new Error(\"Couldn't find which child we were!\");\n\t\t\t}\n\t\t\tthis.cmd(act.setNumElements, currentParent.graphicID, currentParent.numKeys + 1);\n\t\t\tfor (let i = currentParent.numKeys; i > parentIndex; i--) {\n\t\t\t\tcurrentParent.children[i + 1] = currentParent.children[i];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tcurrentParent.graphicID,\n\t\t\t\t\tcurrentParent.children[i].graphicID,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tcurrentParent.graphicID,\n\t\t\t\t\tcurrentParent.children[i].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti + 1,\n\t\t\t\t);\n\n\t\t\t\tcurrentParent.keys[i] = currentParent.keys[i - 1];\n\t\t\t\tthis.cmd(act.setText, currentParent.graphicID, currentParent.keys[i], i);\n\t\t\t}\n\t\t\tcurrentParent.numKeys++;\n\t\t\tcurrentParent.keys[parentIndex] = risingNode;\n\t\t\tthis.cmd(act.setText, currentParent.graphicID, '', parentIndex);\n\t\t\tthis.moveLabel1ID = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.moveLabel1ID,\n\t\t\t\trisingNode,\n\t\t\t\tthis.getLabelX(tree, this.split_index),\n\t\t\t\ttree.y,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.moveLabel1ID, FOREGROUND_COLOR);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.moveLabel1ID,\n\t\t\t\tthis.getLabelX(currentParent, parentIndex),\n\t\t\t\tcurrentParent.y,\n\t\t\t);\n\n\t\t\tcurrentParent.children[parentIndex + 1] = rightNode;\n\t\t\trightNode.parent = currentParent;\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.createBTreeNode,\n\t\t\trightNode.graphicID,\n\t\t\tWIDTH_PER_ELEM,\n\t\t\tNODE_HEIGHT,\n\t\t\ttree.numKeys - this.split_index - 1,\n\t\t\ttree.x,\n\t\t\ttree.y,\n\t\t\tBACKGROUND_COLOR,\n\t\t\tFOREGROUND_COLOR,\n\t\t);\n\n\t\tfor (let i = this.split_index + 1; i < tree.numKeys + 1; i++) {\n\t\t\trightNode.children[i - this.split_index - 1] = tree.children[i];\n\t\t\tif (tree.children[i] != null) {\n\t\t\t\trightNode.isLeaf = false;\n\t\t\t\tthis.cmd(act.disconnect, tree.graphicID, tree.children[i].graphicID);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\trightNode.graphicID,\n\t\t\t\t\trightNode.children[i - this.split_index - 1].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti - this.split_index - 1,\n\t\t\t\t);\n\t\t\t\tif (tree.children[i] != null) {\n\t\t\t\t\ttree.children[i].parent = rightNode;\n\t\t\t\t}\n\t\t\t\ttree.children[i] = null;\n\t\t\t}\n\t\t}\n\t\tfor (let i = this.split_index + 1; i < tree.numKeys; i++) {\n\t\t\trightNode.keys[i - this.split_index - 1] = tree.keys[i];\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\trightNode.graphicID,\n\t\t\t\trightNode.keys[i - this.split_index - 1],\n\t\t\t\ti - this.split_index - 1,\n\t\t\t);\n\t\t}\n\t\tconst leftNode = tree;\n\t\tleftNode.numKeys = this.split_index;\n\t\tfor (let i = this.split_index; i < tree.numKeys; i++) {\n\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t}\n\t\tthis.cmd(act.setNumElements, tree.graphicID, this.split_index);\n\n\t\tif (tree.parent != null) {\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tcurrentParent.graphicID,\n\t\t\t\trightNode.graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\tparentIndex + 1,\n\t\t\t);\n\t\t\tthis.resizeTree();\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\tthis.cmd(act.setText, currentParent.graphicID, risingNode, parentIndex);\n\t\t\treturn tree.parent;\n\t\t} else {\n\t\t\tthis.treeRoot = new BTreeNode(this.nextIndex++, this.starting_x, STARTING_Y);\n\t\t\tthis.cmd(\n\t\t\t\tact.createBTreeNode,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\tWIDTH_PER_ELEM,\n\t\t\t\tNODE_HEIGHT,\n\t\t\t\t1,\n\t\t\t\tthis.starting_x,\n\t\t\t\tSTARTING_Y,\n\t\t\t\tBACKGROUND_COLOR,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t);\n\t\t\tthis.treeRoot.keys[0] = risingNode;\n\t\t\tthis.cmd(act.setText, this.treeRoot.graphicID, risingNode, 0);\n\t\t\tthis.treeRoot.children[0] = leftNode;\n\t\t\tthis.treeRoot.children[1] = rightNode;\n\t\t\tleftNode.parent = this.treeRoot;\n\t\t\trightNode.parent = this.treeRoot;\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\tleftNode.graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\t0,\n\t\t\t); // Connection Point\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\trightNode.graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\t1,\n\t\t\t); // Connection Point\n\t\t\tthis.treeRoot.isLeaf = false;\n\t\t\treturn this.treeRoot;\n\t\t}\n\t}\n\n\tdeleteElement(deletedValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Deleting ' + deletedValue);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.cmd(act.setText, 0, '');\n\t\tif (this.preemptiveSplit) {\n\t\t\tthis.doDeleteNotEmpty(this.treeRoot, deletedValue);\n\t\t} else {\n\t\t\tthis.doDelete(this.treeRoot, deletedValue);\n\t\t}\n\t\tif (this.treeRoot && this.treeRoot.numKeys === 0) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, this.treeRoot.graphicID);\n\t\t\tthis.treeRoot = this.treeRoot.children[0];\n\t\t\tthis.treeRoot.parent = null;\n\t\t\tthis.resizeTree();\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tdoDeleteNotEmpty(tree, val) {\n\t\tif (tree != null) {\n\t\t\tlet nextNode;\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\n\t\t\tif (i === tree.numKeys) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t1,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\n\t\t\t\t\tif (tree.children[tree.numKeys].numKeys === this.min_keys) {\n\t\t\t\t\t\tif (tree.children[tree.numKeys - 1].numKeys > this.min_keys) {\n\t\t\t\t\t\t\tnextNode = this.stealFromLeft(\n\t\t\t\t\t\t\t\ttree.children[tree.numKeys],\n\t\t\t\t\t\t\t\ttree.numKeys,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[tree.numKeys - 1]);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.doDeleteNotEmpty(tree.children[tree.numKeys], val);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else if (tree.keys[i] > val) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\n\t\t\t\t\tif (tree.children[i].numKeys > this.min_keys) {\n\t\t\t\t\t\tthis.doDeleteNotEmpty(tree.children[i], val);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tree.children[i + 1].numKeys > this.min_keys) {\n\t\t\t\t\t\t\tnextNode = this.stealFromRight(tree.children[i], i);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[i]);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, 'FF0000', i);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\tfor (let j = i; j < tree.numKeys - 1; j++) {\n\t\t\t\t\t\ttree.keys[j] = tree.keys[j + 1];\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[j], j);\n\t\t\t\t\t}\n\t\t\t\t\ttree.numKeys--;\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\tthis.cmd(act.setText, this.messageID, '');\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t'Checking to see if tree to left of element to delete \\nhas an extra key',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\t\t\t\t\tlet maxNode = tree.children[i];\n\n\t\t\t\t\tif (tree.children[i].numKeys === this.min_keys) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t'Tree to left of element to delete does not have an extra key.  \\nLooking to the right ...',\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\t\ttree.children[i + 1].graphicID,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\t\ttree.children[i + 1].graphicID,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t);\n\t\t\t\t\t\t// Trees to left and right of node to delete don't have enough keys\n\t\t\t\t\t\t// Do a merge, and then recursively delete the element\n\t\t\t\t\t\tif (tree.children[i + 1].numKeys === this.min_keys) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t\t'Neither subtree has extra nodes.  Mergeing around the key to delete, \\nand recursively deleting ...',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[i]);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t\t'Tree to right of element to delete does have an extra key. \\nFinding the smallest key in that subtree ...',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\tlet minNode = tree.children[i + 1];\n\t\t\t\t\t\t\twhile (!minNode.isLeaf) {\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 1);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 0);\n\t\t\t\t\t\t\t\tif (minNode.children[0].numKeys === this.min_keys) {\n\t\t\t\t\t\t\t\t\tif (minNode.children[1].numKeys === this.min_keys) {\n\t\t\t\t\t\t\t\t\t\tminNode = this.mergeRight(minNode.children[0]);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tminNode = this.stealFromRight(minNode.children[0], 0);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tminNode = minNode.children[0];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 1);\n\t\t\t\t\t\t\ttree.keys[i] = minNode.keys[0];\n\t\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\t\tthis.cmd(act.setText, minNode.graphicID, '', 0);\n\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\t\tminNode.keys[0],\n\t\t\t\t\t\t\t\tthis.getLabelX(minNode, 0),\n\t\t\t\t\t\t\t\tminNode.y,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t\t\t\t\t\tfor (i = 1; i < minNode.numKeys; i++) {\n\t\t\t\t\t\t\t\tminNode.keys[i - 1] = minNode.keys[i];\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tminNode.graphicID,\n\t\t\t\t\t\t\t\t\tminNode.keys[i - 1],\n\t\t\t\t\t\t\t\t\ti - 1,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.cmd(act.setText, minNode.graphicID, '', minNode.numKeys - 1);\n\n\t\t\t\t\t\t\tminNode.numKeys--;\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 0);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\t\t\t\tthis.cmd(act.setNumElements, minNode.graphicID, minNode.numKeys);\n\t\t\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\t\t\tthis.cmd(act.setText, this.messageID, '');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t'Tree to left of element to delete does have \\nan extra key. Finding the largest key in that subtree ...',\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\twhile (!maxNode.isLeaf) {\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\t\tif (maxNode.children[maxNode.numKeys].numKeys === this.min_keys) {\n\t\t\t\t\t\t\t\tif (maxNode.children[maxNode.numKeys - 1] > this.min_keys) {\n\t\t\t\t\t\t\t\t\tmaxNode = this.stealFromLeft(\n\t\t\t\t\t\t\t\t\t\tmaxNode.children[maxNode.numKeys],\n\t\t\t\t\t\t\t\t\t\tmaxNode.numKeys,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tmaxNode = this.mergeRight(maxNode.children[maxNode.numKeys - 1]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmaxNode = maxNode.children[maxNode.numKeys];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\ttree.keys[i] = maxNode.keys[maxNode.numKeys - 1];\n\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, '', maxNode.numKeys - 1);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\ttree.keys[i],\n\t\t\t\t\t\t\tthis.getLabelX(maxNode, maxNode.numKeys - 1),\n\t\t\t\t\t\t\tmaxNode.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t\t\t\t\tmaxNode.numKeys--;\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\t\t\tthis.cmd(act.setNumElements, maxNode.graphicID, maxNode.numKeys);\n\t\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\t\tthis.cmd(act.setText, this.messageID, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdoDelete(tree, val) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\n\t\t\tif (i === tree.numKeys) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t1,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t\tthis.doDelete(tree.children[tree.numKeys], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else if (tree.keys[i] > val) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\t\t\t\t\tthis.doDelete(tree.children[i], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, '#FF0000', i);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\tfor (let j = i; j < tree.numKeys - 1; j++) {\n\t\t\t\t\t\ttree.keys[j] = tree.keys[j + 1];\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[j], j);\n\t\t\t\t\t}\n\t\t\t\t\ttree.numKeys--;\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.repairAfterDelete(tree);\n\t\t\t\t} else {\n\t\t\t\t\tlet maxNode;\n\t\t\t\t\tif (this.predSucc === 'pred') {\n\t\t\t\t\t\tmaxNode = tree.children[i];\n\t\t\t\t\t\twhile (!maxNode.isLeaf) {\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\t\tmaxNode = maxNode.children[maxNode.numKeys];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\ttree.keys[i] = maxNode.keys[maxNode.numKeys - 1];\n\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, '', maxNode.numKeys - 1);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\ttree.keys[i],\n\t\t\t\t\t\t\tthis.getLabelX(maxNode, maxNode.numKeys - 1),\n\t\t\t\t\t\t\tmaxNode.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmaxNode = tree.children[i + 1];\n\t\t\t\t\t\twhile (!maxNode.isLeaf) {\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\t\tmaxNode = maxNode.children[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\ttree.keys[i] = maxNode.keys[0];\n\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, '', 0);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\ttree.keys[i],\n\t\t\t\t\t\t\tthis.getLabelX(maxNode, 0),\n\t\t\t\t\t\t\tmaxNode.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t\t\t\tmaxNode.numKeys--;\n\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\t\t/* When setNumElements is called with the new #, it cuts of the last element\n\t\t\t\t\t(like removeFromBack in an array). Removing the successor is more like \n\t\t\t\t\tremoveFromFront so you need to shift elements left by 1*/\n\t\t\t\t\tif (this.predSucc === 'succ') {\n\t\t\t\t\t\tfor (let j = 0; j < maxNode.numKeys; j++) {\n\t\t\t\t\t\t\tmaxNode.keys[j] = maxNode.keys[j + 1];\n\t\t\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, maxNode.keys[j], j);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.setNumElements, maxNode.graphicID, maxNode.numKeys);\n\t\t\t\t\tthis.repairAfterDelete(maxNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tmergeRight(tree) {\n\t\tthis.cmd(act.setText, this.messageID, 'Merging node');\n\n\t\tconst parentNode = tree.parent;\n\t\tlet parentIndex = 0;\n\t\tfor (parentIndex = 0; parentNode.children[parentIndex] !== tree; parentIndex++);\n\t\tconst rightSib = parentNode.children[parentIndex + 1];\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.setHighlight, parentNode.graphicID, 1);\n\t\tthis.cmd(act.setHighlight, rightSib.graphicID, 1);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys + rightSib.numKeys + 1);\n\t\ttree.x = (tree.x + rightSib.x) / 2;\n\t\tthis.cmd(act.setPosition, tree.graphicID, tree.x, tree.y);\n\n\t\ttree.keys[tree.numKeys] = parentNode.keys[parentIndex];\n\t\tconst fromParentIndex = tree.numKeys;\n\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.moveLabel1ID,\n\t\t\tparentNode.keys[parentIndex],\n\t\t\tthis.getLabelX(parentNode, parentIndex),\n\t\t\tparentNode.y,\n\t\t);\n\n\t\tfor (let i = 0; i < rightSib.numKeys; i++) {\n\t\t\ttree.keys[tree.numKeys + 1 + i] = rightSib.keys[i];\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\ttree.graphicID,\n\t\t\t\ttree.keys[tree.numKeys + 1 + i],\n\t\t\t\ttree.numKeys + 1 + i,\n\t\t\t);\n\t\t\tthis.cmd(act.setText, rightSib.graphicID, '', i);\n\t\t}\n\t\tif (!tree.isLeaf) {\n\t\t\tfor (let i = 0; i <= rightSib.numKeys; i++) {\n\t\t\t\tthis.cmd(act.disconnect, rightSib.graphicID, rightSib.children[i].graphicID);\n\t\t\t\ttree.children[tree.numKeys + 1 + i] = rightSib.children[i];\n\t\t\t\ttree.children[tree.numKeys + 1 + i].parent = tree;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\ttree.graphicID,\n\t\t\t\t\ttree.children[tree.numKeys + 1 + i].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ttree.numKeys + 1 + i,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.disconnect, parentNode.graphicID, rightSib.graphicID);\n\t\tfor (let i = parentIndex + 1; i < parentNode.numKeys; i++) {\n\t\t\tthis.cmd(act.disconnect, parentNode.graphicID, parentNode.children[i + 1].graphicID);\n\t\t\tparentNode.children[i] = parentNode.children[i + 1];\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tparentNode.graphicID,\n\t\t\t\tparentNode.children[i].graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\ti,\n\t\t\t);\n\t\t\tparentNode.keys[i - 1] = parentNode.keys[i];\n\t\t\tthis.cmd(act.setText, parentNode.graphicID, parentNode.keys[i - 1], i - 1);\n\t\t}\n\t\tthis.cmd(act.setText, parentNode.graphicID, '', parentNode.numKeys - 1);\n\t\tparentNode.numKeys--;\n\t\tthis.cmd(act.setNumElements, parentNode.graphicID, parentNode.numKeys);\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, parentNode.graphicID, 0);\n\n\t\tthis.cmd(act.delete, rightSib.graphicID);\n\t\ttree.numKeys = tree.numKeys + rightSib.numKeys + 1;\n\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, fromParentIndex), tree.y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[fromParentIndex], fromParentIndex);\n\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn tree;\n\t}\n\n\tstealFromRight(tree, parentIndex) {\n\t\t// Steal from right sibling\n\t\tconst parentNode = tree.parent;\n\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys + 1);\n\n\t\tthis.cmd(act.setText, this.messageID, 'Stealing from right sibling');\n\n\t\tconst rightSib = parentNode.children[parentIndex + 1];\n\t\ttree.numKeys++;\n\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\n\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys - 1);\n\t\tthis.cmd(act.setText, parentNode.graphicID, '', parentIndex);\n\t\tthis.cmd(act.setText, rightSib.graphicID, '', 0);\n\n\t\tconst tmpLabel1 = this.nextIndex++;\n\t\tconst tmpLabel2 = this.nextIndex++;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel1,\n\t\t\trightSib.keys[0],\n\t\t\tthis.getLabelX(rightSib, 0),\n\t\t\trightSib.y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel2,\n\t\t\tparentNode.keys[parentIndex],\n\t\t\tthis.getLabelX(parentNode, parentIndex),\n\t\t\tparentNode.y,\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel1, FOREGROUND_COLOR);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel2, FOREGROUND_COLOR);\n\n\t\tthis.cmd(act.move, tmpLabel1, this.getLabelX(parentNode, parentIndex), parentNode.y);\n\t\tthis.cmd(act.move, tmpLabel2, this.getLabelX(tree, tree.numKeys - 1), tree.y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, tmpLabel1);\n\t\tthis.cmd(act.delete, tmpLabel2);\n\t\ttree.keys[tree.numKeys - 1] = parentNode.keys[parentIndex];\n\t\tparentNode.keys[parentIndex] = rightSib.keys[0];\n\n\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[tree.numKeys - 1], tree.numKeys - 1);\n\t\tthis.cmd(act.setText, parentNode.graphicID, parentNode.keys[parentIndex], parentIndex);\n\t\tif (!tree.isLeaf) {\n\t\t\ttree.children[tree.numKeys] = rightSib.children[0];\n\t\t\ttree.children[tree.numKeys].parent = tree;\n\t\t\tthis.cmd(act.disconnect, rightSib.graphicID, rightSib.children[0].graphicID);\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\ttree.graphicID,\n\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\ttree.numKeys,\n\t\t\t);\n\n\t\t\tfor (let i = 1; i < rightSib.numKeys + 1; i++) {\n\t\t\t\tthis.cmd(act.disconnect, rightSib.graphicID, rightSib.children[i].graphicID);\n\t\t\t\trightSib.children[i - 1] = rightSib.children[i];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\trightSib.graphicID,\n\t\t\t\t\trightSib.children[i - 1].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti - 1,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tfor (let i = 1; i < rightSib.numKeys; i++) {\n\t\t\trightSib.keys[i - 1] = rightSib.keys[i];\n\t\t\tthis.cmd(act.setText, rightSib.graphicID, rightSib.keys[i - 1], i - 1);\n\t\t}\n\t\tthis.cmd(act.setText, rightSib.graphicID, '', rightSib.numKeys - 1);\n\t\trightSib.numKeys--;\n\t\tthis.cmd(act.setNumElements, rightSib.graphicID, rightSib.numKeys);\n\t\tthis.resizeTree();\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn tree;\n\t}\n\n\tstealFromLeft(tree, parentIndex) {\n\t\tconst parentNode = tree.parent;\n\t\t// Steal from left sibling\n\t\ttree.numKeys++;\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.messageID,\n\t\t\t'Node has too few keys.  Stealing from left sibling.',\n\t\t);\n\n\t\tfor (let i = tree.numKeys - 1; i > 0; i--) {\n\t\t\ttree.keys[i] = tree.keys[i - 1];\n\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t}\n\t\tconst leftSib = parentNode.children[parentIndex - 1];\n\n\t\tthis.cmd(act.setText, tree.graphicID, '', 0);\n\t\tthis.cmd(act.setText, parentNode.graphicID, '', parentIndex - 1);\n\t\tthis.cmd(act.setText, leftSib.graphicID, '', leftSib.numKeys - 1);\n\n\t\tconst tmpLabel1 = this.nextIndex++;\n\t\tconst tmpLabel2 = this.nextIndex++;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel1,\n\t\t\tleftSib.keys[leftSib.numKeys - 1],\n\t\t\tthis.getLabelX(leftSib, leftSib.numKeys - 1),\n\t\t\tleftSib.y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel2,\n\t\t\tparentNode.keys[parentIndex - 1],\n\t\t\tthis.getLabelX(parentNode, parentIndex - 1),\n\t\t\tparentNode.y,\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel1, FOREGROUND_COLOR);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel2, FOREGROUND_COLOR);\n\n\t\tthis.cmd(act.move, tmpLabel1, this.getLabelX(parentNode, parentIndex - 1), parentNode.y);\n\t\tthis.cmd(act.move, tmpLabel2, this.getLabelX(tree, 0), tree.y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, tmpLabel1);\n\t\tthis.cmd(act.delete, tmpLabel2);\n\n\t\tif (!tree.isLeaf) {\n\t\t\tfor (let i = tree.numKeys; i > 0; i--) {\n\t\t\t\tthis.cmd(act.disconnect, tree.graphicID, tree.children[i - 1].graphicID);\n\t\t\t\ttree.children[i] = tree.children[i - 1];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\ttree.graphicID,\n\t\t\t\t\ttree.children[i].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti,\n\t\t\t\t);\n\t\t\t}\n\t\t\ttree.children[0] = leftSib.children[leftSib.numKeys];\n\t\t\tthis.cmd(\n\t\t\t\tact.disconnect,\n\t\t\t\tleftSib.graphicID,\n\t\t\t\tleftSib.children[leftSib.numKeys].graphicID,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\ttree.graphicID,\n\t\t\t\ttree.children[0].graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\t0,\n\t\t\t);\n\t\t\tleftSib.children[leftSib.numKeys] = null;\n\t\t\ttree.children[0].parent = tree;\n\t\t}\n\n\t\ttree.keys[0] = parentNode.keys[parentIndex - 1];\n\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[0], 0);\n\t\tparentNode.keys[parentIndex - 1] = leftSib.keys[leftSib.numKeys - 1];\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tparentNode.graphicID,\n\t\t\tparentNode.keys[parentIndex - 1],\n\t\t\tparentIndex - 1,\n\t\t);\n\t\tthis.cmd(act.setText, leftSib.graphicID, '', leftSib.numKeys - 1);\n\n\t\tleftSib.numKeys--;\n\t\tthis.cmd(act.setNumElements, leftSib.graphicID, leftSib.numKeys);\n\t\tthis.resizeTree();\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn tree;\n\t}\n\n\trepairAfterDelete(tree) {\n\t\tif (tree.numKeys < this.min_keys) {\n\t\t\tif (tree.parent == null) {\n\t\t\t\tif (tree.numKeys === 0) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, tree.graphicID);\n\t\t\t\t\tthis.treeRoot = tree.children[0];\n\t\t\t\t\tif (this.treeRoot != null) this.treeRoot.parent = null;\n\t\t\t\t\tthis.resizeTree();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst parentNode = tree.parent;\n\t\t\t\tlet parentIndex;\n\t\t\t\tlet nextNode;\n\t\t\t\tfor (parentIndex = 0; parentNode.children[parentIndex] !== tree; parentIndex++);\n\t\t\t\tif (\n\t\t\t\t\tparentIndex > 0 &&\n\t\t\t\t\tparentNode.children[parentIndex - 1].numKeys > this.min_keys\n\t\t\t\t) {\n\t\t\t\t\tthis.stealFromLeft(tree, parentIndex);\n\t\t\t\t} else if (\n\t\t\t\t\tparentIndex < parentNode.numKeys &&\n\t\t\t\t\tparentNode.children[parentIndex + 1].numKeys > this.min_keys\n\t\t\t\t) {\n\t\t\t\t\tthis.stealFromRight(tree, parentIndex);\n\t\t\t\t} else if (parentIndex === 0) {\n\t\t\t\t\t// Merge with right sibling\n\t\t\t\t\tnextNode = this.mergeRight(tree);\n\t\t\t\t\tthis.repairAfterDelete(nextNode.parent);\n\t\t\t\t} else {\n\t\t\t\t\t// Merge with left sibling\n\t\t\t\t\tnextNode = this.mergeRight(parentNode.children[parentIndex - 1]);\n\t\t\t\t\tthis.repairAfterDelete(nextNode.parent);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLabelX(tree, index) {\n\t\treturn (\n\t\t\ttree.x -\n\t\t\t(WIDTH_PER_ELEM * tree.numKeys) / 2 +\n\t\t\tWIDTH_PER_ELEM / 2 +\n\t\t\tindex * WIDTH_PER_ELEM\n\t\t);\n\t}\n\n\tresizeTree() {\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tthis.setNewPositions(this.treeRoot, this.starting_x, STARTING_Y);\n\t\tthis.animateNewPositions(this.treeRoot);\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\ttree.x = xPosition;\n\t\t\tif (!tree.isLeaf) {\n\t\t\t\tconst leftEdge = xPosition - tree.width / 2;\n\t\t\t\tlet priorWidth = 0;\n\t\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\n\t\t\t\t\tthis.setNewPositions(\n\t\t\t\t\t\ttree.children[i],\n\t\t\t\t\t\tleftEdge + priorWidth + tree.widths[i] / 2,\n\t\t\t\t\t\tyPosition + HEIGHT_DELTA,\n\t\t\t\t\t);\n\t\t\t\t\tpriorWidth += tree.widths[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet i;\n\t\tfor (i = 0; i < tree.numKeys + 1; i++) {\n\t\t\tthis.animateNewPositions(tree.children[i]);\n\t\t}\n\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (tree.isLeaf) {\n\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\n\t\t\t\ttree.widths[i] = 0;\n\t\t\t}\n\t\t\ttree.width = tree.numKeys * WIDTH_PER_ELEM + NODE_SPACING;\n\t\t\treturn tree.width;\n\t\t} else {\n\t\t\tlet treeWidth = 0;\n\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\n\t\t\t\ttree.widths[i] = this.resizeWidths(tree.children[i]);\n\t\t\t\ttreeWidth = treeWidth + tree.widths[i];\n\t\t\t}\n\t\t\ttreeWidth = Math.max(treeWidth, tree.numKeys * WIDTH_PER_ELEM + NODE_SPACING);\n\t\t\ttree.width = treeWidth;\n\t\t\treturn treeWidth;\n\t\t}\n\t}\n}\n\nfunction BTreeNode(id, initialX, initialY) {\n\tthis.widths = [];\n\tthis.keys = [];\n\tthis.children = [];\n\tthis.x = initialX;\n\tthis.y = initialY;\n\tthis.graphicID = id;\n\tthis.numKeys = 1;\n\tthis.isLeaf = true;\n\tthis.parent = null;\n\n\tthis.leftWidth = 0;\n\tthis.rightWidth = 0;\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\nconst PATTERN_START_Y = 80;\n\nconst FAILURE_TABLE_START_Y = 215;\nconst LAST_TABLE_START_Y = 140;\n\nconst COMP_COUNT_X = 575;\nconst COMP_COUNT_Y = 15;\n\nconst PERIOD_Y = 35;\n\nconst BM_CODE_Y = 195;\n\nconst GALIL_CODE_Y = 265;\n\nlet galilRuleEnabled = false;\n\nexport default class BoyerMoore extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Build Last Occurrence Table button\n\t\tthis.blotButton = addControlToAlgorithmBar('Button', 'Build Last Occurrence Table');\n\t\tthis.blotButton.onclick = this.buildLastOccurrenceTableCallback.bind(this);\n\t\tthis.controls.push(this.blotButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Galil Rule button\n\t\tthis.galilButton = addCheckboxToAlgorithmBar('Galil Rule Optimization', false);\n\t\tthis.galilButton.onclick = this.toggleGalilRule.bind(this);\n\t\tthis.controls.push(this.galilButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.patternTableLabelID = this.nextIndex++;\n\t\tthis.patternTableCharacterID = [];\n\t\tthis.patternTableIndexID = [];\n\t\tthis.lastTableLabelID = this.nextIndex++;\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\tthis.codeID = [];\n\t\t// this.failureTableLabelID = this.nextIndex++;\n\t\t// this.failureTableCharacterID = [];\n\t\t// this.failureTableValueID = [];\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.periodLabelID = this.nextIndex++;\n\n\t\tthis.lastTableCode = [\n\t\t\t['procedure BoyerMooreLastTable(pattern):'],\n\t\t\t['     lastTable <- map from character to integer'],\n\t\t\t['     for i < 0, length of pattern'],\n\t\t\t['          lastTable[pattern[i]] <- i'],\n\t\t\t['     return lastTable'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.failureTableCode = [\n\t\t\t['procedure KMPFailureTable(pattern):'],\n\t\t\t['     m <- length of pattern'],\n\t\t\t['     failureTable <- array of length m'],\n\t\t\t['     i <- 0, j <- 1'],\n\t\t\t['     failureTable[0] <- 0'],\n\t\t\t['     while j < m'],\n\t\t\t['          if pattern[i] = pattern[j]'],\n\t\t\t['               failureTable[j] <- i + 1'],\n\t\t\t['               i < i + 1, j <- j + 1'],\n\t\t\t['          else'],\n\t\t\t['               if i = 0'],\n\t\t\t['                    failureTable[j] <- 0'],\n\t\t\t['                    j <- j + 1'],\n\t\t\t['               else'],\n\t\t\t['                    i <- failureTable[i - 1]'],\n\t\t\t['     return failureTable'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.BMCode = [\n\t\t\t['procedure BoyerMoore(text, pattern):'],\n\t\t\t['     initialize lastTable'],\n\t\t\t['     m <- length of pattern, n <- length of text'],\n\t\t\t['     i <- 0'],\n\t\t\t['     while i <= n - m'],\n\t\t\t['          j = m - 1'],\n\t\t\t['          while j >= 0 and text[i + j] = pattern[j]'],\n\t\t\t['               j -> j - 1'],\n\t\t\t['          if j = -1'],\n\t\t\t['               match found at i'],\n\t\t\t['               i <- i + 1'],\n\t\t\t['          else'],\n\t\t\t['               shift <- lastTable[text[i + j]]'],\n\t\t\t['               if shift < j'],\n\t\t\t['                    i <- i + (j - shift)'],\n\t\t\t['               else'],\n\t\t\t['                    i <- i + 1'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.GalilCode = [\n\t\t\t['procedure BoyerMooreGalil(text, pattern):'],\n\t\t\t['     initialize lastTable, failureTable'],\n\t\t\t['     m <- length of pattern, n <- length of text'],\n\t\t\t['     k <- m - failureTable[m - 1]'],\n\t\t\t['     i <- 0, w <- 0'],\n\t\t\t['     while i <= n - m'],\n\t\t\t['          j = m - 1'],\n\t\t\t['          while j >= w and text[i + j] = pattern[j]'],\n\t\t\t['               j -> j - 1'],\n\t\t\t['          if j < w'],\n\t\t\t['               match found at i'],\n\t\t\t['               i <- i + k'],\n\t\t\t['               w <- m - k'],\n\t\t\t['          else'],\n\t\t\t['               shift <- lastTable[text[i + j]]'],\n\t\t\t['               if shift < j'],\n\t\t\t['                    i <- i + (j - shift)'],\n\t\t\t['               else'],\n\t\t\t['                    i <- i + 1'],\n\t\t\t['               w <- 0'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.createLabel, this.comparisonCountID, '', COMP_COUNT_X, COMP_COUNT_Y, 0);\n\n\t\tthis.period = 1;\n\t\tthis.cmd(act.createLabel, this.periodLabelID, '', COMP_COUNT_X, PERIOD_Y, 0);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.patternTableLabelID = this.nextIndex++;\n\t\tthis.patternTableCharacterID = [];\n\t\tthis.patternTableIndexID = [];\n\t\tthis.lastTableLabelID = this.nextIndex++;\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\tthis.codeID = [];\n\t\t// this.failureTableLabelID = this.nextIndex++;\n\t\t// this.failureTableCharacterID = [];\n\t\t// this.failureTableValueID = [];\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.periodLabelID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.period = 1;\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tbuildLastOccurrenceTableCallback() {\n\t\tif (this.patternField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.onlyBuildLastOccurrenceTable.bind(this), 0, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\ttoggleGalilRule() {\n\t\tgalilRuleEnabled = !galilRuleEnabled;\n\t\t//this.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tconsole.log(this.codeID);\n\t\tif (this.codeID) {\n\t\t\tthis.removeCode(this.codeID);\n\t\t}\n\t\tthis.commands = [];\n\n\t\tconst maxRows = this.getMaxRows(text, pattern);\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tconst xpos = i * this.cellSize + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tlet xpos;\n\t\tlet ypos;\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst lastTable = this.buildLastTable(text.length, pattern);\n\t\tthis.removeCode(this.codeID);\n\t\tif (galilRuleEnabled) {\n\t\t\tthis.buildFailureTable(text.length, pattern);\n\t\t\tthis.codeID = this.addCodeToCanvasBase(\n\t\t\t\tthis.GalilCode,\n\t\t\t\tARRAY_START_X + text.length * this.cellSize + 10,\n\t\t\t\tBM_CODE_Y,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.codeID = this.addCodeToCanvasBase(\n\t\t\t\tthis.BMCode,\n\t\t\t\tARRAY_START_X + text.length * this.cellSize + 10,\n\t\t\t\tBM_CODE_Y,\n\t\t\t);\n\t\t}\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + (pattern.length - 1) * this.cellSize,\n\t\t\tARRAY_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + (pattern.length - 1) * this.cellSize,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\n\t\tlet i = 0;\n\t\tlet j = pattern.length - 1;\n\t\tlet row = 0;\n\t\tlet l = 0;\n\t\tlet gr = galilRuleEnabled ? 1 : 0;\n\t\tthis.highlight(gr + 4, 0);\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\tgr = galilRuleEnabled ? 1 : 0;\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t\tif (k - i < l) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][k], '#FFFF4D');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.highlight(gr + 5, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(gr + 5, 0);\n\t\t\tthis.highlight(gr + 6, 0);\n\t\t\twhile (j >= l && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\tj--;\n\t\t\t\tthis.highlight(gr + 7, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(gr + 7, 0);\n\t\t\t\tif (j >= 0) {\n\t\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.unhighlight(gr + 6, 0);\n\t\t\tthis.highlight(gr + 8, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(gr + 8, 0);\n\t\t\tif (j < l) {\n\t\t\t\tthis.highlight(gr + 9, 0);\n\t\t\t\tthis.highlight(gr + 10, 0);\n\t\t\t\tif (galilRuleEnabled) {\n\t\t\t\t\tthis.highlight(gr + 11, 0);\n\t\t\t\t\ti += this.period;\n\t\t\t\t\tl = pattern.length - this.period;\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(gr + 9, 0);\n\t\t\t\tthis.unhighlight(gr + 10, 0);\n\t\t\t\tthis.unhighlight(gr + 11, 0);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tif (l !== 0) {\n\t\t\t\t\tl = 0;\n\t\t\t\t}\n\t\t\t\tgr = galilRuleEnabled ? 2 : 0;\n\t\t\t\tthis.highlight(11 + gr, 0);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#E74C3C');\n\t\t\t\tlet shift;\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(11 + gr, 0);\n\t\t\t\tthis.highlight(12 + gr, 0);\n\t\t\t\tif (text.charAt(i + j) in lastTable) {\n\t\t\t\t\tshift = lastTable[text.charAt(i + j)];\n\t\t\t\t} else {\n\t\t\t\t\tshift = -1;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(12 + gr, 0);\n\t\t\t\tthis.highlight(13 + gr, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(13 + gr, 0);\n\t\t\t\tif (shift < j) {\n\t\t\t\t\tthis.highlight(14 + gr, 0);\n\t\t\t\t\ti += j - shift;\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlight(15 + gr, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(15 + gr, 0);\n\t\t\t\t\tthis.highlight(16 + gr, 0);\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(14 + gr, 0);\n\t\t\t\tthis.unhighlight(16 + gr, 0);\n\t\t\t}\n\t\t\tj = pattern.length - 1;\n\t\t\trow++;\n\t\t\tif (i <= text.length - pattern.length) {\n\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t}\n\t\t}\n\t\tgr = galilRuleEnabled ? 1 : 0;\n\t\tthis.unhighlight(gr + 4, 0);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\treturn this.commands;\n\t}\n\n\tgetMaxRows(text, pattern) {\n\t\tif (galilRuleEnabled) {\n\t\t\tconst failureTable = [];\n\t\t\tfailureTable[0] = 0;\n\t\t\tlet i = 0;\n\t\t\tlet j = 1;\n\t\t\twhile (j < pattern.length) {\n\t\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\n\t\t\t\t\ti++;\n\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\tj++;\n\t\t\t\t} else {\n\t\t\t\t\tif (i === 0) {\n\t\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\t\tj++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti = failureTable[i - 1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.period = pattern.length - failureTable[pattern.length - 1];\n\t\t}\n\t\tconst lastTable = {};\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tlastTable[pattern.charAt(i)] = i;\n\t\t}\n\t\tlet i = 0;\n\t\tlet j = pattern.length - 1;\n\t\tlet maxRows = 0;\n\t\tlet l = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\twhile (j >= l && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tj--;\n\t\t\t}\n\t\t\tif (j < l) {\n\t\t\t\tif (galilRuleEnabled) {\n\t\t\t\t\ti += this.period;\n\t\t\t\t\tl = pattern.length - this.period;\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (l !== 0) {\n\t\t\t\t\tl = 0;\n\t\t\t\t}\n\t\t\t\tlet shift;\n\t\t\t\tif (text.charAt(i + j) in lastTable) {\n\t\t\t\t\tshift = lastTable[text.charAt(i + j)];\n\t\t\t\t} else {\n\t\t\t\t\tshift = -1;\n\t\t\t\t}\n\t\t\t\tif (shift < j) {\n\t\t\t\t\ti += j - shift;\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tj = pattern.length - 1;\n\t\t\tmaxRows++;\n\t\t}\n\t\treturn maxRows;\n\t}\n\n\tonlyBuildLastOccurrenceTable(textLength, pattern) {\n\t\tthis.commands = [];\n\t\tthis.cellSize = 30;\n\t\tthis.buildLastTable(textLength, pattern);\n\t\treturn this.commands;\n\t}\n\n\tbuildLastTable(textLength, pattern) {\n\t\t// Display labels\n\t\tconst labelsX = ARRAY_START_X + textLength * this.cellSize + 10;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.patternTableLabelID,\n\t\t\t'Pattern:',\n\t\t\tlabelsX,\n\t\t\tPATTERN_START_Y - 5,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.lastTableLabelID,\n\t\t\t'Last occurence table:',\n\t\t\tlabelsX,\n\t\t\tLAST_TABLE_START_Y + 10,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.move, this.comparisonCountID, labelsX, COMP_COUNT_Y);\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.lastTableCode, labelsX, BM_CODE_Y);\n\n\t\t// Display pattern table\n\t\tconst patternTableStartX = ARRAY_START_X + textLength * this.cellSize + 80;\n\t\tthis.patternTableCharacterID = new Array(pattern.length);\n\t\tthis.patternTableIndexID = new Array(pattern.length);\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tconst xpos = patternTableStartX + i * this.cellSize;\n\t\t\tthis.patternTableCharacterID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tpattern.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tPATTERN_START_Y,\n\t\t\t);\n\t\t\tthis.patternTableIndexID[i] = this.nextIndex;\n\t\t\tthis.cmd(act.createLabel, this.nextIndex++, i, xpos, PATTERN_START_Y + this.cellSize);\n\t\t}\n\n\t\t// Create and display last occurrence table\n\t\tconst lastTable = {};\n\t\tconst lotStartX = ARRAY_START_X + textLength * this.cellSize + 155;\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\tlet j = 0;\n\n\t\tconst lotPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tlotPointerID,\n\t\t\t'#0000FF',\n\t\t\tpatternTableStartX,\n\t\t\tPATTERN_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.setHighlight, lotPointerID, 1);\n\t\tthis.highlight(2, 0);\n\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tthis.cmd(act.step);\n\t\t\tlet xpos = patternTableStartX + i * this.cellSize;\n\t\t\tthis.cmd(act.move, lotPointerID, xpos, PATTERN_START_Y);\n\t\t\tthis.highlight(3, 0);\n\t\t\tif (lastTable[pattern.charAt(i)]) {\n\t\t\t\tthis.cmd(act.setText, lastTable[pattern.charAt(i)][1], i);\n\t\t\t\tthis.cmd(act.setHighlight, lastTable[pattern.charAt(i)][1], 1);\n\t\t\t\tlastTable[pattern.charAt(i)][0] = i;\n\t\t\t} else {\n\t\t\t\txpos = lotStartX + j * this.cellSize;\n\t\t\t\tthis.lastTableCharacterID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\tpattern.charAt(i),\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\tLAST_TABLE_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t\t\tthis.lastTableValueID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\ti,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\tLAST_TABLE_START_Y + this.cellSize,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setHighlight, this.nextIndex, 1);\n\t\t\t\tj++;\n\t\t\t\tlastTable[pattern.charAt(i)] = [i, this.nextIndex++];\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.cmd(act.setHighlight, lastTable[pattern.charAt(i)][1], 0);\n\t\t}\n\t\tthis.unhighlight(2, 0);\n\n\t\t// Display '*' entry\n\t\tthis.cmd(act.delete, lotPointerID);\n\t\tconst xpos = lotStartX + j * this.cellSize;\n\t\tthis.lastTableCharacterID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.nextIndex,\n\t\t\t'*',\n\t\t\tthis.cellSize,\n\t\t\tthis.cellSize,\n\t\t\txpos,\n\t\t\tLAST_TABLE_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\tthis.lastTableValueID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.nextIndex++,\n\t\t\t'-1',\n\t\t\tthis.cellSize,\n\t\t\tthis.cellSize,\n\t\t\txpos,\n\t\t\tLAST_TABLE_START_Y + this.cellSize,\n\t\t);\n\t\tthis.highlight(4, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(4, 0);\n\n\t\tObject.keys(lastTable).map(char => (lastTable[char] = lastTable[char][0])); // Return only indices\n\t\treturn lastTable;\n\t}\n\n\tbuildFailureTable(textLength, pattern) {\n\t\tconst startIndex = this.nextIndex;\n\t\tthis.failureTableLabelID = this.nextIndex++;\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\t// Display label\n\t\tconst labelX = ARRAY_START_X + textLength * this.cellSize + 10;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.failureTableLabelID,\n\t\t\t'Failure table:',\n\t\t\tlabelX,\n\t\t\tFAILURE_TABLE_START_Y + 10,\n\t\t\t0,\n\t\t);\n\n\t\tthis.cmd(act.move, this.periodLabelID, labelX, PERIOD_Y);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.periodLabelID,\n\t\t\t'Period = pattern.length - FT[pattern.length - 1]',\n\t\t);\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.failureTableCode, labelX, GALIL_CODE_Y);\n\n\t\t// Display empty failure table\n\t\tconst tableStartX = ARRAY_START_X + textLength * this.cellSize + 110;\n\t\tthis.failureTableCharacterID = new Array(pattern.length);\n\t\tthis.failureTableValueID = new Array(pattern.length);\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tconst xpos = tableStartX + i * this.cellSize;\n\t\t\tthis.failureTableCharacterID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableCharacterID[i],\n\t\t\t\tpattern.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.failureTableCharacterID[i], '#D3D3D3');\n\t\t\tthis.failureTableValueID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableValueID[i],\n\t\t\t\t'',\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Display pointers and set first value to 0\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\ttableStartX,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#FF0000',\n\t\t\ttableStartX + this.cellSize,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.setText, this.failureTableValueID[0], 0);\n\t\tthis.highlight(3, 0);\n\t\tthis.highlight(4, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(3, 0);\n\t\tthis.unhighlight(4, 0);\n\n\t\tconst failureTable = [];\n\t\tfailureTable[0] = 0;\n\t\tlet i = 0;\n\t\tlet j = 1;\n\t\tthis.highlight(5, 0);\n\t\twhile (j < pattern.length) {\n\t\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + ++this.compCount);\n\t\t\tthis.highlight(6, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\tthis.highlight(8, 0);\n\t\t\t\ti++;\n\t\t\t\tfailureTable[j] = i;\n\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\tj++;\n\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t} else {\n\t\t\t\tthis.highlight(9, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(9, 0);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tthis.highlight(11, 0);\n\t\t\t\t\tthis.highlight(12, 0);\n\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\t\tj++;\n\t\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\t\tthis.unhighlight(12, 0);\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlight(13, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\t\tthis.highlight(14, 0);\n\t\t\t\t\ti = failureTable[i - 1];\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(14, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.unhighlight(5, 0);\n\t\tthis.highlight(15, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(15, 0);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.periodLabelID,\n\t\t\t'Period = ' + pattern.length + ' - ' + failureTable[pattern.length - 1],\n\t\t);\n\t\tconst ftPeriodLabel = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tftPeriodLabel,\n\t\t\t'#FF0000',\n\t\t\ttableStartX + this.cellSize * (pattern.length - 1),\n\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tthis.period = pattern.length - failureTable[pattern.length - 1];\n\t\tthis.cmd(act.setText, this.periodLabelID, 'Period = ' + this.period);\n\t\tthis.cmd(act.delete, ftPeriodLabel);\n\n\t\tif (this.failureTableValueID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.failureTableLabelID);\n\t\t}\n\n\t\tfor (let i = 0; i < this.failureTableCharacterID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.failureTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.failureTableValueID[i]);\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\tthis.removeCode(this.codeID);\n\n\t\tthis.nextIndex = startIndex;\n\n\t\treturn failureTable;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\n\t\tthis.comparisonMatrixID = [];\n\t\tif (this.patternTableCharacterID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.patternTableLabelID);\n\t\t}\n\n\t\tfor (let i = 0; i < this.patternTableCharacterID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.patternTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.patternTableIndexID[i]);\n\t\t}\n\n\t\tthis.patternTableCharacterID = [];\n\t\tthis.patternTableIndexID = [];\n\t\tif (this.lastTableCharacterID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.lastTableLabelID);\n\t\t}\n\n\t\tfor (let i = 0; i < this.lastTableCharacterID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.lastTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.lastTableValueID[i]);\n\t\t}\n\n\t\tthis.removeCode(this.codeID);\n\n\t\t// if (this.failureTableValueID.length !== 0) {\n\t\t// \tthis.cmd(act.delete, this.failureTableLabelID);\n\t\t// }\n\n\t\t// for (let i = 0; i < this.failureTableCharacterID.length; i++) {\n\t\t// \tthis.cmd(act.delete, this.failureTableCharacterID[i]);\n\t\t// \tthis.cmd(act.delete, this.failureTableValueID[i]);\n\t\t// }\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, '');\n\t\tthis.cmd(act.setText, this.periodLabelID, '');\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\tthis.codeID = [];\n\t\tthis.period = 1;\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 130;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 200;\n\nlet lastSwapEnabled = true;\n\nexport default class BubbleSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Last swap optimization toggle\n\t\tthis.lastSwapCheckbox = addCheckboxToAlgorithmBar('Enable last swap optimization', true);\n\t\tthis.lastSwapCheckbox.onclick = this.toggleLastSwap.bind(this);\n\t\tthis.controls.push(this.lastSwapCheckbox);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure BubbleSort(array):'],\n\t\t\t['     end <- length of array'],\n\t\t\t['     start <- 0'],\n\t\t\t['     swapped <- start'],\n\t\t\t['     while start < end'],\n\t\t\t['          swapped <- start'],\n\t\t\t['          for j <- 0, end do'],\n\t\t\t['               if arr[j] > arr[j + 1]'],\n\t\t\t['                    swap arr[j], arr[j + 1]'],\n\t\t\t['                    swapped <- j'],\n\t\t\t['               end if'],\n\t\t\t['          end for'],\n\t\t\t['          end <- swapped'],\n\t\t\t['     end while'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t\tif (!lastSwapEnabled) {\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '     while start < end and sorted is false');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '          sorted <- true');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[12][0], '          end <- end - 1');\n\t\t}\n\t\tthis.compCount = 0;\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tconsole.log(list);\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\ttoggleLastSwap() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t\tif (lastSwapEnabled) {\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '     while start < end and sorted is false');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '          sorted <- true');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[12][0], '          end <- end - 1');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     swapped <- start');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '     while start < end');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '          swapped <- start');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '                    swapped <- j');\n\t\t\tthis.cmd(act.setText, this.codeID[12][0], '          end <- swapped');\n\t\t}\n\t\tlastSwapEnabled = !lastSwapEnabled;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.compCount = 0;\n\t\tthis.displayData = [];\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\t\tthis.highlight(0, 0);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\n\t\tlet sorted = true;\n\t\tlet end = this.arrayData.length - 1;\n\t\tlet lastSwapped = 0;\n\t\tthis.highlight(4, 0);\n\t\tthis.cmd(act.step);\n\t\tdo {\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tsorted = true;\n\t\t\tthis.highlight(6, 0);\n\t\t\tfor (let i = 0; i < end; i++) {\n\t\t\t\tthis.movePointers(i, i + 1);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tif (this.arrayData[i] > this.arrayData[i + 1]) {\n\t\t\t\t\tthis.swap(i, i + 1);\n\t\t\t\t\tsorted = false;\n\t\t\t\t\tlastSwapped = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tthis.highlight(12, 0);\n\t\t\tif (lastSwapEnabled) {\n\t\t\t\tend = lastSwapped;\n\t\t\t} else {\n\t\t\t\tend--;\n\t\t\t}\n\t\t\tif (!sorted) {\n\t\t\t\tfor (let i = end + 1; i < this.arrayData.length; i++) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(12, 0);\n\t\t} while (!sorted);\n\t\tthis.highlight(4, 0);\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(4, 0);\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, ARRAY_START_Y);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.highlight(8, 0);\n\t\tthis.highlight(9, 0);\n\t\t// Change pointer colors to red\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\t// Create temporary labels and remove text in array\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\t// Move labels\n\t\tthis.cmd(act.move, iLabelID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, jLabelID, iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array and delete temporary labels\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\t// Reset pointer colors back to blue\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.unhighlight(8, 0);\n\t\tthis.unhighlight(9, 0);\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_HASH_LENGTH = 10;\nconst MAX_LOAD_LENGTH = 5;\n\nconst HASH_NUMBER_START_X = 200;\nconst HASH_X_DIFF = 7;\nconst HASH_NUMBER_START_Y = 10;\nconst HASH_ADD_START_Y = 30;\nconst HASH_INPUT_START_X = 60;\nconst HASH_INPUT_X_DIFF = 7;\nconst HASH_INPUT_START_Y = 55;\nconst HASH_ADD_LINE_Y = 42;\nconst HASH_RESULT_Y = 50;\nconst ELF_HASH_SHIFT = 10;\n\nconst HASH_LABEL_X = 200;\nconst HASH_LABEL_Y = 45;\nconst HASH_LABEL_DELTA_X = 50;\n\nconst HIGHLIGHT_COLOR = '#0000FF';\n\nexport default class Hash extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.hashingIntegers = true;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Key: ');\n\t\tthis.keyField = addControlToAlgorithmBar('Text', '');\n\t\tthis.keyField.size = MAX_HASH_LENGTH;\n\t\tthis.keyField.onkeydown = this.returnSubmit(\n\t\t\tthis.keyField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.keyField);\n\n\t\t//I'm allowing any type of data be inserted for the value, should it be restricted?\n\t\taddLabelToAlgorithmBar('Value: ');\n\t\tthis.valueField = addControlToAlgorithmBar('Text', '');\n\t\tthis.valueField.size = MAX_HASH_LENGTH;\n\t\tthis.valueField.onkeydown = this.returnSubmit(\n\t\t\tthis.valueField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.valueField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.size = MAX_HASH_LENGTH;\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.keyField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.size = MAX_HASH_LENGTH;\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.keyField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.loadField = addControlToAlgorithmBar('Text', '');\n\t\tthis.loadField.setAttribute('placeholder', 'LF/100');\n\t\tthis.loadField.size = MAX_LOAD_LENGTH;\n\t\tthis.loadField.onkeydown = this.returnSubmit(\n\t\t\tthis.loadField,\n\t\t\tthis.changeLoadFactor.bind(this),\n\t\t\tMAX_LOAD_LENGTH,\n\t\t\ttrue,\n\t\t);\n\n\t\tthis.controls.push(this.loadField);\n\n\t\tthis.loadButton = addControlToAlgorithmBar('Button', 'Load Factor');\n\t\tthis.loadButton.onclick = this.loadFactorCallBack.bind(this);\n\t\tthis.controls.push(this.loadButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Hash Integer', 'Hash Strings'],\n\t\t\t'HashType',\n\t\t);\n\t\tthis.hashIntegerButton = radioButtonList[0];\n\t\tthis.hashIntegerButton.onclick = this.changeHashTypeCallback.bind(this, true);\n\t\tthis.controls.push(this.hashIntegerButton);\n\t\tthis.hashStringButton = radioButtonList[1];\n\t\tthis.hashStringButton.onclick = this.changeHashTypeCallback.bind(this, false);\n\t\tthis.hashIntegerButton.checked = true;\n\t\tthis.controls.push(this.hashStringButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\t// Do this extra level of wrapping to get undo to work properly.\n\t// (also, so that we only implement the action if we are changing the\n\t// radio button)\n\tchangeHashTypeCallback(newHashingIntegers) {\n\t\tif (this.hashingIntegers !== newHashingIntegers) {\n\t\t\tthis.implementAction(this.changeHashType.bind(this), newHashingIntegers);\n\t\t}\n\t}\n\n\tchangeHashType(newHashingIntegerValue) {\n\t\tthis.hashingIntegers = newHashingIntegerValue;\n\t\tif (this.hashingIntegers) {\n\t\t\tthis.hashIntegerButton.checked = true;\n\t\t\tthis.keyField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.insertCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.deleteCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.findCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.hashStringButton.checked = true;\n\t\t\tthis.keyField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.insertCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.deleteCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.findCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t}\n\t\treturn this.resetAll();\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tdoHash(input) {\n\t\tif (this.hashingIntegers) {\n\t\t\tconst labelID1 = this.nextIndex++;\n\t\t\tconst labelID2 = this.nextIndex++;\n\t\t\tconst highlightID = this.nextIndex++;\n\t\t\tconst index = parseInt(input) % this.table_size;\n\t\t\tthis.currHash = parseInt(input);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabelID1,\n\t\t\t\tinput + ' % ' + String(this.table_size) + ' = ',\n\t\t\t\tHASH_LABEL_X,\n\t\t\t\tHASH_LABEL_Y,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabelID2,\n\t\t\t\tindex,\n\t\t\t\tHASH_LABEL_X + HASH_LABEL_DELTA_X,\n\t\t\t\tHASH_LABEL_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightID,\n\t\t\t\tHIGHLIGHT_COLOR,\n\t\t\t\tHASH_LABEL_X + HASH_LABEL_DELTA_X,\n\t\t\t\tHASH_LABEL_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.move, highlightID, this.indexXPos[index], this.indexYPos[index]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, labelID1);\n\t\t\tthis.cmd(act.delete, labelID2);\n\t\t\tthis.cmd(act.delete, highlightID);\n\t\t\tthis.nextIndex -= 3;\n\n\t\t\treturn index;\n\t\t} else {\n\t\t\tconst label1 = this.nextIndex++;\n\t\t\tthis.cmd(act.createLabel, label1, 'Hashing:', 10, 55, 0);\n\t\t\tconst wordToHashID = new Array(input.length);\n\t\t\tconst wordToHash = new Array(input.length);\n\t\t\tfor (let i = 0; i < input.length; i++) {\n\t\t\t\twordToHashID[i] = this.nextIndex++;\n\t\t\t\twordToHash[i] = input.charAt(i);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\twordToHashID[i],\n\t\t\t\t\twordToHash[i],\n\t\t\t\t\tHASH_INPUT_START_X + i * HASH_INPUT_X_DIFF,\n\t\t\t\t\tHASH_INPUT_START_Y,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t}\n\t\t\tconst digits = new Array(32);\n\t\t\tconst hashValue = new Array(32);\n\t\t\tconst nextByte = new Array(8);\n\t\t\tconst nextByteID = new Array(8);\n\t\t\tconst resultDigits = new Array(32);\n\t\t\tconst floatingDigits = new Array(4);\n\t\t\tconst floatingVals = new Array(4);\n\n\t\t\tconst operatorID = this.nextIndex++;\n\t\t\tconst barID = this.nextIndex++;\n\t\t\tfor (let i = 0; i < 32; i++) {\n\t\t\t\thashValue[i] = 0;\n\t\t\t\tdigits[i] = this.nextIndex++;\n\t\t\t\tresultDigits[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tfor (let i = 0; i < 8; i++) {\n\t\t\t\tnextByteID[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\tfloatingDigits[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = wordToHash.length - 1; i >= 0; i--) {\n\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tdigits[j],\n\t\t\t\t\t\thashValue[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, wordToHashID[i]);\n\t\t\t\tlet nextChar = wordToHash[i].charCodeAt(0);\n\t\t\t\tfor (let j = 7; j >= 0; j--) {\n\t\t\t\t\tnextByte[j] = nextChar % 2;\n\t\t\t\t\tnextChar = Math.floor(nextChar / 2);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tnextByteID[j],\n\t\t\t\t\t\tnextByte[j],\n\t\t\t\t\t\tHASH_INPUT_START_X + i * HASH_INPUT_X_DIFF,\n\t\t\t\t\t\tHASH_INPUT_START_Y,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tnextByteID[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + (j + 24) * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_ADD_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tbarID,\n\t\t\t\t\t'',\n\t\t\t\t\t32 * HASH_X_DIFF,\n\t\t\t\t\t0,\n\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\tHASH_ADD_LINE_Y,\n\t\t\t\t\t'left',\n\t\t\t\t\t'bottom',\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\toperatorID,\n\t\t\t\t\t'+',\n\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\tHASH_ADD_START_Y,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tlet carry = 0;\n\t\t\t\tfor (let j = 7; j >= 0; j--) {\n\t\t\t\t\thashValue[j + 24] = hashValue[j + 24] + nextByte[j] + carry;\n\t\t\t\t\tif (hashValue[j + 24] > 1) {\n\t\t\t\t\t\thashValue[j + 24] = hashValue[j + 24] - 2;\n\t\t\t\t\t\tcarry = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcarry = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (let j = 23; j >= 0; j--) {\n\t\t\t\t\thashValue[j] = hashValue[j] + carry;\n\t\t\t\t\tif (hashValue[j] > 1) {\n\t\t\t\t\t\thashValue[j] = hashValue[j] - 2;\n\t\t\t\t\t\tcarry = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcarry = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\thashValue[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_RESULT_Y,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tfor (let j = 0; j < 8; j++) {\n\t\t\t\t\tthis.cmd(act.delete, nextByteID[j]);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, barID);\n\t\t\t\tthis.cmd(act.delete, operatorID);\n\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\tthis.cmd(act.delete, digits[j]);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j - 4) * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tfor (let j = 0; j < 28; j++) {\n\t\t\t\t\t\tfloatingVals[j] = hashValue[j];\n\t\t\t\t\t\thashValue[j] = hashValue[j + 4];\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j + ELF_HASH_SHIFT) * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_ADD_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\thashValue[j + 28] = 0;\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tfloatingDigits[j],\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j + 28) * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (floatingVals[j]) {\n\t\t\t\t\t\t\thashValue[j + ELF_HASH_SHIFT] = 1 - hashValue[j + ELF_HASH_SHIFT];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createRectangle,\n\t\t\t\t\t\tbarID,\n\t\t\t\t\t\t'',\n\t\t\t\t\t\t32 * HASH_X_DIFF,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\t\tHASH_ADD_LINE_Y,\n\t\t\t\t\t\t'left',\n\t\t\t\t\t\t'bottom',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\toperatorID,\n\t\t\t\t\t\t'XOR',\n\t\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\t\tHASH_ADD_START_Y,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tdigits[j],\n\t\t\t\t\t\t\thashValue[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_RESULT_Y,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tthis.cmd(act.delete, operatorID);\n\t\t\t\t\tthis.cmd(act.delete, barID);\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, resultDigits[j]);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tdigits[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, floatingDigits[j]);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, digits[j]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, resultDigits[j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.delete, label1);\n\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tdigits[j],\n\t\t\t\t\thashValue[j],\n\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.currHash = 0;\n\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\tthis.currHash = this.currHash * 2 + hashValue[j];\n\t\t\t}\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabel1,\n\t\t\t\t' = ' + String(this.currHash),\n\t\t\t\tHASH_NUMBER_START_X + 32 * HASH_X_DIFF,\n\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t0,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\tthis.cmd(act.delete, digits[j]);\n\t\t\t}\n\n\t\t\tconst label2 = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tlabel1,\n\t\t\t\tString(this.currHash) + ' % ' + String(this.table_size) + ' = ',\n\t\t\t);\n\t\t\tconst index = this.currHash % this.table_size;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabel2,\n\t\t\t\tindex,\n\t\t\t\tHASH_NUMBER_START_X + 32 * HASH_X_DIFF + 105,\n\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t0,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tconst highlightID = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightID,\n\t\t\t\tHIGHLIGHT_COLOR,\n\t\t\t\tHASH_NUMBER_START_X + 30 * HASH_X_DIFF + 120,\n\t\t\t\tHASH_NUMBER_START_Y + 15,\n\t\t\t);\n\t\t\tthis.cmd(act.move, highlightID, this.indexXPos[index], this.indexYPos[index]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, highlightID);\n\t\t\tthis.cmd(act.delete, label1);\n\t\t\tthis.cmd(act.delete, label2);\n\n\t\t\treturn index;\n\t\t}\n\t}\n\n\tresetAll() {\n\t\tthis.keyField.value = '';\n\t\tthis.valueField.value = '';\n\t\tthis.deleteField.value = '';\n\t\tthis.findField.value = '';\n\t\treturn [];\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedKey = this.keyField.value;\n\t\tconst insertedValue = this.valueField.value;\n\t\tif (insertedKey !== '' && insertedValue !== '') {\n\t\t\tthis.keyField.value = '';\n\t\t\tthis.valueField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), insertedKey, insertedValue);\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tconst deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.deleteElement.bind(this), deletedValue);\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), findValue);\n\t\t}\n\t}\n\n\tloadFactorCallBack() {\n\t\tif (this.loadField.value !== '') {\n\t\t\tconst newLF = this.loadField.value / 100;\n\t\t\tthis.loadField.value = '';\n\t\t\tthis.implementAction(this.changeLoadFactor.bind(this), newLF);\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.hashIntegerButton.checked = true;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport { addDivisorToAlgorithmBar, addRadioButtonGroupToAlgorithmBar } from './Algorithm.js';\nimport Hash from './Hash.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_ELEM_WIDTH = 60;\nconst ARRAY_ELEM_HEIGHT = 30;\nconst ARRAY_ELEM_START_Y = 110;\nconst ARRAY_VERTICAL_SEPARATION = 70;\n\nconst CLOSED_HASH_TABLE_SIZE = 13;\n\nconst ARRAY_ELEM_START_X = 100;\n// If you want to center the array:\n// const ARRAY_ELEM_START_X = (window.screen.width - CLOSED_HASH_TABLE_SIZE * ARRAY_ELEM_WIDTH + ARRAY_ELEM_WIDTH) / 2;\nconst ARRAY_RESIZE_ELEM_START_Y = 240;\nconst ELEMS_PER_ROW = 14;\n\nconst LOAD_LABEL_X = 60;\nconst LOAD_LABEL_Y = 20;\n\nconst HASH2_LABEL_X = 270;\nconst HASH2_LABEL_Y = 70;\n\nconst RESIZE_LABEL_X = 400;\nconst RESIZE_LABEL_Y = 20;\n\nconst DEFAULT_LOAD_FACTOR = 0.67;\n\nconst MAX_SIZE = 70;\n\nconst INDEX_COLOR = '#0000FF';\n\nexport default class ClosedHash extends Hash {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.elements_per_row = ELEMS_PER_ROW;\n\t\t//this.elements_per_row = Math.floor(w / ARRAY_ELEM_WIDTH) - 1;\n\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tsuper.addControls();\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t[\n\t\t\t\t'Linear Probing: f(i) = i',\n\t\t\t\t'Quadratic Probing: f(i) = i * i',\n\t\t\t\t'Double Hashing: f(i) = i * hash2(elem)',\n\t\t\t],\n\t\t\t'Collision Strategy: h(elem) + f(i)',\n\t\t);\n\t\tthis.linearProblingButton = radioButtonList[0];\n\t\tthis.linearProblingButton.onclick = this.linearProbeCallback.bind(this);\n\t\tthis.quadraticProbingButton = radioButtonList[1];\n\t\tthis.quadraticProbingButton.onclick = this.quadraticProbeCallback.bind(this);\n\t\tthis.doubleHashingButton = radioButtonList[2];\n\t\tthis.doubleHashingButton.onclick = this.doubleHashingCallback.bind(this);\n\n\t\tthis.linearProblingButton.checked = true;\n\t\tthis.currentHashingTypeButtonState = this.linearProblingButton;\n\n\t\t// Add new controls\n\t}\n\n\tchangeProbeType(newProbingType) {\n\t\tif (newProbingType === this.linearProblingButton) {\n\t\t\tthis.linearProblingButton.checked = true;\n\t\t\tthis.currentHashingTypeButtonState = this.linearProblingButton;\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = i + 1;\n\t\t\t}\n\t\t} else if (newProbingType === this.quadraticProbingButton) {\n\t\t\tthis.quadraticProbingButton.checked = true;\n\t\t\tthis.currentHashingTypeButtonState = this.quadraticProbingButton;\n\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = (i + 1) * (i + 1);\n\t\t\t}\n\t\t} else if (newProbingType === this.doubleHashingButton) {\n\t\t\tthis.doubleHashingButton.checked = true;\n\t\t\tthis.currentHashingTypeButtonState = this.doubleHashingButton;\n\t\t}\n\t\tthis.commands = this.resetAll();\n\t\treturn this.commands;\n\t}\n\n\tquadraticProbeCallback() {\n\t\tif (this.currentHashingTypeButtonState !== this.quadraticProbingButton) {\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.quadraticProbingButton);\n\t\t}\n\t}\n\n\tdoubleHashingCallback() {\n\t\tif (this.currentHashingTypeButtonState !== this.doubleHashingButton) {\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.doubleHashingButton);\n\t\t}\n\t}\n\n\tlinearProbeCallback() {\n\t\tif (this.currentHashingTypeButtonState !== this.linearProblingButton) {\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.linearProblingButton);\n\t\t}\n\t}\n\n\tinsertElement(key, value) {\n\t\tconst entry = new MapEntry(key, value);\n\t\tconst elem = entry.elem;\n\t\tthis.commands = [];\n\n\t\tif (\n\t\t\t(this.size + 1) / this.table_size > this.load_factor &&\n\t\t\tthis.table_size * 2 + 1 < MAX_SIZE\n\t\t) {\n\t\t\tthis.resize(false);\n\t\t}\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting element: ' + elem);\n\t\tthis.cmd(act.step);\n\n\t\tlet index = this.doHash(key);\n\n\t\tindex = this.getEmptyIndex(index, key);\n\n\t\tif (index === -2 && this.table_size * 2 < MAX_SIZE) {\n\t\t\tthis.resize(true);\n\t\t} else if (index === -2) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t`Array would normally resize after length number of probes,\n\t\t\t\thowever there just isn't enough space on the screen to resize. \n\t\t\t\tSo here's a cute emoji of jack instead: V•ᴥ•V`,\n\t\t\t);\n\t\t\treturn this.commands;\n\t\t}\n\n\t\tif (\n\t\t\tthis.hashTableValues[index] &&\n\t\t\tthis.hashTableValues[index].key === key &&\n\t\t\t!this.deleted[index]\n\t\t) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Key ' + key + ' is already in HashMap, updating value.',\n\t\t\t\t``,\n\t\t\t);\n\t\t\tthis.size--;\n\t\t}\n\n\t\tconst labID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, labID, elem, 20, 25);\n\t\tthis.cmd(act.move, labID, this.indexXPos[index], this.indexYPos[index] - ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, labID);\n\t\tthis.cmd(act.setText, this.hashTableVisual[index], elem);\n\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\tthis.hashTableValues[index] = entry;\n\t\tthis.empty[index] = false;\n\t\tthis.deleted[index] = false;\n\t\tthis.size++;\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\t\tthis.cmd(act.setText, this.DelIndexLabel, '');\n\t\treturn this.commands;\n\t}\n\n\tresetSkipDist(key, labelID) {\n\t\tconst skipVal = this.nextLowestPrime - (this.currHash % this.nextLowestPrime);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabelID,\n\t\t\t`hash2(${String(key)}) = ` +\n\t\t\t\t`${this.nextLowestPrime} - ${String(this.currHash)} % ${\n\t\t\t\t\tthis.nextLowestPrime\n\t\t\t\t} = ${String(skipVal)}`,\n\t\t\tHASH2_LABEL_X,\n\t\t\tHASH2_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.skipDist[0] = skipVal;\n\t\tfor (let i = 1; i < this.table_size; i++) {\n\t\t\tthis.skipDist[i] = this.skipDist[i - 1] + skipVal;\n\t\t}\n\t\treturn skipVal;\n\t}\n\n\tgetEmptyIndex(index, key) {\n\t\tlet HashID = -1;\n\t\tlet skipVal = 1;\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\n\t\t\tHashID = this.nextIndex++;\n\t\t\tskipVal = this.resetSkipDist(key, HashID);\n\t\t}\n\n\t\tlet probes = 0;\n\t\tlet removedIndex = -1;\n\t\tconst start = index;\n\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 1);\n\t\twhile (\n\t\t\tprobes < this.table_size &&\n\t\t\t!this.empty[index] &&\n\t\t\t!(this.hashTableValues[index].key === key)\n\t\t) {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, `Entry occupied, so probe forward`);\n\t\t\tthis.cmd(act.step);\n\t\t\t// storing removed index\n\t\t\tif (removedIndex === -1 && this.deleted[index]) {\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Storing index of first deleted element');\n\t\t\t\tthis.cmd(act.setText, this.DelIndexLabel, 'First Deleted Index: ' + index);\n\t\t\t\tremovedIndex = index;\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\n\t\t\t// increment index and clear labels\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\n\t\t\tindex = (start + this.skipDist[probes]) % this.table_size;\n\n\t\t\tif (this.currentHashingTypeButtonState === this.quadraticProbingButton) {\n\t\t\t\tskipVal = probes + 1;\n\t\t\t}\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.HashIndexID,\n\t\t\t\t`Index to probe: (${start} + ${probes + 1}*${skipVal}) % ${this.table_size} =` +\n\t\t\t\t\t` ${(start + this.skipDist[probes]) % this.table_size}`,\n\t\t\t);\n\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 1);\n\t\t\tif (this.empty[index]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.ExplainLabel,\n\t\t\t\t\t'Encountered null spot, so terminate loop',\n\t\t\t\t);\n\t\t\t} else if (this.hashTableValues[index].key === key) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.ExplainLabel,\n\t\t\t\t\t`Encountered matching key, so terminate loop`,\n\t\t\t\t);\n\t\t\t}\n\t\t\tprobes++;\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tthis.cmd(act.setText, this.HashIndexID, '');\n\n\t\tif (HashID !== -1) {\n\t\t\tthis.cmd(act.delete, HashID);\n\t\t\tthis.nextIndex--;\n\t\t}\n\n\t\tif (!this.empty[index] && this.hashTableValues[index].key === key && !this.deleted[index]) {\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\treturn index;\n\t\t} else if (probes === this.table_size && removedIndex === -1) {\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\treturn -2;\n\t\t} else {\n\t\t\tif (removedIndex !== -1) {\n\t\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting at earlier DEL spot');\n\t\t\t\tindex = removedIndex;\n\t\t\t} else if (this.hashTableValues[index] == null) {\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting at null spot');\n\t\t\t} else if (this.hashTableValues[index].key === key) {\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting at DEL spot with same key');\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\treturn removedIndex !== -1 ? removedIndex : index;\n\t\t}\n\t}\n\n\tgetElemIndex(index, key) {\n\t\tlet HashID = -1;\n\t\tlet skipVal = 1;\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\n\t\t\tHashID = this.nextIndex++;\n\t\t\tskipVal = this.resetSkipDist(key, HashID);\n\t\t}\n\n\t\tconst start = index;\n\t\tlet foundIndex = -1;\n\t\tlet candidateIndex = index;\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 0);\n\t\t\tif (\n\t\t\t\t!this.empty[candidateIndex] &&\n\t\t\t\t!this.deleted[candidateIndex] &&\n\t\t\t\tthis.hashTableValues[candidateIndex].key === key\n\t\t\t) {\n\t\t\t\tfoundIndex = candidateIndex;\n\t\t\t\tbreak;\n\t\t\t} else if (\n\t\t\t\tthis.empty[candidateIndex] ||\n\t\t\t\t(this.deleted[candidateIndex] && this.hashTableValues[candidateIndex].key === key)\n\t\t\t) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (this.currentHashingTypeButtonState === this.quadraticProbingButton) {\n\t\t\t\tskipVal = i + 1;\n\t\t\t}\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.HashIndexID,\n\t\t\t\t`Index to probe: (${start} + ${i + 1}*${skipVal}) % ${this.table_size} =` +\n\t\t\t\t\t` ${(start + this.skipDist[i]) % this.table_size}`,\n\t\t\t);\n\t\t\tcandidateIndex = (index + this.skipDist[i]) % this.table_size;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.HashIndexID, '');\n\t\tif (HashID !== -1) {\n\t\t\tthis.cmd(act.delete, HashID);\n\t\t\tthis.nextIndex--;\n\t\t}\n\n\t\treturn foundIndex;\n\t}\n\n\tdeleteElement(key) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Deleting element with key: ' + key);\n\t\tlet index = this.doHash(key);\n\n\t\tindex = this.getElemIndex(index, key);\n\n\t\tif (index >= 0) {\n\t\t\tconst elem = this.hashTableValues[index].elem;\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting element: ' + elem + '  Element deleted',\n\t\t\t);\n\t\t\t// this.empty[index] = true;\n\t\t\tthis.deleted[index] = true;\n\t\t\tthis.cmd(act.setText, this.hashTableVisual[index], 'DEL');\n\t\t\tthis.size--;\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting element with key: ' + key + '  Key not in table',\n\t\t\t);\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tfindElement(key) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Key: ' + key);\n\t\tconst index = this.doHash(key);\n\n\t\tconst found = this.getElemIndex(index, key) !== -1;\n\t\tif (found) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Found Key: ' + key + '  Value: ' + this.hashTableValues[index].val,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Key: ' + key + '  Not Found!');\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tresize(fromCycle) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\t\tthis.cmd(act.setText, this.DelIndexLabel, '');\n\n\t\tconst resizeLabel = this.nextIndex++;\n\t\tif (!fromCycle) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tresizeLabel,\n\t\t\t\t`(Resize Required): (Size + 1 / length) > Load Factor --> (${this.size} + 1 / ${this.table_size}) > ${this.load_factor}`,\n\t\t\t\tRESIZE_LABEL_X,\n\t\t\t\tRESIZE_LABEL_Y,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tresizeLabel,\n\t\t\t\t`(Resize Required): ${this.table_size} elements probed`,\n\t\t\t\tRESIZE_LABEL_X,\n\t\t\t\tRESIZE_LABEL_Y,\n\t\t\t);\n\t\t}\n\n\t\tthis.table_size = this.table_size * 2 + 1;\n\n\t\tif (this.table_size * 2 + 1 > MAX_SIZE) {\n\t\t\tthis.load_factor = 0.99;\n\t\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\t\t}\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.oldHashTableVisual = this.hashTableVisual;\n\t\tthis.oldHashTableValues = this.hashTableValues;\n\t\tthis.oldskipDist = this.skipDist;\n\t\tthis.oldempty = this.empty;\n\t\tthis.olddeleted = this.deleted;\n\t\tthis.oldIndexXPos = this.indexXPos;\n\t\tthis.oldIndexYPos = this.indexYPos;\n\t\tthis.oldindexLabelID = this.indexLabelID;\n\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.skipDist = new Array(this.table_size);\n\t\tthis.empty = new Array(this.table_size);\n\t\tthis.deleted = new Array(this.table_size);\n\t\tthis.indexXPos = new Array(this.table_size);\n\t\tthis.indexYPos = new Array(this.table_size);\n\t\tthis.indexLabelID = new Array(this.table_size);\n\n\t\tif (this.currentHashingTypeButtonState === this.linearProblingButton) {\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = i + 1;\n\t\t\t}\n\t\t} else if (this.currentHashingTypeButtonState === this.quadraticProbingButton) {\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = (i + 1) * (i + 1);\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\n\t\t\tconst nextYPos =\n\t\t\t\tARRAY_RESIZE_ELEM_START_Y +\n\t\t\t\tMath.floor(i / this.elements_per_row) * ARRAY_VERTICAL_SEPARATION;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.hashTableVisual[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\tnextXPos,\n\t\t\t\tnextYPos,\n\t\t\t);\n\t\t\tthis.indexLabelID[i] = this.nextIndex++;\n\t\t\tthis.indexXPos[i] = nextXPos;\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.indexLabelID[i],\n\t\t\t\ti,\n\t\t\t\tthis.indexXPos[i],\n\t\t\t\tthis.indexYPos[i],\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.indexLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tlet elementsMoved = 0;\n\n\t\tfor (let i = 0; i < this.table_size / 2 && elementsMoved < this.size; i++) {\n\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 1);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (!this.oldempty[i] && !this.olddeleted[i]) {\n\t\t\t\tconst oldElement = this.oldHashTableValues[i];\n\n\t\t\t\tlet index = this.doHash(oldElement.key);\n\n\t\t\t\tindex = this.getEmptyIndex(index, oldElement.key);\n\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tconst labID = this.nextIndex++;\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tlabID,\n\t\t\t\t\t\toldElement.elem,\n\t\t\t\t\t\tthis.oldIndexXPos[i],\n\t\t\t\t\t\tthis.oldIndexYPos[i] - ARRAY_ELEM_HEIGHT,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tlabID,\n\t\t\t\t\t\tthis.indexXPos[index],\n\t\t\t\t\t\tthis.indexYPos[index] - ARRAY_ELEM_HEIGHT,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, labID);\n\t\t\t\t\tthis.cmd(act.setText, this.hashTableVisual[index], oldElement.elem);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\t\t\tthis.hashTableValues[index] = oldElement;\n\t\t\t\t\tthis.empty[index] = false;\n\t\t\t\t\tthis.deleted[index] = false;\n\t\t\t\t\telementsMoved++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 0);\n\t\t}\n\n\t\tthis.cmd(act.delete, resizeLabel);\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\n\t\t\tconst nextYPos =\n\t\t\t\tARRAY_ELEM_START_Y +\n\t\t\t\tMath.floor(i / this.elements_per_row) * ARRAY_VERTICAL_SEPARATION;\n\t\t\tif (i < (this.table_size - 1) / 2) {\n\t\t\t\tthis.cmd(act.delete, this.oldHashTableVisual[i]);\n\t\t\t\tthis.cmd(act.delete, this.oldindexLabelID[i]);\n\t\t\t}\n\t\t\tthis.cmd(act.move, this.hashTableVisual[i], nextXPos, nextYPos);\n\t\t\tthis.cmd(act.move, this.indexLabelID[i], nextXPos, nextYPos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tchangeLoadFactor(LF) {\n\t\tthis.commands = [];\n\n\t\tif (this.table_size * 2 + 1 <= MAX_SIZE) {\n\t\t\tthis.load_factor = LF;\n\t\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.loadFactorID,\n\t\t\t\t`Load Factor: ${this.load_factor}\n\t\t\t(Max Array Length)`,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tsetup() {\n\t\tthis.resetIndex = this.nextIndex;\n\t\tthis.table_size = CLOSED_HASH_TABLE_SIZE;\n\t\tthis.nextLowestPrime = 11;\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\n\t\tthis.skipDist = new Array(this.table_size);\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.size = 0;\n\n\t\tthis.indexLabelID = new Array(this.table_size);\n\t\tthis.indexXPos = new Array(this.table_size);\n\t\tthis.indexYPos = new Array(this.table_size);\n\n\t\tthis.empty = new Array(this.table_size);\n\t\tthis.deleted = new Array(this.table_size);\n\n\t\tthis.ExplainLabel = this.nextIndex++;\n\n\t\tthis.HashIndexID = this.nextIndex++;\n\n\t\t// stores deleted index\n\t\tthis.DelIndexLabel = this.nextIndex++;\n\n\t\t// stores the load factor\n\t\tthis.loadFactorID = this.nextIndex++;\n\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.skipDist[i] = i + 1; // Start with linear probing\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\n\t\t\tconst nextYPos =\n\t\t\t\tARRAY_ELEM_START_Y +\n\t\t\t\tMath.floor(i / this.elements_per_row) * ARRAY_VERTICAL_SEPARATION;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.hashTableVisual[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\tnextXPos,\n\t\t\t\tnextYPos,\n\t\t\t);\n\t\t\tthis.indexLabelID[i] = this.nextIndex++;\n\t\t\tthis.indexXPos[i] = nextXPos;\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.indexLabelID[i],\n\t\t\t\ti,\n\t\t\t\tthis.indexXPos[i],\n\t\t\t\tthis.indexYPos[i],\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.indexLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, this.ExplainLabel, '', 10, 40, 0);\n\t\tthis.cmd(act.createLabel, this.HashIndexID, '', HASH2_LABEL_X + 300, HASH2_LABEL_Y + 5);\n\t\tthis.cmd(act.createLabel, this.DelIndexLabel, '', 10, 60, 0);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.loadFactorID,\n\t\t\t`Load Factor: ${this.load_factor}`,\n\t\t\tLOAD_LABEL_X,\n\t\t\tLOAD_LABEL_Y,\n\t\t);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tresetAll() {\n\t\tthis.commands = super.resetAll();\n\n\t\tthis.size = 0;\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\t\t\tthis.hashTableValues[i] = undefined;\n\t\t\tthis.cmd(act.setText, this.hashTableVisual[i], '');\n\t\t}\n\n\t\treturn this.commands;\n\t\t// Clear array, etc\n\t}\n\n\t// NEED TO OVERRIDE IN PARENT\n\treset() {\n\t\tthis.nextIndex = this.resetIndex;\n\t\tthis.table_size = CLOSED_HASH_TABLE_SIZE;\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\n\t\tthis.size = 0;\n\n\t\tthis.empty = new Array(this.table_size);\n\t\tthis.deleted = new Array(this.table_size);\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.indexLabelID = new Array(this.table_size);\n\n\t\tthis.ExplainLabel = this.nextIndex++;\n\n\t\tthis.HashIndexID = this.nextIndex++;\n\n\t\t// stores deleted index\n\t\tthis.DelIndexLabel = this.nextIndex++;\n\n\t\t// stores the load factor\n\t\tthis.loadFactorID = this.nextIndex++;\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\n\t\t\tthis.indexLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tsuper.reset();\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\t\t\n\t\t\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.cmd(act.delete, this.hashTableVisual[i]);\n\t\t\tthis.cmd(act.delete, this.indexLabelID[i]);\n\t\t}\n\n\t\tthis.table_size = CLOSED_HASH_TABLE_SIZE;\n\t\tthis.empty = Array(this.table_size);\n\t\tthis.deleted = Array(this.table_size);\n\t\tconst newHashTableVisual = Array(this.table_size);\n\t\tconst newIndexLabelID = Array(this.table_size);\n\t\tthis.hashTableValues = Array(this.table_size);\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\n\t\t\tnewHashTableVisual[i] = this.nextIndex++;\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\n\t\t\tconst nextYPos =\n\t\t\t\tARRAY_ELEM_START_Y +\n\t\t\t\tMath.floor(i / this.elements_per_row) * ARRAY_VERTICAL_SEPARATION;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tnewHashTableVisual[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\tnextXPos,\n\t\t\t\tnextYPos,\n\t\t\t);\n\n\t\t\tnewIndexLabelID[i] = this.nextIndex++;\n\t\t\tthis.indexXPos[i] = nextXPos;\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tnewIndexLabelID[i],\n\t\t\t\ti,\n\t\t\t\tthis.indexXPos[i],\n\t\t\t\tthis.indexYPos[i],\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, newIndexLabelID[i], INDEX_COLOR);\n\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\t\t\tthis.hashTableValues[i] = undefined;\n\t\t}\n\t\tthis.size = 0;\n\t\tthis.hashTableVisual = newHashTableVisual;\n\t\tthis.indexLabelID = newIndexLabelID;\n\t\treturn this.commands;\n\t}\n\n\tresetCallback() {}\n\n\tdisableUI() {\n\t\tsuper.disableUI();\n\t\tthis.linearProblingButton.disabled = true;\n\t\tthis.quadraticProbingButton.disabled = true;\n\t\tthis.doubleHashingButton.disabled = true;\n\t}\n\n\tenableUI() {\n\t\tsuper.enableUI();\n\t\tthis.linearProblingButton.disabled = false;\n\t\tthis.quadraticProbingButton.disabled = false;\n\t\tthis.doubleHashingButton.disabled = false;\n\t}\n}\n\nclass MapEntry {\n\tconstructor(key, val) {\n\t\tthis.key = key;\n\t\tthis.val = val;\n\t\tthis.elem = `<${key}, ${val}>`;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 120;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 180;\n\nlet lastSwapEnabled = true;\n\nexport default class CocktailSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Last swap optimization toggle\n\t\tthis.lastSwapCheckbox = addCheckboxToAlgorithmBar('Enable last swap optimization', true);\n\t\tthis.lastSwapCheckbox.onclick = this.toggleLastSwap.bind(this);\n\t\tthis.controls.push(this.lastSwapCheckbox);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure CocktailSort(array):'],\n\t\t\t['     start <- 0, end <- length of array - 1'],\n\t\t\t['     swapped <- start'],\n\t\t\t['     while end > start'],\n\t\t\t['          swapped <- start'],\n\t\t\t['          for i <- start, end do'],\n\t\t\t['               if array[i] > array[i + 1]'],\n\t\t\t['                    swap array[i], array[i + 1]'],\n\t\t\t['                    swapped <- i'],\n\t\t\t['               end if'],\n\t\t\t['          end for'],\n\t\t\t['          end <- swapped'],\n\t\t\t['          for i <- end, start do'],\n\t\t\t['               if array[i] < array[i - 1]'],\n\t\t\t['                    swap array[i], array[i - 1]'],\n\t\t\t['                    swapped <- i'],\n\t\t\t['               end if'],\n\t\t\t['          end for'],\n\t\t\t['          start <- swapped'],\n\t\t\t['     end while'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tconsole.log(this.nextIndex);\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.compCount = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t\tif (!lastSwapEnabled) {\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     while start < end and sorted is false');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          sorted <- true');\n\t\t\tthis.cmd(act.setText, this.codeID[8][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[11][0], '          end <- end - 1');\n\t\t\tthis.cmd(act.setText, this.codeID[15][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[18][0], '          start <- start + 1');\n\t\t}\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\ttoggleLastSwap() {\n\t\tif (lastSwapEnabled) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     while start < end and sorted is false');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          sorted <- true');\n\t\t\tthis.cmd(act.setText, this.codeID[8][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[11][0], '          end <- end - 1');\n\t\t\tthis.cmd(act.setText, this.codeID[15][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[18][0], '          start <- start + 1');\n\t\t} else {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     swapped <- start');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     while start < end');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          swapped <- start');\n\t\t\tthis.cmd(act.setText, this.codeID[8][0], '                    swapped <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[11][0], '          end <- swapped');\n\t\t\tthis.cmd(act.setText, this.codeID[15][0], '                    swapped <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[18][0], '          start <- swapped');\n\t\t}\n\t\tlastSwapEnabled = !lastSwapEnabled;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.compCount = 0;\n\t\tthis.displayData = [];\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\t\tthis.highlight(0, 0);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\t\tconst length = this.arrayData.length;\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\n\t\tlet sorted = true;\n\t\tlet start = 0;\n\t\tlet end = this.arrayData.length - 1;\n\t\tlet lastSwapped = 0;\n\t\tthis.highlight(3, 0);\n\t\tthis.cmd(act.step);\n\t\tdo {\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tsorted = true;\n\t\t\tfor (let i = start; i < end; i++) {\n\t\t\t\tthis.movePointers(i, i + 1);\n\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\tthis.highlight(6, 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tif (this.arrayData[i] > this.arrayData[i + 1]) {\n\t\t\t\t\tthis.highlight(7, 0);\n\t\t\t\t\tthis.highlight(8, 0);\n\t\t\t\t\tthis.swap(i, i + 1);\n\t\t\t\t\tsorted = false;\n\t\t\t\t\tlastSwapped = i;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.highlight(11, 0);\n\t\t\tif (lastSwapEnabled) {\n\t\t\t\tend = lastSwapped;\n\t\t\t} else {\n\t\t\t\tend--;\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(11, 0);\n\t\t\tif (!sorted) {\n\t\t\t\tfor (let i = end + 1; i < this.arrayData.length; i++) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.highlight(12, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (!sorted) {\n\t\t\t\tsorted = true;\n\t\t\t\tfor (let i = end; i > start; i--) {\n\t\t\t\t\tthis.movePointers(i - 1, i);\n\t\t\t\t\tthis.unhighlight(12, 0);\n\t\t\t\t\tthis.highlight(13, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\t\tif (+this.arrayData[i] < +this.arrayData[i - 1]) {\n\t\t\t\t\t\tthis.highlight(14, 0);\n\t\t\t\t\t\tthis.highlight(15, 0);\n\t\t\t\t\t\tthis.swap(i, i - 1);\n\t\t\t\t\t\tsorted = false;\n\t\t\t\t\t\tlastSwapped = i;\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(14, 0);\n\t\t\t\t\tthis.unhighlight(15, 0);\n\t\t\t\t}\n\t\t\t\tthis.highlight(18, 0);\n\t\t\t\tif (lastSwapEnabled) {\n\t\t\t\t\tstart = lastSwapped;\n\t\t\t\t} else {\n\t\t\t\t\tstart++;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(18, 0);\n\t\t\t\tif (!sorted) {\n\t\t\t\t\tfor (let i = start - 1; i >= 0; i--) {\n\t\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.unhighlight(12, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t} while (!sorted);\n\t\tthis.unhighlight(3, 0);\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\n\t\t// Swap actual data\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\n\t\t// Swap displayed data\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","class PriorityQueue {\n\tconstructor() {\n\t\tthis.backingArray = [];\n\t}\n\n\tenqueue(data, id, priority) {\n\t\tthis.backingArray.push([data, id, priority]);\n\t\tthis.backingArray.sort((a, b) => {\n\t\t\tif (a[2] !== b[2]) {\n\t\t\t\treturn a[2] - b[2];\n\t\t\t} else {\n\t\t\t\tif (Array.isArray(a[0])) {\n\t\t\t\t\tif (a[0][0] !== b[0][0]) {\n\t\t\t\t\t\treturn a[0][0] - b[0][0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn a[0][1] - b[0][1];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn a[0] - b[0];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tdequeue() {\n\t\tconst x = this.backingArray.shift();\n\t\treturn [x[0], x[1]];\n\t}\n\n\tsize() {\n\t\treturn this.backingArray.length;\n\t}\n\n\tgetIDs() {\n\t\treturn this.backingArray.map(x => x[1]);\n\t}\n}\n\nexport default PriorityQueue;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_SIZE = 32;\nconst LENGTH = 8;\n\nconst MAX_ARRAY_SIZE = 31;\nconst ARRAY_ELEM_WIDTH = 40;\nconst ARRAY_ELEM_HEIGHT = 25;\nconst ARRAY_INITIAL_X = 30;\n\nconst ARRAY_Y_POS = 50;\nconst ARRAY_LABEL_Y_POS = 75;\n\nconst ARRAY_RESIZE_Y_POS = 100;\nconst ARRAY_RESIZE_LABEL_Y_POS = 125;\n\nconst HEAP_X_POSITIONS = [\n\t0, 450, 250, 650, 150, 350, 550, 750, 100, 200, 300, 400, 500, 600, 700, 800, 75, 125, 175, 225,\n\t275, 325, 375, 425, 475, 525, 575, 625, 675, 725, 775, 825,\n];\n\nconst HEAP_Y_POSITIONS = [\n\t0, 180, 250, 250, 320, 320, 320, 320, 390, 390, 390, 390, 390, 390, 390, 390, 460, 460, 460,\n\t460, 460, 460, 460, 460, 460, 460, 460, 460, 460, 460, 460, 460,\n];\n\nexport default class Heap extends Algorithm {\n\tconstructor(am) {\n\t\tsuper(am);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.array_size = LENGTH;\n\t\tthis.order = 'smaller';\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Enqueue');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.removeButton = addControlToAlgorithmBar('Button', 'Dequeue');\n\t\tthis.removeButton.onclick = this.removeCallback.bind(this);\n\t\tthis.controls.push(this.removeButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma separated list (e.g. \"3,1,2\"). Max 31 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\tthis.buildHeapField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.buildHeapField.onkeydown = this.returnSubmit(\n\t\t\tthis.buildHeapField,\n\t\t\tthis.buildHeapCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.buildHeapField);\n\n\t\tthis.buildHeapButton = addControlToAlgorithmBar('Button', 'BuildHeap', horizontalGroup);\n\t\tthis.buildHeapButton.onclick = this.buildHeapCallback.bind(this);\n\t\tthis.controls.push(this.buildHeapButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst minMaxButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['MinHeap', 'MaxHeap'],\n\t\t\t'MinHeap/MaxHeap',\n\t\t);\n\n\t\tthis.minHeapButton = minMaxButtonList[0];\n\t\tthis.minHeapButton.onclick = this.minHeapCallback.bind(this);\n\t\tthis.minHeapButton.checked = true;\n\t\tthis.maxHeapButton = minMaxButtonList[1];\n\t\tthis.maxHeapButton.onclick = this.maxHeapCallback.bind(this);\n\t\tthis.isMinHeap = true;\n\t\tthis.controls.push(this.minHeapButton);\n\t\tthis.controls.push(this.maxHeapButton);\n\t}\n\n\tcreateArray() {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = new Array(this.array_size);\n\t\tthis.arrayLabels = new Array(this.array_size);\n\t\tthis.arrayRects = new Array(this.array_size);\n\t\tthis.circleObjs = new Array(this.array_size);\n\t\tthis.arrayXPositions = new Array(this.array_size);\n\t\tthis.currentHeapSize = 0;\n\n\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\tthis.arrayXPositions[i] = ARRAY_INITIAL_X + i * ARRAY_ELEM_WIDTH;\n\t\t\tthis.arrayLabels[i] = this.nextIndex++;\n\t\t\tthis.arrayRects[i] = this.nextIndex++;\n\t\t\tthis.circleObjs[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayRects[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\tARRAY_Y_POS,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.arrayLabels[i],\n\t\t\t\ti,\n\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\tARRAY_LABEL_Y_POS,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabels[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.setText, this.arrayRects[0], 'null');\n\t\treturn this.commands;\n\t}\n\n\tsetup() {\n\t\tthis.swapLabel1 = this.nextIndex++;\n\t\tthis.swapLabel2 = this.nextIndex++;\n\t\tthis.swapLabel3 = this.nextIndex++;\n\t\tthis.swapLabel4 = this.nextIndex++;\n\t\tthis.descriptLabel1 = this.nextIndex++;\n\t\tthis.descriptLabel2 = this.nextIndex++;\n\t\tthis.descriptLabel3 = this.nextIndex++;\n\t\tthis.resetIndex = this.nextIndex;\n\t\tthis.createArray();\n\t\tthis.cmd(act.createLabel, this.descriptLabel1, '', 20, 10, 0);\n\t\tthis.cmd(act.createLabel, this.descriptLabel3, '', 300, 10, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.normalizeNumber(this.insertField.value, 4);\n\t\tif (insertedValue !== '') {\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tremoveCallback() {\n\t\tthis.implementAction(this.remove.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t\tthis.implementAction(this.resize.bind(this), LENGTH, false);\n\t}\n\n\tbuildHeapCallback() {\n\t\tconst list = this.buildHeapField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.buildHeapField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.buildHeapField.value = '';\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.implementAction(this.buildHeap.bind(this), list);\n\t\t}\n\t}\n\n\tminHeapCallback() {\n\t\tif (!this.isMinHeap) {\n\t\t\tthis.clearCallback();\n\t\t\tthis.isMinHeap = true;\n\t\t\tthis.order = 'smaller';\n\t\t}\n\t}\n\n\tmaxHeapCallback() {\n\t\tif (this.isMinHeap) {\n\t\t\tthis.clearCallback();\n\t\t\tthis.isMinHeap = false;\n\t\t\tthis.order = 'larger';\n\t\t}\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\twhile (this.currentHeapSize > 0) {\n\t\t\tthis.cmd(act.delete, this.circleObjs[this.currentHeapSize]);\n\t\t\tthis.cmd(act.setText, this.arrayRects[this.currentHeapSize], '');\n\t\t\tthis.currentHeapSize--;\n\t\t}\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\t\treturn this.commands;\n\t}\n\n\treset() {\n\t\tthis.currentHeapSize = 0;\n\t\tthis.array_size = LENGTH;\n\n\t\tthis.nextIndex = this.resetIndex;\n\n\t\tthis.arrayData = new Array(this.array_size);\n\t\tthis.arrayLabels = new Array(this.array_size);\n\t\tthis.arrayRects = new Array(this.array_size);\n\t\tthis.circleObjs = new Array(this.array_size);\n\t\tthis.arrayXPositions = new Array(this.array_size);\n\n\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\tthis.arrayXPositions[i] = ARRAY_INITIAL_X + i * ARRAY_ELEM_WIDTH;\n\t\t\tthis.arrayLabels[i] = this.nextIndex++;\n\t\t\tthis.arrayRects[i] = this.nextIndex++;\n\t\t\tthis.circleObjs[i] = this.nextIndex++;\n\t\t}\n\t}\n\n\tswap(index1, index2) {\n\t\tthis.cmd(act.setText, this.arrayRects[index1], '');\n\t\tthis.cmd(act.setText, this.arrayRects[index2], '');\n\t\tthis.cmd(act.setText, this.circleObjs[index1], '');\n\t\tthis.cmd(act.setText, this.circleObjs[index2], '');\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel1,\n\t\t\tthis.arrayData[index1],\n\t\t\tthis.arrayXPositions[index1],\n\t\t\tARRAY_Y_POS,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel2,\n\t\t\tthis.arrayData[index2],\n\t\t\tthis.arrayXPositions[index2],\n\t\t\tARRAY_Y_POS,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel3,\n\t\t\tthis.arrayData[index1],\n\t\t\tHEAP_X_POSITIONS[index1],\n\t\t\tHEAP_Y_POSITIONS[index1],\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel4,\n\t\t\tthis.arrayData[index2],\n\t\t\tHEAP_X_POSITIONS[index2],\n\t\t\tHEAP_Y_POSITIONS[index2],\n\t\t);\n\t\tthis.cmd(act.move, this.swapLabel1, this.arrayXPositions[index2], ARRAY_Y_POS);\n\t\tthis.cmd(act.move, this.swapLabel2, this.arrayXPositions[index1], ARRAY_Y_POS);\n\t\tthis.cmd(act.move, this.swapLabel3, HEAP_X_POSITIONS[index2], HEAP_Y_POSITIONS[index2]);\n\t\tthis.cmd(act.move, this.swapLabel4, HEAP_X_POSITIONS[index1], HEAP_Y_POSITIONS[index1]);\n\t\tconst tmp = this.arrayData[index1];\n\t\tthis.arrayData[index1] = this.arrayData[index2];\n\t\tthis.arrayData[index2] = tmp;\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayRects[index1], this.arrayData[index1]);\n\t\tthis.cmd(act.setText, this.arrayRects[index2], this.arrayData[index2]);\n\t\tthis.cmd(act.setText, this.circleObjs[index1], this.arrayData[index1]);\n\t\tthis.cmd(act.setText, this.circleObjs[index2], this.arrayData[index2]);\n\t\tthis.cmd(act.delete, this.swapLabel1);\n\t\tthis.cmd(act.delete, this.swapLabel2);\n\t\tthis.cmd(act.delete, this.swapLabel3);\n\t\tthis.cmd(act.delete, this.swapLabel4);\n\t}\n\n\tsetIndexHighlight(index, highlightVal) {\n\t\tthis.cmd(act.setHighlight, this.circleObjs[index], highlightVal);\n\t\tthis.cmd(act.setHighlight, this.arrayRects[index], highlightVal);\n\t}\n\n\tpushDown(index) {\n\t\tlet childIndex; // Used to keep track of smallest (in MinHeap) or largest (in MaxHeap) child\n\n\t\twhile (index * 2 <= this.currentHeapSize) {\n\t\t\tchildIndex = 2 * index;\n\n\t\t\tif (index * 2 + 1 <= this.currentHeapSize) {\n\t\t\t\tthis.cmd(act.setText, this.descriptLabel3, `Finding ${this.order} of two children`);\n\t\t\t\tthis.setIndexHighlight(2 * index, 1);\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.setIndexHighlight(2 * index, 0);\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 0);\n\t\t\t\tif (this.downheapCheckRightChild(index)) {\n\t\t\t\t\tchildIndex = 2 * index + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.setText, this.descriptLabel3, `Comparing child to parent`);\n\t\t\tthis.setIndexHighlight(index, 1);\n\t\t\tthis.setIndexHighlight(childIndex, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.setIndexHighlight(index, 0);\n\t\t\tthis.setIndexHighlight(childIndex, 0);\n\t\t\tthis.cmd(act.setText, this.descriptLabel3, ``);\n\n\t\t\tif (this.downheapCompare(childIndex, index)) {\n\t\t\t\tthis.swap(childIndex, index);\n\t\t\t\tindex = childIndex;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdownheapCheckRightChild(index) {\n\t\t// Checks if the right child is smaller (in MinHeap) or greater (in MaxHeap) than left child\n\t\tif (this.isMinHeap) {\n\t\t\tif (this.arrayData[2 * index + 1] < this.arrayData[2 * index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.arrayData[2 * index + 1] > this.arrayData[2 * index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdownheapCompare(childIndex, index) {\n\t\t// Checks if smallest child is smaller than parent (in MinHeap)\n\t\t// or greatest child is greater than parent (in MaxHeap)\n\t\tif (this.isMinHeap) {\n\t\t\tif (this.arrayData[childIndex] < this.arrayData[index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.arrayData[childIndex] > this.arrayData[index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tremove() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\n\t\tif (this.currentHeapSize === 0) {\n\t\t\tthis.cmd(act.setText, this.descriptLabel1, 'Heap is empty, cannot dequeue');\n\t\t\treturn this.commands;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Removing element:');\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.descriptLabel2,\n\t\t\tthis.arrayData[1],\n\t\t\tHEAP_X_POSITIONS[1],\n\t\t\tHEAP_Y_POSITIONS[1],\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.setText, this.circleObjs[1], '');\n\t\tthis.cmd(act.move, this.descriptLabel2, 120, 40);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.descriptLabel2);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Removing element: ' + this.arrayData[1]);\n\t\tthis.arrayData[1] = '';\n\t\tif (this.currentHeapSize > 1) {\n\t\t\tthis.cmd(act.setText, this.arrayRects[1], '');\n\t\t\tthis.cmd(act.setText, this.arrayRects[this.currentHeapSize], '');\n\t\t\tthis.swap(1, this.currentHeapSize);\n\t\t\tthis.cmd(act.delete, this.circleObjs[this.currentHeapSize]);\n\t\t\tthis.currentHeapSize--;\n\t\t\tthis.pushDown(1);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.arrayRects[1], '');\n\t\t\tthis.cmd(act.delete, this.circleObjs[this.currentHeapSize]);\n\t\t\tthis.currentHeapSize--;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tbuildHeap(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = params\n\t\t\t.map(Number) // Map to numbers (to remove invalid characters)\n\t\t\t.filter(x => !Number.isNaN(x)) // Remove stuff that was invalid\n\t\t\t.slice(0, MAX_ARRAY_SIZE); // Get first 31 numbers\n\t\tthis.arrayData.unshift(0); // Add a 0 to start of array\n\n\t\tthis.currentHeapSize = this.arrayData.length - 1;\n\t\tconst size = Math.min(MAX_SIZE, this.currentHeapSize * 2 + 1);\n\t\tif (this.array_size !== size) {\n\t\t\tthis.commands = this.resize(size, false);\n\t\t}\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Adding data to array');\n\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 1; i <= this.currentHeapSize; i++) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircle,\n\t\t\t\tthis.circleObjs[i],\n\t\t\t\tthis.arrayData[i],\n\t\t\t\tHEAP_X_POSITIONS[i],\n\t\t\t\tHEAP_Y_POSITIONS[i],\n\t\t\t);\n\t\t\tthis.cmd(act.setText, this.arrayRects[i], this.arrayData[i]);\n\t\t\tif (i > 1) {\n\t\t\t\tthis.cmd(act.connect, this.circleObjs[Math.floor(i / 2)], this.circleObjs[i]);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Enforcing order property using downheap');\n\t\tlet nextElem = this.currentHeapSize;\n\t\twhile (nextElem > 0) {\n\t\t\tthis.pushDown(nextElem);\n\t\t\tnextElem = nextElem - 1;\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Buildheap complete!');\n\t\treturn this.commands;\n\t}\n\n\tinsertElement(insertedValue) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\n\t\tif (this.currentHeapSize === this.array_size - 1) {\n\t\t\tif (this.currentHeapSize >= MAX_SIZE - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.descriptLabel1,\n\t\t\t\t\t'Array would normally resize here, ' +\n\t\t\t\t\t\t\"but there's not enough space on the screen for a larger heap. So here's a cute emoji of jack instead: V•ᴥ•V\",\n\t\t\t\t);\n\t\t\t\treturn this.commands;\n\t\t\t} else {\n\t\t\t\tconst size = Math.min(MAX_SIZE, this.array_size * 2);\n\t\t\t\tthis.commands = this.resize(size, true);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Enqueueing Element: ' + insertedValue);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Enqueueing Element: ');\n\t\tthis.currentHeapSize++;\n\t\tthis.arrayData[this.currentHeapSize] = insertedValue;\n\t\tthis.cmd(\n\t\t\tact.createCircle,\n\t\t\tthis.circleObjs[this.currentHeapSize],\n\t\t\t'',\n\t\t\tHEAP_X_POSITIONS[this.currentHeapSize],\n\t\t\tHEAP_Y_POSITIONS[this.currentHeapSize],\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.descriptLabel2, insertedValue, 120, 45, 1);\n\t\tif (this.currentHeapSize > 1) {\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.circleObjs[Math.floor(this.currentHeapSize / 2)],\n\t\t\t\tthis.circleObjs[this.currentHeapSize],\n\t\t\t);\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.move,\n\t\t\tthis.descriptLabel2,\n\t\t\tHEAP_X_POSITIONS[this.currentHeapSize],\n\t\t\tHEAP_Y_POSITIONS[this.currentHeapSize],\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.circleObjs[this.currentHeapSize], insertedValue);\n\t\tthis.cmd(act.delete, this.descriptLabel2);\n\t\tthis.cmd(act.setText, this.arrayRects[this.currentHeapSize], insertedValue);\n\n\t\tlet currentIndex = this.currentHeapSize;\n\t\tlet parentIndex = Math.floor(currentIndex / 2);\n\n\t\tif (currentIndex > 1) {\n\t\t\tthis.setIndexHighlight(currentIndex, 1);\n\t\t\tthis.setIndexHighlight(parentIndex, 1);\n\t\t\tthis.cmd(act.setText, this.descriptLabel3, `Comparing child to parent`);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.setIndexHighlight(currentIndex, 0);\n\t\t\tthis.setIndexHighlight(parentIndex, 0);\n\t\t}\n\n\t\twhile (currentIndex > 1 && this.upheapCompare(currentIndex, parentIndex)) {\n\t\t\tthis.swap(currentIndex, parentIndex);\n\t\t\tcurrentIndex = parentIndex;\n\t\t\tparentIndex = Math.floor(parentIndex / 2);\n\t\t\tif (currentIndex > 1) {\n\t\t\t\tthis.setIndexHighlight(currentIndex, 1);\n\t\t\t\tthis.setIndexHighlight(parentIndex, 1);\n\t\t\t\tthis.cmd(act.setText, this.descriptLabel3, `Comparing child to parent`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.setIndexHighlight(currentIndex, 0);\n\t\t\t\tthis.setIndexHighlight(parentIndex, 0);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\t\tthis.cmd(act.setText, this.descriptLabel3, '');\n\t\treturn this.commands;\n\t}\n\n\tresize(size, add) {\n\t\tthis.commands = [];\n\t\tconst resizeLabelID = this.nextIndex++;\n\n\t\tif (add) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tresizeLabelID,\n\t\t\t\t'Resize Required: size == array.length - 1',\n\t\t\t\t400,\n\t\t\t\t20,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (size === MAX_SIZE) {\n\t\t\t\tthis.cmd(act.setText, resizeLabelID, 'Resizing to 32 (Max array size)');\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setText, resizeLabelID, 'Resizing to 2 * array.length');\n\t\t\t}\n\t\t}\n\n\t\tconst oldSize = this.array_size;\n\n\t\tthis.array_size = size;\n\n\t\tthis.newArrayData = new Array(this.array_size);\n\t\tthis.newArrayLabels = new Array(this.array_size);\n\t\tthis.newArrayRects = new Array(this.array_size);\n\t\tthis.newCircleObjs = new Array(this.array_size);\n\t\tthis.newArrayXPositions = new Array(this.array_size);\n\n\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\tthis.newArrayLabels[i] = this.nextIndex++;\n\t\t\tthis.newArrayRects[i] = this.nextIndex++;\n\t\t\tthis.newArrayXPositions[i] = ARRAY_INITIAL_X + i * ARRAY_ELEM_WIDTH;\n\t\t\tif (i < oldSize) {\n\t\t\t\tthis.newCircleObjs[i] = this.circleObjs[i];\n\t\t\t} else {\n\t\t\t\tthis.newCircleObjs[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tthis.newArrayData[i] = this.arrayData[i];\n\t\t}\n\n\t\tif (add) {\n\t\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.newArrayRects[i],\n\t\t\t\t\t'',\n\t\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\t\tthis.newArrayXPositions[i],\n\t\t\t\t\tARRAY_RESIZE_Y_POS,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.newArrayLabels[i],\n\t\t\t\t\ti,\n\t\t\t\t\tthis.newArrayXPositions[i],\n\t\t\t\t\tARRAY_RESIZE_LABEL_Y_POS,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.newArrayLabels[i], '#0000FF');\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.arrayMoveID = new Array(this.oldSize);\n\n\t\t\tfor (let i = 0; i <= this.currentHeapSize; i++) {\n\t\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.arrayMoveID[i],\n\t\t\t\t\t\t'null',\n\t\t\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\t\t\tARRAY_Y_POS,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.arrayMoveID[i],\n\t\t\t\t\t\tthis.arrayData[i],\n\t\t\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\t\t\tARRAY_Y_POS,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.arrayMoveID[i],\n\t\t\t\t\tthis.newArrayXPositions[i],\n\t\t\t\t\tARRAY_RESIZE_Y_POS,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let i = 0; i < oldSize; i++) {\n\t\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\t\tthis.cmd(act.setText, this.newArrayRects[i], this.newArrayData[i]);\n\t\t\t}\n\n\t\t\tthis.cmd(act.setText, this.newArrayRects[0], 'null');\n\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tfor (let i = 0; i < oldSize; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayLabels[i]);\n\t\t\tthis.cmd(act.delete, this.arrayRects[i]);\n\t\t}\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayData = this.newArrayData;\n\t\tthis.arrayLabels = this.newArrayLabels;\n\t\tthis.arrayXPositions = this.newArrayXPositions;\n\t\tthis.arrayRects = this.newArrayRects;\n\t\tthis.circleObjs = this.newCircleObjs;\n\n\t\tif (add) {\n\t\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\t\tthis.cmd(act.move, this.arrayRects[i], this.arrayXPositions[i], ARRAY_Y_POS);\n\t\t\t\tthis.cmd(act.move, this.arrayLabels[i], this.arrayXPositions[i], ARRAY_LABEL_Y_POS);\n\t\t\t}\n\n\t\t\tthis.cmd(act.delete, resizeLabelID);\n\t\t} else {\n\t\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.arrayRects[i],\n\t\t\t\t\t'',\n\t\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\t\tARRAY_Y_POS,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.arrayLabels[i],\n\t\t\t\t\ti,\n\t\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\t\tARRAY_LABEL_Y_POS,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.newArrayLabels[i], '#0000FF');\n\t\t\t}\n\t\t\tthis.cmd(act.setText, this.arrayRects[0], 'null');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tupheapCompare(currentIndex, parentIndex) {\n\t\tif (this.isMinHeap) {\n\t\t\tif (this.arrayData[currentIndex] < this.arrayData[parentIndex]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.arrayData[currentIndex] > this.arrayData[parentIndex]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tthis.controls.forEach(button => (button.disabled = true));\n\t}\n\n\tenableUI() {\n\t\tthis.controls.forEach(button => (button.disabled = false));\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Hash from './Hash.js';\nimport { act } from '../anim/AnimationMain';\n\nconst POINTER_ARRAY_ELEM_WIDTH = 50;\nconst POINTER_ARRAY_ELEM_HEIGHT = 25;\nconst POINTER_ARRAY_ELEM_START_X = 70;\nconst POINTER_ARRAY_ELEM_START_Y = 100;\n\nconst RESIZE_POINTER_ARRAY_ELEM_START_X = 670;\nconst RESIZE_POINTER_ARRAY_ELEM_START_Y = 50;\nconst RESIZE_LABEL_X = 800;\nconst RESIZE_LABEL_Y = 20;\n\nconst LINKED_ITEM_WIDTH = 70;\nconst LINKED_ITEM_HEIGHT = 20;\n\nconst LINKED_ITEM_INITIAL_X = 60;\nconst LINKED_ITEM_INITIAL_Y = 40;\nconst LINKED_ITEM_X_DELTA_INIT = 70;\nconst LINKED_ITEM_X_DELTA = 90;\n\nconst EXPLAIN_LABEL_X = 550;\nconst EXPLAIN_LABEL_Y = 15;\n\nconst HASH_TABLE_SIZE = 7;\n\nconst DEFAULT_LOAD_FACTOR = 0.67;\n\nconst LOAD_LABEL_X = 60;\nconst LOAD_LABEL_Y = 20;\n\nconst MAX_SIZE = 30;\n\nconst INDEX_COLOR = '#0000FF';\n\nexport default class OpenHash extends Hash {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.nextIndex = 0;\n\t\tthis.POINTER_ARRAY_ELEM_Y = h - POINTER_ARRAY_ELEM_WIDTH;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tsuper.addControls();\n\t}\n\n\tsetup() {\n\t\tthis.hashTableVisual = new Array(HASH_TABLE_SIZE);\n\t\tthis.hashTableIndices = new Array(HASH_TABLE_SIZE);\n\t\tthis.hashTableValues = new Array(HASH_TABLE_SIZE);\n\t\tthis.indexXPos = new Array(HASH_TABLE_SIZE);\n\t\tthis.indexYPos = new Array(HASH_TABLE_SIZE);\n\n\t\tthis.ExplainLabel = this.nextIndex++;\n\n\t\tthis.loadFactorID = this.nextIndex++;\n\n\t\tthis.size = 0;\n\n\t\tthis.table_size = HASH_TABLE_SIZE;\n\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\n\n\t\tthis.resetIndex = this.nextIndex;\n\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < HASH_TABLE_SIZE; i++) {\n\t\t\tlet nextID = this.nextIndex++;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tnextID,\n\t\t\t\t'',\n\t\t\t\tPOINTER_ARRAY_ELEM_WIDTH,\n\t\t\t\tPOINTER_ARRAY_ELEM_HEIGHT,\n\t\t\t\tPOINTER_ARRAY_ELEM_START_X,\n\t\t\t\tPOINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.hashTableVisual[i] = nextID;\n\t\t\tthis.cmd(act.setNull, this.hashTableVisual[i], 1);\n\n\t\t\tnextID = this.nextIndex++;\n\t\t\tthis.hashTableIndices[i] = nextID;\n\t\t\tthis.hashTableValues[i] = null;\n\n\t\t\tthis.indexXPos[i] = POINTER_ARRAY_ELEM_START_X - POINTER_ARRAY_ELEM_WIDTH;\n\t\t\tthis.indexYPos[i] = POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(act.createLabel, nextID, i, this.indexXPos[i], this.indexYPos[i]);\n\t\t\tthis.cmd(act.setForegroundColor, nextID, INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.loadFactorID,\n\t\t\t`Load Factor: ${this.load_factor}`,\n\t\t\tLOAD_LABEL_X,\n\t\t\tLOAD_LABEL_Y,\n\t\t);\n\t\tthis.cmd(act.createLabel, this.ExplainLabel, '', EXPLAIN_LABEL_X, EXPLAIN_LABEL_Y, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tinsertElement(key, value) {\n\t\tconst elem = `<${key}, ${value}>`;\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\n\t\tif (\n\t\t\t(this.size + 1) / this.table_size > this.load_factor &&\n\t\t\tthis.table_size * 2 + 1 < MAX_SIZE\n\t\t) {\n\t\t\tthis.resize();\n\t\t}\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting element ' + elem);\n\t\tconst node = new LinkedListNode(\n\t\t\tkey,\n\t\t\tvalue,\n\t\t\tthis.nextIndex++,\n\t\t\tLINKED_ITEM_INITIAL_X,\n\t\t\tLINKED_ITEM_INITIAL_Y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tnode.graphicID,\n\t\t\telem,\n\t\t\tLINKED_ITEM_WIDTH,\n\t\t\tLINKED_ITEM_HEIGHT,\n\t\t\tLINKED_ITEM_INITIAL_X,\n\t\t\tLINKED_ITEM_INITIAL_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1,\n\t\t);\n\n\t\tconst index = this.doHash(key);\n\n\t\tlet found = false;\n\t\tlet prev = null;\n\t\tlet old;\n\t\tif (this.hashTableValues[index] != null) {\n\t\t\t// Search for duplicates\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Searching for duplicates of ' + key);\n\n\t\t\tconst compareIndex = this.nextIndex++;\n\t\t\tlet tmp = this.hashTableValues[index];\n\t\t\tthis.cmd(act.createLabel, compareIndex, '', EXPLAIN_LABEL_X, EXPLAIN_LABEL_Y + 30, 0);\n\t\t\twhile (tmp != null && !found) {\n\t\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 1);\n\t\t\t\tif (tmp.key === key) {\n\t\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.key + '==' + key);\n\t\t\t\t\told = tmp;\n\t\t\t\t\tfound = true;\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.key + '!=' + key);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\t\tprev = tmp;\n\t\t\t\ttmp = tmp.next;\n\t\t\t}\n\n\t\t\tthis.cmd(act.delete, compareIndex);\n\t\t\tthis.nextIndex--;\n\t\t} else {\n\t\t\tthis.cmd(act.setNull, node.graphicID, 1);\n\t\t\tthis.cmd(act.setNull, this.hashTableVisual[index], 0);\n\t\t}\n\n\t\tif (found) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Key ' + key + ' is already in HashMap, updating value.',\n\t\t\t);\n\t\t\tthis.cmd(act.delete, old.graphicID);\n\t\t\tnode.next = old.next;\n\n\t\t\tif (prev != null) {\n\t\t\t\tprev.next = node;\n\t\t\t\tthis.cmd(act.connect, prev.graphicID, node.graphicID);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.hashTableVisual[index],\n\t\t\t\t\tthis.hashTableValues[index].graphicID,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.connect, this.hashTableVisual[index], node.graphicID);\n\t\t\t\tthis.hashTableValues[index] = node;\n\t\t\t}\n\t\t\tif (node.next != null) {\n\t\t\t\tthis.cmd(act.connect, node.graphicID, node.next.graphicID);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setNull, node.graphicID, 1);\n\t\t\t}\n\n\t\t\tthis.repositionList(index, this.hashTableValues[index]);\n\t\t\tthis.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Duplicate of  ' + key + '  not found!');\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (this.hashTableValues[index] != null) {\n\t\t\t\tthis.cmd(act.connect, node.graphicID, this.hashTableValues[index].graphicID);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.hashTableVisual[index],\n\t\t\t\t\tthis.hashTableValues[index].graphicID,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.cmd(act.connect, this.hashTableVisual[index], node.graphicID);\n\t\t\tnode.next = this.hashTableValues[index];\n\t\t\tthis.hashTableValues[index] = node;\n\t\t\tthis.repositionList(index, this.hashTableValues[index]);\n\t\t\tthis.size++;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\n\t\treturn this.commands;\n\t}\n\n\trepositionList(index, tmp) {\n\t\tlet startX = POINTER_ARRAY_ELEM_START_X + LINKED_ITEM_X_DELTA_INIT;\n\t\tconst startY = POINTER_ARRAY_ELEM_START_Y + index * POINTER_ARRAY_ELEM_HEIGHT;\n\t\t// let tmp = this.hashTableValues[index];\n\t\twhile (tmp != null) {\n\t\t\ttmp.x = startX;\n\t\t\ttmp.y = startY;\n\t\t\tthis.cmd(act.move, tmp.graphicID, tmp.x, tmp.y);\n\t\t\tstartX = startX + LINKED_ITEM_X_DELTA;\n\t\t\ttmp = tmp.next;\n\t\t}\n\t}\n\n\trepositionResizeList(index) {\n\t\tlet startX = RESIZE_POINTER_ARRAY_ELEM_START_X + LINKED_ITEM_X_DELTA_INIT;\n\t\tconst startY = RESIZE_POINTER_ARRAY_ELEM_START_Y + index * POINTER_ARRAY_ELEM_HEIGHT;\n\t\tlet tmp = this.hashTableValues[index];\n\t\twhile (tmp != null) {\n\t\t\ttmp.x = startX;\n\t\t\ttmp.y = startY;\n\t\t\tthis.cmd(act.move, tmp.graphicID, tmp.x, tmp.y);\n\t\t\tstartX = startX + LINKED_ITEM_X_DELTA;\n\t\t\ttmp = tmp.next;\n\t\t}\n\t}\n\n\tdeleteElement(key) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Deleting entry with key: ' + key);\n\t\tconst index = this.doHash(key);\n\t\tif (this.hashTableValues[index] == null) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting entry with key: ' + key + '  Key not in table',\n\t\t\t);\n\t\t\treturn this.commands;\n\t\t}\n\t\tthis.cmd(act.setHighlight, this.hashTableValues[index].graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.hashTableValues[index].graphicID, 0);\n\t\tif (this.hashTableValues[index].key === key) {\n\t\t\tif (this.hashTableValues[index].next != null) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.hashTableVisual[index],\n\t\t\t\t\tthis.hashTableValues[index].next.graphicID,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setNull, this.hashTableVisual[index], 1);\n\t\t\t}\n\t\t\tthis.cmd(act.delete, this.hashTableValues[index].graphicID);\n\t\t\tthis.hashTableValues[index] = this.hashTableValues[index].next;\n\t\t\tthis.repositionList(index, this.hashTableValues[index]);\n\t\t\tthis.size--;\n\t\t\treturn this.commands;\n\t\t}\n\t\tlet tmpPrev = this.hashTableValues[index];\n\t\tlet tmp = this.hashTableValues[index].next;\n\t\tlet found = false;\n\t\twhile (tmp != null && !found) {\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\tif (tmp.key === key) {\n\t\t\t\tfound = true;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.ExplainLabel,\n\t\t\t\t\t'Deleting entry with key: ' + key + '  Entry deleted',\n\t\t\t\t);\n\t\t\t\tif (tmp.next != null) {\n\t\t\t\t\tthis.cmd(act.connect, tmpPrev.graphicID, tmp.next.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setNull, tmpPrev.graphicID, 1);\n\t\t\t\t}\n\t\t\t\ttmpPrev.next = tmpPrev.next.next;\n\t\t\t\tthis.cmd(act.delete, tmp.graphicID);\n\t\t\t\tthis.repositionList(index, this.hashTableValues[index]);\n\t\t\t\tthis.size--;\n\t\t\t} else {\n\t\t\t\ttmpPrev = tmp;\n\t\t\t\ttmp = tmp.next;\n\t\t\t}\n\t\t}\n\t\tif (!found) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting entry with key: ' + key + '  Key not in table',\n\t\t\t);\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tfindElement(key) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding entry with key: ' + key);\n\n\t\tconst index = this.doHash(key);\n\t\tconst compareIndex = this.nextIndex++;\n\t\tlet found = false;\n\t\tlet tmp = this.hashTableValues[index];\n\t\tlet value = null;\n\t\tthis.cmd(act.createLabel, compareIndex, '', 10, 40, 0);\n\t\twhile (tmp != null && !found) {\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 1);\n\t\t\tif (tmp.key === key) {\n\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.key + '==' + key);\n\t\t\t\tfound = true;\n\t\t\t\tvalue = tmp.val;\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.key + '!=' + key);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\ttmp = tmp.next;\n\t\t}\n\t\tif (found) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Found entry with key: ' + key + '  Value: ' + value,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Finding entry with key: ' + key + '  Not Found!',\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.delete, compareIndex);\n\t\tthis.nextIndex--;\n\t\treturn this.commands;\n\t}\n\n\tresize() {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\n\t\tconst resizeLabel = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tresizeLabel,\n\t\t\t`(Resize Required): (Size + 1 / length) > Load Factor --> (${this.size} + 1 / ${this.table_size}) > ${this.load_factor}`,\n\t\t\tRESIZE_LABEL_X,\n\t\t\tRESIZE_LABEL_Y,\n\t\t);\n\n\t\tthis.table_size = this.table_size * 2 + 1;\n\n\t\tif (this.table_size * 2 + 1 > MAX_SIZE) {\n\t\t\tthis.load_factor = 0.99;\n\t\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\t\t}\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.oldHashTableVisual = this.hashTableVisual;\n\t\tthis.oldHashTableValues = this.hashTableValues;\n\t\tthis.oldHashTableIndices = this.hashTableIndices;\n\t\tthis.oldIndexXPos = this.indexXPos;\n\t\tthis.oldIndexYPos = this.indexYPos;\n\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.hashTableIndices = new Array(this.table_size);\n\t\tthis.indexXPos = new Array(this.table_size);\n\t\tthis.indexYPos = new Array(this.table_size);\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tlet nextID = this.nextIndex++;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tnextID,\n\t\t\t\t'',\n\t\t\t\tPOINTER_ARRAY_ELEM_WIDTH,\n\t\t\t\tPOINTER_ARRAY_ELEM_HEIGHT,\n\t\t\t\tRESIZE_POINTER_ARRAY_ELEM_START_X,\n\t\t\t\tRESIZE_POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.hashTableVisual[i] = nextID;\n\t\t\tthis.cmd(act.setNull, this.hashTableVisual[i], 1);\n\n\t\t\tnextID = this.nextIndex++;\n\t\t\tthis.hashTableIndices[i] = nextID;\n\t\t\tthis.hashTableValues[i] = null;\n\n\t\t\tthis.indexXPos[i] = RESIZE_POINTER_ARRAY_ELEM_START_X - POINTER_ARRAY_ELEM_WIDTH;\n\t\t\tthis.indexYPos[i] = RESIZE_POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(act.createLabel, nextID, i, this.indexXPos[i], this.indexYPos[i]);\n\t\t\tthis.cmd(act.setForegroundColor, nextID, INDEX_COLOR);\n\t\t}\n\n\t\tfor (let i = 0; i < (this.table_size - 1) / 2; i++) {\n\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 1);\n\t\t\tthis.cmd(act.step);\n\n\t\t\twhile (this.oldHashTableValues[i] != null) {\n\t\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 0);\n\n\t\t\t\tconst node = this.oldHashTableValues[i];\n\t\t\t\tthis.cmd(act.setHighlight, node.graphicID, 1);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.move, node.graphicID, LINKED_ITEM_INITIAL_X, LINKED_ITEM_INITIAL_Y);\n\n\t\t\t\tthis.oldHashTableValues[i] = this.oldHashTableValues[i].next;\n\n\t\t\t\tthis.cmd(act.disconnect, this.oldHashTableVisual[i], node.graphicID);\n\t\t\t\tif (this.oldHashTableValues[i] != null) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\tthis.oldHashTableVisual[i],\n\t\t\t\t\t\tthis.oldHashTableValues[i].graphicID,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.disconnect, node.graphicID, this.oldHashTableValues[i].graphicID);\n\t\t\t\t\tthis.repositionList(i, this.oldHashTableValues[i]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setNull, this.oldHashTableVisual[i], 1);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tconst index = this.doHash(node.key);\n\n\t\t\t\tnode.next = this.hashTableValues[index];\n\t\t\t\tthis.cmd(act.setNull, node.graphicID, 1);\n\t\t\t\tthis.cmd(act.setNull, this.hashTableVisual[index], 0);\n\n\t\t\t\tif (node.next != null) {\n\t\t\t\t\tthis.cmd(act.disconnect, this.hashTableVisual[index], node.next.graphicID);\n\t\t\t\t\tthis.cmd(act.connect, node.graphicID, node.next.graphicID);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.connect, this.hashTableVisual[index], node.graphicID);\n\t\t\t\tthis.hashTableValues[index] = node;\n\t\t\t\tthis.repositionResizeList(index);\n\n\t\t\t\tthis.cmd(act.setHighlight, node.graphicID, 0);\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 0);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < (this.table_size - 1) / 2; i++) {\n\t\t\tthis.cmd(act.setNull, this.oldHashTableVisual[i], 1);\n\t\t\tthis.cmd(act.delete, this.oldHashTableVisual[i]);\n\t\t\tthis.cmd(act.delete, this.oldHashTableIndices[i]);\n\t\t}\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tconst xpos = POINTER_ARRAY_ELEM_START_X;\n\t\t\tconst ypos = POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.indexXPos[i] = POINTER_ARRAY_ELEM_START_X - POINTER_ARRAY_ELEM_WIDTH;\n\t\t\tthis.indexYPos[i] = POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(act.move, this.hashTableVisual[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.hashTableIndices[i], xpos - POINTER_ARRAY_ELEM_WIDTH, ypos);\n\n\t\t\tlet index = 0;\n\t\t\tlet tmp = this.hashTableValues[i];\n\t\t\twhile (tmp != null) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\ttmp.graphicID,\n\t\t\t\t\txpos + LINKED_ITEM_X_DELTA_INIT + LINKED_ITEM_X_DELTA * index,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t\tindex++;\n\t\t\t\ttmp = tmp.next;\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, resizeLabel);\n\t\tthis.cmd(act.step);\n\t}\n\n\tchangeLoadFactor(LF) {\n\t\tthis.commands = [];\n\n\t\tif (this.table_size * 2 + 1 <= MAX_SIZE) {\n\t\t\tthis.load_factor = LF;\n\t\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.loadFactorID,\n\t\t\t\t`Load Factor: ${this.load_factor}\n\t\t\t(Max Array Length)`,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tresetAll() {\n\t\tlet tmp;\n\t\tthis.commands = super.resetAll();\n\n\t\tthis.size = 0;\n\n\t\tfor (let i = 0; i < this.hashTableValues.length; i++) {\n\t\t\ttmp = this.hashTableValues[i];\n\t\t\tif (tmp != null) {\n\t\t\t\twhile (tmp != null) {\n\t\t\t\t\tthis.cmd(act.delete, tmp.graphicID);\n\t\t\t\t\ttmp = tmp.next;\n\t\t\t\t}\n\t\t\t\tthis.hashTableValues[i] = null;\n\t\t\t\tthis.cmd(act.setNull, this.hashTableVisual[i], 1);\n\t\t\t}\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\t// NEED TO OVERRIDE IN PARENT\n\treset() {\n\t\tthis.nextIndex = this.resetIndex;\n\t\tthis.table_size = HASH_TABLE_SIZE;\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\n\t\tthis.size = 0;\n\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.hashTableIndices = new Array(HASH_TABLE_SIZE);\n\n\t\tthis.indexXPos = new Array(HASH_TABLE_SIZE);\n\t\tthis.indexYPos = new Array(HASH_TABLE_SIZE);\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.hashTableValues[i] = null;\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\n\t\t\tthis.hashTableIndices[i] = this.nextIndex++;\n\t\t}\n\n\t\tsuper.reset();\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.hashTableValues.length; i++) {\n\t\t\tlet node = this.hashTableValues[i];\n\t\t\tif (node != null) {\n\t\t\t\tthis.cmd(act.delete, node.graphicID);\n\t\t\t}\n\t\t\tif (i >= HASH_TABLE_SIZE) {\n\t\t\t\tthis.cmd(act.delete, this.hashTableVisual[i], 1);\n\t\t\t\tthis.cmd(act.delete, this.hashTableIndices[i]);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setNull, this.hashTableVisual[i], 1);\n\t\t\t}\n\t\t}\n\n\t\tthis.hashTableValues = new Array(HASH_TABLE_SIZE);\n\t\tthis.size = 0;\n\n\t\treturn this.commands;\n\t}\n\n\t/*this.nextIndex = 0;\n this.commands = [];\n this.cmd(act.createLabel, 0, \"\", 20, 50, 0);\n this.animationManager.startNewAnimation(this.commands);\n this.animationManager.skipForward();\n this.animationManager.clearHistory(); */\n\n\tdisableUI() {\n\t\tsuper.disableUI();\n\t}\n\n\tenableUI() {\n\t\tsuper.enableUI();\n\t}\n}\n\nclass LinkedListNode {\n\tconstructor(key, val, id, initialX, initialY) {\n\t\tthis.key = key;\n\t\tthis.val = val;\n\t\tthis.graphicID = id;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.next = null;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINK_COLOR = '#007700';\nconst HIGHLIGHT_CIRCLE_COLOR = '#007700';\nconst FOREGROUND_COLOR = '#007700';\nconst BACKGROUND_COLOR = '#EEFFEE';\nconst PRINT_COLOR = FOREGROUND_COLOR;\n\nconst WIDTH_DELTA = 50;\nconst HEIGHT_DELTA = 50;\nconst STARTING_Y = 50;\n\nconst FIRST_PRINT_POS_X = 50;\nconst PRINT_VERTICAL_GAP = 20;\nconst PRINT_HORIZONTAL_GAP = 50;\n\nexport default class SplayTree extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.startingX = w / 2;\n\t\tthis.first_print_pos_y = h - 2 * PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.cmd(act.createLabel, 0, '', 20, 10, 0);\n\t\tthis.nextIndex = 1;\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t}\n\n\tinsertCallback() {\n\t\tlet insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.deleteElement.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\t//  TODO:  This top-down version is broken.  Don't use\n\tsplay(value) {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this.treeRoot.data === value) {\n\t\t\treturn true;\n\t\t}\n\t\tif (value < this.treeRoot.data) {\n\t\t\tif (this.treeRoot.left == null) {\n\t\t\t\treturn false;\n\t\t\t} else if (this.treeRoot.left.data === value) {\n\t\t\t\tthis.singleRotateRight(this.treeRoot);\n\t\t\t\treturn true;\n\t\t\t} else if (value < this.treeRoot.left.data) {\n\t\t\t\tif (this.treeRoot.left.left == null) {\n\t\t\t\t\tthis.singleRotateRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.zigZigRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.treeRoot.left.right == null) {\n\t\t\t\t\tthis.singleRotateRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.doubleRotateRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.treeRoot.right == null) {\n\t\t\t\treturn false;\n\t\t\t} else if (this.treeRoot.right.data === value) {\n\t\t\t\tthis.singleRotateLeft(this.treeRoot);\n\t\t\t\treturn true;\n\t\t\t} else if (value > this.treeRoot.right.data) {\n\t\t\t\tif (this.treeRoot.right.right == null) {\n\t\t\t\t\tthis.singleRotateLeft(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.zigZigLeft(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.treeRoot.right.left == null) {\n\t\t\t\t\tthis.singleRotateLeft(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.doubleRotateLeft(this.treeRot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y,\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) {\n\t\t\t\tthis.cmd(act.delete, i);\n\t\t\t}\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\n\t\t}\n\t\tif (tree.right != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\treturn;\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.normalizeNumber(this.findField.value, 4);\n\t\tthis.findField.value = '';\n\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tconst found = this.doFind(this.treeRoot, findValue);\n\n\t\tif (found) {\n\t\t\tthis.cmd(act.setText, 0, 'Element ' + findValue + ' found.');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, 'Element ' + findValue + ' not found.');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searching for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Splaying found node to root of tree');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\tthis.splayUp(tree);\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t\treturn this.doFind(tree.left, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.splayUp(tree);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t\treturn this.doFind(tree.right, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.splayUp(tree);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t'Searching for ' + value + ' : < Empty Tree > (Element not found)',\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, 'Searching for ' + value + ' :  (Element not found)');\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tinsertElement(insertedValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Inserting ' + insertedValue);\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tif (this.treeRoot == null) {\n\t\t\tthis.cmd(act.createCircle, this.nextIndex, insertedValue, this.startingX, STARTING_Y);\n\t\t\tthis.cmd(act.setForegroundColor, this.nextIndex, FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex, BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.treeRoot = new BSTNode(insertedValue, this.nextIndex, this.startingX, STARTING_Y);\n\t\t\tthis.nextIndex += 1;\n\t\t} else {\n\t\t\tthis.cmd(act.createCircle, this.nextIndex, insertedValue, 100, 100);\n\t\t\tthis.cmd(act.setForegroundColor, this.nextIndex, FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex, BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tconst insertElem = new BSTNode(insertedValue, this.nextIndex, 100, 100);\n\n\t\t\tthis.nextIndex += 1;\n\t\t\tthis.cmd(act.setHighlight, insertElem.graphicID, 1);\n\t\t\tthis.insert(insertElem, this.treeRoot);\n\t\t\tthis.resizeTree();\n\t\t\tthis.cmd(act.setText, 0, 'Splay inserted element to root of tree');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.splayUp(insertElem);\n\t\t}\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn this.commands;\n\t}\n\n\tinsert(elem, tree) {\n\t\tlet foundDuplicate = false;\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.setHighlight, elem.graphicID, 1);\n\n\t\tif (elem.data < tree.data) {\n\t\t\tthis.cmd(act.setText, 0, elem.data + ' < ' + tree.data + '.  Looking at left subtree');\n\t\t} else if (elem.data > tree.data) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\telem.data + ' >= ' + tree.data + '.  Looking at right subtree',\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, elem.data + ' = ' + tree.data + '. Ignoring duplicate');\n\t\t\tfoundDuplicate = true;\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, elem.graphicID, 0);\n\n\t\tif (foundDuplicate) {\n\t\t\tthis.cmd(act.delete, elem.graphicID, 0);\n\t\t\treturn;\n\t\t}\n\n\t\tif (elem.data < tree.data) {\n\t\t\tif (tree.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Found null tree, inserting element');\n\n\t\t\t\tthis.cmd(act.setHighlight, elem.graphicID, 0);\n\t\t\t\ttree.left = elem;\n\t\t\t\telem.parent = tree;\n\t\t\t\tthis.cmd(act.connect, tree.graphicID, elem.graphicID, LINK_COLOR);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\tthis.highlightID,\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\ttree.x,\n\t\t\t\t\ttree.y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\tthis.insert(elem, tree.left);\n\t\t\t}\n\t\t} else {\n\t\t\tif (tree.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Found null tree, inserting element');\n\t\t\t\tthis.cmd(act.setHighlight, elem.graphicID, 0);\n\t\t\t\ttree.right = elem;\n\t\t\t\telem.parent = tree;\n\t\t\t\tthis.cmd(act.connect, tree.graphicID, elem.graphicID, LINK_COLOR);\n\t\t\t\telem.x = tree.x + WIDTH_DELTA / 2;\n\t\t\t\telem.y = tree.y + HEIGHT_DELTA;\n\t\t\t\tthis.cmd(act.move, elem.graphicID, elem.x, elem.y);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\tthis.highlightID,\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\ttree.x,\n\t\t\t\t\ttree.y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\tthis.insert(elem, tree.right);\n\t\t\t}\n\t\t}\n\t}\n\n\tdeleteElement(deletedValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Deleting ' + deletedValue);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeDelete(this.treeRoot, deletedValue);\n\t\tthis.cmd(act.setText, 0, '');\n\t\t// Do delete\n\t\treturn this.commands;\n\t}\n\n\ttreeDelete(tree, valueToDelete) {\n\t\tthis.cmd(act.setText, 0, 'Finding ' + valueToDelete + ' and splaying to rooot');\n\t\tthis.cmd(act.step);\n\n\t\tconst inTree = this.doFind(this.treeRoot, valueToDelete);\n\t\tthis.cmd(act.setText, 0, 'Removing root, leaving left and right trees');\n\t\tthis.cmd(act.step);\n\t\tif (inTree) {\n\t\t\tif (this.treeRoot.right == null) {\n\t\t\t\tthis.cmd(act.delete, this.treeRoot.graphicID);\n\t\t\t\tthis.cmd(act.setText, 0, 'No right tree, make left tree the root.');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.treeRoot = this.treeRoot.left;\n\t\t\t\tthis.treeRoot.parent = null;\n\t\t\t\tthis.resizeTree();\n\t\t\t} else if (this.treeRoot.left == null) {\n\t\t\t\tthis.cmd(act.delete, this.treeRoot.graphicID);\n\t\t\t\tthis.cmd(act.setText, 0, 'No left tree, make right tree the root.');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.treeRoot = this.treeRoot.right;\n\t\t\t\tthis.treeRoot.parent = null;\n\t\t\t\tthis.resizeTree();\n\t\t\t} else {\n\t\t\t\tconst right = this.treeRoot.right;\n\t\t\t\tconst left = this.treeRoot.left;\n\t\t\t\tconst oldGraphicID = this.treeRoot.graphicID;\n\t\t\t\tthis.cmd(act.disconnect, this.treeRoot.graphicID, left.graphicID);\n\t\t\t\tthis.cmd(act.disconnect, this.treeRoot.graphicID, right.graphicID);\n\t\t\t\tthis.cmd(act.setAlpha, this.treeRoot.graphicID, 0);\n\t\t\t\tthis.cmd(act.setText, 0, 'Splay largest element in left tree to root');\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tleft.parent = null;\n\t\t\t\tconst largestLeft = this.findMax(left);\n\t\t\t\tthis.splayUp(largestLeft);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Left tree now has no right subtree, connect left and right trees',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.connect, largestLeft.graphicID, right.graphicID, LINK_COLOR);\n\t\t\t\tlargestLeft.parent = null;\n\t\t\t\tlargestLeft.right = right;\n\t\t\t\tright.parent = largestLeft;\n\t\t\t\tthis.treeRoot = largestLeft;\n\t\t\t\tthis.cmd(act.delete, oldGraphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t}\n\t}\n\n\tsingleRotateRight(tree) {\n\t\tconst B = tree;\n\t\t// const t3 = B.right;\n\t\tconst A = tree.left;\n\t\t// const t1 = A.left;\n\t\tconst t2 = A.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig Right');\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, LINK_COLOR);\n\t\tA.parent = B.parent;\n\t\tif (B.parent == null) {\n\t\t\tthis.treeRoot = A;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, B.parent.graphicID, B.graphicID, LINK_COLOR);\n\t\t\tthis.cmd(act.connect, B.parent.graphicID, A.graphicID, LINK_COLOR);\n\t\t\tif (B.isLeftChild()) {\n\t\t\t\tB.parent.left = A;\n\t\t\t} else {\n\t\t\t\tB.parent.right = A;\n\t\t\t}\n\t\t}\n\t\tA.right = B;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tthis.resizeTree();\n\t}\n\n\tzigZigRight(tree) {\n\t\tconst C = tree;\n\t\tconst B = tree.left;\n\t\tconst A = tree.left.left;\n\t\t// const t1 = A.left;\n\t\tconst t2 = A.right;\n\t\tconst t3 = B.right;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig-Zig Right');\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, B.graphicID, 0);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 0);\n\n\t\tif (C.parent != null) {\n\t\t\tthis.cmd(act.disconnect, C.parent.graphicID, C.graphicID);\n\t\t\tthis.cmd(act.connect, C.parent.graphicID, A.graphicID, LINK_COLOR);\n\t\t\tif (C.isLeftChild()) {\n\t\t\t\tC.parent.left = A;\n\t\t\t} else {\n\t\t\t\tC.parent.right = A;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.treeRoot = A;\n\t\t}\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t3.graphicID);\n\t\t\tthis.cmd(act.connect, C.graphicID, t3.graphicID, LINK_COLOR);\n\t\t\tt3.parent = C;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.disconnect, C.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, C.graphicID, LINK_COLOR);\n\n\t\tA.right = B;\n\t\tA.parent = C.parent;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tB.right = C;\n\t\tC.parent = B;\n\t\tC.left = t3;\n\t\tthis.resizeTree();\n\t}\n\n\tzigZigLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\tconst C = tree.right.right;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\tconst t3 = C.left;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig-Zig Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, C.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 0);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, C.graphicID, 0);\n\n\t\tif (A.parent != null) {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, C.graphicID, LINK_COLOR);\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = C;\n\t\t\t} else {\n\t\t\t\tA.parent.right = C;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.treeRoot = C;\n\t\t}\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = A;\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, C.graphicID, t3.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t3.graphicID, LINK_COLOR);\n\t\t\tt3.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.disconnect, B.graphicID, C.graphicID);\n\t\tthis.cmd(act.connect, C.graphicID, B.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tC.parent = A.parent;\n\t\tA.right = t2;\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tB.right = t3;\n\t\tC.left = B;\n\t\tB.parent = C;\n\n\t\tthis.resizeTree();\n\t}\n\n\tsingleRotateLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\t// const t3 = B.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = A;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tB.parent = A.parent;\n\t\tif (A.parent == null) {\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID, LINK_COLOR);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, LINK_COLOR);\n\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t}\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tA.right = t2;\n\n\t\tthis.resizeTree();\n\t}\n\n\tsplayUp(tree) {\n\t\tif (tree.parent == null) {\n\t\t\treturn;\n\t\t} else if (tree.parent.parent == null) {\n\t\t\tif (tree.isLeftChild()) {\n\t\t\t\tthis.singleRotateRight(tree.parent);\n\t\t\t} else {\n\t\t\t\tthis.singleRotateLeft(tree.parent);\n\t\t\t}\n\t\t} else if (tree.isLeftChild() && !tree.parent.isLeftChild()) {\n\t\t\tthis.doubleRotateLeft(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t} else if (!tree.isLeftChild() && tree.parent.isLeftChild()) {\n\t\t\tthis.doubleRotateRight(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t} else if (tree.isLeftChild()) {\n\t\t\tthis.zigZigRight(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t} else {\n\t\t\tthis.zigZigLeft(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t}\n\t}\n\n\tfindMax(tree) {\n\t\tif (tree.right != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\ttree.x,\n\t\t\t\ttree.y,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (tree.right != null) {\n\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\ttree = tree.right;\n\t\t\t}\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\treturn tree;\n\t\t} else {\n\t\t\treturn tree;\n\t\t}\n\t}\n\n\tdoubleRotateRight(tree) {\n\t\tthis.cmd(act.setText, 0, 'Zig-Zag Right');\n\t\tconst A = tree.left;\n\t\tconst B = tree.left.right;\n\t\tconst C = tree;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\tconst t3 = B.right;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tt2.parent = A;\n\t\t\tA.right = t2;\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t3.graphicID);\n\t\t\tt3.parent = C;\n\t\t\tC.left = t2;\n\t\t\tthis.cmd(act.connect, C.graphicID, t3.graphicID, LINK_COLOR);\n\t\t}\n\t\tif (C.parent == null) {\n\t\t\tB.parent = null;\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, C.parent.graphicID, C.graphicID);\n\t\t\tthis.cmd(act.connect, C.parent.graphicID, B.graphicID, LINK_COLOR);\n\t\t\tif (C.isLeftChild()) {\n\t\t\t\tC.parent.left = B;\n\t\t\t} else {\n\t\t\t\tC.parent.right = B;\n\t\t\t}\n\t\t\tB.parent = C.parent;\n\t\t\tC.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, C.graphicID, A.graphicID);\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.connect, B.graphicID, C.graphicID, LINK_COLOR);\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tB.right = C;\n\t\tC.parent = B;\n\t\tA.right = t2;\n\t\tC.left = t3;\n\n\t\tthis.resizeTree();\n\t}\n\n\tdoubleRotateLeft(tree) {\n\t\tthis.cmd(act.setText, 0, 'Zig-Zag Left');\n\t\tconst A = tree;\n\t\tconst B = tree.right.left;\n\t\tconst C = tree.right;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\tconst t3 = B.right;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, C.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, B.graphicID, 1);\n\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tt2.parent = A;\n\t\t\tA.right = t2;\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t3.graphicID);\n\t\t\tt3.parent = C;\n\t\t\tC.left = t2;\n\t\t\tthis.cmd(act.connect, C.graphicID, t3.graphicID, LINK_COLOR);\n\t\t}\n\n\t\tif (A.parent == null) {\n\t\t\tB.parent = null;\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, LINK_COLOR);\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t\tB.parent = A.parent;\n\t\t\tA.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, C.graphicID);\n\t\tthis.cmd(act.disconnect, C.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.connect, B.graphicID, C.graphicID, LINK_COLOR);\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tB.right = C;\n\t\tC.parent = B;\n\t\tA.right = t2;\n\t\tC.left = t3;\n\n\t\tthis.resizeTree();\n\t}\n\n\tresizeTree() {\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n\nclass BSTNode {\n\tconstructor(val, id, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n\n\tisLeftChild() {\n\t\tif (this.parent == null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.parent.left === this;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 15;\n\nconst INFO_MSG_X = 20;\nconst INFO_MSG_Y = 150;\nconst CODE_START_X = 25;\nconst CODE_START_Y = 35;\nconst CODE_LINE_HEIGHT = 14;\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\nconst CODE_STANDARD_COLOR = '#000000';\n\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\nconst ARRAY_INITIAL_X = 400;\nconst ARRAY_INITIAL_Y = 50;\n\nconst HEAP_ARRAY_ELEM_WIDTH = 40;\nconst HEAP_ARRAY_ELEM_HEIGHT = 30;\nconst HEAP_INITIAL_X = 400;\nconst HEAP_INITIAL_Y = 150;\nconst HEAP_LABEL_Y_POS = 180;\n\nconst HEAP_X_POSITIONS = [\n\t0, 450, 250, 650, 150, 350, 550, 750, 100, 200, 300, 400, 500, 600, 700, 800, 75, 125, 175, 225,\n\t275, 325, 375, 425, 475, 525, 575, 625, 675, 725, 775, 825,\n];\n\nconst HEAP_Y_POSITIONS = [\n\t0, 250, 320, 320, 390, 390, 390, 390, 460, 460, 460, 460, 460, 460, 460, 460, 530, 530, 530,\n\t530, 530, 530, 530, 530, 530, 530, 530, 530, 530, 530, 530, 530,\n];\n\nexport default class HeapSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 15 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.heapArrayData = [];\n\t\tthis.heapArrayID = [];\n\t\tthis.heapArrayLabelID = [];\n\t\tthis.heapTreeObj = [];\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.code = [\n\t\t\t['procedure heapSort(array)'],\n\t\t\t['     heap <- create new PriorityQueue(array)'],\n\t\t\t['     for i <- 0, array.length - 1, loop:'],\n\t\t\t['          add ', 'heap.remove()', ' to data[i]'],\n\t\t\t['     end for'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = Array(this.code.length);\n\t\tlet i, j;\n\t\tfor (i = 0; i < this.code.length; i++) {\n\t\t\tthis.codeID[i] = new Array(this.code[i].length);\n\t\t\tfor (j = 0; j < this.code[i].length; j++) {\n\t\t\t\tthis.codeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.codeID[i][j],\n\t\t\t\t\tthis.code[i][j],\n\t\t\t\t\tCODE_START_X,\n\t\t\t\t\tCODE_START_Y + i * CODE_LINE_HEIGHT,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[i][j], CODE_STANDARD_COLOR);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, this.codeID[i][j], this.codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tsort(list) {\n\t\tthis.commands = [];\n\n\t\tthis.highlight(0, 0);\n\n\t\tthis.arrayData = list\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tconst length = this.arrayData.length;\n\t\tconst displayDataTemp = new Array(length);\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_INITIAL_X;\n\t\t\tconst ypos = ARRAY_INITIAL_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tdisplayDataTemp[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\t\tthis.arrayData = displayDataTemp;\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\n\t\t//Create a new heap\n\t\tthis.highlight(1, 0);\n\t\tthis.createHeap(this.arrayData);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Buildheap the new array');\n\t\t//Buildheap the new heap\n\t\tlet nextElem = Math.floor(this.currentHeapSize / 2);\n\t\twhile (nextElem > 0) {\n\t\t\tthis.pushDown(nextElem);\n\t\t\tnextElem = nextElem - 1;\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.unhighlight(1, 0);\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\n\n\t\t//Remove all of the elements from the heap\n\t\twhile (this.currentHeapSize > 0) {\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.remove();\n\t\t}\n\n\t\tthis.highlight(4, 0);\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < length + 1; i++) {\n\t\t\tthis.cmd(act.delete, this.heapArrayID[i]);\n\t\t\tthis.cmd(act.delete, this.heapArrayLabelID[i]);\n\t\t}\n\t\tthis.unhighlight(4, 0);\n\t\tthis.highlight(5, 0);\n\t\tthis.cmd(act.step);\n\n\t\tthis.unhighlight(5, 0);\n\n\t\treturn this.commands;\n\t}\n\n\tcreateHeap(arrayData) {\n\t\tconst length = arrayData.length + 1;\n\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Array-backed heap created');\n\n\t\tthis.heapArrayXPositions = new Array(length);\n\t\tthis.heapArrayData = arrayData.slice();\n\t\tthis.heapArrayData.unshift(null);\n\t\tthis.currentHeapSize = length - 1;\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\t//Create heap array\n\t\t\tthis.heapArrayXPositions[i] = HEAP_INITIAL_X + i * HEAP_ARRAY_ELEM_WIDTH;\n\t\t\tthis.heapArrayID[i] = this.nextIndex++;\n\t\t\tthis.heapArrayLabelID[i] = this.nextIndex++;\n\t\t\tthis.heapTreeObj[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.heapArrayID[i],\n\t\t\t\tthis.heapArrayData[i],\n\t\t\t\tHEAP_ARRAY_ELEM_WIDTH,\n\t\t\t\tHEAP_ARRAY_ELEM_HEIGHT,\n\t\t\t\tthis.heapArrayXPositions[i],\n\t\t\t\tHEAP_INITIAL_Y,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.heapArrayLabelID[i],\n\t\t\t\ti,\n\t\t\t\tthis.heapArrayXPositions[i],\n\t\t\t\tHEAP_LABEL_Y_POS,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.heapArrayLabelID[i], '#0000FF');\n\n\t\t\t//Create heap tree\n\t\t\tif (i > 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createCircle,\n\t\t\t\t\tthis.heapTreeObj[i],\n\t\t\t\t\tthis.heapArrayData[i],\n\t\t\t\t\tHEAP_X_POSITIONS[i],\n\t\t\t\t\tHEAP_Y_POSITIONS[i],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setText, this.heapArrayID[i], this.heapArrayData[i]);\n\t\t\t\tif (i > 1) {\n\t\t\t\t\tthis.cmd(act.connect, this.heapTreeObj[Math.floor(i / 2)], this.heapTreeObj[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tremove() {\n\t\tconst index = this.arrayData.length - this.currentHeapSize;\n\t\tconst remData = this.heapArrayData[1];\n\t\tconst removedElementID = this.nextIndex; //no ++ since 'removedElementID' is deleted before any other elements are created\n\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\n\n\t\tthis.highlight(3, 0);\n\t\tthis.highlight(3, 1);\n\t\tthis.highlight(3, 2);\n\n\t\tthis.cmd(act.setText, this.heapArrayID[1], '');\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tremovedElementID,\n\t\t\tremData,\n\t\t\tHEAP_X_POSITIONS[1],\n\t\t\tHEAP_Y_POSITIONS[1],\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.setText, this.heapTreeObj[1], '');\n\t\tthis.cmd(act.setText, this.arrayID[index], '');\n\t\tthis.cmd(\n\t\t\tact.move,\n\t\t\tremovedElementID,\n\t\t\tindex * ARRAY_ELEM_WIDTH + ARRAY_INITIAL_X - 5,\n\t\t\tARRAY_INITIAL_Y - 5,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayData[index] = remData;\n\t\tthis.cmd(act.setText, this.arrayID[index], remData);\n\t\tthis.cmd(act.delete, removedElementID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.heapArrayData[1] = '';\n\n\t\tthis.unhighlight(3, 0);\n\t\tthis.unhighlight(3, 2);\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Downheap to maintain order');\n\n\t\tif (this.currentHeapSize > 1) {\n\t\t\tthis.cmd(act.setHighlight, this.heapArrayID[1], 1);\n\t\t\tthis.cmd(act.setHighlight, this.heapArrayID[this.currentHeapSize], 1);\n\t\t\tthis.cmd(act.setHighlight, this.heapTreeObj[1], 1);\n\t\t\tthis.cmd(act.setHighlight, this.heapTreeObj[this.currentHeapSize], 1);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.cmd(act.setHighlight, this.heapArrayID[1], 0);\n\t\t\tthis.cmd(act.setHighlight, this.heapArrayID[this.currentHeapSize], 0);\n\t\t\tthis.cmd(act.setHighlight, this.heapTreeObj[1], 0);\n\t\t\tthis.cmd(act.setHighlight, this.heapTreeObj[this.currentHeapSize], 0);\n\t\t\tthis.swap(1, this.currentHeapSize);\n\n\t\t\tthis.cmd(act.delete, this.heapTreeObj[this.currentHeapSize]);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.currentHeapSize--;\n\t\t\tif (this.currentHeapSize > 0) {\n\t\t\t\tthis.pushDown(1);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.heapArrayID[1], '');\n\t\t\tthis.cmd(act.delete, this.heapTreeObj[this.currentHeapSize]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.currentHeapSize--;\n\t\t}\n\t\tthis.unhighlight(3, 1);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tpushDown(index) {\n\t\tlet childIndex; // Used to keep track of smallest (in MinHeap) or largest (in MaxHeap) child\n\n\t\twhile (index * 2 <= this.currentHeapSize) {\n\t\t\tchildIndex = 2 * index;\n\n\t\t\tif (index * 2 + 1 <= this.currentHeapSize) {\n\t\t\t\tthis.setIndexHighlight(2 * index, 1);\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.setIndexHighlight(2 * index, 0);\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 0);\n\t\t\t\tif (this.downheapCheckRightChild(index)) {\n\t\t\t\t\tchildIndex = 2 * index + 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setIndexHighlight(index, 1);\n\t\t\tthis.setIndexHighlight(childIndex, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.setIndexHighlight(index, 0);\n\t\t\tthis.setIndexHighlight(childIndex, 0);\n\n\t\t\tif (this.downheapCompare(childIndex, index)) {\n\t\t\t\tthis.swap(childIndex, index);\n\t\t\t\tindex = childIndex;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdownheapCheckRightChild(index) {\n\t\t// Checks if the right child is smaller than left child\n\t\treturn this.compareWithLetters(\n\t\t\tthis.heapArrayData[2 * index + 1],\n\t\t\tthis.heapArrayData[2 * index],\n\t\t);\n\t}\n\n\tdownheapCompare(childIndex, index) {\n\t\t// Checks if smallest child is smaller than parent\n\t\treturn this.compareWithLetters(this.heapArrayData[childIndex], this.heapArrayData[index]);\n\t}\n\n\tcompareWithLetters(num1, num2) {\n\t\treturn parseInt(num1) < parseInt(num2);\n\t}\n\n\tswap(index1, index2) {\n\t\tconst swapLabel1 = this.nextIndex++;\n\t\tconst swapLabel2 = this.nextIndex++;\n\t\tconst swapLabel3 = this.nextIndex++;\n\t\tconst swapLabel4 = this.nextIndex++;\n\t\tthis.cmd(act.setText, this.heapArrayID[index1], '');\n\t\tthis.cmd(act.setText, this.heapArrayID[index2], '');\n\t\tthis.cmd(act.setText, this.heapTreeObj[index1], '');\n\t\tthis.cmd(act.setText, this.heapTreeObj[index2], '');\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tswapLabel1,\n\t\t\tthis.heapArrayData[index1],\n\t\t\tthis.heapArrayXPositions[index1],\n\t\t\tHEAP_INITIAL_Y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tswapLabel2,\n\t\t\tthis.heapArrayData[index2],\n\t\t\tthis.heapArrayXPositions[index2],\n\t\t\tHEAP_INITIAL_Y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tswapLabel3,\n\t\t\tthis.heapArrayData[index1],\n\t\t\tHEAP_X_POSITIONS[index1],\n\t\t\tHEAP_Y_POSITIONS[index1],\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tswapLabel4,\n\t\t\tthis.heapArrayData[index2],\n\t\t\tHEAP_X_POSITIONS[index2],\n\t\t\tHEAP_Y_POSITIONS[index2],\n\t\t);\n\t\tthis.cmd(act.move, swapLabel1, this.heapArrayXPositions[index2], HEAP_INITIAL_Y);\n\t\tthis.cmd(act.move, swapLabel2, this.heapArrayXPositions[index1], HEAP_INITIAL_Y);\n\t\tthis.cmd(act.move, swapLabel3, HEAP_X_POSITIONS[index2], HEAP_Y_POSITIONS[index2]);\n\t\tthis.cmd(act.move, swapLabel4, HEAP_X_POSITIONS[index1], HEAP_Y_POSITIONS[index1]);\n\t\tconst tmp = this.heapArrayData[index1];\n\t\tthis.heapArrayData[index1] = this.heapArrayData[index2];\n\t\tthis.heapArrayData[index2] = tmp;\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.heapArrayID[index1], this.heapArrayData[index1]);\n\t\tthis.cmd(act.setText, this.heapArrayID[index2], this.heapArrayData[index2]);\n\t\tthis.cmd(act.setText, this.heapTreeObj[index1], this.heapArrayData[index1]);\n\t\tthis.cmd(act.setText, this.heapTreeObj[index2], this.heapArrayData[index2]);\n\t\tthis.cmd(act.delete, swapLabel1);\n\t\tthis.cmd(act.delete, swapLabel2);\n\t\tthis.cmd(act.delete, swapLabel3);\n\t\tthis.cmd(act.delete, swapLabel4);\n\t\tthis.nextIndex -= 4;\n\t}\n\n\tsetIndexHighlight(index, highlightVal) {\n\t\tthis.cmd(act.setHighlight, this.heapTreeObj[index], highlightVal);\n\t\tthis.cmd(act.setHighlight, this.heapArrayID[index], highlightVal);\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.heapArrayData = [];\n\t\tthis.heapArrayID = [];\n\t\tthis.heapArrayLabelID = [];\n\n\t\treturn this.commands;\n\t}\n\n\treset() {\n\t\tthis.currentHeapSize = 0;\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\thighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\n\t}\n\n\tunhighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","import * as algos from './algo';\n\n// After adding the export in algos/index.js, add new algorithms in the following format:\n// AlgorithmName: ['Menu Display Name', algos.ClassName, 'Verbose Display Name (optional)']\nexport const algoMap = {\n\tArrayList: ['ArrayList', algos.ArrayList],\n\tLinkedList: ['Singly LinkedList', algos.LinkedList],\n\tDoublyLinkedList: ['Doubly LinkedList', algos.DoublyLinkedList],\n\tCircularlyLinkedList: ['Circularly LinkedList', algos.CircularlyLinkedList],\n\tStackArray: ['Stack (Array)', algos.StackArray],\n\tStackLL: ['Stack (LinkedList)', algos.StackLL],\n\tQueueArray: ['Queue (Array)', algos.QueueArray],\n\tQueueLL: ['Queue (LinkedList)', algos.QueueLL],\n\tDequeArray: ['Deque (Array)', algos.DequeArray],\n\tDequeLL: ['Deque (LinkedList)', algos.DequeLL],\n\tBST: ['Binary Search Tree', algos.BST],\n\tHeap: ['Heaps / PQs', algos.Heap],\n\tSkipList: ['SkipList', algos.SkipList],\n\tClosedHash: ['HashMap (Probing)', algos.ClosedHash],\n\tOpenHash: ['HashMap (Chaining)', algos.OpenHash],\n\tSplayTree: ['SplayTree', algos.SplayTree],\n\tAVL: ['AVL', algos.AVL],\n\tBTree: ['2-4 Tree', algos.BTree],\n\tBubbleSort: ['Bubble Sort', algos.BubbleSort],\n\tCocktailSort: ['Cocktail Shaker Sort', algos.CocktailSort],\n\tInsertionSort: ['Insertion Sort', algos.InsertionSort],\n\tSelectionSort: ['Selection Sort', algos.SelectionSort],\n\tQuickSort: ['QuickSort', algos.QuickSort],\n\tQuickSelect: ['QuickSelect / kᵗʰ Select', algos.QuickSelect],\n\tMergeSort: ['MergeSort', algos.MergeSort],\n\tLSDRadix: ['LSD Radix Sort', algos.LSDRadix],\n\tHeapSort: ['HeapSort', algos.HeapSort],\n\tBruteForce: ['Brute Force', algos.BruteForce],\n\tBoyerMoore: ['Boyer-Moore', algos.BoyerMoore],\n\tKMP: ['KMP', algos.KMP],\n\tRabinKarp: ['Rabin-Karp', algos.RabinKarp],\n\tBFS: ['Breadth-First Search', algos.BFS],\n\tDFS: ['Depth-First Search', algos.DFS],\n\tDijkstra: [\"Dijkstra's\", algos.Dijkstras],\n\tPrim: [\"Prim's\", algos.Prims],\n\tKruskal: [\"Kruskal's\", algos.Kruskals],\n\tLCS: ['LCS', algos.LCS, 'Longest Common Subsequence'],\n\tFloyd: ['Floyd-Warshall', algos.Floyd],\n};\n\nexport const algoList = [\n\t'Lists',\n\t'ArrayList',\n\t'LinkedList',\n\t'DoublyLinkedList',\n\t'CircularlyLinkedList',\n\t'Stacks, Queues and Deques',\n\t'StackArray',\n\t'StackLL',\n\t'QueueArray',\n\t'QueueLL',\n\t'DequeArray',\n\t'DequeLL',\n\t'Trees and SkipList',\n\t'BST',\n\t'Heap',\n\t'AVL',\n\t'BTree',\n\t'SplayTree',\n\t'SkipList',\n\t'HashMaps',\n\t'ClosedHash',\n\t'OpenHash',\n\t'Sorting and QuickSelect',\n\t'BubbleSort',\n\t'CocktailSort',\n\t'InsertionSort',\n\t'SelectionSort',\n\t'QuickSort',\n\t'QuickSelect',\n\t'MergeSort',\n\t'LSDRadix',\n\t'HeapSort',\n\t'String Searching',\n\t'BruteForce',\n\t'BoyerMoore',\n\t'KMP',\n\t'RabinKarp',\n\t'Graph Algorithms',\n\t'BFS',\n\t'DFS',\n\t'Dijkstra',\n\t'Prim',\n\t'Kruskal',\n\t'Dynamic Programming',\n\t'LCS',\n\t'Floyd',\n];\n","/* eslint-disable lines-between-class-members */\n// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 150;\nconst RESIZE_ARRAY_START_X = 100;\nconst RESIZE_ARRAY_START_Y = 280;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRAY_ELEMS_PER_LINE = 14;\nconst ARRAY_LINE_SPACING = 130;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\nconst PUSH_RESIZE_LABEL_X = 60;\nconst PUSH_RESIZE_LABEL_Y = 60;\n\nconst SIZE = 7;\nconst MAX_SIZE = 30;\n\nexport default class ArrayList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Front',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Back',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add at Index',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Index',\n\t\t\tremoveTopHorizontalGroup,\n\t\t);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Front',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Back',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tthis.size = 0;\n\t\tthis.length = SIZE;\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], '#0000FF');\n\t\t}\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.size = 0;\n\t\tthis.length = SIZE;\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.highlight1ID = this.nextIndex++;\n\t}\n\n\taddIndexCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\tthis.addIndexField.value !== '' &&\n\t\t\t!(this.length === this.size && this.length * 2 > MAX_SIZE)\n\t\t) {\n\t\t\tconst addVal = this.addValueField.value;\n\t\t\tconst index = this.addIndexField.value;\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tif (this.size === this.length) {\n\t\t\t\t\tthis.implementAction(this.resize.bind(this), addVal, index);\n\t\t\t\t} else {\n\t\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\t!(this.length === this.size && this.length * 2 > MAX_SIZE)\n\t\t) {\n\t\t\tconst addVal = this.addValueField.value;\n\t\t\tthis.addValueField.value = '';\n\t\t\tif (this.size === this.length) {\n\t\t\t\tthis.implementAction(this.resize.bind(this), addVal, 0);\n\t\t\t} else {\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\t!(this.length === this.size && this.length * 2 > MAX_SIZE)\n\t\t) {\n\t\t\tconst addVal = this.addValueField.value;\n\t\t\tthis.addValueField.value = '';\n\t\t\tif (this.size === this.length) {\n\t\t\t\tthis.implementAction(this.resize.bind(this), addVal, this.size);\n\t\t\t} else {\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.clearAll();\n\t\treturn this.commands;\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = this.size; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\tif (index !== this.size) {\n\t\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\t\tconst ypos =\n\t\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\t\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], this.arrayData[i + 1], xpos, ypos);\n\t\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos + ARRAY_ELEM_WIDTH, ypos);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\t\tthis.cmd(act.setText, this.arrayID[i + 1], this.arrayData[i + 1]);\n\t\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\t'#0000FF',\n\t\t\tPUSH_ELEMENT_X,\n\t\t\tPUSH_ELEMENT_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (parseInt(index) % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(parseInt(index) / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos);\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\tif (index != null) {\n\t\t\tthis.nextIndex = this.nextIndex - (this.size - index) - 2;\n\t\t} else {\n\t\t\tthis.nextIndex = this.nextIndex - 2;\n\t\t}\n\n\t\tthis.size = this.size + 1;\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tconst xpos = (index % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos = Math.floor(index / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, '#0000FF', xpos, ypos);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[index], '');\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos - 100);\n\t\tthis.cmd(act.move, labPopValID, xpos, ypos - 100);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t}\n\t\tthis.arrayData[this.size] = null;\n\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\tfor (let i = index + 1; i < this.size; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], this.arrayData[i - 1], xpos, ypos);\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos - ARRAY_ELEM_WIDTH, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = index + 1; i < this.size; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i - 1], this.arrayData[i - 1]);\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tif (index != null) {\n\t\t\tthis.nextIndex = this.nextIndex - (this.size - index);\n\t\t} else {\n\t\t\tthis.nextIndex = this.nextIndex - 2;\n\t\t}\n\n\t\tthis.size = this.size - 1;\n\n\t\treturn this.commands;\n\t}\n\n\tresize(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tconst labPushResizeID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPushResizeID,\n\t\t\t'(Resize Required)',\n\t\t\tPUSH_RESIZE_LABEL_X,\n\t\t\tPUSH_RESIZE_LABEL_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayIDNew = new Array(this.size * 2);\n\t\tthis.arrayLabelIDNew = new Array(this.size * 2);\n\t\tthis.arrayDataNew = new Array(this.size * 2);\n\n\t\tthis.length = this.length * 2;\n\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tthis.arrayIDNew[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelIDNew[i] = this.nextIndex++;\n\t\t\tif (i < index) {\n\t\t\t\tthis.arrayDataNew[i] = this.arrayData[i];\n\t\t\t} else if (i > index && i <= this.size) {\n\t\t\t\tthis.arrayDataNew[i] = this.arrayData[i - 1];\n\t\t\t}\n\t\t}\n\n\t\tthis.arrayDataNew[index] = elemToAdd;\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\t//Create new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayIDNew[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelIDNew[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelIDNew[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\t//Move elements before index from old array\n\t\tfor (let i = 0; i < index; i++) {\n\t\t\tconst xposinit = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yposinit =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], this.arrayData[i], xposinit, yposinit);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//delete movement id objects and set text\n\t\tfor (let i = 0; i < index; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\tthis.cmd(act.setText, this.arrayIDNew[i], this.arrayData[i]);\n\t\t}\n\n\t\t//Add elemToAdd at the index\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\t'#0000FF',\n\t\t\tPUSH_ELEMENT_X,\n\t\t\tPUSH_ELEMENT_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos =\n\t\t\t(parseInt(index) % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(parseInt(index) / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\tRESIZE_ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos);\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayIDNew[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\t//Move elements after index from old array\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tconst xposinit = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yposinit =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tconst xpos = (i % (ARRAY_ELEMS_PER_LINE - 1)) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / (ARRAY_ELEMS_PER_LINE - 1)) * ARRAY_LINE_SPACING +\n\t\t\t\tRESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], this.arrayData[i], xposinit, yposinit);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos + ARRAY_ELEM_WIDTH, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//delete movement id objects\n\t\tfor (let i = index; i <= this.size; i++) {\n\t\t\tif (i < this.size) {\n\t\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\t}\n\t\t\tthis.cmd(act.setText, this.arrayIDNew[i], this.arrayData[i - 1]);\n\t\t}\n\n\t\tthis.cmd(act.setText, this.arrayIDNew[index], elemToAdd);\n\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.delete, labPushResizeID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t\tthis.cmd(act.delete, this.arrayLabelID[i]);\n\t\t}\n\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tthis.cmd(act.move, this.arrayIDNew[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.arrayLabelIDNew[i], xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t}\n\n\t\tthis.arrayID = this.arrayIDNew;\n\t\tthis.arrayLabelID = this.arrayLabelIDNew;\n\t\tthis.arrayData = this.arrayDataNew;\n\n\t\tif (index != null) {\n\t\t\tthis.nextIndex = this.nextIndex - this.size;\n\t\t}\n\n\t\tthis.size = this.size + 1;\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t\tthis.arrayData[i] = null;\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst TOP_ELEM_WIDTH = 30;\nconst TOP_ELEM_HEIGHT = 30;\n\nconst SIZE = 32;\n\nexport default class LinkedList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Front',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Back',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add at Index',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Index',\n\t\t\tremoveTopHorizontalGroup,\n\t\t);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Front',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Back',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.topID = this.nextIndex++;\n\t\tthis.topLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\t// this.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.cmd(act.createLabel, this.topLabelID, 'Head', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.topID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y,\n\t\t);\n\t\tthis.cmd(act.setNull, this.topID, 1);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddIndexCallback() {\n\t\tif (this.addValueField.value !== '' && this.addIndexField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// getCallback()\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\ttraverse(index) {\n\t\tfor (let i = 0; i <= index; i++) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.linkedListElemID[i], 1);\n\t\t\tif (i > 0) {\n\t\t\t\tthis.cmd(act.setHighlight, this.linkedListElemID[i - 1], 0);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.traverse(index - 1);\n\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tthis.linkedListElemID[index],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (index === this.size) {\n\t\t\t// adding to back , dont need to do anything to head\n\t\t\tthis.cmd(act.setNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (this.size !== 0) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[index + 1]);\n\t\t\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[index]);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t} else if (index === this.size) {\n\t\t\t\tthis.cmd(act.setNull, this.linkedListElemID[index - 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[0]);\n\t\t}\n\n\t\tthis.cmd(act.setHighlight, this.linkedListElemID[index - 1], 0);\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.resetNodePositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.traverse(index - 1);\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[index]);\n\t\t\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[index + 1]);\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setNull, this.linkedListElemID[index - 1], 1);\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[index]);\n\n\t\tthis.cmd(act.setHighlight, this.linkedListElemID[index - 1], 0);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 100;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 150;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst HEAD_POS_X = 180;\nconst HEAD_POS_Y = 100;\n\nconst TAIL_POS_X = 180;\n\nconst POINTER_LABEL_X = 130;\nconst HEAD_LABEL_Y = 100;\n\nconst POINTER_ELEM_WIDTH = 30;\nconst POINTER_ELEM_HEIGHT = 30;\n\nconst SIZE = 32;\n\nexport default class DoublyLinkedList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.tail_pos_y = h - LINKED_LIST_ELEM_HEIGHT;\n\t\tthis.tail_label_y = this.tail_pos_y;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Front',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Back',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add at Index',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Index',\n\t\t\tremoveTopHorizontalGroup,\n\t\t);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Front',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Back',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.headID = this.nextIndex++;\n\t\tthis.headLabelID = this.nextIndex++;\n\n\t\tthis.tailID = this.nextIndex++;\n\t\tthis.tailLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.headLabelID, 'Head', POINTER_LABEL_X, HEAD_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.headID,\n\t\t\t'',\n\t\t\tPOINTER_ELEM_WIDTH,\n\t\t\tPOINTER_ELEM_HEIGHT,\n\t\t\tHEAD_POS_X,\n\t\t\tHEAD_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.tailLabelID, 'Tail', POINTER_LABEL_X, this.tail_label_y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.tailID,\n\t\t\t'',\n\t\t\tPOINTER_ELEM_WIDTH,\n\t\t\tPOINTER_ELEM_HEIGHT,\n\t\t\tTAIL_POS_X,\n\t\t\tthis.tail_pos_y,\n\t\t);\n\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\tthis.cmd(act.setNull, this.tailID, 1);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddIndexCallback() {\n\t\tif (this.addValueField.value !== '' && this.addIndexField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// DoublyLinkedList.prototype.getCallback = function(event)\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\ttraverse(index) {\n\t\tif (index < Math.floor(this.size / 2)) {\n\t\t\tfor (let i = 0; i <= index; i++) {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, this.linkedListElemID[i], 1);\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tthis.cmd(act.setHighlight, this.linkedListElemID[i - 1], 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t} else {\n\t\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, this.linkedListElemID[i], 1);\n\t\t\t\tif (i < this.size) {\n\t\t\t\t\tthis.cmd(act.setHighlight, this.linkedListElemID[i + 1], 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\t// iterate to the correct node if it is an index != 0 or size\n\t\tconst indexToTraverseTo = index < Math.floor(this.size / 2) ? index - 1 : index;\n\t\tif (index > 0 && index < this.size) {\n\t\t\tthis.traverse(indexToTraverseTo);\n\t\t}\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createDoublyLinkedListNode,\n\t\t\tthis.linkedListElemID[index],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (index === 0) {\n\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index], 1);\n\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[index]);\n\t\t}\n\n\t\tif (index === this.size) {\n\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index], 1);\n\t\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[index]);\n\t\t}\n\n\t\tif (this.size !== 0) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[index + 1]);\n\t\t\t} else if (index === this.size) {\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[index - 1]);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.setHighlight,\n\t\t\tthis.linkedListElemID[\n\t\t\t\tindex < Math.floor(this.size / 2) ? indexToTraverseTo : indexToTraverseTo + 1\n\t\t\t],\n\t\t\t0,\n\t\t);\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.resetNodePositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tif (index > 0 && index < this.size - 1) {\n\t\t\tthis.traverse(index);\n\t\t}\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 1);\n\t\t\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[index]);\n\t\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[index + 1]);\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 1);\n\t\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[index]);\n\t\t\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[index - 1]);\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[index]);\n\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[index]);\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[index]);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\tthis.cmd(act.setNull, this.tailID, 1);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 9;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst HEAD_POS_X = 180;\nconst HEAD_POS_Y = 100;\n\nconst POINTER_LABEL_X = 130;\nconst HEAD_LABEL_Y = 100;\n\nconst POINTER_ELEM_WIDTH = 30;\nconst POINTER_ELEM_HEIGHT = 30;\n\nconst SIZE = 9;\n\nexport default class CircularlyLinkedList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Front',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Back',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add at Index',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Index',\n\t\t\tremoveTopHorizontalGroup,\n\t\t);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Front',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Back',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.headID = this.nextIndex++;\n\t\tthis.headLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.headLabelID, 'Head', POINTER_LABEL_X, HEAD_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.headID,\n\t\t\t'',\n\t\t\tPOINTER_ELEM_WIDTH,\n\t\t\tPOINTER_ELEM_HEIGHT,\n\t\t\tHEAD_POS_X,\n\t\t\tHEAD_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddIndexCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\tthis.addIndexField.value !== '' &&\n\t\t\tthis.size < SIZE\n\t\t) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// CircularlySinglyLinkedList.prototype.getCallback = function()\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\ttraverse(index) {\n\t\tfor (let i = 0; i <= index; i++) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.linkedListElemID[i], 1);\n\t\t\tif (i > 0) {\n\t\t\t\tthis.cmd(act.setHighlight, this.linkedListElemID[i - 1], 0);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tif (index < this.size) {\n\t\t\tthis.traverse(index - 1);\n\t\t}\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\t// Order of data should behave as normal\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\n\t\t// Adding to the front or back using O(1) trick, so new node will be added to index 1\n\t\tif (this.size !== 0 && (index === 0 || index === this.size)) {\n\t\t\t// Move over all node IDs but the first\n\t\t\tfor (let i = this.size - 1; i >= 1; i--) {\n\t\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t\t}\n\t\t\t// Place new node's ID at index 1\n\t\t\tthis.linkedListElemID[1] = this.nextIndex++;\n\t\t}\n\t\t// Adding first node or to the middle, so new node will be placed normally\n\t\telse {\n\t\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t\t}\n\t\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tif (this.size !== 0 && (index === 0 || index === this.size)) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircularlyLinkedListNode,\n\t\t\t\tthis.linkedListElemID[1],\n\t\t\t\t'',\n\t\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\t\tLINKED_LIST_INSERT_X,\n\t\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircularlyLinkedListNode,\n\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t'',\n\t\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\t\tLINKED_LIST_INSERT_X,\n\t\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size === 0) {\n\t\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.cmd(act.setText, this.linkedListElemID[0], elemToAdd);\n\t\t\tthis.cmd(act.delete, labPushValID);\n\t\t\tthis.cmd(act.connectCurve, this.linkedListElemID[0], this.linkedListElemID[0], -0.5);\n\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[0]);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.size = this.size + 1;\n\t\t\tthis.resetNodePositions();\n\t\t} else {\n\t\t\tif (index === 0 || index === this.size) {\n\t\t\t\t// Move label from first node to new node\n\t\t\t\tconst labCopiedValID = this.nextIndex++;\n\t\t\t\tconst copiedData = index === 0 ? this.arrayData[1] : this.arrayData[0];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tlabCopiedValID,\n\t\t\t\t\tcopiedData,\n\t\t\t\t\tLINKED_LIST_START_X,\n\t\t\t\t\tLINKED_LIST_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, labCopiedValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[1], copiedData);\n\t\t\t\tthis.cmd(act.delete, labCopiedValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t// Move label for new data to the first node\n\t\t\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_START_X, LINKED_LIST_START_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[0], elemToAdd);\n\t\t\t\tthis.cmd(act.delete, labPushValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t// Change pointers\n\t\t\t\tif (this.size === 1) {\n\t\t\t\t\t// Case where we're adding the second node\n\t\t\t\t\tthis.cmd(act.disconnect, this.linkedListElemID[0], this.linkedListElemID[0]); // Disconnect head node from itself\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[0], this.linkedListElemID[1]); // Connect head node to new node\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t); // Connect new node to head node\n\t\t\t\t} else {\n\t\t\t\t\t// Other cases\n\t\t\t\t\tthis.cmd(act.disconnect, this.linkedListElemID[0], this.linkedListElemID[2]); // Disconnect head from old second node\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[0], this.linkedListElemID[1]); // Connect head node to new node\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[1], this.linkedListElemID[2]); // Connect new node to old second node\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.size = this.size + 1;\n\t\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[0]);\n\t\t\t\tthis.resetNodePositions();\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t// If adding to the back, \"move head over\" (rotate elements backwards)\n\t\t\t\tif (index === this.size - 1) {\n\t\t\t\t\t// We increment size above, so subtract one to check if adding to back\n\t\t\t\t\tlet i;\n\t\t\t\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[0]);\n\t\t\t\t\tconst firstNodeID = this.linkedListElemID[0];\n\t\t\t\t\tfor (i = 0; i < this.size - 1; i++) {\n\t\t\t\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t\t\t\t}\n\t\t\t\t\tthis.linkedListElemID[this.size - 1] = firstNodeID;\n\n\t\t\t\t\tconst lastX =\n\t\t\t\t\t\t((this.size - 1) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\t\tconst lastY =\n\t\t\t\t\t\tMath.floor((this.size - 1) / LINKED_LIST_ELEMS_PER_LINE) *\n\t\t\t\t\t\t\tLINKED_LIST_LINE_SPACING +\n\t\t\t\t\t\tLINKED_LIST_START_Y;\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tthis.linkedListElemID[i],\n\t\t\t\t\t\t(LINKED_LIST_START_X + lastX) / 2,\n\t\t\t\t\t\tlastY + LINKED_LIST_ELEM_HEIGHT * 3,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[0]);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tfor (let i = 0; i < this.size - 1; i++) {\n\t\t\t\t\t\tconst nextX =\n\t\t\t\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\t\t\tconst nextY =\n\t\t\t\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\t\t\t\tLINKED_LIST_START_Y;\n\t\t\t\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.disconnect,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 2],\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t); // Disconnect curved pointer\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 2],\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t); // Connect with normal pointer\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.disconnect,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t); // Disconnect normal pointer\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t); // Connect with curved pointer\n\t\t\t\t\tthis.cmd(act.move, this.linkedListElemID[i], lastX, lastY);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\t\t\tthis.cmd(act.delete, labPushValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\n\t\t\t\tthis.size = this.size + 1;\n\t\t\t\tthis.resetNodePositions();\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.setHighlight, this.linkedListElemID[index - 1], 0);\n\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.traverse(index - 1);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\t// O(1) remove from front trick\n\t\t\t\tconst labCopiedValID = this.nextIndex++;\n\t\t\t\tconst secondNodeX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING;\n\t\t\t\tconst secondNodeY = LINKED_LIST_START_Y;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tlabCopiedValID,\n\t\t\t\t\tthis.arrayData[1],\n\t\t\t\t\tsecondNodeX,\n\t\t\t\t\tsecondNodeY,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, labCopiedValID, LINKED_LIST_START_X, LINKED_LIST_START_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[0], this.arrayData[1]);\n\t\t\t\tthis.cmd(act.delete, labCopiedValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.linkedListElemID[1],\n\t\t\t\t\tsecondNodeX,\n\t\t\t\t\tsecondNodeY - LINKED_LIST_ELEM_HEIGHT * 2,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.disconnect, this.linkedListElemID[0], this.linkedListElemID[1]);\n\t\t\t\tif (this.size === 2) {\n\t\t\t\t\t// Only one node will remain, connect it to itself\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// Normal remove\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[0], this.linkedListElemID[2]);\n\t\t\t\t}\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tif (this.size === 2) {\n\t\t\t\t\t// Only one node will remain, connect it to itself\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// Normal remove\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tconst removedNodeIndex = index === 0 ? 1 : index; // If deleting from front, we need to remove the second node\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[removedNodeIndex]);\n\t\t\tfor (let i = removedNodeIndex; i < this.size; i++) {\n\t\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[0]);\n\t\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\t}\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.setHighlight, this.linkedListElemID[index - 1], 0);\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\nconst RESIZE_ARRAY_START_X = 100;\nconst RESIZE_ARRAY_START_Y = 300;\n\nconst ARRAY_ELEMS_PER_LINE = 14;\nconst ARRAY_LINE_SPACING = 130;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\nconst PUSH_RESIZE_LABEL_X = 60;\nconst PUSH_RESIZE_LABEL_Y = 60;\n\nconst SIZE = 7;\nconst MAX_SIZE = 30;\n\nexport default class StackArray extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.pushField = addControlToAlgorithmBar('Text', '');\n\t\tthis.pushField.onkeydown = this.returnSubmit(\n\t\t\tthis.pushField,\n\t\t\tthis.pushCallback.bind(this),\n\t\t\t4,\n\t\t);\n\n\t\tthis.pushButton = addControlToAlgorithmBar('Button', 'Push');\n\t\tthis.pushButton.onclick = this.pushCallback.bind(this);\n\t\tthis.controls.push(this.pushField);\n\t\tthis.controls.push(this.pushButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.popButton = addControlToAlgorithmBar('Button', 'Pop');\n\t\tthis.popButton.onclick = this.popCallback.bind(this);\n\t\tthis.controls.push(this.popButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.topID = this.nextIndex++;\n\t\tthis.topLabelID = this.nextIndex++;\n\n\t\tthis.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.createLabel, this.topLabelID, 'Size', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.topID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.highlight2ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = 0;\n\t\tthis.length = SIZE;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.nextIndex = this.nextIndex + 3;\n\t\t//^ To keep nextIndex in the same place relative to setup()\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.highlight2ID = this.nextIndex++;\n\t}\n\n\tpushCallback() {\n\t\tif (this.top < this.arrayData.length && this.pushField.value !== '') {\n\t\t\tconst pushVal = this.pushField.value;\n\t\t\tthis.pushField.value = '';\n\t\t\tthis.implementAction(this.push.bind(this), pushVal);\n\t\t} else if (this.top === this.arrayData.length && this.top * 2 < MAX_SIZE) {\n\t\t\tconst pushVal = this.pushField.value;\n\t\t\tthis.pushField.value = '';\n\t\t\tthis.implementAction(this.resize.bind(this), pushVal);\n\t\t}\n\t}\n\n\tpopCallback() {\n\t\tif (this.top > 0) {\n\t\t\tthis.implementAction(this.pop.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearData.bind(this));\n\t}\n\n\tclearData() {\n\t\tthis.commands = [];\n\t\tthis.clearAll();\n\t\treturn this.commands;\n\t}\n\n\tpush(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData[this.top] = elemToPush;\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, '#0000FF', TOP_POS_X, TOP_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.top % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.top / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[this.top], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top + 1;\n\t\tthis.cmd(act.setText, this.topID, this.top);\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.topID, 0);\n\n\t\tif (elemToPush != null) {\n\t\t\tthis.nextIndex = this.nextIndex - 2;\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tpop() {\n\t\tthis.commands = [];\n\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPopID, 'Popped Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top - 1;\n\n\t\tconst popVal = this.arrayData[this.top];\n\t\tthis.arrayData[this.top] = '';\n\n\t\tthis.cmd(act.setText, this.topID, this.top);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.topID, 0);\n\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, '#0000FF', TOP_POS_X, TOP_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.top % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.top / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.createLabel, labPopValID, popVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[this.top], '');\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Popped Value: ' + popVal);\n\t\tthis.cmd(act.delete, labPopValID);\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tresize(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tconst labPushResizeID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPushResizeID,\n\t\t\t'(Resize Required)',\n\t\t\tPUSH_RESIZE_LABEL_X,\n\t\t\tPUSH_RESIZE_LABEL_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayIDNew = new Array(this.top * 2);\n\t\tthis.arrayLabelIDNew = new Array(this.top * 2);\n\t\tthis.arrayDataNew = new Array(this.top * 2);\n\n\t\tfor (let i = 0; i < this.top * 2; i++) {\n\t\t\tthis.arrayIDNew[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelIDNew[i] = this.nextIndex++;\n\t\t\tif (i < this.top) {\n\t\t\t\tthis.arrayDataNew[i] = this.arrayData[i];\n\t\t\t}\n\t\t}\n\t\tthis.arrayDataNew[this.top] = elemToPush;\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\t//Create new array\n\t\tfor (let i = 0; i < this.top * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayIDNew[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelIDNew[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelIDNew[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayMoveID = new Array(this.top);\n\n\t\t//Move old array elements to the new array\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tconst xposinit = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yposinit =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\t// const display = this.animationManager.objectManager.getText(this.arrayID[i]);\n\t\t\tconst display = this.arrayData[i];\n\n\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], display, xposinit, yposinit);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//delete movement id objects and set text\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\t// const display = this.animationManager.objectManager.getText(this.arrayID[i]);\n\t\t\tconst display = this.arrayData[i];\n\n\t\t\tthis.cmd(act.setText, this.arrayIDNew[i], display);\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//Add elemToPush at the index\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\t'#0000FF',\n\t\t\tPUSH_ELEMENT_X,\n\t\t\tPUSH_ELEMENT_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos =\n\t\t\t(parseInt(this.top) % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(parseInt(this.top) / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\tRESIZE_ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos);\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayIDNew[this.top], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t\tthis.cmd(act.delete, this.arrayLabelID[i]);\n\t\t}\n\n\t\tfor (let i = 0; i < this.top * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tthis.cmd(act.move, this.arrayIDNew[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.arrayLabelIDNew[i], xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.top = this.top + 1;\n\t\tthis.cmd(act.setText, this.topID, this.top);\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.delete, labPushResizeID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 0);\n\n\t\tthis.arrayID = this.arrayIDNew;\n\t\tthis.arrayLabelID = this.arrayLabelIDNew;\n\t\tthis.arrayData = this.arrayDataNew;\n\n\t\tthis.nextIndex = this.nextIndex - this.top + 1;\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.top = 0;\n\t\tthis.cmd(act.setText, this.topID, '0');\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 250;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst TOP_ELEM_WIDTH = 30;\nconst TOP_ELEM_HEIGHT = 30;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst CODE_START_X = 400;\nconst CODE_START_Y = 25;\nconst CODE_LINE_HEIGHT = 14;\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\nconst CODE_STANDARD_COLOR = '#000000';\n\nconst SIZE = 32;\n\nexport default class StackLL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.pushField = addControlToAlgorithmBar('Text', '');\n\t\tthis.pushField.onkeydown = this.returnSubmit(\n\t\t\tthis.pushField,\n\t\t\tthis.pushCallback.bind(this),\n\t\t\t4,\n\t\t);\n\n\t\tthis.pushButton = addControlToAlgorithmBar('Button', 'Push');\n\t\tthis.pushButton.onclick = this.pushCallback.bind(this);\n\t\tthis.controls.push(this.pushField);\n\t\tthis.controls.push(this.pushButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.popButton = addControlToAlgorithmBar('Button', 'Pop');\n\t\tthis.popButton.onclick = this.popCallback.bind(this);\n\t\tthis.controls.push(this.popButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.linkedListElemID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.topID = this.nextIndex++;\n\t\tthis.topLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.topLabelID, 'Head', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.topID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y,\n\t\t);\n\t\tthis.cmd(act.setNull, this.topID, 1);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.code = [\n\t\t\t['procedure push(data)'],\n\t\t\t['     head = new node(data, head)'],\n\t\t\t// ['     increment size'],\n\t\t\t['end procedure'],\n\n\t\t\t[],\n\t\t\t['procedure pop()'],\n\n\t\t\t['     result = head.data'],\n\t\t\t['     head = head.next'],\n\t\t\t// ['     decrement size'],\n\t\t\t// ['     return result'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = Array(this.code.length);\n\t\tlet i, j;\n\t\tfor (i = 0; i < this.code.length; i++) {\n\t\t\tthis.codeID[i] = new Array(this.code[i].length);\n\t\t\tfor (j = 0; j < this.code[i].length; j++) {\n\t\t\t\tthis.codeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.codeID[i][j],\n\t\t\t\t\tthis.code[i][j],\n\t\t\t\t\tCODE_START_X,\n\t\t\t\t\tCODE_START_Y + i * CODE_LINE_HEIGHT,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[i][j], CODE_STANDARD_COLOR);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, this.codeID[i][j], this.codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tresetLinkedListPositions() {\n\t\tfor (let i = this.top - 1; i >= 0; i--) {\n\t\t\tconst nextX =\n\t\t\t\t((this.top - 1 - i) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\tLINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor((this.top - 1 - i) / LINKED_LIST_ELEMS_PER_LINE) *\n\t\t\t\t\tLINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tpushCallback() {\n\t\tif (this.top < SIZE && this.pushField.value !== '') {\n\t\t\tconst pushVal = this.pushField.value;\n\t\t\tthis.pushField.value = '';\n\t\t\tthis.implementAction(this.push.bind(this), pushVal);\n\t\t}\n\t}\n\n\tpopCallback() {\n\t\tif (this.top > 0) {\n\t\t\tthis.implementAction(this.pop.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tpush(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tthis.arrayData[this.top] = elemToPush;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.highlight(1, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tthis.linkedListElemID[this.top],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[this.top], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (this.top === 0) {\n\t\t\tthis.cmd(act.setNull, this.topID, 0);\n\t\t\tthis.cmd(act.setNull, this.linkedListElemID[this.top], 1);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.linkedListElemID[this.top],\n\t\t\t\tthis.linkedListElemID[this.top - 1],\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[this.top - 1]);\n\t\t}\n\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[this.top]);\n\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top + 1;\n\t\tthis.resetLinkedListPositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\n\t\treturn this.commands;\n\t}\n\n\tpop() {\n\t\tthis.commands = [];\n\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPopID, 'Popped Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPopValID,\n\t\t\tthis.arrayData[this.top - 1],\n\t\t\tLINKED_LIST_START_X,\n\t\t\tLINKED_LIST_START_Y,\n\t\t);\n\n\t\tthis.highlight(5, 0);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[this.top - 1]);\n\t\tthis.unhighlight(5, 0);\n\n\t\tif (this.top === 1) {\n\t\t\tthis.cmd(act.setNull, this.topID, 1);\n\t\t} else {\n\t\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[this.top - 2]);\n\t\t}\n\t\tthis.highlight(6, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(6, 0);\n\t\tthis.cmd(act.delete, this.linkedListElemID[this.top - 1]);\n\t\tthis.highlight(7, 0);\n\t\tthis.top = this.top - 1;\n\t\tthis.resetLinkedListPositions();\n\t\tthis.unhighlight(7, 0);\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Popped Value: ' + this.arrayData[this.top]);\n\n\t\treturn this.commands;\n\t}\n\n\thighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\n\t}\n\n\tunhighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.top = 0;\n\t\tthis.cmd(act.setNull, this.topID, 1);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRAY_ELEMS_PER_LINE = 14;\nconst ARRAY_LINE_SPACING = 130;\n\nconst FRONT_POS_X = 180;\nconst FRONT_POS_Y = 100;\nconst FRONT_LABEL_X = 130;\nconst FRONT_LABEL_Y = 100;\n\nconst SIZE_POS_X = 280;\nconst SIZE_POS_Y = 100;\nconst SIZE_LABEL_X = 230;\nconst SIZE_LABEL_Y = 100;\n\nconst QUEUE_LABEL_X = 60;\nconst QUEUE_LABEL_Y = 30;\nconst QUEUE_ELEMENT_X = 130;\nconst QUEUE_ELEMENT_Y = 30;\n\nconst QUEUE_INDEX_X = 129;\nconst QUEUE_INDEX_Y = 50;\nconst QUEUE_INDEXVAL_X = 260;\nconst QUEUE_INDEXVAL_Y = 50;\n\nconst RESIZE_ARRAY_START_X = 100;\nconst RESIZE_ARRAY_START_Y = 300;\nconst QUEUE_RESIZE_LABEL_X = 60;\nconst QUEUE_RESIZE_LABEL_Y = 60;\n\nconst INDEX_COLOR = '#0000FF';\n\nconst FRONT_LABEL_OFFSET = -40;\n\nconst SIZE = 7;\nconst MAX_SIZE = 30;\n\nexport default class QueueArray extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.enqueueField = addControlToAlgorithmBar('Text', '');\n\t\tthis.enqueueField.onkeydown = this.returnSubmit(\n\t\t\tthis.enqueueField,\n\t\t\tthis.enqueueCallback.bind(this),\n\t\t\t4,\n\t\t);\n\n\t\tthis.enqueueButton = addControlToAlgorithmBar('Button', 'Enqueue');\n\t\tthis.enqueueButton.onclick = this.enqueueCallback.bind(this);\n\t\tthis.controls.push(this.enqueueField);\n\t\tthis.controls.push(this.enqueueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.dequeueButton = addControlToAlgorithmBar('Button', 'Dequeue');\n\t\tthis.dequeueButton.onclick = this.dequeueCallback.bind(this);\n\t\tthis.controls.push(this.dequeueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.frontID = this.nextIndex++;\n\t\tconst frontLabelID = this.nextIndex++;\n\t\tthis.sizeID = this.nextIndex++;\n\t\tconst sizeLabelID = this.nextIndex++;\n\t\tthis.frontPointerID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, frontLabelID, 'Front', FRONT_LABEL_X, FRONT_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.frontID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, sizeLabelID, 'Size', SIZE_LABEL_X, SIZE_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.sizeID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tSIZE_POS_X,\n\t\t\tSIZE_POS_Y,\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.frontPointerID,\n\t\t\t'Front',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + FRONT_LABEL_OFFSET,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.top = 0;\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.nextIndex = this.nextIndex + 7;\n\t}\n\n\tenqueueCallback() {\n\t\tif (this.size < this.arrayData.length && this.enqueueField.value !== '') {\n\t\t\tconst pushVal = this.enqueueField.value;\n\t\t\tthis.enqueueField.value = '';\n\t\t\tthis.implementAction(this.enqueue.bind(this), pushVal);\n\t\t} else if (\n\t\t\tthis.size === this.arrayData.length &&\n\t\t\tthis.enqueueField !== '' &&\n\t\t\tthis.size * 2 < MAX_SIZE\n\t\t) {\n\t\t\tconst pushVal = this.enqueueField.value;\n\t\t\tthis.enqueueField.value = '';\n\t\t\tthis.implementAction(this.resize.bind(this), pushVal);\n\t\t}\n\t}\n\n\tdequeueCallback() {\n\t\tif (this.size !== 0) {\n\t\t\tthis.implementAction(this.dequeue.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tenqueue(elemToEnqueue) {\n\t\tthis.commands = [];\n\n\t\tconst labEnqueueID = this.nextIndex++;\n\t\tconst labEnqueueValID = this.nextIndex++;\n\t\tconst labIndexID = this.nextIndex++;\n\t\tconst labIndexValID = this.nextIndex++;\n\n\t\tconst newTail = (this.front + this.size) % this.arrayData.length;\n\t\tthis.arrayData[newTail] = elemToEnqueue;\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labEnqueueID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labEnqueueValID, elemToEnqueue, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabIndexID,\n\t\t\t'Enqueueing at (front + size) % array.length: ',\n\t\t\tQUEUE_INDEX_X,\n\t\t\tQUEUE_INDEX_Y,\n\t\t);\n\t\tthis.cmd(act.createLabel, labIndexValID, newTail, QUEUE_INDEXVAL_X, QUEUE_INDEXVAL_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (newTail % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(newTail / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, QUEUE_INDEXVAL_X, QUEUE_INDEXVAL_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, labIndexValID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labEnqueueValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[newTail], elemToEnqueue);\n\t\tthis.cmd(act.delete, labEnqueueValID);\n\t\tthis.cmd(act.delete, labIndexValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.delete, labEnqueueID);\n\t\tthis.cmd(act.delete, labIndexID);\n\n\t\tthis.nextIndex = this.nextIndex - 4;\n\n\t\treturn this.commands;\n\t}\n\n\tdequeue() {\n\t\tthis.commands = [];\n\n\t\tconst labDequeueID = this.nextIndex++;\n\t\tconst labDequeueValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labDequeueID, 'Dequeued Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\tINDEX_COLOR,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.front % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.front / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tconst dequeuedVal = this.arrayData[this.front];\n\t\tthis.cmd(act.createLabel, labDequeueValID, dequeuedVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[this.front], '');\n\t\tthis.cmd(act.move, labDequeueValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.front = (this.front + 1) % this.arrayData.length;\n\t\tconst frontxpos = (this.front % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst frontypos =\n\t\t\tMath.floor(this.front / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\tARRAY_START_Y +\n\t\t\tFRONT_LABEL_OFFSET;\n\t\tthis.cmd(act.move, this.frontPointerID, frontxpos, frontypos);\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Dequeued Value: ' + dequeuedVal);\n\n\t\tthis.cmd(act.delete, labDequeueID);\n\t\tthis.cmd(act.delete, labDequeueValID);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size - 1;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tresize(elemToEnqueue) {\n\t\tthis.commands = [];\n\n\t\tconst labEnqueueID = this.nextIndex++;\n\t\tconst labEnqueueValID = this.nextIndex++;\n\t\tconst labEnqueueResizeID = this.nextIndex++;\n\n\t\tthis.arrayIDNew = new Array(this.size * 2);\n\t\tthis.arrayLabelIDNew = new Array(this.size * 2);\n\t\tthis.arrayDataNew = new Array(this.size * 2);\n\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tthis.arrayIDNew[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelIDNew[i] = this.nextIndex++;\n\t\t\tif (i < this.size) {\n\t\t\t\tthis.arrayDataNew[i] = this.arrayData[(this.front + i) % this.arrayData.length];\n\t\t\t}\n\t\t}\n\n\t\tthis.arrayDataNew[this.size] = elemToEnqueue;\n\n\t\tthis.cmd(act.createLabel, labEnqueueID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labEnqueueValID, elemToEnqueue, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabEnqueueResizeID,\n\t\t\t'(Resize Required)',\n\t\t\tQUEUE_RESIZE_LABEL_X,\n\t\t\tQUEUE_RESIZE_LABEL_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\t//Create new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayIDNew[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelIDNew[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelIDNew[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\t//Move old elements to new array\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst xposinit =\n\t\t\t\t(((this.front + i) % this.arrayData.length) % ARRAY_ELEMS_PER_LINE) *\n\t\t\t\t\tARRAY_ELEM_WIDTH +\n\t\t\t\tARRAY_START_X;\n\t\t\tconst yposinit =\n\t\t\t\tMath.floor(((this.front + i) % this.arrayData.length) / ARRAY_ELEMS_PER_LINE) *\n\t\t\t\t\tARRAY_LINE_SPACING +\n\t\t\t\tARRAY_START_Y;\n\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.arrayMoveID[i],\n\t\t\t\tthis.arrayData[(this.front + i) % this.arrayData.length],\n\t\t\t\txposinit,\n\t\t\t\typosinit,\n\t\t\t);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos, ypos);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//Delete movement objects and set text\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\tthis.cmd(act.setText, this.arrayIDNew[i], this.arrayDataNew[i]);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//Delete old array\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t\tthis.cmd(act.delete, this.arrayLabelID[i]);\n\t\t}\n\n\t\t//Move new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tthis.cmd(act.move, this.arrayIDNew[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.arrayLabelIDNew[i], xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.front = 0;\n\t\tthis.arrayID = this.arrayIDNew;\n\t\tthis.arrayLabelID = this.arrayLabelIDNew;\n\t\tthis.arrayData = this.arrayDataNew;\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.move, this.frontPointerID, ARRAY_START_X, ARRAY_START_Y + FRONT_LABEL_OFFSET);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\t//Delete '(resize required)' text, create circle at the \"size\" object, add enqueue text\n\n\t\tconst newTail = (this.front + this.size) % this.arrayData.length;\n\t\tconst labIndexID = this.nextIndex++;\n\t\tconst labIndexValID = this.nextIndex++;\n\n\t\tthis.cmd(act.delete, labEnqueueResizeID);\n\n\t\t//Just so the element travels over the array instead of underneath it\n\t\tthis.cmd(act.delete, labEnqueueValID);\n\t\tconst labEnqueueValIDNew = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabEnqueueValIDNew,\n\t\t\telemToEnqueue,\n\t\t\tQUEUE_ELEMENT_X,\n\t\t\tQUEUE_ELEMENT_Y,\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabIndexID,\n\t\t\t'Enqueueing at (front + size) % array.length: ',\n\t\t\tQUEUE_INDEX_X,\n\t\t\tQUEUE_INDEX_Y,\n\t\t);\n\t\tthis.cmd(act.createLabel, labIndexValID, newTail, QUEUE_INDEXVAL_X, QUEUE_INDEXVAL_Y);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\t//Enqueue 'elemToEnqueue'\n\t\tconst xpos = (newTail % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(newTail / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, QUEUE_INDEXVAL_X, QUEUE_INDEXVAL_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, labIndexValID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labEnqueueValIDNew, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[newTail], elemToEnqueue);\n\t\tthis.cmd(act.delete, labEnqueueValIDNew);\n\t\tthis.cmd(act.delete, labIndexValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.delete, labEnqueueID);\n\t\tthis.cmd(act.delete, labIndexID);\n\n\t\tthis.nextIndex = this.nextIndex - this.size;\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.cmd(act.setText, this.frontID, '0');\n\t\tthis.cmd(act.setText, this.sizeID, '0');\n\t\tthis.cmd(\n\t\t\tact.setPosition,\n\t\t\tthis.frontPointerID,\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + FRONT_LABEL_OFFSET,\n\t\t);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 250;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst TOP_ELEM_WIDTH = 30;\nconst TOP_ELEM_HEIGHT = 30;\n\nconst TAIL_POS_X = 180;\nconst TAIL_LABEL_X = 130;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 32;\n\nexport default class QueueLL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.tail_pos_y = h - LINKED_LIST_ELEM_HEIGHT;\n\t\tthis.tail_label_y = this.tail_pos_y;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.enqueueField = addControlToAlgorithmBar('Text', '');\n\t\tthis.enqueueField.onkeydown = this.returnSubmit(\n\t\t\tthis.enqueueField,\n\t\t\tthis.enqueueCallback.bind(this),\n\t\t\t4,\n\t\t);\n\n\t\tthis.enqueueButton = addControlToAlgorithmBar('Button', 'Enqueue');\n\t\tthis.enqueueButton.onclick = this.enqueueCallback.bind(this);\n\t\tthis.controls.push(this.enqueueField);\n\t\tthis.controls.push(this.enqueueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.dequeueButton = addControlToAlgorithmBar('Button', 'Dequeue');\n\t\tthis.dequeueButton.onclick = this.dequeueCallback.bind(this);\n\t\tthis.controls.push(this.dequeueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.linkedListElemID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.headID = this.nextIndex++;\n\t\tthis.headLabelID = this.nextIndex++;\n\n\t\tthis.tailID = this.nextIndex++;\n\t\tthis.tailLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.headLabelID, 'Head', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.headID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y,\n\t\t);\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\n\t\tthis.cmd(act.createLabel, this.tailLabelID, 'Tail', TAIL_LABEL_X, this.tail_label_y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.tailID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTAIL_POS_X,\n\t\t\tthis.tail_pos_y,\n\t\t);\n\t\tthis.cmd(act.setNull, this.tailID, 1);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', 5, PUSH_LABEL_Y, 0);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tresetLinkedListPositions() {\n\t\tfor (let i = this.top - 1; i >= 0; i--) {\n\t\t\tconst nextX =\n\t\t\t\t((this.top - 1 - i) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\tLINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor((this.top - 1 - i) / LINKED_LIST_ELEMS_PER_LINE) *\n\t\t\t\t\tLINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tenqueueCallback() {\n\t\tif (this.top < SIZE && this.enqueueField.value !== '') {\n\t\t\tconst pushVal = this.enqueueField.value;\n\t\t\tthis.enqueueField.value = '';\n\t\t\tthis.implementAction(this.enqueue.bind(this), pushVal);\n\t\t}\n\t}\n\n\tdequeueCallback() {\n\t\tif (this.top > 0) {\n\t\t\tthis.implementAction(this.dequeue.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tenqueue(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData[this.top] = elemToPush;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tfor (let i = this.top; i > 0; i--) {\n\t\t\tthis.arrayData[i] = this.arrayData[i - 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i - 1];\n\t\t}\n\t\tthis.arrayData[0] = elemToPush;\n\t\tthis.linkedListElemID[0] = this.nextIndex++;\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tthis.linkedListElemID[0],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1,\n\t\t);\n\n\t\tthis.cmd(act.setNull, this.linkedListElemID[0], 1);\n\t\tthis.cmd(act.createLabel, labPushID, 'Enqueuing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[0], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (this.top === 0) {\n\t\t\tthis.cmd(act.setNull, this.headID, 0);\n\t\t\tthis.cmd(act.setNull, this.tailID, 0);\n\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[this.top]);\n\t\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[this.top]);\n\t\t} else {\n\t\t\tthis.cmd(act.setNull, this.linkedListElemID[1], 0);\n\t\t\tthis.cmd(act.connect, this.linkedListElemID[1], this.linkedListElemID[0]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[1]);\n\t\t}\n\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[0]);\n\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top + 1;\n\t\tthis.resetLinkedListPositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tdequeue() {\n\t\tthis.commands = [];\n\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPopID, 'Dequeued Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPopValID,\n\t\t\tthis.arrayData[this.top - 1],\n\t\t\tLINKED_LIST_START_X,\n\t\t\tLINKED_LIST_START_Y,\n\t\t);\n\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[this.top - 1]);\n\n\t\tif (this.top === 1) {\n\t\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\t\tthis.cmd(act.setNull, this.tailID, 1);\n\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[this.top - 1]);\n\t\t} else {\n\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[this.top - 2]);\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[this.top - 1]);\n\t\tthis.top = this.top - 1;\n\t\tthis.resetLinkedListPositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Dequeued Value: ' + this.arrayData[this.top]);\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.top = 0;\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\tthis.cmd(act.setNull, this.tailID, 1);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRAY_ELEMS_PER_LINE = 14;\nconst ARRAY_LINE_SPACING = 130;\n\nconst FRONT_POS_X = 180;\nconst FRONT_POS_Y = 100;\nconst FRONT_LABEL_X = 130;\nconst FRONT_LABEL_Y = 100;\n\nconst SIZE_POS_X = 280;\nconst SIZE_POS_Y = 100;\nconst SIZE_LABEL_X = 230;\nconst SIZE_LABEL_Y = 100;\n\nconst QUEUE_LABEL_X = 50;\nconst QUEUE_LABEL_Y = 30;\nconst QUEUE_ELEMENT_X = 120;\nconst QUEUE_ELEMENT_Y = 30;\n\nconst RESIZE_ARRAY_START_X = 100;\nconst RESIZE_ARRAY_START_Y = 300;\nconst QUEUE_RESIZE_LABEL_X = 60;\nconst QUEUE_RESIZE_LABEL_Y = 60;\n\nconst FRONT_LABEL_OFFSET = -40;\n\nconst INDEX_COLOR = '#0000FF';\n\nconst SIZE = 7;\nconst MAX_SIZE = 30;\n\nexport default class DequeArray extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\t// Add's value text field\n\t\tthis.addField = addControlToAlgorithmBar('Text', '');\n\t\tthis.addField.onkeydown = this.returnSubmit(this.addField, null, 4);\n\t\tthis.controls.push(this.addField);\n\n\t\t// Add first button\n\t\tthis.addFirstButton = addControlToAlgorithmBar('Button', 'Add First');\n\t\tthis.addFirstButton.onclick = this.addFirstCallBack.bind(this);\n\t\tthis.controls.push(this.addFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Add last button\n\t\tthis.addLastButton = addControlToAlgorithmBar('Button', 'Add Last');\n\t\tthis.addLastButton.onclick = this.addLastCallback.bind(this);\n\t\tthis.controls.push(this.addLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Remove first button\n\t\tthis.removeFirstButton = addControlToAlgorithmBar('Button', 'Remove First');\n\t\tthis.removeFirstButton.onclick = this.removeFirstCallback.bind(this);\n\t\tthis.controls.push(this.removeFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Remove last button\n\t\tthis.removeLastButton = addControlToAlgorithmBar('Button', 'Remove Last');\n\t\tthis.removeLastButton.onclick = this.removeLastCallback.bind(this);\n\t\tthis.controls.push(this.removeLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.frontID = this.nextIndex++;\n\t\tconst frontLabelID = this.nextIndex++;\n\t\tthis.frontPointerID = this.nextIndex++;\n\t\tthis.sizeID = this.nextIndex++;\n\t\tconst sizeLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, frontLabelID, 'Front', FRONT_LABEL_X, FRONT_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.frontID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, sizeLabelID, 'Size', SIZE_LABEL_X, SIZE_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.sizeID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tSIZE_POS_X,\n\t\t\tSIZE_POS_Y,\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.frontPointerID,\n\t\t\t'Front',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + FRONT_LABEL_OFFSET,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', QUEUE_LABEL_X, QUEUE_LABEL_Y, false);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.nextIndex = this.nextIndex + 7;\n\t}\n\n\taddLastCallback() {\n\t\tif (this.size < this.arrayData.length && this.addField.value !== '') {\n\t\t\tconst pushVal = this.addField.value;\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.addLast.bind(this), pushVal);\n\t\t} else if (\n\t\t\tthis.size === this.arrayData.length &&\n\t\t\tthis.addField.value !== '' &&\n\t\t\tthis.size * 2 < MAX_SIZE\n\t\t) {\n\t\t\tconst pushVal = this.addField.value;\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.resize.bind(this), pushVal, false);\n\t\t}\n\t}\n\n\tremoveFirstCallback() {\n\t\tif (this.size !== 0) {\n\t\t\tthis.implementAction(this.removeFirst.bind(this));\n\t\t}\n\t}\n\n\tremoveLastCallback() {\n\t\tif (this.size !== 0) {\n\t\t\tthis.implementAction(this.removeLast.bind(this));\n\t\t}\n\t}\n\n\taddFirstCallBack() {\n\t\tif (this.size < this.arrayData.length && this.addField.value !== '') {\n\t\t\tconst pushVal = this.addField.value;\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.addFirst.bind(this), pushVal);\n\t\t} else if (\n\t\t\tthis.size === this.arrayData.length &&\n\t\t\tthis.addField.value !== '' &&\n\t\t\tthis.size * 2 < MAX_SIZE\n\t\t) {\n\t\t\tconst pushVal = this.addField.value;\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.resize.bind(this), pushVal, true);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\taddLast(elemToAddLast) {\n\t\tthis.commands = [];\n\n\t\tconst labAddLastID = this.nextIndex++;\n\t\tconst labAddLastValID = this.nextIndex++;\n\t\tconst addIndex = (this.front + this.size) % this.arrayData.length;\n\n\t\tthis.arrayData[addIndex] = elemToAddLast;\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X + 100, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labAddLastID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labAddLastValID, elemToAddLast, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.leftoverLabelID,\n\t\t\t`Adding ${elemToAddLast} to back at index (${this.front} + ${this.size}) % ${this.arrayData.length}`,\n\t\t);\n\n\t\tconst xpos = (addIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(addIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labAddLastValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[addIndex], elemToAddLast);\n\t\tthis.cmd(act.delete, labAddLastValID);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.delete, labAddLastID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\taddFirst(elemToAdd) {\n\t\tthis.commands = [];\n\n\t\tconst labelAddID = this.nextIndex++;\n\t\tconst labelAddIDVal = this.nextIndex++;\n\n\t\tconst addIndex = (this.front - 1 + this.arrayData.length) % this.arrayData.length;\n\n\t\tconst xpos = (addIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(addIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.arrayData[addIndex] = elemToAdd;\n\n\t\tthis.cmd(act.createLabel, labelAddID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labelAddIDVal, elemToAdd, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X + 100, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\tINDEX_COLOR,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.leftoverLabelID,\n\t\t\t`Adding ${elemToAdd} to front at index (${this.front} - 1) % ${this.arrayData.length}`,\n\t\t);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(\n\t\t\tact.move,\n\t\t\tthis.highlight1ID,\n\t\t\tthis.front * ARRAY_ELEM_WIDTH + ARRAY_START_X,\n\t\t\typos + ARRAY_ELEM_HEIGHT,\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, labelAddIDVal, xpos, ypos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, labelAddIDVal);\n\n\t\tthis.front = addIndex;\n\n\t\tconst frontxpos = (addIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst frontypos =\n\t\t\tMath.floor(addIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\tARRAY_START_Y +\n\t\t\tFRONT_LABEL_OFFSET;\n\n\t\tthis.cmd(act.setText, this.arrayID[addIndex], elemToAdd);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, this.frontPointerID, frontxpos, frontypos);\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.sizeID, this.size + 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.delete, labelAddID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.size++;\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tremoveFirst() {\n\t\tthis.commands = [];\n\n\t\tconst labremoveFirstID = this.nextIndex++;\n\t\tconst labremoveFirstValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabremoveFirstID,\n\t\t\t'removeFirst Value: ',\n\t\t\tQUEUE_LABEL_X,\n\t\t\tQUEUE_LABEL_Y,\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\tINDEX_COLOR,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.front % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.front / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tconst removeFirstdVal = this.arrayData[this.front];\n\t\tthis.cmd(act.createLabel, labremoveFirstValID, removeFirstdVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[this.front], '');\n\t\tthis.cmd(act.move, labremoveFirstValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.front = (this.front + 1) % this.arrayData.length;\n\t\tconst frontxpos = (this.front % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst frontypos =\n\t\t\tMath.floor(this.front / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\tARRAY_START_Y +\n\t\t\tFRONT_LABEL_OFFSET;\n\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.move, this.frontPointerID, frontxpos, frontypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'removeFirst Value: ' + removeFirstdVal);\n\n\t\tthis.cmd(act.delete, labremoveFirstID);\n\t\tthis.cmd(act.delete, labremoveFirstValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size--;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tremoveLast() {\n\t\tthis.commands = [];\n\t\tconst remLabelID = this.nextIndex++;\n\t\tconst remLabelValID = this.nextIndex++;\n\n\t\tconst remIndex =\n\t\t\t(this.front + this.size - 1 + this.arrayData.length) % this.arrayData.length;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(act.createLabel, remLabelID, 'Removed Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\tINDEX_COLOR,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight2ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (remIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(remIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, this.highlight2ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.delete, this.highlight2ID);\n\n\t\tconst removedVal = this.arrayData[remIndex];\n\t\tthis.cmd(act.createLabel, remLabelValID, removedVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[remIndex], '');\n\t\tthis.cmd(act.move, remLabelValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Removed Value: ' + removedVal);\n\n\t\tthis.cmd(act.delete, remLabelID);\n\t\tthis.cmd(act.delete, remLabelValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.sizeID, this.size - 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.size--;\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tresize(elemToEnqueue, isFront) {\n\t\tthis.commands = [];\n\n\t\tconst labEnqueueID = this.nextIndex++;\n\t\tconst labEnqueueValID = this.nextIndex++;\n\t\tconst labEnqueueResizeID = this.nextIndex++;\n\n\t\tthis.arrayIDNew = new Array(this.size * 2);\n\t\tthis.arrayLabelIDNew = new Array(this.size * 2);\n\t\tthis.arrayDataNew = new Array(this.size * 2);\n\n\t\tconst frontOffset = isFront ? 1 : 0;\n\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tthis.arrayIDNew[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelIDNew[i] = this.nextIndex++;\n\t\t\tif (i < this.size) {\n\t\t\t\tthis.arrayDataNew[i + frontOffset] =\n\t\t\t\t\tthis.arrayData[(this.front + i) % this.arrayData.length];\n\t\t\t}\n\t\t}\n\n\t\tconst extra = isFront ? ': elements shifted by 1' : '';\n\n\t\tthis.cmd(act.createLabel, labEnqueueID, 'Enqueuing Value:', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labEnqueueValID, elemToEnqueue, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabEnqueueResizeID,\n\t\t\t`(Resize Required${extra})`,\n\t\t\tisFront ? QUEUE_RESIZE_LABEL_X + 100 : QUEUE_RESIZE_LABEL_X,\n\t\t\tQUEUE_RESIZE_LABEL_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\t//Create new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayIDNew[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelIDNew[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelIDNew[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\t//Move old elements to new array\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst xposinit =\n\t\t\t\t(((this.front + i) % this.arrayData.length) % ARRAY_ELEMS_PER_LINE) *\n\t\t\t\t\tARRAY_ELEM_WIDTH +\n\t\t\t\tARRAY_START_X;\n\t\t\tconst yposinit =\n\t\t\t\tMath.floor(((this.front + i) % this.arrayData.length) / ARRAY_ELEMS_PER_LINE) *\n\t\t\t\t\tARRAY_LINE_SPACING +\n\t\t\t\tARRAY_START_Y;\n\n\t\t\tconst xpos =\n\t\t\t\t((i + frontOffset) % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH +\n\t\t\t\tRESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor((i + frontOffset) / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\t\tRESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.arrayMoveID[i],\n\t\t\t\tthis.arrayData[(this.front + i) % this.arrayData.length],\n\t\t\t\txposinit,\n\t\t\t\typosinit,\n\t\t\t);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos, ypos);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\t//Delete movement objects and set text\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.arrayIDNew[i + frontOffset],\n\t\t\t\tthis.arrayDataNew[i + frontOffset],\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//Delete old array\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t\tthis.cmd(act.delete, this.arrayLabelID[i]);\n\t\t}\n\n\t\t//Move new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tthis.cmd(act.move, this.arrayIDNew[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.arrayLabelIDNew[i], xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.front = 0;\n\t\tthis.arrayID = this.arrayIDNew;\n\t\tthis.arrayLabelID = this.arrayLabelIDNew;\n\t\tthis.arrayData = this.arrayDataNew;\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.move, this.frontPointerID, ARRAY_START_X, ARRAY_START_Y + FRONT_LABEL_OFFSET);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\t//Delete '(resize required)' text, create circle at the \"size\" object, add enqueue text\n\n\t\tconst addIndex = !isFront\n\t\t\t? (this.front + this.size) % this.arrayDataNew.length\n\t\t\t: this.front;\n\n\t\tthis.cmd(act.delete, labEnqueueResizeID);\n\n\t\t//Just so the element travels over the array instead of underneath it\n\t\tthis.cmd(act.delete, labEnqueueValID);\n\t\tconst labEnqueueValIDNew = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabEnqueueValIDNew,\n\t\t\telemToEnqueue,\n\t\t\tQUEUE_ELEMENT_X,\n\t\t\tQUEUE_ELEMENT_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tif (isFront) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlight1ID,\n\t\t\t\tINDEX_COLOR,\n\t\t\t\tFRONT_POS_X,\n\t\t\t\tFRONT_POS_Y,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlight1ID,\n\t\t\t\tINDEX_COLOR,\n\t\t\t\tSIZE_POS_X,\n\t\t\t\tSIZE_POS_Y,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (addIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(addIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(\n\t\t\tact.move,\n\t\t\tthis.highlight1ID,\n\t\t\tthis.front * ARRAY_ELEM_WIDTH + ARRAY_START_X,\n\t\t\typos + ARRAY_ELEM_HEIGHT,\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, labEnqueueValIDNew, xpos, ypos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, labEnqueueValIDNew);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.arrayData[addIndex] = elemToEnqueue;\n\t\tthis.cmd(act.setText, this.arrayID[addIndex], elemToEnqueue);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.sizeID, this.size + 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\n\t\tthis.cmd(act.delete, labEnqueueID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.size++;\n\n\t\tthis.nextIndex = this.nextIndex - this.size;\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.cmd(act.setText, this.frontID, '0');\n\t\tthis.cmd(act.setText, this.sizeID, '0');\n\t\tthis.cmd(\n\t\t\tact.setPosition,\n\t\t\tthis.frontPointerID,\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + FRONT_LABEL_OFFSET,\n\t\t);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 100;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 150;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst HEAD_POS_X = 180;\nconst HEAD_POS_Y = 100;\n\nconst TAIL_POS_X = 180;\n\nconst POINTER_LABEL_X = 130;\nconst HEAD_LABEL_Y = 100;\n\nconst POINTER_ELEM_WIDTH = 30;\nconst POINTER_ELEM_HEIGHT = 30;\n\nconst SIZE = 32;\n\nexport default class DequeLL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.tail_pos_y = h - LINKED_LIST_ELEM_HEIGHT;\n\t\tthis.tail_label_y = this.tail_pos_y;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\t// Add's value text field\n\t\tthis.addField = addControlToAlgorithmBar('Text', '');\n\t\tthis.addField.onkeydown = this.returnSubmit(this.addField, null, 4);\n\t\tthis.controls.push(this.addField);\n\n\t\t// Add first button\n\t\tthis.addFirstButton = addControlToAlgorithmBar('Button', 'Add First');\n\t\tthis.addFirstButton.onclick = this.addFirstCallback.bind(this);\n\t\tthis.controls.push(this.addFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Add last button\n\t\tthis.addLastButton = addControlToAlgorithmBar('Button', 'Add Last');\n\t\tthis.addLastButton.onclick = this.addLastCallback.bind(this);\n\t\tthis.controls.push(this.addLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Remove first button\n\t\tthis.removeFirstButton = addControlToAlgorithmBar('Button', 'Remove First');\n\t\tthis.removeFirstButton.onclick = this.removeFirstCallback.bind(this);\n\t\tthis.controls.push(this.removeFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Remove last button\n\t\tthis.removeLastButton = addControlToAlgorithmBar('Button', 'Remove Last');\n\t\tthis.removeLastButton.onclick = this.removeLastCallback.bind(this);\n\t\tthis.controls.push(this.removeLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.headID = this.nextIndex++;\n\t\tthis.headLabelID = this.nextIndex++;\n\n\t\tthis.tailID = this.nextIndex++;\n\t\tthis.tailLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.headLabelID, 'Head', POINTER_LABEL_X, HEAD_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.headID,\n\t\t\t'',\n\t\t\tPOINTER_ELEM_WIDTH,\n\t\t\tPOINTER_ELEM_HEIGHT,\n\t\t\tHEAD_POS_X,\n\t\t\tHEAD_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.tailLabelID, 'Tail', POINTER_LABEL_X, this.tail_label_y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.tailID,\n\t\t\t'',\n\t\t\tPOINTER_ELEM_WIDTH,\n\t\t\tPOINTER_ELEM_HEIGHT,\n\t\t\tTAIL_POS_X,\n\t\t\tthis.tail_pos_y,\n\t\t);\n\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\tthis.cmd(act.setNull, this.tailID, 1);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddFirstCallback() {\n\t\tif (this.addField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addField.value);\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddLastCallback() {\n\t\tif (this.addField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addField.value);\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveFirstCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveLastCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// getCallback(event)\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createDoublyLinkedListNode,\n\t\t\tthis.linkedListElemID[index],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (index === 0) {\n\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index], 1);\n\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[index]);\n\t\t}\n\n\t\tif (index === this.size) {\n\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index], 1);\n\t\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[index]);\n\t\t}\n\n\t\tif (this.size !== 0) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[index + 1]);\n\t\t\t} else if (index === this.size) {\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[index - 1]);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.resetNodePositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 1);\n\t\t\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[index]);\n\t\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[index + 1]);\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 1);\n\t\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[index]);\n\t\t\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[index - 1]);\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[index]);\n\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[index]);\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[index]);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\tthis.cmd(act.setNull, this.tailID, 1);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst SKIP_LIST_START_X = 100;\nconst SKIP_LIST_START_Y = 400;\nconst SKIP_LIST_ELEM_SIZE = 40;\n\nconst SKIP_LIST_SPACING = 80;\n\nconst VALUE_LABEL_X = 50;\nconst VALUE_LABEL_Y = 23;\nconst VALUE_STRING_X = 120;\nconst VALUE_STRING_Y = 23;\n\nconst CF_LABEL_X = 50;\nconst CF_LABEL_Y = 37;\nconst CF_STRING_X = 120;\nconst CF_STRING_Y = 37;\n\nconst EXP_LABEL_X = 250;\nconst EXP_LABEL_Y = 30;\n\nconst NINF = '\\u2212\\u221E'; // Negative infinity\nconst PINF = '\\u221E'; // Positive infinity\n\nexport default class SkipList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\t// add w/ heads groups\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst topHorizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\t\tconst bottomHorizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// add w/ random heads groups\n\t\tconst verticalGroupRandom = addGroupToAlgorithmBar(false);\n\t\tconst topHorizontalGroupRandom = addGroupToAlgorithmBar(true, verticalGroupRandom);\n\t\tconst bottomHorizontalGroupRandom = addGroupToAlgorithmBar(true, verticalGroupRandom);\n\n\t\t// Add w/ heads section\n\t\taddLabelToAlgorithmBar('Add', topHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', topHorizontalGroup);\n\t\tthis.addValueField.setAttribute('placeholder', 'Value');\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\tthis.addWithHeadsCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('with', topHorizontalGroup);\n\n\t\t// Heads' text field\n\t\tthis.headsField = addControlToAlgorithmBar('Text', '', topHorizontalGroup);\n\t\tthis.headsField.setAttribute('placeholder', '#');\n\t\tthis.headsField.onkeydown = this.returnSubmit(\n\t\t\tthis.headsField,\n\t\t\tthis.addWithHeadsCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.headsField);\n\n\t\taddLabelToAlgorithmBar('heads (Max 4)', topHorizontalGroup);\n\n\t\t// Add with heads button\n\t\tthis.addWithHeadsButton = addControlToAlgorithmBar('Button', 'Add', bottomHorizontalGroup);\n\t\tthis.addWithHeadsButton.onclick = this.addWithHeadsCallback.bind(this);\n\t\tthis.controls.push(this.addWithHeadsButton);\n\n\t\t// Add w/ random heads section\n\t\taddLabelToAlgorithmBar('Add', topHorizontalGroupRandom);\n\n\t\t// Add's value text field\n\t\tthis.addValueFieldRandom = addControlToAlgorithmBar('Text', '', topHorizontalGroupRandom);\n\t\tthis.addValueFieldRandom.setAttribute('placeholder', 'Value');\n\t\tthis.addValueFieldRandom.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueFieldRandom,\n\t\t\tthis.addRandomlyCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueFieldRandom);\n\n\t\taddLabelToAlgorithmBar('with random coin flip', topHorizontalGroupRandom);\n\n\t\t// Add randomly button\n\t\tthis.addRandomlyButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add',\n\t\t\tbottomHorizontalGroupRandom,\n\t\t);\n\t\tthis.addRandomlyButton.onclick = this.addRandomlyCallback.bind(this);\n\t\tthis.controls.push(this.addRandomlyButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Remove's text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '');\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\tthis.removeCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove button\n\t\tthis.removeButton = addControlToAlgorithmBar('Button', 'Remove');\n\t\tthis.removeButton.onclick = this.removeCallback.bind(this);\n\t\tthis.controls.push(this.removeButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Get's index text field\n\t\tthis.getField = addControlToAlgorithmBar('Text', '');\n\t\tthis.getField.onkeydown = this.returnSubmit(\n\t\t\tthis.getField,\n\t\t\tthis.getCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.getField);\n\n\t\t// Get button\n\t\tthis.getButton = addControlToAlgorithmBar('Button', 'Get');\n\t\tthis.getButton.onclick = this.getCallback.bind(this);\n\t\tthis.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\n\t\tthis.size = 0;\n\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[0][0],\n\t\t\tNINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[1][0],\n\t\t\tPINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING,\n\t\t\tSKIP_LIST_START_Y,\n\t\t);\n\t\tthis.cmd(act.connectSkipList, this.nodeID[0][0], this.nodeID[1][0], 3);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\n\t\tthis.size = 0;\n\t}\n\n\taddRandomlyCallback() {\n\t\tif (this.addValueFieldRandom.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueFieldRandom.value);\n\t\t\tthis.addValueFieldRandom.value = '';\n\t\t\tthis.headsField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal);\n\t\t}\n\t}\n\n\taddWithHeadsCallback() {\n\t\tif (this.addValueField.value !== '' && this.headsField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tconst heads = parseInt(this.headsField.value);\n\t\t\tthis.headsField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, heads);\n\t\t}\n\t}\n\n\tremoveCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst value = parseInt(this.removeField.value);\n\t\t\tthis.removeField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), value);\n\t\t}\n\t}\n\n\tgetCallback() {\n\t\tif (this.getField.value !== '') {\n\t\t\tconst value = parseInt(this.getField.value);\n\t\t\tthis.getField.value = '';\n\t\t\tthis.implementAction(this.get.bind(this), value);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(value, heads) {\n\t\tthis.commands = [];\n\n\t\tif (heads === undefined) {\n\t\t\theads = Math.floor(Math.random() * 5); // random int between [0, 4]\n\t\t}\n\t\theads = Math.min(heads, 4);\n\n\t\tconst valueLabelId = this.nextIndex++;\n\t\tconst valueStringId = this.nextIndex++;\n\n\t\tconst cfLabelId = this.nextIndex++;\n\t\tconst cfStringId = this.nextIndex++;\n\t\tconst expLabelID = this.nextIndex++;\n\n\t\tlet headsString = '';\n\t\tfor (let i = 0; i < heads; i++) {\n\t\t\theadsString += 'H';\n\t\t}\n\t\theadsString += 'T';\n\n\t\tthis.cmd(act.createLabel, valueLabelId, 'Value to add:', VALUE_LABEL_X, VALUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, valueStringId, value, VALUE_STRING_X, VALUE_STRING_Y);\n\t\tthis.cmd(act.createLabel, cfLabelId, 'Coin Flipper:', CF_LABEL_X, CF_LABEL_Y);\n\t\tthis.cmd(act.createLabel, cfStringId, headsString, CF_STRING_X, CF_STRING_Y);\n\t\tthis.cmd(act.createLabel, expLabelID, '', EXP_LABEL_X, EXP_LABEL_Y);\n\t\tthis.cmd(act.step);\n\n\t\t// Add levels\n\t\tfor (let row = this.nodeID[0].length; row <= heads; row++) {\n\t\t\tconst rightPhantomsCol = this.nodeID.length - 1;\n\t\t\tthis.data[0][row] = Number.NEGATIVE_INFINITY;\n\t\t\tthis.nodeID[0][row] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createSkipListNode,\n\t\t\t\tthis.nodeID[0][row],\n\t\t\t\tNINF,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_START_X,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tthis.data[rightPhantomsCol][row] = Number.POSITIVE_INFINITY;\n\t\t\tthis.nodeID[rightPhantomsCol][row] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createSkipListNode,\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\n\t\t\t\tPINF,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * rightPhantomsCol,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.connectSkipList,\n\t\t\t\tthis.nodeID[0][row],\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\n\t\t\t\t3,\n\t\t\t);\n\t\t\tthis.cmd(act.connectSkipList, this.nodeID[0][row - 1], this.nodeID[0][row], 0);\n\t\t\tthis.cmd(\n\t\t\t\tact.connectSkipList,\n\t\t\t\tthis.nodeID[rightPhantomsCol][row - 1],\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\n\t\t\t\t0,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\t// Find column where new element will be inserted\n\t\tlet newCol = 1;\n\t\twhile (value > this.data[newCol][0]) {\n\t\t\tnewCol++;\n\t\t}\n\n\t\t//this step should be skipped in the case of a duplicate\n\t\tif (value !== this.data[newCol][0]) {\n\t\t\t// Move IDs and data in next columns to the right\n\t\t\tfor (let col = this.nodeID.length - 1; col >= newCol; col--) {\n\t\t\t\tthis.nodeID[col + 1] = this.nodeID[col];\n\t\t\t\tthis.data[col + 1] = this.data[col];\n\t\t\t}\n\t\t\tthis.nodeID[newCol] = [];\n\t\t\tthis.data[newCol] = [];\n\t\t}\n\n\t\t// Traverse and add\n\t\tlet col = 0;\n\t\tlet row = this.nodeID[0].length - 1;\n\n\t\tconst highlightID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\thighlightID,\n\t\t\t'#FF0000',\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t);\n\t\tthis.cmd(act.setHighlight, highlightID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tlet foundDuplicate = false;\n\t\twhile (row >= 0) {\n\t\t\t// Move right until next element is greater or equal\n\t\t\tlet nextCol = this.getNextCol(col, row);\n\t\t\tif (value === this.data[nextCol][row]) {\n\t\t\t\tcol = nextCol;\n\t\t\t\tfoundDuplicate = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\twhile (value > this.data[nextCol][row]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tcol = nextCol;\n\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t}\n\n\t\t\tif (value === this.data[nextCol][row]) {\n\t\t\t\tcol = nextCol;\n\t\t\t\tfoundDuplicate = true;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Move highlight circle downward\n\t\t\trow--;\n\t\t\tif (row >= 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\t// Add nodes bottom-up to the new column if no duplicate has been found\n\t\tif (!foundDuplicate) {\n\t\t\tthis.shiftColumns(newCol);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightID,\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, expLabelID, 'Duplicate found!');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\trow++;\n\t\t// Having a highlight circle in the previous ID causes an object to look weird (this\n\t\t// seems to be an already existing bug) Creating a random object before it is a workaround\n\t\tthis.cmd(act.createCircle, this.nextIndex++, '', -100, -100, 0);\n\n\t\twhile (row <= heads) {\n\t\t\tthis.cmd(act.setText, expLabelID, 'Adding data');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.data[newCol][row] = value;\n\t\t\tthis.nodeID[newCol][row] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createSkipListNode,\n\t\t\t\tthis.nodeID[newCol][row],\n\t\t\t\tvalue,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * newCol,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tconst prevCol = this.getPrevCol(newCol, row);\n\t\t\tconst nextCol = this.getNextCol(newCol, row);\n\t\t\tthis.cmd(act.disconnect, this.nodeID[prevCol][row], this.nodeID[nextCol][row]);\n\t\t\tthis.cmd(act.connectSkipList, this.nodeID[prevCol][row], this.nodeID[newCol][row], 3);\n\t\t\tthis.cmd(act.connectSkipList, this.nodeID[newCol][row], this.nodeID[nextCol][row], 3);\n\t\t\tif (row !== 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectSkipList,\n\t\t\t\t\tthis.nodeID[newCol][row - 1],\n\t\t\t\t\tthis.nodeID[newCol][row],\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightID,\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * newCol,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\trow++;\n\t\t}\n\n\t\tthis.cmd(act.delete, valueLabelId);\n\t\tthis.cmd(act.delete, valueStringId);\n\t\tthis.cmd(act.delete, cfLabelId);\n\t\tthis.cmd(act.delete, cfStringId);\n\t\tthis.cmd(act.delete, highlightID);\n\t\tthis.cmd(act.delete, expLabelID);\n\n\t\tthis.size++;\n\n\t\treturn this.commands;\n\t}\n\n\tremove(params) {\n\t\tthis.commands = [];\n\n\t\tconst value = parseInt(params);\n\n\t\tconst valueLabelId = this.nextIndex++;\n\t\tconst valueStringId = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, valueLabelId, 'Value to remove:', VALUE_LABEL_X, VALUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, valueStringId, value, VALUE_STRING_X, VALUE_STRING_Y);\n\t\tthis.cmd(act.step);\n\n\t\t// Traverse and remove\n\t\tlet col = 0;\n\t\tlet row = this.nodeID[0].length - 1;\n\t\tlet removedCol = -1;\n\n\t\tconst highlightID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\thighlightID,\n\t\t\t'#FF0000',\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\twhile (row >= 0) {\n\t\t\t// Move right until next element is greater or equal\n\t\t\tlet nextCol = this.getNextCol(col, row);\n\t\t\twhile (value > this.data[nextCol][row]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tcol = nextCol;\n\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t}\n\n\t\t\tif (value === this.data[nextCol][row]) {\n\t\t\t\tremovedCol = nextCol;\n\t\t\t\tcol = nextCol;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\twhile (row >= 0) {\n\t\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t\t\tconst prevCol = this.getPrevCol(col, row);\n\t\t\t\t\tthis.cmd(act.disconnect, this.nodeID[prevCol][row], this.nodeID[col][row]);\n\t\t\t\t\tthis.cmd(act.disconnect, this.nodeID[col][row], this.nodeID[nextCol][row]);\n\t\t\t\t\tif (this.nodeID[col][row + 1] != null) {\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.nodeID[col][row + 1], this.nodeID[col][row]);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectSkipList,\n\t\t\t\t\t\tthis.nodeID[prevCol][row],\n\t\t\t\t\t\tthis.nodeID[nextCol][row],\n\t\t\t\t\t\t3,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.delete, this.nodeID[col][row]);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\trow--;\n\t\t\t\t\tif (row !== -1) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\thighlightID,\n\t\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trow--;\n\t\t\t\tif (row !== -1) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\thighlightID,\n\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, valueLabelId);\n\t\tthis.cmd(act.delete, valueStringId);\n\t\tthis.cmd(act.delete, highlightID);\n\n\t\tif (removedCol !== -1) {\n\t\t\t// Shift ID and data columns to the left (already erases last column)\n\t\t\tfor (let col = removedCol; col < this.nodeID.length - 1; col++) {\n\t\t\t\tthis.nodeID[col] = this.nodeID[col + 1];\n\t\t\t\tthis.data[col] = this.data[col + 1];\n\t\t\t}\n\t\t\tthis.nodeID.pop();\n\t\t\tthis.data.pop();\n\n\t\t\tthis.shiftColumns(removedCol);\n\t\t}\n\n\t\t// Remove empty rows\n\t\t// Find tallest column of actual values (not phantoms)\n\t\tlet maxHeight = 1;\n\t\tfor (let col = 1; col < this.nodeID.length - 1; col++) {\n\t\t\tmaxHeight = Math.max(maxHeight, this.nodeID[col].length);\n\t\t}\n\t\t// Remove rows above tallest column (so empty rows)\n\t\tfor (let row = this.nodeID[0].length - 1; row >= maxHeight; row--) {\n\t\t\tthis.data[0].pop();\n\t\t\tconst leftPhantomID = this.nodeID[0].pop();\n\t\t\tthis.cmd(act.delete, leftPhantomID);\n\t\t\tconst rightPhantomsCol = this.nodeID.length - 1;\n\t\t\tthis.data[rightPhantomsCol].pop();\n\t\t\tconst rightPhantomID = this.nodeID[rightPhantomsCol].pop();\n\t\t\tthis.cmd(act.delete, rightPhantomID);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.size--;\n\n\t\treturn this.commands;\n\t}\n\n\tget(params) {\n\t\tthis.commands = [];\n\n\t\tconst value = parseInt(params);\n\n\t\tlet col = 0;\n\t\tlet row = this.nodeID[0].length - 1;\n\t\t// let nextCol = this.getNextCol(col, row);\n\n\t\tconst highlightID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\thighlightID,\n\t\t\t'#FF0000',\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t);\n\t\tthis.cmd(act.setHighlight, highlightID, 1);\n\t\tthis.cmd(act.step);\n\n\t\twhile (row >= 0 && value !== this.data[col][row]) {\n\t\t\t// Move right until next element is greater or equal\n\t\t\tlet nextCol = this.getNextCol(col, row);\n\t\t\twhile (value >= this.data[nextCol][row]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tcol = nextCol;\n\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t}\n\n\t\t\t// Move highlight circle downward if data has not been found\n\t\t\tif (value !== this.data[col][row]) {\n\t\t\t\trow--;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, highlightID);\n\n\t\treturn this.commands;\n\t}\n\n\t// Shifts columns on screen\n\tshiftColumns(col) {\n\t\tfor (; col < this.nodeID.length; col++) {\n\t\t\tfor (let row = 0; row < this.nodeID[col].length; row++) {\n\t\t\t\tif (this.nodeID[col][row] != null) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tthis.nodeID[col][row],\n\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t}\n\n\t// Gets the column of the next node (\"right pointer\")\n\tgetNextCol(col, row) {\n\t\tcol++;\n\t\twhile (this.data[col][row] == null) {\n\t\t\tcol++;\n\t\t}\n\t\treturn col;\n\t}\n\n\t// Gets the column of the previous node (\"left pointer\")\n\tgetPrevCol(col, row) {\n\t\tcol--;\n\t\twhile (this.data[col][row] == null) {\n\t\t\tcol--;\n\t\t}\n\t\treturn col;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\n\t\tfor (let col = 0; col < this.nodeID.length; col++) {\n\t\t\tfor (let row = 0; row < this.nodeID[col].length; row++) {\n\t\t\t\tthis.cmd(act.delete, this.nodeID[col][row]);\n\t\t\t}\n\t\t}\n\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\n\t\tthis.size = 0;\n\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[0][0],\n\t\t\tNINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[1][0],\n\t\t\tPINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING,\n\t\t\tSKIP_LIST_START_Y,\n\t\t);\n\t\tthis.cmd(act.connectSkipList, this.nodeID[0][0], this.nodeID[1][0], 3);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 130;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 200;\n\nexport default class InsertionSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure InsertionSort(array):'],\n\t\t\t['     length <- length of array'],\n\t\t\t['     for i <- 1, length - 1 do'],\n\t\t\t['          j <- i'],\n\t\t\t['          while ', 'j > 0, ', 'array[j - 1] > array[j]', ' do'],\n\t\t\t['               swap array[j-1], array[j] '],\n\t\t\t['               j <- j - 1'],\n\t\t\t['          end while'],\n\t\t\t['     end for'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.highlight(0, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\t\tthis.highlight(2, 0);\n\n\t\tfor (let i = 1; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(4, 0);\n\t\t\tfor (let j = i; j >= 1; j--) {\n\t\t\t\tthis.movePointers(j - 1, j);\n\t\t\t\tthis.unhighlight(3, 0);\n\t\t\t\tthis.unhighlight(4, 0);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tthis.highlight(4, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(4, 1);\n\t\t\t\tthis.highlight(4, 2);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(4, 2);\n\t\t\t\tif (this.arrayData[j] < this.arrayData[j - 1]) {\n\t\t\t\t\tthis.highlight(5, 0);\n\t\t\t\t\tthis.swap(j, j - 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\t\tthis.highlight(6, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tif (i === 1) this.cmd(act.setBackgroundColor, this.arrayID[0], '#2ECC71');\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(2, 0);\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 130;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 200;\n\n// const ARRRAY_ELEMS_PER_LINE = 15;\n// const ARRAY_LINE_SPACING = 130;\n\n// const TOP_POS_X = 180;\n// const TOP_POS_Y = 100;\n// const TOP_LABEL_X = 130;\n// const TOP_LABEL_Y = 100;\n\n// const PUSH_LABEL_X = 50;\n// const PUSH_LABEL_Y = 30;\n// const PUSH_ELEMENT_X = 120;\n// const PUSH_ELEMENT_Y = 30;\n\n// const SIZE = 10;\n\nexport default class SelectionSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\t//Min & Max selection button\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst minMaxButtonList = addRadioButtonGroupToAlgorithmBar(['Min', 'Max'], 'Min/Max');\n\n\t\tthis.minButton = minMaxButtonList[0];\n\t\tthis.minButton.onclick = this.minCallback.bind(this);\n\t\tthis.controls.push(this.minButton);\n\t\tthis.minButton.checked = true;\n\t\tthis.maxButton = minMaxButtonList[1];\n\t\tthis.maxButton.onclick = this.maxCallback.bind(this);\n\t\tthis.controls.push(this.maxButton);\n\t\tthis.isMin = true;\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure SelectionSort(array):'],\n\t\t\t['     length <- length of array'],\n\t\t\t['     for i <- 0, length do'],\n\t\t\t['          min <- i'],\n\t\t\t['          for j <- i + 1, length do'],\n\t\t\t['               if array[j] < array[min]'],\n\t\t\t['                    min <- j'],\n\t\t\t['               end if'],\n\t\t\t['          end for'],\n\t\t\t['          swap array[min], array[i]'],\n\t\t\t['     end for'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t\tif (!this.isMin) {\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     for i <- length - 1, 0 do');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '          max <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          for j <- i - 1, 0 do');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '               if array[j] > array[max]');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '                    max <- j');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '          swap array[max], array[i]');\n\t\t}\n\t}\n\n\tminCallback() {\n\t\tif (!this.isMin) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     for i <- 0, length do');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '          min <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          for j <- i + 1, length do');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '               if array[j] < array[min]');\n\t\t\tthis.cmd(act.setText, this.codeID[6][0], '                    min <- j');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '          swap array[min], array[i]');\n\t\t\tthis.isMin = true;\n\t\t}\n\t}\n\n\tmaxCallback() {\n\t\tif (this.isMin) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     for i <- length - 1, 0 do');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '          max <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          for j <- i - 1, 0 do');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '               if array[j] > array[max]');\n\t\t\tthis.cmd(act.setText, this.codeID[6][0], '                    max <- j');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '          swap array[max], array[i]');\n\t\t\tthis.isMin = false;\n\t\t}\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.compCount = 0;\n\t\tthis.displayData = [];\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\t\tthis.highlight(0, 0);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tconst length = this.arrayData.length;\n\t\tthis.displayData = new Array(length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\t\tlet circleShift = 0;\n\t\tif (!this.isMin) {\n\t\t\tcircleShift = ARRAY_ELEM_WIDTH * (this.arrayData.length - 1);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#FF0000',\n\t\t\tARRAY_START_X + circleShift,\n\t\t\tARRAY_START_Y,\n\t\t);\n\n\t\tcircleShift = ARRAY_ELEM_WIDTH;\n\t\tif (!this.isMin) {\n\t\t\tcircleShift = ARRAY_ELEM_WIDTH * (this.arrayData.length - 2);\n\t\t}\n\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + circleShift,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.highlight(2, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(2, 0);\n\t\tfor (let i = 0; i < this.arrayData.length - 1; i++) {\n\t\t\tthis.highlight(3, 0);\n\t\t\tlet k = i;\n\t\t\tif (!this.isMin) {\n\t\t\t\tk = this.arrayData.length - 1 - i;\n\t\t\t}\n\n\t\t\tlet toSwap = k;\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[toSwap], '#FFFF00');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let j = i + 1; j < this.arrayData.length; j++) {\n\t\t\t\tthis.unhighlight(4, 0);\n\t\t\t\tlet w = j;\n\t\t\t\tif (!this.isMin) {\n\t\t\t\t\tw = this.arrayData.length - 1 - j;\n\t\t\t\t}\n\n\t\t\t\tthis.movePointers(toSwap, w);\n\t\t\t\tif (this.compare(this.arrayData[w], this.arrayData[toSwap])) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[toSwap], '#FFFFFF');\n\t\t\t\t\tthis.highlight(6, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\ttoSwap = w;\n\t\t\t\t\tthis.movePointers(toSwap, w);\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[toSwap], '#FFFF00');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.swap(k, toSwap);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[toSwap], '#FFFFFF');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[k], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\tlet lastIndex = this.arrayID.length - 1;\n\t\tif (!this.isMin) {\n\t\t\tlastIndex = 0;\n\t\t}\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[lastIndex], '#2ECC71');\n\n\t\treturn this.commands;\n\t}\n\n\tcompare(i, j) {\n\t\tthis.highlight(5, 0);\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + ++this.compCount);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(5, 0);\n\t\tif (this.isMin) {\n\t\t\treturn i < j;\n\t\t} else {\n\t\t\treturn i > j;\n\t\t}\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.highlight(9, 0);\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\tthis.unhighlight(9, 0);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 120;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 180;\n\nexport default class QuickSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Toggles\n\t\tconst pivotButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Random pivot', 'Min element', 'First element', 'Perfect pivot'],\n\t\t\t'Traversals',\n\t\t);\n\n\t\tthis.randomPivotSelect = pivotButtonList[0];\n\t\tthis.minPivotSelect = pivotButtonList[1];\n\t\tthis.firstPivotSelect = pivotButtonList[2];\n\t\tthis.perfectPivotSelect = pivotButtonList[3];\n\t\tthis.randomPivotSelect.onclick = () => (this.pivotType = 'random');\n\t\tthis.minPivotSelect.onclick = () => (this.pivotType = 'min');\n\t\tthis.firstPivotSelect.onclick = () => (this.pivotType = 'first');\n\t\tthis.perfectPivotSelect.onclick = () => (this.pivotType = 'perfect');\n\t\tthis.randomPivotSelect.checked = true;\n\t\tthis.pivotType = 'random';\n\n\t\tthis.controls.push(this.randomPivotSelect);\n\t\tthis.controls.push(this.perfectPivotSelect);\n\t\tthis.controls.push(this.firstPivotSelect);\n\t\tthis.controls.push(this.minPivotSelect);\n\n\t\taddDivisorToAlgorithmBar();\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure QuickSort(array, left, right):'],\n\t\t\t['     pivotIdx <- random index within region being sorted'],\n\t\t\t['     pivot <- array[pivotIdx]'],\n\t\t\t['     swap array[left] and array[pivotIdx]'],\n\t\t\t['     i <- left + 1, j <- right - 1'],\n\t\t\t['     while i <= j do'],\n\t\t\t['          while ', 'i <= j', ' and ', 'array[i] <= pivot'],\n\t\t\t['               i <- i + 1'],\n\t\t\t['          end while'],\n\t\t\t['          while ', 'i <= j', ' and ', 'array[j] >= pivot'],\n\t\t\t['               j <- j - 1'],\n\t\t\t['          end while'],\n\t\t\t['          if i <= j then'],\n\t\t\t['               swap array[i] and array[j]'],\n\t\t\t['               i <- i + 1, j <- j - 1'],\n\t\t\t['          end if'],\n\t\t\t['     end while'],\n\t\t\t['     swap pivot and array[j]'],\n\t\t\t['     QuickSort on array, left, j'],\n\t\t\t['     QuickSort on array, j + 1, right'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.arrayData[i] = parseInt(this.arrayData[i]);\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.pPointerID = this.nextIndex++;\n\t\tthis.helper(0, this.arrayData.length - 1);\n\n\t\treturn this.commands;\n\t}\n\n\thelper(left, right) {\n\t\tif (left > right) return;\n\n\t\tthis.highlight(0, 0);\n\n\t\t// Hightlight cells in the current sub-array\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#99CCFF');\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\n\t\tif (left === right) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(0, 0);\n\t\t\treturn;\n\t\t}\n\n\t\t// Create pivot pointer and swap with left-most element\n\t\t// To make things more interesting (and clearer), we don't pick the left-most element as pivot\n\t\tlet pivot;\n\t\tthis.highlight(1, 0);\n\t\tthis.highlight(2, 0);\n\t\tif (this.pivotType === 'min') {\n\t\t\tlet min = left;\n\t\t\tfor (let i = left + 1; i <= right; i++) {\n\t\t\t\tif (this.arrayData[i] < this.arrayData[min]) {\n\t\t\t\t\tmin = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpivot = min;\n\t\t} else if (this.pivotType === 'first') {\n\t\t\tpivot = left;\n\t\t} else if (this.pivotType === 'perfect') {\n\t\t\tconst sorted = this.arrayData.slice(left, right + 1);\n\t\t\tsorted.sort((a, b) => a - b);\n\t\t\tconst midIndex = Math.floor(sorted.length / 2);\n\t\t\tpivot = this.arrayData.indexOf(sorted[midIndex]);\n\t\t} else if (this.pivotType === 'random') {\n\t\t\tpivot = Math.floor(Math.random() * (right - left)) + left + 1;\n\t\t}\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.pPointerID, '#FFFF00', pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.highlight(3, 0);\n\t\tthis.swapPivot(pivot, left);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(3, 0);\n\t\tthis.highlight(4, 0);\n\t\t// Partition\n\t\tlet i = left + 1;\n\t\tlet j = right;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.iPointerID, '#0000FF', iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.createHighlightCircle, this.jPointerID, '#0000FF', jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(4, 0);\n\t\tthis.highlight(5, 0);\n\t\twhile (i <= j) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.highlight(6, 0);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.highlight(6, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tthis.unhighlight(6, 1);\n\t\t\tthis.highlight(6, 3);\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (i <= j && this.arrayData[left] >= this.arrayData[i]) {\n\t\t\t\tthis.unhighlight(6, 3);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\ti++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.highlight(6, 1);\n\t\t\t\tif (i <= j) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(6, 1);\n\t\t\t\t\tthis.highlight(6, 3);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.unhighlight(6, 1);\n\t\t\tthis.unhighlight(6, 3);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\t\t\t// One additional comparison will be made in the above loop if i <= j\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.highlight(9, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(9, 0);\n\t\t\tthis.highlight(9, 1);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(9, 1);\n\t\t\t\tthis.highlight(9, 3);\n\t\t\t}\n\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (i <= j && this.arrayData[left] <= this.arrayData[j]) {\n\t\t\t\tthis.unhighlight(9, 3);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tj--;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tthis.highlight(9, 1);\n\t\t\t\tif (i <= j) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(9, 1);\n\t\t\t\t\tthis.highlight(9, 3);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.unhighlight(9, 1);\n\t\t\tthis.unhighlight(9, 3);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.highlight(13, 0);\n\t\t\t\tthis.swap(i, j);\n\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\tthis.highlight(14, 0);\n\t\t\t\ti++;\n\t\t\t\tj--;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(14, 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.highlight(17, 0);\n\t\t// Move pivot back and delete pivot pointer\n\t\tthis.swapPivot(left, j, true);\n\t\tthis.unhighlight(17, 0);\n\n\t\t// Delete i and j pointers\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.delete, this.pPointerID);\n\t\tthis.cmd(act.step);\n\n\t\t// Un-hightlight cells in sub-array and set pivot cell to green\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#FFFFFF');\n\t\t}\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[j], '#2ECC71');\n\t\tthis.cmd(act.step);\n\n\t\tthis.highlight(18, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(18, 0);\n\n\t\tthis.helper(left, j - 1);\n\n\t\tthis.highlight(19, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(19, 0);\n\n\t\tthis.helper(j + 1, right);\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, ARRAY_START_Y);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswapPivot(pivot, other, moveJ) {\n\t\tif (pivot === other) return;\n\t\t// Create temporary labels and remove text in array\n\t\tconst lLabelID = this.nextIndex++;\n\t\tconst lXPos = other * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, lLabelID, this.displayData[other], lXPos, ARRAY_START_Y);\n\t\tconst pLabelID = this.nextIndex++;\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, pLabelID, this.displayData[pivot], pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[other], '');\n\t\tthis.cmd(act.setText, this.arrayID[pivot], '');\n\t\t// Move labels and pivot pointer\n\t\tthis.cmd(act.move, pLabelID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, this.pPointerID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, lLabelID, pXPos, ARRAY_START_Y);\n\t\tmoveJ && this.cmd(act.move, this.jPointerID, pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array, and delete temporary labels and pointer\n\t\tthis.cmd(act.setText, this.arrayID[other], this.displayData[pivot]);\n\t\tthis.cmd(act.setText, this.arrayID[pivot], this.displayData[other]);\n\t\tthis.cmd(act.delete, pLabelID);\n\t\tthis.cmd(act.delete, lLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[pivot];\n\t\tthis.arrayData[pivot] = this.arrayData[other];\n\t\tthis.arrayData[other] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[pivot];\n\t\tthis.displayData[pivot] = this.displayData[other];\n\t\tthis.displayData[other] = temp;\n\t}\n\n\tswap(i, j) {\n\t\t// Create temporary labels and remove text in array\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\t// Move labels\n\t\tthis.cmd(act.move, iLabelID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, jLabelID, iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array and delete temporary labels\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\t// Reset pointer colors back to blue\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\t// toggleWorstPivot() {\n\t// \tworstPivotEnabled = !worstPivotEnabled;\n\t// \tif (firstPivotEnabled) {\n\t// \t\tfirstPivotEnabled = false;\n\t// \t\tthis.firstPivotToggle.checked = false;\n\t// \t}\n\t// }\n\n\t// toggleFirstPivot() {\n\t// \tfirstPivotEnabled = !firstPivotEnabled;\n\t// \tif (worstPivotEnabled) {\n\t// \t\tworstPivotEnabled = false;\n\t// \t\tthis.worstPivotToggle.checked = false;\n\t// \t}\n\t// }\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 350;\nconst ARRAY_START_Y = 120;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 100;\n\nexport default class QuickSelect extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t`Comma seperated list (e.g. \"3,1,2\"). Max ${MAX_ARRAY_SIZE} elements & no elements > 999`,\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.runCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\taddLabelToAlgorithmBar('kᵗʰ element (1 indexed)', horizontalGroup);\n\n\t\t// k text field\n\t\tthis.kField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.kField.onkeydown = this.returnSubmit(\n\t\t\tthis.kField,\n\t\t\tthis.runCallback.bind(this),\n\t\t\t2,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.kField);\n\n\t\t// Run button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Run', horizontalGroup);\n\t\tthis.findButton.onclick = this.runCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\t\t// Toggles\n\t\tconst pivotButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Random pivot', 'Min element', 'First element', 'Perfect pivot'],\n\t\t\t'Traversals',\n\t\t);\n\n\t\tthis.randomPivotSelect = pivotButtonList[0];\n\t\tthis.minPivotSelect = pivotButtonList[1];\n\t\tthis.firstPivotSelect = pivotButtonList[2];\n\t\tthis.perfectPivotSelect = pivotButtonList[3];\n\t\tthis.randomPivotSelect.onclick = () => (this.pivotType = 'random');\n\t\tthis.minPivotSelect.onclick = () => (this.pivotType = 'min');\n\t\tthis.firstPivotSelect.onclick = () => (this.pivotType = 'first');\n\t\tthis.perfectPivotSelect.onclick = () => (this.pivotType = 'perfect');\n\t\tthis.randomPivotSelect.checked = true;\n\t\tthis.pivotType = 'random';\n\n\t\tthis.controls.push(this.randomPivotSelect);\n\t\tthis.controls.push(this.perfectPivotSelect);\n\t\tthis.controls.push(this.firstPivotSelect);\n\t\tthis.controls.push(this.minPivotSelect);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure QuickSelect(array, left, right, k):'],\n\t\t\t['     pivotIdx <- random index within [left, right]'],\n\t\t\t['     pivot <- array[pivotIdx]'],\n\t\t\t['     swap array[left] and array[pivotIdx]'],\n\t\t\t['     i <- left + 1, j <- right - 1'],\n\t\t\t['     while i <= j do'],\n\t\t\t['          while ', 'i <= j', ' and ', 'array[i] <= pivot'],\n\t\t\t['               i <- i + 1'],\n\t\t\t['          end while'],\n\t\t\t['          while ', 'i <= j', ' and ', 'array[j] >= pivot'],\n\t\t\t['               j <- j - 1'],\n\t\t\t['          end while'],\n\t\t\t['          if i <= j then'],\n\t\t\t['               swap array[i] and array[j]'],\n\t\t\t['               i <- i + 1, j <- j - 1'],\n\t\t\t['          end if'],\n\t\t\t['     end while'],\n\t\t\t['     swap pivot and array[j]'],\n\t\t\t['     if j equals k - 1 then'],\n\t\t\t['          return array[j]'],\n\t\t\t['     if j > k - 1 then'],\n\t\t\t['          QuickSelect on array, left, j - 1, k'],\n\t\t\t['     else'],\n\t\t\t['          QuickSelect on array, j + 1, right, k'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t}\n\n\trunCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tthis.kField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tconst k = this.kField.value;\n\t\t\tif (k > 0 && k <= list.length) {\n\t\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\t\tthis.listField.value = '';\n\t\t\t\tthis.kField.value = '';\n\t\t\t\tthis.implementAction(this.run.bind(this), list, k);\n\t\t\t}\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\trun(list, k) {\n\t\tthis.commands = [];\n\n\t\tthis.k = Number(k);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = list\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, 18);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.arrayData[i] = parseInt(this.arrayData[i]);\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.pPointerID = this.nextIndex++;\n\t\tthis.helper(0, this.arrayData.length - 1);\n\n\t\treturn this.commands;\n\t}\n\n\thelper(left, right) {\n\t\tif (left > right) return;\n\n\t\tthis.highlight(0, 0);\n\n\t\t// Hightlight cells in the current sub-array\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#99CCFF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tif (left === right) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(0, 0);\n\t\t\treturn;\n\t\t}\n\t\tthis.unhighlight(0, 0);\n\n\t\t// Create pivot pointer and swap with left-most element\n\t\t// To make things more interesting (and clearer), we don't pick the left-most element as pivot\n\t\tlet pivot;\n\t\tthis.highlight(1, 0);\n\t\tthis.highlight(2, 0);\n\t\tif (this.pivotType === 'min') {\n\t\t\tlet min = left;\n\t\t\tfor (let i = left + 1; i <= right; i++) {\n\t\t\t\tif (this.arrayData[i] < this.arrayData[min]) {\n\t\t\t\t\tmin = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpivot = min;\n\t\t} else if (this.pivotType === 'first') {\n\t\t\tpivot = left;\n\t\t} else if (this.pivotType === 'perfect') {\n\t\t\tconst sorted = this.arrayData.slice(left, right + 1);\n\t\t\tsorted.sort((a, b) => a - b);\n\t\t\tconst midIndex = Math.floor(sorted.length / 2);\n\t\t\tpivot = this.arrayData.indexOf(sorted[midIndex]);\n\t\t} else if (this.pivotType === 'random') {\n\t\t\tpivot = Math.floor(Math.random() * (right - left)) + left + 1;\n\t\t}\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.pPointerID, '#FFFF00', pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.highlight(3, 0);\n\t\tthis.swapPivot(pivot, left);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(3, 0);\n\t\tthis.highlight(4, 0);\n\t\t// Partition\n\t\tlet i = left + 1;\n\t\tlet j = right;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.iPointerID, '#0000FF', iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.createHighlightCircle, this.jPointerID, '#0000FF', jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(4, 0);\n\t\tthis.highlight(5, 0);\n\t\twhile (i <= j) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.highlight(6, 0);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.highlight(6, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tthis.unhighlight(6, 1);\n\t\t\tthis.highlight(6, 3);\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (i <= j && this.arrayData[left] >= this.arrayData[i]) {\n\t\t\t\tthis.unhighlight(6, 3);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\ti++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.highlight(6, 1);\n\t\t\t\tif (i <= j) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(6, 1);\n\t\t\t\t\tthis.highlight(6, 3);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.unhighlight(6, 1);\n\t\t\tthis.unhighlight(6, 3);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\n\t\t\tthis.highlight(9, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(9, 0);\n\t\t\tthis.highlight(9, 1);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(9, 1);\n\t\t\t\tthis.highlight(9, 3);\n\t\t\t}\n\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (i <= j && this.arrayData[left] <= this.arrayData[j]) {\n\t\t\t\tthis.unhighlight(9, 3);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tj--;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tthis.highlight(9, 1);\n\t\t\t\tif (i <= j) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(9, 1);\n\t\t\t\t\tthis.highlight(9, 3);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.unhighlight(9, 1);\n\t\t\tthis.unhighlight(9, 3);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.highlight(13, 0);\n\t\t\t\tthis.swap(i, j);\n\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\tthis.highlight(14, 0);\n\t\t\t\ti++;\n\t\t\t\tj--;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(14, 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.highlight(17, 0);\n\t\t// Move pivot back and delete pivot pointer\n\t\tthis.swapPivot(left, j, true);\n\t\tthis.unhighlight(17, 0);\n\n\t\t// Delete i and j pointers\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.delete, this.pPointerID);\n\t\tthis.cmd(act.step);\n\n\t\t// Un-hightlight cells in sub-array and set pivot cell to green\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#FFFFFF');\n\t\t}\n\t\tthis.highlight(18, 0);\n\t\tthis.cmd(act.step);\n\t\tif (this.k - 1 === j) {\n\t\t\tthis.unhighlight(18, 0);\n\t\t\tthis.highlight(19, 0);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[j], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(19, 0);\n\t\t} else {\n\t\t\tthis.unhighlight(18, 0);\n\t\t\tthis.highlight(20, 0);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[j], '#4DA6ff');\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (this.k - 1 < j) {\n\t\t\t\tthis.unhighlight(20, 0);\n\t\t\t\tthis.highlight(21, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(21, 0);\n\t\t\t\tthis.helper(left, j - 1);\n\t\t\t} else {\n\t\t\t\tthis.unhighlight(20, 0);\n\t\t\t\tthis.highlight(23, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(23, 0);\n\t\t\t\tthis.helper(j + 1, right);\n\t\t\t}\n\t\t}\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, ARRAY_START_Y);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswapPivot(pivot, other, moveJ) {\n\t\tif (pivot === other) return;\n\t\t// Create temporary labels and remove text in array\n\t\tconst lLabelID = this.nextIndex++;\n\t\tconst lXPos = other * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, lLabelID, this.displayData[other], lXPos, ARRAY_START_Y);\n\t\tconst pLabelID = this.nextIndex++;\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, pLabelID, this.displayData[pivot], pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[other], '');\n\t\tthis.cmd(act.setText, this.arrayID[pivot], '');\n\t\t// Move labels and pivot pointer\n\t\tthis.cmd(act.move, pLabelID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, this.pPointerID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, lLabelID, pXPos, ARRAY_START_Y);\n\t\tmoveJ && this.cmd(act.move, this.jPointerID, pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array, and delete temporary labels and pointer\n\t\tthis.cmd(act.setText, this.arrayID[other], this.displayData[pivot]);\n\t\tthis.cmd(act.setText, this.arrayID[pivot], this.displayData[other]);\n\t\tthis.cmd(act.delete, pLabelID);\n\t\tthis.cmd(act.delete, lLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[pivot];\n\t\tthis.arrayData[pivot] = this.arrayData[other];\n\t\tthis.arrayData[other] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[pivot];\n\t\tthis.displayData[pivot] = this.displayData[other];\n\t\tthis.displayData[other] = temp;\n\t}\n\n\tswap(i, j) {\n\t\t// Create temporary labels and remove text in array\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\t// Move labels\n\t\tthis.cmd(act.move, iLabelID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, jLabelID, iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array and delete temporary labels\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\t// Reset pointer colors back to blue\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 15;\n\nconst ARRAY_START_X = 450;\nconst ARRAY_START_Y = 50;\nconst ARRAY_LINE_SPACING = 75;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 80;\n\n// const ARRRAY_ELEMS_PER_LINE = 15;\n\n// const TOP_POS_X = 180;\n// const TOP_POS_Y = 100;\n// const TOP_LABEL_X = 130;\n// const TOP_LABEL_Y = 100;\n\n// const PUSH_LABEL_X = 50;\n// const PUSH_LABEL_Y = 30;\n// const PUSH_ELEMENT_X = 120;\n// const PUSH_ELEMENT_Y = 30;\n\n// const SIZE = 10;\n\nconst LARGE_OFFSET = 15;\nconst SMALL_OFFSET = 7;\n\nexport default class MergeSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\n\t\t// Useful for memory management\n\t\tthis.nextIndex = 0;\n\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\n\t\t// structures, etc.\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 15 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.kPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure MergeSort(array)'],\n\t\t\t['     length <- length of array, midIdx <- length / 2'],\n\t\t\t['     leftArray <- array[0...midIdx - 1]'],\n\t\t\t['     rightArray <- array[midIdx...length - 1]'],\n\t\t\t['     MergeSort(leftArray)'],\n\t\t\t['     MergeSort(rightArray)'],\n\t\t\t['     leftIdx, rightIdx, currIdx <- 0'],\n\t\t\t['     while leftIdx < midIdx and rightIdx < length - midIdx do'],\n\t\t\t['          if leftArray[leftIdx] <= rightArray[rightIdx] then'],\n\t\t\t['               array[currIdx] <- leftArray[leftIdx]'],\n\t\t\t['               leftIdx <- leftIdx + 1'],\n\t\t\t['          else'],\n\t\t\t['               array[currIdx] <- rightArray[rightIdx]'],\n\t\t\t['               rightIdx <- rightIdx + 1'],\n\t\t\t['          end if'],\n\t\t\t['          currIdx <- currIdx + 1'],\n\t\t\t['     end while'],\n\t\t\t['     while leftIdx < midIdx do'],\n\t\t\t['          array[currIdx] <- leftArray[leftIdx]'],\n\t\t\t['          currIdx <- currIdx + 1'],\n\t\t\t['          leftIdx <- leftIdx + 1'],\n\t\t\t['     end while'],\n\t\t\t['     while rightIdx < length - midIdx do'],\n\t\t\t['          array[currIdx] <- rightArray[rightIdx]'],\n\t\t\t['          currIdx <- currIdx + 1'],\n\t\t\t['          rightIdx <- rightIdx + 1'],\n\t\t\t['     end while'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.kPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\t\tthis.highlight(0, 0);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst xPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yPos = ARRAY_START_Y;\n\t\t\tthis.arrayID.push(this.nextIndex);\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txPos,\n\t\t\t\tyPos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\n\t\tif (this.arrayData.length !== 1) {\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tconst mid = Math.ceil((this.arrayData.length - 1) / 2);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.leftHelper(0, mid - 1, -LARGE_OFFSET, 0, 1);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.rightHelper(mid, this.arrayData.length - 1, LARGE_OFFSET, 0, 1);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.merge(\n\t\t\t\t0,\n\t\t\t\tthis.arrayData.length - 1,\n\t\t\t\tmid,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\t-LARGE_OFFSET,\n\t\t\t\tLARGE_OFFSET,\n\t\t\t\tthis.arrayID,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[0], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tleftHelper(left, right, offset, prevOffset, row) {\n\t\tthis.cmd(act.step);\n\t\tif (left > right) return;\n\t\tthis.unhighlight(4, 0);\n\t\tthis.unhighlight(5, 0);\n\t\tthis.highlight(0, 0);\n\n\t\tconst tempArrayID = this.drawArrayAndCopy(left, right, offset, prevOffset, row);\n\t\tthis.unhighlight(0, 0);\n\n\t\tif (left !== right) {\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tconst mid = Math.ceil((left + right) / 2);\n\t\t\tconst extraOffset = row < 2 ? 2 * LARGE_OFFSET : 2 * SMALL_OFFSET;\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.leftHelper(left, mid - 1, offset - extraOffset, offset, row + 1);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.leftHelper(mid, right, offset, offset, row + 1);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.merge(left, right, mid, row, offset, offset - extraOffset, offset, tempArrayID);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, tempArrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\trightHelper(left, right, offset, prevOffset, row) {\n\t\tthis.cmd(act.step);\n\t\tif (left > right) return;\n\t\tthis.unhighlight(4, 0);\n\t\tthis.unhighlight(5, 0);\n\t\tthis.highlight(0, 0);\n\n\t\tconst tempArrayID = this.drawArrayAndCopy(left, right, offset, prevOffset, row);\n\t\tthis.unhighlight(0, 0);\n\n\t\tif (left !== right) {\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tconst mid = Math.ceil((left + right) / 2);\n\t\t\tconst extraOffset = row < 2 ? 2 * LARGE_OFFSET : 2 * SMALL_OFFSET;\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.rightHelper(left, mid - 1, offset, offset, row + 1);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.rightHelper(mid, right, offset + extraOffset, offset, row + 1);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.merge(left, right, mid, row, offset, offset, offset + extraOffset, tempArrayID);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, tempArrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tdrawArrayAndCopy(left, right, offset, prevOffset, row) {\n\t\tconst tempArrayID = [];\n\n\t\t// Display subarray\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tconst xPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X + offset;\n\t\t\tconst yPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\n\t\t\ttempArrayID[i] = this.nextIndex;\n\t\t\tthis.arrayID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txPos,\n\t\t\t\tyPos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Copy elements from big array to current subarray\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.copyData(\n\t\t\t\ti,\n\t\t\t\ti,\n\t\t\t\tprevOffset,\n\t\t\t\toffset,\n\t\t\t\trow - 1,\n\t\t\t\trow,\n\t\t\t\tthis.displayData[i],\n\t\t\t\ttempArrayID[i],\n\t\t\t\t-1,\n\t\t\t);\n\t\t}\n\n\t\treturn tempArrayID;\n\t}\n\n\tmerge(left, right, mid, row, currOffset, leftOffset, rightOffset, currArrayID) {\n\t\tconst tempArray = new Array(this.arrayData.length); // Temporary array to store data for sorting\n\t\tconst tempDisplay = new Array(this.arrayData.length);\n\n\t\t// Copy data to temporary array\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\ttempArray[i] = this.arrayData[i];\n\t\t\ttempDisplay[i] = this.displayData[i];\n\t\t}\n\n\t\tthis.highlight(6, 0);\n\n\t\t// Create pointers\n\t\tconst bottomYPos = ARRAY_START_Y + (row + 1) * ARRAY_LINE_SPACING;\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst iXPos = left * ARRAY_ELEM_WIDTH + ARRAY_START_X + leftOffset;\n\t\tthis.cmd(act.createHighlightCircle, iPointerID, '#0000FF', iXPos, bottomYPos);\n\t\tconst jPointerID = this.nextIndex++;\n\t\tconst jXPos = mid * ARRAY_ELEM_WIDTH + ARRAY_START_X + rightOffset;\n\t\tthis.cmd(act.createHighlightCircle, jPointerID, '#0000FF', jXPos, bottomYPos);\n\t\tconst kPointerID = this.nextIndex++;\n\t\tconst kXPos = left * ARRAY_ELEM_WIDTH + ARRAY_START_X + currOffset;\n\t\tconst topYPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\n\t\tthis.cmd(act.createHighlightCircle, kPointerID, '#0000FF', kXPos, topYPos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.unhighlight(6, 0);\n\t\tthis.highlight(7, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(7, 0);\n\t\t// Merge data and animate\n\t\tlet i = left;\n\t\tlet j = mid;\n\t\tlet k = left;\n\t\twhile (i < mid && j <= right) {\n\t\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + ++this.compCount);\n\t\t\tthis.highlight(8, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(8, 0);\n\t\t\tif (tempArray[i] <= tempArray[j]) {\n\t\t\t\tthis.highlight(9, 0);\n\t\t\t\tthis.copyData(\n\t\t\t\t\ti,\n\t\t\t\t\tk,\n\t\t\t\t\tleftOffset,\n\t\t\t\t\tcurrOffset,\n\t\t\t\t\trow + 1,\n\t\t\t\t\trow,\n\t\t\t\t\ttempDisplay[i],\n\t\t\t\t\tcurrArrayID[k],\n\t\t\t\t\tiPointerID,\n\t\t\t\t);\n\t\t\t\tthis.unhighlight(9, 0);\n\t\t\t\tthis.arrayData[k] = tempArray[i];\n\t\t\t\tthis.displayData[k] = tempDisplay[i];\n\t\t\t\ti++;\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tif (i < mid) {\n\t\t\t\t\tthis.movePointer(i, row + 1, leftOffset, iPointerID);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t} else {\n\t\t\t\tthis.highlight(11, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\tthis.highlight(12, 0);\n\t\t\t\tthis.copyData(\n\t\t\t\t\tj,\n\t\t\t\t\tk,\n\t\t\t\t\trightOffset,\n\t\t\t\t\tcurrOffset,\n\t\t\t\t\trow + 1,\n\t\t\t\t\trow,\n\t\t\t\t\ttempDisplay[j],\n\t\t\t\t\tcurrArrayID[k],\n\t\t\t\t\tjPointerID,\n\t\t\t\t);\n\t\t\t\tthis.unhighlight(12, 0);\n\t\t\t\tthis.arrayData[k] = tempArray[j];\n\t\t\t\tthis.displayData[k] = tempDisplay[j];\n\t\t\t\tj++;\n\t\t\t\tthis.highlight(13, 0);\n\t\t\t\tif (j <= right) {\n\t\t\t\t\tthis.movePointer(j, row + 1, rightOffset, jPointerID);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t}\n\t\t\tk++;\n\t\t\tthis.highlight(15, 0);\n\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(15, 0);\n\t\t}\n\t\tthis.highlight(17, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(17, 0);\n\t\twhile (i < mid) {\n\t\t\tthis.highlight(18, 0);\n\t\t\tthis.copyData(\n\t\t\t\ti,\n\t\t\t\tk,\n\t\t\t\tleftOffset,\n\t\t\t\tcurrOffset,\n\t\t\t\trow + 1,\n\t\t\t\trow,\n\t\t\t\ttempDisplay[i],\n\t\t\t\tcurrArrayID[k],\n\t\t\t\tiPointerID,\n\t\t\t);\n\t\t\tthis.unhighlight(18, 0);\n\t\t\tthis.highlight(19, 0);\n\t\t\tthis.highlight(20, 0);\n\t\t\tthis.arrayData[k] = tempArray[i];\n\t\t\tthis.displayData[k] = tempDisplay[i];\n\t\t\tk++;\n\t\t\ti++;\n\t\t\tif (k <= right) {\n\t\t\t\tthis.movePointer(i, row + 1, leftOffset, iPointerID);\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(19, 0);\n\t\t\tthis.unhighlight(20, 0);\n\t\t}\n\t\tthis.highlight(22, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(22, 0);\n\t\twhile (j <= right) {\n\t\t\tthis.highlight(23, 0);\n\t\t\tthis.copyData(\n\t\t\t\tj,\n\t\t\t\tk,\n\t\t\t\trightOffset,\n\t\t\t\tcurrOffset,\n\t\t\t\trow + 1,\n\t\t\t\trow,\n\t\t\t\ttempDisplay[j],\n\t\t\t\tcurrArrayID[k],\n\t\t\t\tjPointerID,\n\t\t\t);\n\t\t\tthis.unhighlight(23, 0);\n\t\t\tthis.highlight(24, 0);\n\t\t\tthis.highlight(25, 0);\n\t\t\tthis.arrayData[k] = tempArray[j];\n\t\t\tthis.displayData[k] = tempDisplay[j];\n\t\t\tj++;\n\t\t\tk++;\n\t\t\tif (k <= right) {\n\t\t\t\tthis.movePointer(j, row + 1, rightOffset, jPointerID);\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.unhighlight(24, 0);\n\t\t\tthis.unhighlight(25, 0);\n\t\t}\n\n\t\t// Delete pointers\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\tthis.cmd(act.delete, kPointerID);\n\t\tthis.cmd(act.step);\n\t}\n\n\tcopyData(fromIndex, toIndex, fromOffset, toOffset, fromRow, toRow, value, cellID, pointerID) {\n\t\tif (pointerID !== -1) {\n\t\t\tthis.cmd(act.setForegroundColor, pointerID, '#FF0000');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst fromXPos = fromIndex * ARRAY_ELEM_WIDTH + ARRAY_START_X + fromOffset;\n\t\tconst fromYPos = ARRAY_START_Y + fromRow * ARRAY_LINE_SPACING;\n\t\tconst labelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, labelID, value, fromXPos, fromYPos);\n\t\tconst toXPos = toIndex * ARRAY_ELEM_WIDTH + ARRAY_START_X + toOffset;\n\t\tconst toYPos = ARRAY_START_Y + toRow * ARRAY_LINE_SPACING;\n\t\tthis.cmd(act.move, labelID, toXPos, toYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, cellID, value);\n\t\tthis.cmd(act.delete, labelID);\n\t\tif (pointerID !== -1) {\n\t\t\tthis.cmd(act.setBackgroundColor, cellID, '#2ECC71');\n\t\t\tthis.cmd(act.setForegroundColor, pointerID, '#0000FF');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tmovePointer(index, row, offset, pointerID) {\n\t\tconst xPos = index * ARRAY_ELEM_WIDTH + ARRAY_START_X + offset;\n\t\tconst yPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\n\t\tthis.cmd(act.move, pointerID, xPos, yPos);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst INFO_LABEL_X = 75;\nconst INFO_LABEL_Y = 20;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 70;\n\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst BUCKETS_START_X = 100;\nconst BUCKETS_START_Y = 140;\n\nconst BUCKET_ELEM_WIDTH = 50;\nconst BUCKET_ELEM_HEIGHT = 20;\nconst BUCKET_ELEM_SPACING = 15;\n\nconst CODE_START_X = 650;\nconst CODE_START_Y = 140;\n\nexport default class LSDRadix extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements < 0',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.arrayDisplay = [];\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\t\tthis.bucketsDisplay = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.infoLabelID = this.nextIndex++;\n\n\t\tthis.code = [\n\t\t\t['procedure LSDRadixSort(array):'],\n\t\t\t['     buckets <- list of 10 lists'],\n\t\t\t['     iterations <- length of longest number'],\n\t\t\t['     length <- length of array'],\n\t\t\t['     for i <- 1, iterations do'],\n\t\t\t['          for j <- 0, length - 1 do'],\n\t\t\t['               bucket <- ith digit of array[j]'],\n\t\t\t['               add array[j] to buckets[bucket]'],\n\t\t\t['          end for'],\n\t\t\t['          index <- 0'],\n\t\t\t['          for bucket <- 0, 9 do'],\n\t\t\t[\"               while buckets[bucket] isn't empty\"],\n\t\t\t['                    array[index] <- remove first from buckets[bucket]'],\n\t\t\t['                    index <- index + 1'],\n\t\t\t['               end while'],\n\t\t\t['          end for'],\n\t\t\t['     end for'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.arrayDisplay = [];\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\t\tthis.bucketsDisplay = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tfor (let i = 0; i < this.bucketsID.length; i++) {\n\t\t\tfor (let j = 0; j < this.bucketsID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.bucketsID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.arrayDisplay = [];\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\t\tthis.bucketsDisplay = [];\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.highlight(0, 0);\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\t// Create data array\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet arrayDisplay = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tarrayDisplay += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.arrayDisplay[i] = arrayDisplay;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tarrayDisplay,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\t\tthis.highlight(1, 0);\n\n\t\t// Create buckets\n\t\tfor (let i = 0; i < 10; i++) {\n\t\t\tthis.bucketsData[i] = [];\n\t\t\tthis.bucketsID[i] = [];\n\t\t\tthis.bucketsDisplay[i] = [];\n\t\t\tthis.bucketsID[i].push(this.nextIndex++);\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + BUCKETS_START_X;\n\t\t\tconst ypos = BUCKETS_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.bucketsID[i][0],\n\t\t\t\ti,\n\t\t\t\tBUCKET_ELEM_WIDTH,\n\t\t\t\tBUCKET_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.bucketsID[i], '#D3D3D3');\n\t\t}\n\n\t\t// Find number of digits\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.infoLabelID,\n\t\t\t'Searching for number with greatest magnitude',\n\t\t\tINFO_LABEL_X,\n\t\t\tINFO_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#FF0000',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\t\tthis.highlight(2, 0);\n\t\tlet greatest = 0;\n\t\tfor (let i = 1; i < this.arrayData.length; i++) {\n\t\t\tthis.movePointers(greatest, i);\n\t\t\tif (this.arrayData[i] > this.arrayData[greatest]) {\n\t\t\t\tgreatest = i;\n\t\t\t\tthis.movePointers(greatest, i);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[greatest], '#FFFF00');\n\n\t\tlet digits = Math.floor(Math.log10(this.arrayData[greatest])) + 1;\n\t\tdigits = digits || 1; // If greatest is 0, above returns NaN, so set to 1 if that happens\n\n\t\tconst longData = this.arrayData[greatest];\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\tlongData + ' has greatest magnitude, number of digits is ' + digits,\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[greatest], '#FFFFFF');\n\t\tthis.highlight(4, 0);\n\n\t\t// Run algorithm\n\t\tfor (let i = 0; i < digits; i++) {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Getting digits at position ' + (i + 1));\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.iPointerID,\n\t\t\t\t'#0000FF',\n\t\t\t\tARRAY_START_X,\n\t\t\t\tARRAY_START_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tfor (let j = 0; j < this.arrayData.length; j++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.iPointerID,\n\t\t\t\t\tARRAY_START_X + j * ARRAY_ELEM_WIDTH,\n\t\t\t\t\tARRAY_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\tthis.highlight(6, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\tconst id = this.nextIndex++;\n\t\t\t\tconst data = this.arrayData[j];\n\t\t\t\tconst display = this.arrayDisplay[j];\n\t\t\t\tconst digit = this.nthDigit(data, i);\n\t\t\t\tthis.bucketsID[digit].push(id);\n\t\t\t\tthis.bucketsData[digit].push(data);\n\t\t\t\tthis.bucketsDisplay[digit].push(display);\n\t\t\t\tconst len = this.bucketsData[digit].length;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tid,\n\t\t\t\t\tdisplay,\n\t\t\t\t\tBUCKET_ELEM_WIDTH,\n\t\t\t\t\tBUCKET_ELEM_HEIGHT,\n\t\t\t\t\tBUCKETS_START_X + digit * BUCKET_ELEM_WIDTH,\n\t\t\t\t\tBUCKETS_START_Y + len * BUCKET_ELEM_HEIGHT + len * BUCKET_ELEM_SPACING,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.bucketsID[digit][this.bucketsID[digit].length - 2],\n\t\t\t\t\tid,\n\t\t\t\t\t0,\n\t\t\t\t\t0,\n\t\t\t\t\t1,\n\t\t\t\t\t'',\n\t\t\t\t\t2,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t}\n\t\t\tthis.cmd(act.delete, this.iPointerID);\n\t\t\tthis.highlight(9, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(9, 0);\n\t\t\tthis.highlight(10, 0);\n\t\t\tlet index = 0;\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let j = 0; j < 10; j++) {\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tconst idBucket = this.bucketsID[j];\n\t\t\t\tconst dataBucket = this.bucketsData[j];\n\t\t\t\tconst displayBucket = this.bucketsDisplay[j];\n\t\t\t\tthis.highlight(11, 0);\n\t\t\t\twhile (dataBucket.length) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\t\tthis.highlight(12, 0);\n\t\t\t\t\tconst labelID = this.nextIndex++;\n\t\t\t\t\tconst nodeID = idBucket.splice(1, 1)[0];\n\t\t\t\t\tconst data = dataBucket.shift();\n\t\t\t\t\tconst display = displayBucket.shift();\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tlabelID,\n\t\t\t\t\t\tdisplay,\n\t\t\t\t\t\tBUCKETS_START_X + j * BUCKET_ELEM_WIDTH,\n\t\t\t\t\t\tBUCKETS_START_Y + BUCKET_ELEM_HEIGHT + BUCKET_ELEM_SPACING,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tlabelID,\n\t\t\t\t\t\tARRAY_START_X + index * ARRAY_ELEM_WIDTH,\n\t\t\t\t\t\tARRAY_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setText, this.arrayID[index], display);\n\t\t\t\t\tthis.cmd(act.delete, labelID);\n\t\t\t\t\tthis.cmd(act.delete, nodeID);\n\t\t\t\t\tthis.unhighlight(12, 0);\n\t\t\t\t\tthis.highlight(13, 0);\n\t\t\t\t\tif (dataBucket.length) {\n\t\t\t\t\t\tthis.cmd(act.connect, idBucket[0], idBucket[1]);\n\t\t\t\t\t\tfor (let k = 1; k < idBucket.length; k++) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\tidBucket[k],\n\t\t\t\t\t\t\t\tBUCKETS_START_X + j * BUCKET_ELEM_WIDTH,\n\t\t\t\t\t\t\t\tBUCKETS_START_Y + k * BUCKET_ELEM_HEIGHT + k * BUCKET_ELEM_SPACING,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.arrayData[index] = data;\n\t\t\t\t\tthis.arrayDisplay[index] = display;\n\t\t\t\t\tindex++;\n\t\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\t}\n\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, this.infoLabelID);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t}\n\n\tnthDigit(data, digit) {\n\t\tdata = Math.floor(data / Math.pow(10, digit));\n\t\tdata %= 10;\n\t\treturn data;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\nconst COMP_COUNT_X = 575;\nconst COMP_COUNT_Y = 30;\n\nconst CODE_Y = 120;\n\nexport default class BruteForce extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.codeID = [];\n\n\t\tthis.code = [\n\t\t\t['procedure BruteForce(text, pattern)'],\n\t\t\t['     n <- text.length, m <- pattern.length'],\n\t\t\t['     for i <- 0, n - m'],\n\t\t\t['          j <- 0'],\n\t\t\t['          while j < m and pattern[j] = text[i + j]'],\n\t\t\t['               j <- j + 1'],\n\t\t\t['          if j = m'],\n\t\t\t['               match found at i'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.createLabel, this.comparisonCountID, '', COMP_COUNT_X, COMP_COUNT_Y, 0);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.codeID = [];\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\tconst maxRows = text.length - pattern.length + 1;\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tconst labelsX = ARRAY_START_X + text.length * this.cellSize + 10;\n\t\tthis.cmd(act.move, this.comparisonCountID, labelsX, COMP_COUNT_Y);\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tlet xpos, ypos;\n\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\typos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, labelsX, CODE_Y);\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\n\t\tlet i = 0;\n\t\tlet j = 0;\n\t\tlet row = 0;\n\t\tthis.highlight(2, 0);\n\t\tthis.cmd(act.step);\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\tj++;\n\t\t\t\tthis.highlight(5, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tif (j < pattern.length) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.highlight(6, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tif (j !== pattern.length) {\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#E74C3C');\n\t\t\t} else {\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t}\n\t\t\ti++;\n\t\t\tj = 0;\n\t\t\trow++;\n\t\t\tif (i <= text.length - pattern.length) {\n\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\t\tthis.unhighlight(2, 0);\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.codeID = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, '');\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\nconst FAILURE_TABLE_START_Y = 100;\n\nconst COMP_COUNT_X = 575;\nconst COMP_COUNT_Y = 30;\n\nconst CODE_Y = 195;\n\nexport default class KMP extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Build Failure Table button\n\t\tthis.bftButton = addControlToAlgorithmBar('Button', 'Build Failure Table');\n\t\tthis.bftButton.onclick = this.buildFailureTableCallback.bind(this);\n\t\tthis.controls.push(this.bftButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.failureTableLabelID = this.nextIndex++;\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\tthis.codeID = [];\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.createLabel, this.comparisonCountID, '', COMP_COUNT_X, COMP_COUNT_Y, 0);\n\n\t\tthis.failureTableCode = [\n\t\t\t['procedure KMPFailureTable(pattern):'],\n\t\t\t['     m <- length of pattern'],\n\t\t\t['     failureTable <- array of length m'],\n\t\t\t['     i <- 0, j <- 1'],\n\t\t\t['     failureTable[0] <- 0'],\n\t\t\t['     while j < m'],\n\t\t\t['          if pattern[i] = pattern[j]'],\n\t\t\t['               failureTable[j] <- i + 1'],\n\t\t\t['               i < i + 1, j <- j + 1'],\n\t\t\t['          else'],\n\t\t\t['               if i = 0'],\n\t\t\t['                    failureTable[j] <- 0'],\n\t\t\t['                    j <- j + 1'],\n\t\t\t['               else'],\n\t\t\t['                    i <- failureTable[i - 1]'],\n\t\t\t['     return failureTable'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.KMPCode = [\n\t\t\t['procedure KMP(text, pattern):'],\n\t\t\t['     initialize failureTable'],\n\t\t\t['     m <- length of pattern, n <- length of text'],\n\t\t\t['     i <- 0, j <- 0'],\n\t\t\t['     while i <= n - m'],\n\t\t\t['          while j < m and text[i + j] = pattern[j]'],\n\t\t\t['               j -> j + 1'],\n\t\t\t['          if j = 0'],\n\t\t\t['               i <- i + 1'],\n\t\t\t['          else'],\n\t\t\t['               if j = m'],\n\t\t\t['                    match found at i'],\n\t\t\t['               shift <- failureTable[j - 1]'],\n\t\t\t['               i <- i + j - shift'],\n\t\t\t['               j <- shift'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.failureTableLabelID = this.nextIndex++;\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\tthis.codeID = [];\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tbuildFailureTableCallback() {\n\t\tif (this.patternField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.onlyBuildFailureTable.bind(this), 0, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\tconst maxRows = this.getMaxRows(text, pattern);\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tlet xpos, ypos;\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\typos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst failureTable = this.buildFailureTable(text.length, pattern);\n\t\tthis.removeCode(this.codeID);\n\t\tconst tableStartX = ARRAY_START_X + text.length * this.cellSize + 110;\n\n\t\tthis.codeID = this.addCodeToCanvasBase(\n\t\t\tthis.KMPCode,\n\t\t\tARRAY_START_X + text.length * this.cellSize + 10,\n\t\t\tCODE_Y,\n\t\t);\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tconst fjPointerID = this.nextIndex++;\n\t\tconst f0PointerID = this.nextIndex++;\n\t\tconst f1PointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tfjPointerID,\n\t\t\t'#FF0000',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tf0PointerID,\n\t\t\t'#FF0000',\n\t\t\ttableStartX,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tf1PointerID,\n\t\t\t'#FF0000',\n\t\t\ttableStartX,\n\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.setAlpha, fjPointerID, 0);\n\t\tthis.cmd(act.setAlpha, f0PointerID, 0);\n\t\tthis.cmd(act.setAlpha, f1PointerID, 0);\n\n\t\tlet i = 0;\n\t\tlet j = 0;\n\t\tlet row = 0;\n\t\tthis.highlight(4, 0);\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t\tif (k - i < j) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][k], '#FFFF4D');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.cmd(act.setAlpha, fjPointerID, 0);\n\t\t\tthis.cmd(act.setAlpha, f0PointerID, 0);\n\t\t\tthis.cmd(act.setAlpha, f1PointerID, 0);\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\tj++;\n\t\t\t\tthis.highlight(6, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tif (j < pattern.length) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.highlight(7, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (j === 0) {\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.highlight(8, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i], '#E74C3C');\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.highlight(9, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(9, 0);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setBackgroundColor,\n\t\t\t\t\t\tthis.comparisonMatrixID[row][i + j],\n\t\t\t\t\t\t'#E74C3C',\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlight(11, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\t}\n\t\t\t\tthis.highlight(12, 0);\n\t\t\t\tconst nextAlignment = failureTable[j - 1];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setPosition,\n\t\t\t\t\tfjPointerID,\n\t\t\t\t\t(i + j - 1) * this.cellSize + ARRAY_START_X,\n\t\t\t\t\t(row + 1) * this.cellSize + ARRAY_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setPosition,\n\t\t\t\t\tf0PointerID,\n\t\t\t\t\ttableStartX + (j - 1) * this.cellSize,\n\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setPosition,\n\t\t\t\t\tf1PointerID,\n\t\t\t\t\ttableStartX + (j - 1) * this.cellSize,\n\t\t\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setAlpha, fjPointerID, 1);\n\t\t\t\tthis.cmd(act.setAlpha, f0PointerID, 1);\n\t\t\t\tthis.cmd(act.setAlpha, f1PointerID, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(12, 0);\n\t\t\t\tthis.highlight(13, 0);\n\t\t\t\tthis.highlight(14, 0);\n\t\t\t\ti += j - nextAlignment;\n\t\t\t\tj = nextAlignment;\n\t\t\t}\n\t\t\trow++;\n\t\t\tif (i <= text.length - pattern.length) {\n\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(13, 0);\n\t\t\tthis.unhighlight(14, 0);\n\t\t}\n\t\tthis.unhighlight(4, 0);\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\tthis.cmd(act.delete, fjPointerID);\n\t\tthis.cmd(act.delete, f0PointerID);\n\t\tthis.cmd(act.delete, f1PointerID);\n\t\treturn this.commands;\n\t}\n\n\tgetMaxRows(text, pattern) {\n\t\tconst failureTable = [];\n\t\tfailureTable[0] = 0;\n\t\tlet i = 0;\n\t\tlet j = 1;\n\t\twhile (j < pattern.length) {\n\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\n\t\t\t\ti++;\n\t\t\t\tfailureTable[j] = i;\n\t\t\t\tj++;\n\t\t\t} else {\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\tj++;\n\t\t\t\t} else {\n\t\t\t\t\ti = failureTable[i - 1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ti = 0;\n\t\tj = 0;\n\t\tlet maxRows = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tif (j === 0) {\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tconst nextAlignment = failureTable[j - 1];\n\t\t\t\ti += j - nextAlignment;\n\t\t\t\tj = nextAlignment;\n\t\t\t}\n\t\t\tmaxRows++;\n\t\t}\n\t\treturn maxRows;\n\t}\n\n\tonlyBuildFailureTable(textLength, pattern) {\n\t\tthis.commands = [];\n\t\tthis.cellSize = 30;\n\t\tthis.buildFailureTable(textLength, pattern);\n\t\treturn this.commands;\n\t}\n\n\tbuildFailureTable(textLength, pattern) {\n\t\t// Display label\n\t\tconst labelX = ARRAY_START_X + textLength * this.cellSize + 10;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.failureTableLabelID,\n\t\t\t'Failure table:',\n\t\t\tlabelX,\n\t\t\tFAILURE_TABLE_START_Y + 10,\n\t\t\t0,\n\t\t);\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.failureTableCode, labelX, CODE_Y);\n\n\t\tthis.cmd(act.move, this.comparisonCountID, labelX, COMP_COUNT_Y);\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\n\t\t// Display empty failure table\n\t\tconst tableStartX = ARRAY_START_X + textLength * this.cellSize + 110;\n\t\tthis.failureTableCharacterID = new Array(pattern.length);\n\t\tthis.failureTableValueID = new Array(pattern.length);\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tconst xpos = tableStartX + i * this.cellSize;\n\t\t\tthis.failureTableCharacterID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableCharacterID[i],\n\t\t\t\tpattern.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.failureTableCharacterID[i], '#D3D3D3');\n\t\t\tthis.failureTableValueID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableValueID[i],\n\t\t\t\t'',\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Display pointers and set first value to 0\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\ttableStartX,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#FF0000',\n\t\t\ttableStartX + this.cellSize,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.setText, this.failureTableValueID[0], 0);\n\t\tthis.highlight(3, 0);\n\t\tthis.highlight(4, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(3, 0);\n\t\tthis.unhighlight(4, 0);\n\n\t\tconst failureTable = [];\n\t\tfailureTable[0] = 0;\n\t\tlet i = 0;\n\t\tlet j = 1;\n\t\tthis.highlight(5, 0);\n\t\twhile (j < pattern.length) {\n\t\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + ++this.compCount);\n\t\t\tthis.highlight(6, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\tthis.highlight(8, 0);\n\t\t\t\ti++;\n\t\t\t\tfailureTable[j] = i;\n\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\tj++;\n\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t} else {\n\t\t\t\tthis.highlight(9, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(9, 0);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tthis.highlight(11, 0);\n\t\t\t\t\tthis.highlight(12, 0);\n\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\t\tj++;\n\t\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\t\tthis.unhighlight(12, 0);\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlight(13, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\t\tthis.highlight(14, 0);\n\t\t\t\t\ti = failureTable[i - 1];\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(14, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.unhighlight(5, 0);\n\t\tthis.highlight(15, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(15, 0);\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\n\t\t//this.removeCode(this.codeID);\n\t\t//this.codeID = [];\n\n\t\treturn failureTable;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\t\tif (this.failureTableValueID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.failureTableLabelID);\n\t\t}\n\t\tfor (let i = 0; i < this.failureTableCharacterID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.failureTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.failureTableValueID[i]);\n\t\t}\n\n\t\tthis.removeCode(this.codeID);\n\t\tthis.codeID = [];\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, '');\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\n// const LOWER_A_CHAR_CODE = 97;\n\nconst BASE_LABEL_Y = 45;\nconst CHARACTER_VALUES_LABEL_Y = 60;\nconst TEXT_HASH_LABEL_START_Y = 100;\nconst PATTERN_HASH_LABEL_START_Y = 115;\n\nconst COMP_COUNT_X = 575;\nconst COMP_COUNT_Y = 30;\n\nconst CODE_Y = 180;\n\nexport default class RabinKarp extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t//Base value text field\n\t\tthis.baseField = addControlToAlgorithmBar('Base', '');\n\t\tthis.baseField.onkeydown = this.returnSubmit(\n\t\t\tthis.baseField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.baseField);\n\n\t\t// Base button\n\t\tthis.baseButton = addControlToAlgorithmBar('Button', 'Change Base');\n\t\tthis.baseButton.onclick = this.baseCallback.bind(this);\n\t\tthis.controls.push(this.baseButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.baseLabelID = this.nextIndex++;\n\t\tthis.characterValuesLabelID = this.nextIndex++;\n\t\tthis.textHashLabelID = this.nextIndex++;\n\t\tthis.textHashCalculationID = this.nextIndex++;\n\t\tthis.patternHashLabelID = this.nextIndex++;\n\t\tthis.patternHashCalculationID = this.nextIndex++;\n\n\t\tthis.baseValue = 1;\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.createLabel, this.comparisonCountID, '', COMP_COUNT_X, COMP_COUNT_Y, 0);\n\n\t\tthis.code = [\n\t\t\t['procedure RabinKarp(text, pattern)'],\n\t\t\t['     m <- length of pattern, n <- length of text'],\n\t\t\t['     patternHash ← rolling hash of pattern'],\n\t\t\t['     textHash ← rolling hash of first m characters of text'],\n\t\t\t['     i <- 0'],\n\t\t\t['     while i <= n - m'],\n\t\t\t['          if patternHash = textHash'],\n\t\t\t['               j <- 0'],\n\t\t\t['               while j < m and text[i + j] = pattern[j]'],\n\t\t\t['                    j <- j + 1'],\n\t\t\t['               if j = m'],\n\t\t\t['                    match found at i'],\n\t\t\t['          i <- i + 1'],\n\t\t\t['          if i <= n - m'],\n\t\t\t['               textHash <- new hash of text, from i to i + m'],\n\t\t\t['end procedure'],\n\t\t];\n\t\tthis.codeID = [];\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.baseLabelID = this.nextIndex++;\n\t\tthis.characterValuesLabelID = this.nextIndex++;\n\t\tthis.textHashLabelID = this.nextIndex++;\n\t\tthis.textHashCalculationID = this.nextIndex++;\n\t\tthis.patternHashLabelID = this.nextIndex++;\n\t\tthis.patternHashCalculationID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.codeID = [];\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tbaseCallback() {\n\t\tconst val = parseInt(this.baseField.value);\n\t\tif (this.baseField.value !== '' && val !== 0) {\n\t\t\tthis.baseField.value = '';\n\t\t\tthis.baseValue = val;\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\t// Filter non-letters from string and make lower case\n\t\ttext = text.replace(/[^a-zA-Z]/g, '').toLowerCase();\n\t\tpattern = pattern.replace(/[^a-zA-Z]/g, '').toLowerCase();\n\n\t\tconst maxRows = text.length - pattern.length + 1;\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tlet xpos, ypos;\n\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\typos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst labelsX = ARRAY_START_X + text.length * this.cellSize + 10;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.baseLabelID,\n\t\t\t`Base constant = ${this.baseValue}`,\n\t\t\tlabelsX,\n\t\t\tBASE_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.characterValuesLabelID,\n\t\t\t'Character values: a = 0, b = 1, ..., z = 25',\n\t\t\tlabelsX,\n\t\t\tCHARACTER_VALUES_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.textHashLabelID,\n\t\t\t'Text hash:',\n\t\t\tlabelsX,\n\t\t\tTEXT_HASH_LABEL_START_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.patternHashLabelID,\n\t\t\t'Pattern hash:',\n\t\t\tlabelsX,\n\t\t\tPATTERN_HASH_LABEL_START_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.move, this.comparisonCountID, labelsX, COMP_COUNT_Y);\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, labelsX, CODE_Y);\n\n\t\tlet textCalculation = '';\n\t\tlet textHash = 0;\n\t\tlet patternCalculation = '';\n\t\tlet patternHash = 0;\n\t\tconst base = Math.pow(this.baseValue, pattern.length - 1);\n\t\tlet runningBase = base;\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\ttextHash += (text.charCodeAt(i) - 97) * runningBase;\n\t\t\ttextCalculation += `(${text.charAt(i)} * ${runningBase}) + `;\n\t\t\tpatternHash += (pattern.charCodeAt(i) - 97) * runningBase;\n\t\t\tpatternCalculation += `(${pattern.charAt(i)} * ${runningBase}) + `;\n\t\t\trunningBase /= this.baseValue;\n\t\t}\n\t\ttextCalculation =\n\t\t\ttextCalculation.substring(0, textCalculation.length - 2) + ' = ' + textHash;\n\t\tpatternCalculation =\n\t\t\tpatternCalculation.substring(0, patternCalculation.length - 2) + ' = ' + patternHash;\n\t\tconst calculationsX = ARRAY_START_X + text.length * this.cellSize + 100;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.textHashCalculationID,\n\t\t\ttextCalculation,\n\t\t\tcalculationsX,\n\t\t\tTEXT_HASH_LABEL_START_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.patternHashCalculationID,\n\t\t\tpatternCalculation,\n\t\t\tcalculationsX,\n\t\t\tPATTERN_HASH_LABEL_START_Y,\n\t\t\t0,\n\t\t);\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\n\t\tthis.highlight(2, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.highlight(3, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(3, 0);\n\n\t\tthis.highlight(5, 0);\n\t\tlet row = 0;\n\t\tfor (let i = 0; i <= text.length - pattern.length; i++) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.highlight(6, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (patternHash === textHash) {\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.createHighlightCircle, iPointerID, '#0000FF', xpos, ARRAY_START_Y);\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.createHighlightCircle, jPointerID, '#0000FF', xpos, ypos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.highlight(8, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tlet j = 0;\n\t\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setBackgroundColor,\n\t\t\t\t\t\tthis.comparisonMatrixID[row][i + j],\n\t\t\t\t\t\t'#2ECC71',\n\t\t\t\t\t);\n\t\t\t\t\tj++;\n\t\t\t\t\tthis.highlight(9, 0);\n\t\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(9, 0);\n\t\t\t\t}\n\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setBackgroundColor,\n\t\t\t\t\t\tthis.comparisonMatrixID[row][i + j],\n\t\t\t\t\t\t'#E74C3C',\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlight(11, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, iPointerID);\n\t\t\t\tthis.cmd(act.delete, jPointerID);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t} else {\n\t\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][k], '#FFFF4D');\n\t\t\t\t}\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.highlight(12, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(12, 0);\n\t\t\tthis.highlight(13, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(13, 0);\n\t\t\tif (i < text.length - pattern.length) {\n\t\t\t\tthis.highlight(14, 0);\n\t\t\t\ttextHash =\n\t\t\t\t\tthis.baseValue * (textHash - base * (text.charCodeAt(i) - 97)) +\n\t\t\t\t\t(text.charCodeAt(i + pattern.length) - 97);\n\t\t\t\ttextCalculation = '';\n\t\t\t\trunningBase = base;\n\t\t\t\tfor (let k = 0; k < pattern.length; k++) {\n\t\t\t\t\ttextCalculation += `(${text.charAt(k + i + 1)} * ${runningBase}) + `; //text.charAt(k + i + 1) + ' + ';\n\t\t\t\t\trunningBase /= this.baseValue;\n\t\t\t\t}\n\t\t\t\ttextCalculation =\n\t\t\t\t\ttextCalculation.substring(0, textCalculation.length - 2) + ' = ' + textHash;\n\t\t\t\tthis.cmd(act.setText, this.textHashCalculationID, textCalculation);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(14, 0);\n\t\t\t}\n\t\t\trow++;\n\t\t}\n\t\tthis.unhighlight(5, 0);\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tif (this.textRowID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.baseLabelID);\n\t\t\tthis.cmd(act.delete, this.characterValuesLabelID);\n\t\t\tthis.cmd(act.delete, this.textHashLabelID);\n\t\t\tthis.cmd(act.delete, this.textHashCalculationID);\n\t\t\tthis.cmd(act.delete, this.patternHashLabelID);\n\t\t\tthis.cmd(act.delete, this.patternHashCalculationID);\n\t\t}\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, '');\n\t\tthis.removeCode(this.codeID);\n\t\tthis.codeID = [];\n\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { BFS_DFS_ADJ_LIST } from './util/GraphValues';\nimport Graph from './Graph.js';\nimport { act } from '../anim/AnimationMain';\n\nconst BFS_QUEUE_HEAD_COLOR = '#0000FF';\nconst VISITED_COLOR = '#99CCFF';\n\nconst INFO_MSG_X = 25;\nconst INFO_MSG_Y = 15;\n\nconst LIST_START_X = 30;\nconst LIST_START_Y = 65;\nconst LIST_SPACING = 20;\n\nconst VISITED_START_X = 30;\nconst VISITED_START_Y = 115;\n\nconst CURRENT_VERTEX_LABEL_X = 25;\nconst CURRENT_VERTEX_LABEL_Y = 140;\nconst CURRENT_VERTEX_X = 115;\nconst CURRENT_VERTEX_Y = 146;\n\nconst QUEUE_START_X = 30;\nconst QUEUE_START_Y = 190;\nconst QUEUE_SPACING = 20;\n\nconst CODE_START_X = 25;\nconst CODE_START_Y = 250;\n\nexport default class BFS extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, BFS_DFS_ADJ_LIST);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start vertex: ');\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse,\n\t\t);\n\t\tthis.startField.size = 2;\n\t\tthis.controls.push(this.startField);\n\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\t\tthis.commands = [];\n\t\tthis.messageID = [];\n\n\t\tthis.visited = [];\n\n\t\tthis.queueID = [];\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.code = [\n\t\t\t['procedure BFS(Vertex S)'],\n\t\t\t['initialize VisitedSet, VS'],\n\t\t\t['initialize Queue, Q'],\n\t\t\t['add S to Q'],\n\t\t\t['while Q is not empty'],\n\t\t\t['     v <- remove from Q'],\n\t\t\t['          for all w adjacent to v'],\n\t\t\t['               if w not in VS'],\n\t\t\t['                    add w to Q'],\n\t\t\t['                    mark w as visited in VS'],\n\t\t];\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited Set:',\n\t\t\tVISITED_START_X - 5,\n\t\t\tVISITED_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'List:',\n\t\t\tLIST_START_X - 5,\n\t\t\tLIST_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current vertex:',\n\t\t\tCURRENT_VERTEX_LABEL_X,\n\t\t\tCURRENT_VERTEX_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Queue:',\n\t\t\tQUEUE_START_X - 5,\n\t\t\tQUEUE_START_Y - 25,\n\t\t\t0,\n\t\t);\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.listID = [];\n\t\tthis.messageID = [];\n\t\tthis.visitedID = [];\n\t}\n\n\tstartCallback() {\n\t\tif (this.startField.value !== '') {\n\t\t\tlet startvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size) {\n\t\t\t\tthis.implementAction(this.doBFS.bind(this), startvalue);\n\t\t\t}\n\t\t}\n\t}\n\n\tdoBFS(startVetex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.queue = [];\n\t\tthis.queueID = [];\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\n\t\tthis.rebuildEdges();\n\n\t\tlet vertex = startVetex;\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Enqueueing ' + this.toStr(vertex) + ' and adding to visited set',\n\t\t);\n\t\tthis.visited[vertex] = true;\n\t\tthis.visitedID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(vertex),\n\t\t\tVISITED_START_X,\n\t\t\tVISITED_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[vertex], VISITED_COLOR);\n\t\tthis.queue.push(vertex);\n\t\tthis.queueID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(vertex),\n\t\t\tQUEUE_START_X,\n\t\t\tQUEUE_START_Y,\n\t\t);\n\t\tthis.highlight(1, 0);\n\t\tthis.highlight(2, 0);\n\t\tthis.highlight(3, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.unhighlight(3, 0);\n\t\tthis.highlight(4, 0);\n\t\twhile (this.queue.length > 0 && this.listID.length < this.size) {\n\t\t\tvertex = this.queue.shift();\n\t\t\tthis.highlight(5, 0);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.infoLabelID,\n\t\t\t\t'Dequeueing ' + this.toStr(vertex) + ' and adding to list',\n\t\t\t);\n\n\t\t\tthis.cmd(act.setTextColor, this.queueID[0], BFS_QUEUE_HEAD_COLOR);\n\t\t\tthis.cmd(act.move, this.queueID[0], CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\t\t\tfor (let i = 1; i < this.queueID.length; i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.queueID[i],\n\t\t\t\t\tQUEUE_START_X + (i - 1) * QUEUE_SPACING,\n\t\t\t\t\tQUEUE_START_Y,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.listID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tthis.toStr(vertex),\n\t\t\t\tLIST_START_X + (this.listID.length - 1) * LIST_SPACING,\n\t\t\t\tLIST_START_Y,\n\t\t\t);\n\n\t\t\tthis.visitVertex(vertex);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.highlight(6, 0);\n\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\tif (this.adj_matrix[vertex][neighbor] > 0) {\n\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 1);\n\t\t\t\t\tthis.highlight(7, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tif (!this.visited[neighbor]) {\n\t\t\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\t\t\tthis.highlight(8, 0);\n\t\t\t\t\t\tthis.highlight(9, 0);\n\t\t\t\t\t\tthis.visited[neighbor] = true;\n\t\t\t\t\t\tthis.visitedID.push(this.nextIndex);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\tthis.toStr(neighbor) +\n\t\t\t\t\t\t\t\t' has not yet been visited, enqueueing and adding to visited set',\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\tthis.toStr(neighbor),\n\t\t\t\t\t\t\tVISITED_START_X + (this.visitedID.length - 1) * LIST_SPACING,\n\t\t\t\t\t\t\tVISITED_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[neighbor], VISITED_COLOR);\n\t\t\t\t\t\tthis.queue.push(neighbor);\n\t\t\t\t\t\tthis.queueID.push(this.nextIndex);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\tthis.toStr(neighbor),\n\t\t\t\t\t\t\tQUEUE_START_X + (this.queue.length - 1) * QUEUE_SPACING,\n\t\t\t\t\t\t\tQUEUE_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\tthis.toStr(neighbor) + ' has already been visited, skipping',\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t\t\tthis.unhighlight(9, 0);\n\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.unhighlight(6, 0);\n\n\t\t\tthis.cmd(act.delete, this.queueID.shift());\n\n\t\t\tthis.leaveVertex();\n\t\t}\n\t\tthis.unhighlight(4, 0);\n\n\t\tif (this.queue.length > 0) {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'All vertices have been visited, done');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Queue is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], '#FFFFFF');\n\t\t\tthis.visited[i] = false;\n\t\t}\n\t\tfor (let i = 0; i < this.listID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.listID[i]);\n\t\t}\n\t\tfor (let i = 0; i < this.visitedID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.visitedID[i]);\n\t\t}\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.messageID = [];\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { BFS_DFS_ADJ_LIST } from './util/GraphValues';\nimport Graph from './Graph.js';\nimport { act } from '../anim/AnimationMain';\n\nconst DFS_STACK_TOP_COLOR = '#0000FF';\nconst VISITED_COLOR = '#99CCFF';\n\nconst INFO_MSG_X = 25;\nconst INFO_MSG_Y = 15;\n\nconst LIST_START_X = 30;\nconst LIST_START_Y = 70;\nconst LIST_SPACING = 20;\n\nconst VISITED_START_X = 30;\nconst VISITED_START_Y = 120;\n\nconst CURRENT_VERTEX_LABEL_X = 25;\nconst CURRENT_VERTEX_LABEL_Y = 145;\nconst CURRENT_VERTEX_X = 115;\nconst CURRENT_VERTEX_Y = 151;\n\nconst STACK_LABEL_X = 25;\nconst STACK_LABEL_Y = 170;\n\nconst STACK_START_X = 40;\nconst SMALL_STACK_START_Y = 335;\nconst LARGE_STACK_START_Y = 465;\nconst SMALL_STACK_SPACING = 20;\nconst LARGE_STACK_SPACING = 16;\n\nconst RECURSION_START_X = 125;\nconst RECURSION_START_Y = 185;\nconst SMALL_RECURSION_SPACING_X = 20;\nconst LARGE_RECURSION_SPACING_X = 10;\nconst SMALL_RECURSION_SPACING_Y = 20;\nconst LARGE_RECURSION_SPACING_Y = 15;\n\nconst CODE_START_X = 250;\nconst CODE_START_Y = 170;\n\nexport default class DFS extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, BFS_DFS_ADJ_LIST);\n\t\tthis.addControls();\n\t\tthis.physicalStack = false;\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start vertex: ');\n\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.startField);\n\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Recursion', 'Stack'],\n\t\t\t'StackType',\n\t\t);\n\n\t\tthis.recursiveStackButton = radioButtonList[0];\n\t\tthis.recursiveStackButton.onclick = this.stackCallback.bind(this, false);\n\t\tthis.recursiveStackButton.checked = true;\n\t\tthis.controls.push(this.recursiveStackButton);\n\n\t\tthis.physicalStackButton = radioButtonList[1];\n\t\tthis.physicalStackButton.onclick = this.stackCallback.bind(this, true);\n\t\tthis.controls.push(this.physicalStackButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\t\tthis.commands = [];\n\t\tthis.messageID = [];\n\n\t\tthis.visited = [];\n\n\t\tthis.stackID = [];\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited Set:',\n\t\t\tVISITED_START_X - 5,\n\t\t\tVISITED_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'List:',\n\t\t\tLIST_START_X - 5,\n\t\t\tLIST_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current vertex:',\n\t\t\tCURRENT_VERTEX_LABEL_X,\n\t\t\tCURRENT_VERTEX_LABEL_Y,\n\t\t\t0,\n\t\t);\n\n\t\tthis.stackLabelID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.stackLabelID,\n\t\t\tthis.physicalStack ? 'Stack:' : 'Recursive stack:   Recursive calls:',\n\t\t\tSTACK_LABEL_X,\n\t\t\tSTACK_LABEL_Y,\n\t\t\t0,\n\t\t);\n\n\t\tthis.recCode = [\n\t\t\t['Procedure DFS(Vertex s, Set VS, List L):'],\n\t\t\t['     add s to VS, L'],\n\t\t\t['     for all v adjacent to s'],\n\t\t\t['          if v not in VS'],\n\t\t\t['               do DFS(v, VS, L)'],\n\t\t];\n\n\t\tthis.itCode = [\n\t\t\t['Procedure DFS(Vertex s, Set VS, List L):'],\n\t\t\t['     Initialize Stack K'],\n\t\t\t['     add s to K, VS'],\n\t\t\t['     while K not empty'],\n\t\t\t['          v <- remove from K'],\n\t\t\t['          add v to L'],\n\t\t\t['          for all w adjacent to v'],\n\t\t\t['               if w not in VS'],\n\t\t\t['                    add w to K, VS'],\n\t\t];\n\n\t\tif (this.physicalStack) {\n\t\t\tthis.codeID = this.addCodeToCanvasBase(this.itCode, CODE_START_X, CODE_START_Y);\n\t\t} else {\n\t\t\tthis.codeID = this.addCodeToCanvasBase(this.recCode, CODE_START_X, CODE_START_Y);\n\t\t}\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\t\tthis.messageID = [];\n\t}\n\n\tstackCallback(physical) {\n\t\tif (this.physicalStack !== physical) {\n\t\t\tthis.physicalStack = physical;\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup(this.adj_matrix);\n\t\t}\n\t}\n\n\tstartCallback() {\n\t\tif (this.startField.value !== '') {\n\t\t\tlet startvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size) {\n\t\t\t\tif (this.physicalStack) {\n\t\t\t\t\tthis.implementAction(this.doDFSStack.bind(this), startvalue);\n\t\t\t\t} else {\n\t\t\t\t\tthis.implementAction(this.doDFSRecursive.bind(this), startvalue);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdoDFSStack(startVertex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.visited = new Array(this.size);\n\t\tthis.stack = [];\n\t\tthis.stackID = [];\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\t\tthis.stackStartY = this.isLarge ? LARGE_STACK_START_Y : SMALL_STACK_START_Y;\n\t\tthis.stackSpacing = this.isLarge ? LARGE_STACK_SPACING : SMALL_STACK_SPACING;\n\n\t\tthis.rebuildEdges();\n\n\t\tlet vertex = startVertex;\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Pushing ' + this.toStr(vertex) + ' and adding to visited set',\n\t\t);\n\t\tthis.highlight(2, 0);\n\t\tlet vertexID = this.nextIndex++;\n\t\tthis.visited[vertex] = true;\n\t\tthis.visitedID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(vertex),\n\t\t\tVISITED_START_X,\n\t\t\tVISITED_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[vertex], VISITED_COLOR);\n\t\tthis.stack.push(vertex);\n\t\tthis.stackID.push(vertexID);\n\t\tthis.cmd(act.createLabel, vertexID, this.toStr(vertex), STACK_START_X, this.stackStartY);\n\t\tthis.cmd(act.step);\n\n\t\tthis.unhighlight(2, 0);\n\t\tthis.highlight(3, 0);\n\t\twhile (this.stack.length > 0 && this.listID.length < this.size) {\n\t\t\tvertex = this.stack.pop();\n\t\t\tvertexID = this.stackID.pop();\n\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.infoLabelID,\n\t\t\t\t'Popping ' + this.toStr(vertex) + ' and adding to list',\n\t\t\t);\n\n\t\t\tthis.cmd(act.setTextColor, vertexID, DFS_STACK_TOP_COLOR);\n\t\t\tthis.cmd(act.move, vertexID, CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\n\t\t\tthis.listID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tthis.toStr(vertex),\n\t\t\t\tLIST_START_X + (this.listID.length - 1) * LIST_SPACING,\n\t\t\t\tLIST_START_Y,\n\t\t\t);\n\n\t\t\tthis.visitVertex(vertex);\n\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.unhighlight(5, 0);\n\n\t\t\tthis.highlight(6, 0);\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\tif (this.adj_matrix[vertex][neighbor] > 0) {\n\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 1);\n\t\t\t\t\tthis.highlight(7, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tif (!this.visited[neighbor]) {\n\t\t\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\t\t\tthis.highlight(8, 0);\n\t\t\t\t\t\tthis.visited[neighbor] = true;\n\t\t\t\t\t\tthis.visitedID.push(this.nextIndex);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\tthis.toStr(neighbor) +\n\t\t\t\t\t\t\t\t' has not yet been visited, pushing and adding to visited set',\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\tthis.toStr(neighbor),\n\t\t\t\t\t\t\tVISITED_START_X + (this.visitedID.length - 1) * LIST_SPACING,\n\t\t\t\t\t\t\tVISITED_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[neighbor], VISITED_COLOR);\n\t\t\t\t\t\tthis.stack.push(neighbor);\n\t\t\t\t\t\tthis.stackID.push(this.nextIndex);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\tthis.toStr(neighbor),\n\t\t\t\t\t\t\tSTACK_START_X,\n\t\t\t\t\t\t\tthis.stackStartY - (this.stack.length - 1) * this.stackSpacing,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\tthis.toStr(neighbor) + ' has already been visited, skipping',\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t\t\t// this.highlightEdge(vertex, neighbor, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.unhighlight(6, 0);\n\n\t\t\tthis.cmd(act.delete, vertexID);\n\n\t\t\tthis.leaveVertex();\n\t\t}\n\t\tthis.unhighlight(3, 0);\n\n\t\tif (this.stack.length > 0) {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'All vertices have been visited, done');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Stack is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tdoDFSRecursive(startVertex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.visited = new Array(this.size);\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\t\tthis.stackStartY = this.isLarge ? LARGE_STACK_START_Y : SMALL_STACK_START_Y;\n\t\tthis.stackSpacing = this.isLarge ? LARGE_STACK_SPACING : SMALL_STACK_SPACING;\n\t\tthis.recursionSpacingX = this.isLarge\n\t\t\t? LARGE_RECURSION_SPACING_X\n\t\t\t: SMALL_RECURSION_SPACING_X;\n\t\tthis.recursionSpacingY = this.isLarge\n\t\t\t? LARGE_RECURSION_SPACING_Y\n\t\t\t: SMALL_RECURSION_SPACING_Y;\n\t\tthis.currentID = this.nextIndex++;\n\n\t\tthis.rebuildEdges();\n\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\n\n\t\tconst vertex = startVertex;\n\n\t\tthis.cmd(act.createLabel, this.currentID, '', CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\t\tthis.cmd(act.setTextColor, this.currentID, DFS_STACK_TOP_COLOR);\n\n\t\tthis.cmd(act.setText, this.infoLabelID, 'About to recurse to ' + this.toStr(startVertex));\n\t\tthis.cmd(act.step);\n\n\t\tthis.visitVertex(vertex);\n\n\t\tthis.dfsVisit(vertex, RECURSION_START_X);\n\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Returned from ' + this.toStr(vertex) + ', done');\n\t\tthis.cmd(act.delete, this.currentID);\n\t\tthis.leaveVertex();\n\n\t\treturn this.commands;\n\t}\n\n\tdfsVisit(currVertex, messageX) {\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Visiting ' + this.toStr(currVertex) + ' and adding to list',\n\t\t);\n\t\tthis.cmd(act.setText, this.currentID, this.toStr(currVertex));\n\n\t\tthis.stackID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(currVertex),\n\t\t\tSTACK_START_X,\n\t\t\tthis.stackStartY - (this.stackID.length - 1) * this.stackSpacing,\n\t\t);\n\n\t\tconst nextMessage = this.nextIndex++;\n\t\tthis.messageID.push(nextMessage);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tnextMessage,\n\t\t\t'DFS(' + this.toStr(currVertex) + ')',\n\t\t\tmessageX,\n\t\t\tRECURSION_START_Y + (this.messageID.length - 1) * this.recursionSpacingY,\n\t\t\t0,\n\t\t);\n\n\t\tthis.listID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(currVertex),\n\t\t\tLIST_START_X + (this.listID.length - 1) * LIST_SPACING,\n\t\t\tLIST_START_Y,\n\t\t);\n\n\t\tthis.visited[currVertex] = true;\n\t\tthis.visitedID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(currVertex),\n\t\t\tVISITED_START_X + (this.visitedID.length - 1) * LIST_SPACING,\n\t\t\tVISITED_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[currVertex], VISITED_COLOR);\n\t\tthis.highlight(1, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\n\t\tthis.highlight(2, 0);\n\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\tif (this.adj_matrix[currVertex][neighbor] > 0) {\n\t\t\t\tthis.highlight(3, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (this.visited[neighbor]) {\n\t\t\t\t\tthis.unhighlight(3, 0);\n\t\t\t\t\t// this.highlightEdge(currVertex, neighbor, 1, 'blue');\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t'Vertex ' + this.toStr(neighbor) + ' already visited, skipping',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t// this.highlightEdge(currVertex, neighbor, 0);\n\t\t\t\t} else {\n\t\t\t\t\tthis.unhighlight(3, 0);\n\t\t\t\t\tthis.highlight(4, 0);\n\t\t\t\t\tthis.highlightEdge(currVertex, neighbor, 1, 'red');\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t'About to recurse to ' + this.toStr(neighbor),\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(4, 0);\n\t\t\t\t\tthis.unhighlight(2, 0);\n\n\t\t\t\t\tthis.leaveVertex();\n\t\t\t\t\tthis.visitVertex(neighbor);\n\t\t\t\t\t// this.highlightEdge(currVertex, neighbor, 0);\n\n\t\t\t\t\tthis.dfsVisit(neighbor, messageX + this.recursionSpacingX);\n\t\t\t\t\tthis.highlight(2, 0);\n\n\t\t\t\t\tthis.leaveVertex();\n\t\t\t\t\tthis.visitVertex(currVertex);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t'Returned from ' + this.toStr(neighbor) + ' to ' + this.toStr(currVertex),\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.unhighlight(2, 0);\n\n\t\tthis.cmd(act.delete, this.stackID.pop());\n\t}\n\n\tclear() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], '#FFFFFF');\n\t\t\tthis.visited[i] = false;\n\t\t}\n\t\tfor (let i = 0; i < this.listID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.listID[i]);\n\t\t}\n\t\tthis.listID = [];\n\t\tfor (let i = 0; i < this.visitedID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.visitedID[i]);\n\t\t}\n\t\tthis.visitedID = [];\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.messageID = [];\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { VERTEX_INDEX_COLOR } from './Graph.js';\nimport {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { DIJKSTRAS_ADJ_LIST } from './util/GraphValues';\nimport PriorityQueue from './util/PriorityQueue';\nimport { act } from '../anim/AnimationMain';\n\nconst PQ_DEQUEUED_COLOR = '#0000FF';\nconst VISITED_COLOR = '#99CCFF';\n\nconst INFO_MSG_X = 25;\nconst INFO_MSG_Y = 15;\n\nconst VISITED_START_X = 30;\nconst VISITED_START_Y = 65;\nconst VISITED_SPACING = 20;\n\nconst CURRENT_VERTEX_LABEL_X = 25;\nconst CURRENT_VERTEX_LABEL_Y = 85;\nconst CURRENT_VERTEX_X = 110;\nconst CURRENT_VERTEX_Y = 85;\n\nconst PQ_LABEL_X = 25;\nconst PQ_LABEL_Y = 110;\n\nconst PQ_X = 110;\nconst PQ_Y = 110;\nconst PQ_SPACING = 42;\nconst PQ_LINE_SPACING = 25;\nconst PQ_MAX_PER_LINE = 9;\n\nconst TABLE_ENTRY_WIDTH = 50;\nconst SMALL_TABLE_ENTRY_HEIGHT = 20;\nconst LARGE_TABLE_ENTRY_HEIGHT = 17;\nconst TABLE_START_X = 50;\nconst TABLE_START_Y = 180;\n\nconst CODE_START_X = 1100;\nconst CODE_START_Y = 50;\n\nexport default class Dijkstras extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, DIJKSTRAS_ADJ_LIST, false, false, true);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start vertex: ');\n\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse,\n\t\t);\n\t\tthis.startField.size = 2;\n\t\tthis.controls.push(this.startField);\n\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\n\t\tthis.commands = [];\n\n\t\tthis.vertexID = new Array(this.size);\n\n\t\tthis.distance = new Array(this.size);\n\t\tthis.distanceID = new Array(this.size);\n\n\t\tthis.visited = [];\n\t\tthis.visitedID = [];\n\n\t\tthis.pq = new PriorityQueue();\n\n\t\tthis.code = [\n\t\t\t['initialize VisitedSet, VS'],\n\t\t\t['initialize distanceMap, DM'],\n\t\t\t['initialize PriorityQueue, PQ'],\n\t\t\t['for all v in G, initialize distance of v to INF'],\n\t\t\t['PQ.enqueue((s, 0))'],\n\t\t\t['while PQ is not empty and VS is not full'],\n\t\t\t['    (u, d) <- PQ.dequeue()'],\n\t\t\t['    if u is not visited in VS'],\n\t\t\t['        mark u as visited in VS'],\n\t\t\t['    for all (w, d2) adjacent to u and not visited in VS'],\n\t\t\t['        update DM for d2'],\n\t\t\t['        PQ.enqueue((w, d + d2))'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.tableEntryHeight = this.isLarge ? LARGE_TABLE_ENTRY_HEIGHT : SMALL_TABLE_ENTRY_HEIGHT;\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.vertexID[i] = this.nextIndex++;\n\t\t\tthis.distanceID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.vertexID[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tTABLE_ENTRY_WIDTH,\n\t\t\t\tthis.tableEntryHeight,\n\t\t\t\tTABLE_START_X,\n\t\t\t\tTABLE_START_Y + i * this.tableEntryHeight,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.distanceID[i],\n\t\t\t\t'',\n\t\t\t\tTABLE_ENTRY_WIDTH,\n\t\t\t\tthis.tableEntryHeight,\n\t\t\t\tTABLE_START_X + TABLE_ENTRY_WIDTH,\n\t\t\t\tTABLE_START_Y + i * this.tableEntryHeight,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.vertexID[i], VERTEX_INDEX_COLOR);\n\t\t}\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited Set:',\n\t\t\tVISITED_START_X - 5,\n\t\t\tVISITED_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current vertex:',\n\t\t\tCURRENT_VERTEX_LABEL_X,\n\t\t\tCURRENT_VERTEX_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.createLabel, this.nextIndex++, 'Priority Queue:', PQ_LABEL_X, PQ_LABEL_Y, 0);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Distance Map:',\n\t\t\tTABLE_START_X + 0.5 * TABLE_ENTRY_WIDTH,\n\t\t\tTABLE_START_Y - SMALL_TABLE_ENTRY_HEIGHT,\n\t\t);\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.comparisonMessageID = this.nextIndex++;\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.messageID = [];\n\t\tthis.visitedID = [];\n\t\tthis.pq = new PriorityQueue();\n\t}\n\n\tstartCallback() {\n\t\tlet startvalue;\n\n\t\tif (this.startField.value !== '') {\n\t\t\tstartvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size)\n\t\t\t\tthis.implementAction(this.doDijkstra.bind(this), startvalue);\n\t\t}\n\t}\n\n\tdoDijkstra(startVertex) {\n\t\tthis.commands = [];\n\n\t\tlet current = startVertex;\n\t\tlet currentID = this.nextIndex++;\n\n\t\tthis.clear();\n\n\t\tthis.visitedID = [];\n\n\t\tthis.distance[current] = 0;\n\t\tthis.cmd(act.setText, this.distanceID[current], 0);\n\n\t\tthis.pq = new PriorityQueue();\n\t\tthis.pq.enqueue(current, currentID, 0);\n\t\tthis.cmd(act.createLabel, currentID, '(' + this.toStr(current) + ', 0)', PQ_X, PQ_Y, 0);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Enqueueing ' + this.toStr(current) + ' with distance 0 and updating distance map',\n\t\t);\n\t\tthis.highlight(0, 0);\n\t\tthis.highlight(1, 0);\n\t\tthis.highlight(2, 0);\n\t\tthis.highlight(3, 0);\n\t\tthis.highlight(4, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\t\tthis.unhighlight(1, 0);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.unhighlight(3, 0);\n\t\tthis.unhighlight(4, 0);\n\n\t\twhile (this.visited.includes(false) && this.pq.size() !== 0) {\n\t\t\t//TODO: ADD HIGHLIGHTS HERE\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.highlight(6, 0);\n\t\t\t[current, currentID] = this.pq.dequeue();\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Dequeueing ' + this.toStr(current));\n\t\t\tthis.cmd(act.move, currentID, CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\t\t\tthis.cmd(act.setText, currentID, this.toStr(current));\n\t\t\tthis.cmd(act.setTextColor, currentID, PQ_DEQUEUED_COLOR);\n\t\t\tlet pqIDs = this.pq.getIDs();\n\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tpqIDs[i],\n\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\tPQ_Y + Math.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.visitVertex(current);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tthis.highlight(7, 0);\n\n\t\t\tif (!this.visited[current]) {\n\t\t\t\tthis.highlight(8, 0);\n\t\t\t\tthis.visited[current] = true;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Adding ' + this.toStr(current) + ' to visited set',\n\t\t\t\t);\n\t\t\t\tthis.visitedID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\tthis.toStr(current),\n\t\t\t\t\tVISITED_START_X + (this.visitedID.length - 1) * VISITED_SPACING,\n\t\t\t\t\tVISITED_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[current], VISITED_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t\tthis.unhighlight(7, 0);\n\n\t\t\t\tthis.highlight(9, 0);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Updating neighbors of vertex ' + this.toStr(current),\n\t\t\t\t);\n\n\t\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\t\tif (this.adj_matrix[current][neighbor] >= 0) {\n\t\t\t\t\t\tthis.highlightEdge(current, neighbor, 1);\n\t\t\t\t\t\tif (this.visited[neighbor]) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\tthis.toStr(neighbor) + ' has already been visited, skipping',\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Comparing distances');\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 1);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[neighbor], 1);\n\t\t\t\t\t\t\tconst curDist = this.distance[current];\n\t\t\t\t\t\t\tconst edgDist = this.adj_matrix[current][neighbor];\n\t\t\t\t\t\t\tconst newDist = curDist + edgDist;\n\t\t\t\t\t\t\tconst oldDist = this.distance[neighbor];\n\t\t\t\t\t\t\tconst oldDistStr =\n\t\t\t\t\t\t\t\toldDist >= 0 ? String(this.distance[neighbor]) : 'INF';\n\n\t\t\t\t\t\t\tif (oldDist < 0 || newDist < oldDist) {\n\t\t\t\t\t\t\t\tthis.distance[neighbor] = newDist;\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\n\t\t\t\t\t\t\t\t\t'New distance (' +\n\t\t\t\t\t\t\t\t\t\tcurDist +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tedgDist +\n\t\t\t\t\t\t\t\t\t\t' = ' +\n\t\t\t\t\t\t\t\t\t\tnewDist +\n\t\t\t\t\t\t\t\t\t\t') is less than old distance (' +\n\t\t\t\t\t\t\t\t\t\toldDistStr +\n\t\t\t\t\t\t\t\t\t\t'), updating',\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 2 * TABLE_ENTRY_WIDTH - 15,\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * this.tableEntryHeight - 5,\n\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tthis.highlight(10, 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Updating distance');\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tthis.distanceID[neighbor],\n\t\t\t\t\t\t\t\t\tthis.distance[neighbor],\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[neighbor], 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, this.comparisonMessageID);\n\t\t\t\t\t\t\t\tthis.pq.enqueue(neighbor, this.nextIndex, newDist);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\t\t'Enqueueing ' +\n\t\t\t\t\t\t\t\t\t\tthis.toStr(neighbor) +\n\t\t\t\t\t\t\t\t\t\t' with distance ' +\n\t\t\t\t\t\t\t\t\t\tnewDist,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\t\t\t'(' + this.toStr(neighbor) + ', ' + newDist + ')',\n\t\t\t\t\t\t\t\t\tPQ_X + ((this.pq.size() - 1) % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\t\t\tPQ_Y +\n\t\t\t\t\t\t\t\t\t\tMath.floor((this.pq.size() - 1) / PQ_MAX_PER_LINE) *\n\t\t\t\t\t\t\t\t\t\t\tPQ_LINE_SPACING,\n\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.highlight(11, 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\t\tconst newPqIDs = this.pq.getIDs();\n\t\t\t\t\t\t\t\tif (String(pqIDs) !== String(newPqIDs.slice(0, -1))) {\n\t\t\t\t\t\t\t\t\t// Check if newly enqueued element shifted things\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\t\t\tnewPqIDs[i],\n\t\t\t\t\t\t\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\t\t\t\t\tPQ_Y +\n\t\t\t\t\t\t\t\t\t\t\t\tMath.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpqIDs = newPqIDs;\n\t\t\t\t\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\n\t\t\t\t\t\t\t\t\t'New distance (' +\n\t\t\t\t\t\t\t\t\t\tcurDist +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tedgDist +\n\t\t\t\t\t\t\t\t\t\t' = ' +\n\t\t\t\t\t\t\t\t\t\tnewDist +\n\t\t\t\t\t\t\t\t\t\t') is greater than or equal to old distance (' +\n\t\t\t\t\t\t\t\t\t\toldDistStr +\n\t\t\t\t\t\t\t\t\t\t'), skipping',\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 2 * TABLE_ENTRY_WIDTH - 15,\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * this.tableEntryHeight - 5,\n\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.highlight(5, 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, this.comparisonMessageID);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[neighbor], 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.highlightEdge(current, neighbor, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tthis.unhighlight(9, 0);\n\t\t\t} else {\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\tthis.toStr(current) + ' has already been visited, skipping',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.leaveVertex();\n\t\t\tthis.cmd(act.delete, currentID);\n\t\t\tthis.unhighlight(5, 0);\n\t\t}\n\n\t\tif (this.pq.size() > 0) {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'All vertices have been visited, done');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Priority queue is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], '#FFFFFF');\n\t\t\tthis.cmd(act.setText, this.distanceID[i], 'INF');\n\t\t\tthis.visited[i] = false;\n\t\t\tthis.distance[i] = -1;\n\t\t}\n\t\tfor (let i = 0; i < this.visitedID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.visitedID[i]);\n\t\t}\n\t\tconst pqIDs = this.pq.getIDs();\n\t\tfor (const id of pqIDs) {\n\t\t\tthis.cmd(act.delete, id);\n\t\t}\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.messageID = [];\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport Graph from './Graph.js';\nimport { PRIMS_KRUSKALS_ADJ_LIST } from './util/GraphValues';\nimport PriorityQueue from './util/PriorityQueue';\nimport { act } from '../anim/AnimationMain';\n\nconst PQ_DEQUEUED_COLOR = '#0000FF';\nconst VISITED_COLOR = '#99CCFF';\nconst MST_EDGE_COLOR = '#3399FF';\nconst MST_EDGE_THICKNESS = 4;\n\nconst INFO_MSG_X = 25;\nconst INFO_MSG_Y = 15;\n\nconst VISITED_START_X = 30;\nconst VISITED_START_Y = 65;\nconst VISITED_SPACING = 20;\n\nconst CURRENT_EDGE_LABEL_X = 25;\nconst CURRENT_EDGE_LABEL_Y = 90;\nconst CURRENT_VERTEX_X = 110;\nconst CURRENT_VERTEX_Y = 96;\n\nconst PQ_LABEL_X = 25;\nconst PQ_LABEL_Y = 115;\n\nconst PQ_X = 45;\nconst PQ_Y = 143;\nconst PQ_SPACING = 50;\nconst PQ_LINE_SPACING = 25;\nconst PQ_MAX_PER_LINE = 8;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 200;\n\nexport default class Prims extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, PRIMS_KRUSKALS_ADJ_LIST, false, false, true);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start vertex: ');\n\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse,\n\t\t);\n\t\tthis.startField.size = 2;\n\t\tthis.controls.push(this.startField);\n\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls(false);\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\t\tthis.commands = [];\n\t\tthis.messageID = null;\n\n\t\tthis.visited = [];\n\t\tthis.visitedID = [];\n\t\tthis.pq = new PriorityQueue();\n\n\t\tthis.code = [\n\t\t\t['initialize VisitedSet, VS'],\n\t\t\t['initialize MST EdgeSet, MST'],\n\t\t\t['initialize PriorityQueue, PQ'],\n\t\t\t['mark s as visited in VS'],\n\t\t\t['for each edge(s, v) in G, PQ.enqueue(edge(s, v))'],\n\t\t\t['while PQ is not empty and VS is not full'],\n\t\t\t['    edge(u, w) <- PQ.dequeue()'],\n\t\t\t['    if w is not visited in VS'],\n\t\t\t['        add edge(u, w) to MST'],\n\t\t\t['        mark w as visited in VS'],\n\t\t\t['        for each edge(w, x) such that x is not visited'],\n\t\t\t['            PQ.enqueue(edge(w, x))'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited Set:',\n\t\t\tVISITED_START_X - 5,\n\t\t\tVISITED_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current edge:',\n\t\t\tCURRENT_EDGE_LABEL_X,\n\t\t\tCURRENT_EDGE_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.createLabel, this.nextIndex++, 'Priority Queue:', PQ_LABEL_X, PQ_LABEL_Y, 0);\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.highlightCircleL = this.nextIndex++;\n\t\tthis.highlightCircleAL = this.nextIndex++;\n\t\tthis.highlightCircleAM = this.nextIndex++;\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.messageID = [];\n\t\tthis.visitedID = [];\n\t\tthis.pq = new PriorityQueue();\n\t}\n\n\tstartCallback() {\n\t\tif (this.startField.value !== '') {\n\t\t\tlet startvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size)\n\t\t\t\tthis.implementAction(this.doPrim.bind(this), startvalue);\n\t\t}\n\t}\n\n\tdoPrim(startVertex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.visitedID = [];\n\n\t\tthis.visitVertex(startVertex);\n\n\t\tthis.visited[startVertex] = true;\n\t\tthis.visitedID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(startVertex),\n\t\t\tVISITED_START_X,\n\t\t\tVISITED_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[startVertex], VISITED_COLOR);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Adding ' + this.toStr(startVertex) + ' to visited set',\n\t\t);\n\n\t\tthis.highlight(0, 0);\n\t\tthis.highlight(1, 0);\n\t\tthis.highlight(2, 0);\n\t\tthis.highlight(3, 0);\n\t\t// this.highlight(4, 0);\n\t\tthis.cmd(act.step);\n\t\t// this.unhighlight(4, 0);\n\t\tthis.unhighlight(3, 0);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.unhighlight(1, 0);\n\t\tthis.unhighlight(0, 0);\n\n\t\tthis.highlight(4, 0);\n\t\tthis.pq = new PriorityQueue();\n\t\tlet pqIDs = [];\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Enqueuing edges of ' + this.toStr(startVertex));\n\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\tconst weight = this.adj_matrix[startVertex][neighbor];\n\t\t\tif (weight >= 0) {\n\t\t\t\tthis.highlightEdge(startVertex, neighbor, 1);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\t'(' + this.toStr(startVertex) + this.toStr(neighbor) + ', ' + weight + ')',\n\t\t\t\t\tPQ_X + (this.pq.size() % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\tPQ_Y + Math.floor(this.pq.size() / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t);\n\t\t\t\tthis.pq.enqueue([startVertex, neighbor], this.nextIndex++, weight);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tconst newPqIDs = this.pq.getIDs();\n\t\t\t\tif (String(pqIDs) !== String(newPqIDs.slice(0, -1))) {\n\t\t\t\t\t// Check if newly enqueued element shifted things\n\t\t\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tnewPqIDs[i],\n\t\t\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\tPQ_Y + Math.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tpqIDs = newPqIDs;\n\t\t\t\tthis.highlightEdge(startVertex, neighbor, 0);\n\t\t\t}\n\t\t}\n\t\tthis.unhighlight(4, 0);\n\n\t\tthis.leaveVertex();\n\n\t\tthis.highlight(5, 0);\n\t\twhile (this.visited.includes(false) && this.pq.size() !== 0) {\n\t\t\tthis.highlight(6, 0);\n\t\t\tconst [edge, edgeID] = this.pq.dequeue();\n\t\t\tlet edgeStr = this.toStr(edge[0]) + this.toStr(edge[1]);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.infoLabelID,\n\t\t\t\t'Dequeued ' + edgeStr + ', with destination ' + this.toStr(edge[1]),\n\t\t\t);\n\t\t\tthis.cmd(act.move, edgeID, CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\t\t\tthis.cmd(act.setText, edgeID, this.toStr(edge[0]) + this.toStr(edge[1]));\n\t\t\tthis.cmd(act.setTextColor, edgeID, PQ_DEQUEUED_COLOR);\n\t\t\tpqIDs = this.pq.getIDs();\n\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tpqIDs[i],\n\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\tPQ_Y + Math.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.highlightEdge(edge[0], edge[1], 1);\n\t\t\tthis.visitVertex(edge[1]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tthis.highlight(7, 0);\n\t\t\tif (!this.visited[edge[1]]) {\n\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Adding ' + edgeStr + ' to MST');\n\t\t\t\tthis.highlightEdge(edge[0], edge[1], 0);\n\t\t\t\tthis.setEdgeColor(edge[0], edge[1], MST_EDGE_COLOR);\n\t\t\t\tthis.setEdgeThickness(edge[0], edge[1], MST_EDGE_THICKNESS);\n\n\t\t\t\tthis.highlight(8, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(8, 0);\n\n\t\t\t\tthis.visited[edge[1]] = true;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Adding ' + this.toStr(edge[1]) + ' to visited set',\n\t\t\t\t);\n\t\t\t\tthis.visitedID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\tthis.toStr(edge[1]),\n\t\t\t\t\tVISITED_START_X + (this.visitedID.length - 1) * VISITED_SPACING,\n\t\t\t\t\tVISITED_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[edge[1]], VISITED_COLOR);\n\t\t\t\tthis.highlight(9, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(9, 0);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Enqueuing edges of ' + this.toStr(edge[1]),\n\t\t\t\t);\n\t\t\t\tthis.highlight(11, 0);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\t\tif (this.adj_matrix[edge[1]][neighbor] >= 0) {\n\t\t\t\t\t\tthis.highlightEdge(edge[1], neighbor, 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.circleID[neighbor], 1);\n\t\t\t\t\t\tif (this.visited[neighbor]) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\t'Vertex ' +\n\t\t\t\t\t\t\t\t\tthis.toStr(neighbor) +\n\t\t\t\t\t\t\t\t\t' has already been visited, skipping',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.circleID[neighbor], 0);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\t'Vertex ' + this.toStr(neighbor) + ' has not yet been visited',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.circleID[neighbor], 0);\n\t\t\t\t\t\t\tedgeStr = this.toStr(edge[1]) + this.toStr(neighbor);\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\t'Enqueueing edge ' +\n\t\t\t\t\t\t\t\t\tedgeStr +\n\t\t\t\t\t\t\t\t\t' with weight ' +\n\t\t\t\t\t\t\t\t\tthis.adj_matrix[edge[1]][neighbor],\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\t\t\t\t'(' + edgeStr + ', ' + this.adj_matrix[edge[1]][neighbor] + ')',\n\t\t\t\t\t\t\t\tPQ_X + (this.pq.size() % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\t\tPQ_Y +\n\t\t\t\t\t\t\t\t\tMath.floor(this.pq.size() / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.pq.enqueue(\n\t\t\t\t\t\t\t\t[edge[1], neighbor],\n\t\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\t\tthis.adj_matrix[edge[1]][neighbor],\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\tconst newPqIDs = this.pq.getIDs();\n\t\t\t\t\t\t\tif (String(pqIDs) !== String(newPqIDs.slice(0, -1))) {\n\t\t\t\t\t\t\t\t// Check if newly enqueued element shifted things\n\t\t\t\t\t\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\t\tnewPqIDs[i],\n\t\t\t\t\t\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\t\t\t\tPQ_Y + Math.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpqIDs = newPqIDs;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.highlightEdge(edge[1], neighbor, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t} else {\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.highlightEdge(edge[0], edge[1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\tthis.toStr(edge[1]) + ' has already been visited, skipping',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.leaveVertex();\n\t\t\tthis.cmd(act.delete, edgeID);\n\t\t}\n\t\tthis.unhighlight(5, 0);\n\t\tthis.unhighlight(7, 0);\n\n\t\tif (this.pq.size() > 0) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.infoLabelID,\n\t\t\t\t'MST has correct amount of edges / all vertices have been visited, done',\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Priority queue is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tthis.recolorGraph();\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], '#FFFFFF');\n\t\t\tthis.visited[i] = false;\n\t\t}\n\t\tfor (let i = 0; i < this.visitedID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.visitedID[i]);\n\t\t}\n\t\tconst pqIDs = this.pq.getIDs();\n\t\tfor (const id of pqIDs) {\n\t\t\tthis.cmd(act.delete, id);\n\t\t}\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.messageID = [];\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { EDGE_COLOR, VERTEX_INDEX_COLOR } from './Graph.js';\nimport { KRUSKALS_DS_COLORS, PRIMS_KRUSKALS_ADJ_LIST } from './util/GraphValues';\nimport { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MESSAGE_LABEL_X = 30;\nconst MESSAGE_LABEL_Y = 15;\n\nconst FIND_LABEL_1_X = 30;\nconst FIND_LABEL_2_X = 100;\nconst FIND_LABEL_1_Y = 40;\nconst FIND_LABEL_2_Y = FIND_LABEL_1_Y;\n\nconst CURRENT_LABEL_X = 145;\nconst CURRENT_LABEL_Y = 67;\n\nconst PQ_LABEL_X = 145;\nconst PQ_LABEL_Y = 92;\n\nconst SET_ARRAY_ELEM_WIDTH = 50;\nconst SET_ARRAY_ELEM_HEIGHT = 20;\nconst SET_ARRAY_START_X = 52;\nconst SET_ARRAY_START_Y = 110;\n\nconst EDGE_LIST_ELEM_WIDTH = 40;\nconst EDGE_LIST_ELEM_HEIGHT = 40;\nconst EDGE_LIST_COLUMN_WIDTH = 100;\nconst EDGE_LIST_MAX_PER_COLUMN = 9;\n\nconst EDGE_LIST_START_X = 150;\nconst EDGE_LIST_START_Y = 135;\n\nconst HIGHLIGHT_CIRCLE_COLOR_1 = '#FF9999';\nconst HIGHLIGHT_CIRCLE_COLOR_2 = '#FF0000';\nconst HIGHLIGHT_CIRCLE_COLOR_3 = '#0000FF';\nconst HIGHLIGHT_CIRCLE_RADIUS = 12;\n\nconst MST_EDGE_COLOR = '#3399FF';\nconst MST_EDGE_THICKNESS = 4;\n\nconst CODE_START_X = 1100;\nconst CODE_START_Y = 30;\n\nexport default class Kruskals extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, PRIMS_KRUSKALS_ADJ_LIST, false, false, true);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls(false);\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\t\tthis.messageID = [];\n\t\tthis.commands = [];\n\t\tthis.setID = new Array(this.size);\n\t\tthis.setIndexID = new Array(this.size);\n\t\tthis.setData = new Array(this.size);\n\t\tthis.edgesListLeftID = [];\n\t\tthis.edgesListRightID = [];\n\n\t\tlet i;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.setID[i] = this.nextIndex++;\n\t\t\tthis.setIndexID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.setIndexID[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tSET_ARRAY_ELEM_WIDTH,\n\t\t\t\tSET_ARRAY_ELEM_HEIGHT,\n\t\t\t\tSET_ARRAY_START_X,\n\t\t\t\tSET_ARRAY_START_Y + i * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.setID[i],\n\t\t\t\t'',\n\t\t\t\tSET_ARRAY_ELEM_WIDTH,\n\t\t\t\tSET_ARRAY_ELEM_HEIGHT,\n\t\t\t\tSET_ARRAY_START_X + SET_ARRAY_ELEM_WIDTH,\n\t\t\t\tSET_ARRAY_START_Y + i * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.setIndexID[i], VERTEX_INDEX_COLOR);\n\t\t}\n\n\t\tthis.messageLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.messageLabelID, '', MESSAGE_LABEL_X, MESSAGE_LABEL_Y, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Disjoint Set:',\n\t\t\tSET_ARRAY_START_X + 0.5 * SET_ARRAY_ELEM_WIDTH,\n\t\t\tSET_ARRAY_START_Y - 37,\n\t\t\t1,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Vertex',\n\t\t\tSET_ARRAY_START_X,\n\t\t\tSET_ARRAY_START_Y - 22,\n\t\t\t1,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Set ID',\n\t\t\tSET_ARRAY_START_X + SET_ARRAY_ELEM_WIDTH,\n\t\t\tSET_ARRAY_START_Y - 22,\n\t\t\t1,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current edge:',\n\t\t\tCURRENT_LABEL_X,\n\t\t\tCURRENT_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.createLabel, this.nextIndex++, 'Priority Queue:', PQ_LABEL_X, PQ_LABEL_Y, 0);\n\n\t\tthis.code = [\n\t\t\t['initialize DisjointSet, DS, with all vertices in G'],\n\t\t\t['initialize MST EdgeSet, MST'],\n\t\t\t['initialize PriorityQueue, PQ with all edges in G'],\n\t\t\t['while PQ is not empty and MST has fewer than n-1 edges'],\n\t\t\t['    edge(u, v) <- PQ.dequeue()'],\n\t\t\t['    if u and v are not in the same cluster'],\n\t\t\t['        add edge(u, v) to MST'],\n\t\t\t[`        merge u's cluster with v's cluster`],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.messageID = [];\n\t\tthis.edgesListLeft = [];\n\t\tthis.edgesListRight = [];\n\t\tthis.edgesListLeftID = [];\n\t\tthis.edgesListRightID = [];\n\t}\n\n\tstartCallback() {\n\t\tthis.implementAction(this.doKruskal.bind(this));\n\t}\n\n\tdoKruskal() {\n\t\tthis.commands = [];\n\n\t\tfor (let k = 0; k < this.edgesListLeftID.length; k++) {\n\t\t\tthis.cmd(act.delete, this.edgesListLeftID[k]);\n\t\t\tthis.cmd(act.delete, this.edgesListRightID[k]);\n\t\t}\n\n\t\tthis.edgesListLeftID = [];\n\t\tthis.edgesListRightID = [];\n\t\tthis.edgesListLeft = [];\n\t\tthis.edgesListRight = [];\n\n\t\tlet i;\n\t\tlet j;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.setData[i] = i + 1;\n\t\t\tthis.cmd(act.setText, this.setID[i], i + 1);\n\t\t\t!this.isLarge && this.cmd(act.setBackgroundColor, this.setID[i], KRUSKALS_DS_COLORS[i]);\n\t\t}\n\n\t\tthis.recolorGraph();\n\n\t\tthis.highlight(0, 0);\n\t\tthis.highlight(1, 0);\n\n\t\t// Create edge list\n\t\tthis.cmd(act.setText, this.messageLabelID, 'Enqueueing all edges into Priority Queue');\n\t\tlet top;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tfor (j = i + 1; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tthis.edgesListLeftID.push(this.nextIndex++);\n\t\t\t\t\tthis.edgesListRightID.push(this.nextIndex++);\n\t\t\t\t\ttop = this.edgesListLeftID.length - 1;\n\t\t\t\t\tthis.edgesListLeft.push(i);\n\t\t\t\t\tthis.edgesListRight.push(j);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.edgesListLeftID[top],\n\t\t\t\t\t\tthis.toStr(i) + ' ',\n\t\t\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\t\t\tMath.floor(top / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\t\tEDGE_LIST_START_Y +\n\t\t\t\t\t\t\t(top % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.edgesListRightID[top],\n\t\t\t\t\t\t' ' + this.toStr(j),\n\t\t\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\t\t\tEDGE_LIST_ELEM_WIDTH +\n\t\t\t\t\t\t\tMath.floor(top / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\t\tEDGE_LIST_START_Y +\n\t\t\t\t\t\t\t(top % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\tthis.edgesListLeftID[top],\n\t\t\t\t\t\tthis.edgesListRightID[top],\n\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tthis.adj_matrix[i][j],\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\t\tthis.unhighlight(1, 0);\n\n\t\t// Sort edge list based on edge cost\n\t\tconst edgeCount = this.edgesListLeftID.length;\n\t\tlet tmpLeftID;\n\t\tlet tmpRightID;\n\t\tlet tmpLeft;\n\t\tlet tmpRight;\n\t\tfor (i = 1; i < edgeCount; i++) {\n\t\t\ttmpLeftID = this.edgesListLeftID[i];\n\t\t\ttmpRightID = this.edgesListRightID[i];\n\t\t\ttmpLeft = this.edgesListLeft[i];\n\t\t\ttmpRight = this.edgesListRight[i];\n\t\t\tj = i;\n\t\t\twhile (\n\t\t\t\tj > 0 &&\n\t\t\t\tthis.adj_matrix[this.edgesListLeft[j - 1]][this.edgesListRight[j - 1]] >\n\t\t\t\t\tthis.adj_matrix[tmpLeft][tmpRight]\n\t\t\t) {\n\t\t\t\tthis.edgesListLeft[j] = this.edgesListLeft[j - 1];\n\t\t\t\tthis.edgesListRight[j] = this.edgesListRight[j - 1];\n\t\t\t\tthis.edgesListLeftID[j] = this.edgesListLeftID[j - 1];\n\t\t\t\tthis.edgesListRightID[j] = this.edgesListRightID[j - 1];\n\t\t\t\tj = j - 1;\n\t\t\t}\n\t\t\tthis.edgesListLeft[j] = tmpLeft;\n\t\t\tthis.edgesListRight[j] = tmpRight;\n\t\t\tthis.edgesListLeftID[j] = tmpLeftID;\n\t\t\tthis.edgesListRightID[j] = tmpRightID;\n\t\t}\n\t\tfor (i = 0; i < edgeCount; i++) {\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListLeftID[i],\n\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\tMath.floor(i / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\tEDGE_LIST_START_Y + (i % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListRightID[i],\n\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\tEDGE_LIST_ELEM_WIDTH +\n\t\t\t\t\tMath.floor(i / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\tEDGE_LIST_START_Y + (i % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t);\n\t\t}\n\t\tthis.highlight(2, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(2, 0);\n\n\t\tconst findLabelLeft = this.nextIndex++;\n\t\tconst findLabelRight = this.nextIndex++;\n\t\tconst highlightCircle1 = this.nextIndex++;\n\t\tconst highlightCircle2 = this.nextIndex++;\n\t\tconst highlightCircle3 = this.nextIndex++;\n\n\t\tlet edgesAdded = 0;\n\t\tlet nextListIndex = 0;\n\t\tthis.cmd(act.createLabel, findLabelLeft, '', FIND_LABEL_1_X, FIND_LABEL_1_Y, 0);\n\t\tthis.cmd(act.createLabel, findLabelRight, '', FIND_LABEL_2_X, FIND_LABEL_2_Y, 0);\n\n\t\t// Run algorithm\n\t\tthis.highlight(3, 0);\n\t\twhile (edgesAdded < this.size - 1 && nextListIndex < edgeCount) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.messageLabelID,\n\t\t\t\t'Dequeueing ' +\n\t\t\t\t\tthis.toStr(this.edgesListLeft[nextListIndex]) +\n\t\t\t\t\tthis.toStr(this.edgesListRight[nextListIndex]),\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListLeftID[nextListIndex],\n\t\t\t\tCURRENT_LABEL_X + 90,\n\t\t\t\tCURRENT_LABEL_Y + 6,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListRightID[nextListIndex],\n\t\t\t\tCURRENT_LABEL_X + EDGE_LIST_ELEM_WIDTH + 90,\n\t\t\t\tCURRENT_LABEL_Y + 6,\n\t\t\t);\n\n\t\t\tfor (i = nextListIndex + 1; i < edgeCount; i++) {\n\t\t\t\tconst newPos = i - nextListIndex - 1;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.edgesListLeftID[i],\n\t\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\t\tMath.floor(newPos / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\tEDGE_LIST_START_Y + (newPos % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.edgesListRightID[i],\n\t\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\t\tEDGE_LIST_ELEM_WIDTH +\n\t\t\t\t\t\tMath.floor(newPos / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\tEDGE_LIST_START_Y + (newPos % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.highlightEdge(\n\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t1,\n\t\t\t);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(4, 0);\n\n\t\t\tthis.highlight(5, 0);\n\n\t\t\tthis.cmd(act.setText, this.messageLabelID, 'Looking at disjoint set');\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelLeft,\n\t\t\t\t'find(' + this.toStr(this.edgesListLeft[nextListIndex]) + ') = ',\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightCircle1,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR_1,\n\t\t\t\tCURRENT_LABEL_X + 88,\n\t\t\t\tCURRENT_LABEL_Y + 6,\n\t\t\t\tHIGHLIGHT_CIRCLE_RADIUS,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tconst left = this.edgesListLeft[nextListIndex];\n\t\t\tconst leftRoot = this.setData[left];\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightCircle1,\n\t\t\t\tSET_ARRAY_START_X,\n\t\t\t\tSET_ARRAY_START_Y + this.edgesListLeft[nextListIndex] * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelLeft,\n\t\t\t\t'find(' + this.toStr(this.edgesListLeft[nextListIndex]) + ') = ' + leftRoot,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelRight,\n\t\t\t\t'find(' + this.toStr(this.edgesListRight[nextListIndex]) + ') = ',\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightCircle2,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR_2,\n\t\t\t\tCURRENT_LABEL_X + EDGE_LIST_ELEM_WIDTH + 91,\n\t\t\t\tCURRENT_LABEL_Y + 6,\n\t\t\t\tHIGHLIGHT_CIRCLE_RADIUS,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tconst right = this.edgesListRight[nextListIndex];\n\t\t\tconst rightRoot = this.setData[right];\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightCircle2,\n\t\t\t\tSET_ARRAY_START_X,\n\t\t\t\tSET_ARRAY_START_Y + this.edgesListRight[nextListIndex] * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelRight,\n\t\t\t\t'find(' + this.toStr(this.edgesListRight[nextListIndex]) + ') = ' + rightRoot,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(5, 0);\n\n\t\t\tif (leftRoot !== rightRoot) {\n\t\t\t\tthis.highlight(5, 0);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.messageLabelID,\n\t\t\t\t\t'Vertices in different sets.  Add edge to MST.',\n\t\t\t\t);\n\t\t\t\tthis.highlightEdge(\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tedgesAdded++;\n\t\t\t\tthis.setEdgeColor(\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\tMST_EDGE_COLOR,\n\t\t\t\t);\n\t\t\t\tthis.setEdgeThickness(\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\tMST_EDGE_THICKNESS,\n\t\t\t\t);\n\t\t\t\tthis.highlight(6, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(6, 0);\n\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.messageLabelID,\n\t\t\t\t\t'Union sets ' + leftRoot + ' and ' + rightRoot,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tfindLabelLeft, // reusing find label\n\t\t\t\t\t'union(' + this.toStr(left) + ', ' + this.toStr(right) + ')',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setText, findLabelRight, '');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tconst minRoot = Math.min(leftRoot, rightRoot);\n\t\t\t\tconst maxRoot = Math.max(leftRoot, rightRoot);\n\t\t\t\tlet firstMatch = true;\n\t\t\t\tfor (let k = 0; k < this.size; k++) {\n\t\t\t\t\tif (this.setData[k] === maxRoot) {\n\t\t\t\t\t\tif (firstMatch) {\n\t\t\t\t\t\t\tfirstMatch = false;\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\t\thighlightCircle3,\n\t\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR_3,\n\t\t\t\t\t\t\t\tSET_ARRAY_START_X + SET_ARRAY_ELEM_WIDTH,\n\t\t\t\t\t\t\t\tSET_ARRAY_START_Y + k * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_RADIUS,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, highlightCircle3, 1);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\thighlightCircle3,\n\t\t\t\t\t\t\t\tSET_ARRAY_START_X + SET_ARRAY_ELEM_WIDTH,\n\t\t\t\t\t\t\t\tSET_ARRAY_START_Y + k * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.setData[k] = minRoot;\n\t\t\t\t\t\tthis.cmd(act.setText, this.setID[k], minRoot);\n\t\t\t\t\t\t!this.isLarge &&\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setBackgroundColor,\n\t\t\t\t\t\t\t\tthis.setID[k],\n\t\t\t\t\t\t\t\tKRUSKALS_DS_COLORS[minRoot - 1],\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.cmd(act.delete, highlightCircle3);\n\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setText, this.messageLabelID, 'Vertices in the same set, skip edge');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\n\t\t\tthis.highlightEdge(\n\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t0,\n\t\t\t);\n\n\t\t\tthis.cmd(act.delete, highlightCircle1);\n\t\t\tthis.cmd(act.delete, highlightCircle2);\n\n\t\t\tthis.cmd(act.delete, this.edgesListLeftID[nextListIndex]);\n\t\t\tthis.cmd(act.delete, this.edgesListRightID[nextListIndex]);\n\t\t\tthis.cmd(act.setText, findLabelLeft, '');\n\t\t\tthis.cmd(act.setText, findLabelRight, '');\n\t\t\tnextListIndex++;\n\t\t}\n\t\tthis.unhighlight(3, 0);\n\t\tthis.cmd(act.delete, findLabelLeft);\n\t\tthis.cmd(act.delete, findLabelRight);\n\n\t\tthis.edgesListLeftID = this.edgesListLeftID.slice(nextListIndex);\n\t\tthis.edgesListRightID = this.edgesListRightID.slice(nextListIndex);\n\n\t\tif (edgesAdded === this.size - 1) {\n\t\t\tthis.cmd(act.setText, this.messageLabelID, 'MST has correct amount of edges, done');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.messageLabelID, 'Priority queue is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst INFO_MSG_X = 20;\nconst INFO_MSG_Y = 400;\n\nconst TABLE_ELEM_WIDTH = 40;\nconst TABLE_ELEM_HEIGHT = 30;\n\nconst TABLE_START_X = 500;\nconst TABLE_START_Y = 80;\n\nconst CODE_START_X = 20;\nconst CODE_START_Y = 20;\nconst CODE_LINE_HEIGHT = 14;\n\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\nconst CODE_STANDARD_COLOR = '#000000';\nconst LCS_CELL_COLOR = '#99CCFF';\nconst MAX_SEQUENCE_LENGTH = 13;\n\nconst SEQUENCE_START_X = 20;\nconst SEQUENCE_START_Y = 450;\nconst SEQUENCE_DELTA_X = 10;\n\nexport default class LCS extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\taddLabelToAlgorithmBar('S1:');\n\t\tthis.S1Field = addControlToAlgorithmBar('Text', '');\n\t\tthis.S1Field.onkeydown = this.returnSubmit(\n\t\t\tthis.S1Field,\n\t\t\tthis.runCallback.bind(this),\n\t\t\tMAX_SEQUENCE_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.S1Field);\n\n\t\taddLabelToAlgorithmBar('S2:');\n\t\tthis.S2Field = addControlToAlgorithmBar('Text', '');\n\t\tthis.S2Field.onkeydown = this.returnSubmit(\n\t\t\tthis.S2Field,\n\t\t\tthis.runCallback.bind(this),\n\t\t\tMAX_SEQUENCE_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.S2Field);\n\n\t\tthis.tableButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.tableButton.onclick = this.runCallback.bind(this);\n\t\tthis.controls.push(this.tableButton);\n\t}\n\n\tsetup() {\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.code = [\n\t\t\t['procedure ', 'LCS(S1, S2, matrix)'],\n\t\t\t['     matrix <- create new 2D array of length S1.length by S2.length'],\n\t\t\t['     for y <- 1, to S1.length, loop'],\n\t\t\t['          for x <- 1 to S2.length, loop'],\n\t\t\t['               if ', '(S1[y] == S2[x])'],\n\t\t\t['                    matrix[y][x] = 1 + ', 'matrix[y - 1][x - 1]'],\n\t\t\t['               else'],\n\t\t\t[\n\t\t\t\t'                    matrix[y][x] = max(',\n\t\t\t\t'matrix[y - 1][x]',\n\t\t\t\t',',\n\t\t\t\t' matrix[y][x - 1]',\n\t\t\t\t')',\n\t\t\t],\n\t\t\t['          end for'],\n\t\t\t['     end for'],\n\t\t\t['     currY <- S1.length'],\n\t\t\t['     currX <- S2.length'],\n\t\t\t['     list <- create new List()'],\n\t\t\t['     while currY > 0 and currX > 0, loop:'],\n\t\t\t[['          if '], ['matrix[currY - 1][currX] == matrix[currY][currX - 1] ']],\n\t\t\t[['           and '], ['matrix[currY][currX] != matrix [currY - 1][currX - 1]']],\n\t\t\t['               list.addFront(S1[currY])'],\n\t\t\t['               currX--'],\n\t\t\t['               currY--'],\n\t\t\t['          else'],\n\t\t\t[['               if '], ['matrix[currY - 1][currX] > matrix[currY][currX - 1]']],\n\t\t\t['                    currX--'],\n\t\t\t['               else'],\n\t\t\t['                    currY--'],\n\t\t\t['     end while'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = Array(this.code.length);\n\t\tlet i, j;\n\t\tfor (i = 0; i < this.code.length; i++) {\n\t\t\tthis.codeID[i] = new Array(this.code[i].length);\n\t\t\tfor (j = 0; j < this.code[i].length; j++) {\n\t\t\t\tthis.codeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.codeID[i][j],\n\t\t\t\t\tthis.code[i][j],\n\t\t\t\t\tCODE_START_X,\n\t\t\t\t\tCODE_START_Y + i * CODE_LINE_HEIGHT,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[i][j], CODE_STANDARD_COLOR);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, this.codeID[i][j], this.codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.initialIndex = this.nextIndex;\n\t\tthis.oldIDs = [];\n\t\tthis.commands = [];\n\t}\n\n\treset() {\n\t\tthis.oldIDs = [];\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\trunCallback() {\n\t\tconst string1 = this.S1Field.value;\n\t\tconst string2 = this.S2Field.value;\n\t\tif (string1 !== '' && string2 !== '') {\n\t\t\tthis.S1Field.value = '';\n\t\t\tthis.S2Field.value = '';\n\t\t\tthis.implementAction(this.run.bind(this), string1, string2);\n\t\t}\n\t}\n\n\trun(str1, str2) {\n\t\tthis.commands = [];\n\t\tthis.clearOldIDs();\n\n\t\tthis.buildTable(str1, str2);\n\n\t\tconst moveID = this.nextIndex++;\n\t\tconst x = str1.length;\n\t\tconst y = str2.length;\n\t\tlet i, j;\n\n\t\tfor (i = 0; i <= x; i++) {\n\t\t\tthis.cmd(act.setText, this.tableID[i][0], '0');\n\t\t\tthis.tableVals[i][0] = 0;\n\t\t}\n\t\tfor (i = 0; i <= y; i++) {\n\t\t\tthis.cmd(act.setText, this.tableID[0][i], '0');\n\t\t\tthis.tableVals[0][i] = 0;\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tfor (j = 0; j < y; j++) {\n\t\t\tfor (i = 0; i < x; i++) {\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j + 1], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[i], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[j], 1);\n\t\t\t\tthis.highlight(4, 1);\n\t\t\t\t// this.cmd(act.setForegroundColor, this.codeID[4][1], CODE_HIGHLIGHT_COLOR);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Comparing ' + str1.charAt(i) + ' and ' + str2.charAt(j),\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[i], 0);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[j], 0);\n\t\t\t\tthis.unhighlight(4, 1);\n\t\t\t\t// this.cmd(act.setForegroundColor, this.codeID[4][1], CODE_STANDARD_COLOR);\n\t\t\t\tif (str1.charAt(i) === str2.charAt(j)) {\n\t\t\t\t\t// this.cmd(act.setForegroundColor, this.codeID[5][0], CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\t// this.cmd(act.setForegroundColor, this.codeID[5][1], CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\tthis.highlight(5, 0);\n\t\t\t\t\tthis.highlight(5, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1 - 1][j + 1 - 1], 1);\n\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Match, increment from the diagonal');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\tthis.tableVals[i][j] + 1,\n\t\t\t\t\t\tthis.tableXPos[i][j],\n\t\t\t\t\t\tthis.tableYPos[i][j],\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.bringToTop, moveID, 1);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\tthis.tableXPos[i + 1][j + 1],\n\t\t\t\t\t\tthis.tableYPos[i + 1][j + 1],\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, moveID);\n\t\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\t\tthis.unhighlight(5, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1 - 1][j + 1 - 1], 0);\n\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i][j] + 1;\n\t\t\t\t\tthis.cmd(act.setText, this.tableID[i + 1][j + 1], this.tableVals[i + 1][j + 1]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlight(7, 0);\n\t\t\t\t\tthis.highlight(7, 1);\n\t\t\t\t\tthis.highlight(7, 2);\n\t\t\t\t\tthis.highlight(7, 3);\n\t\t\t\t\tthis.highlight(7, 4);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i][j + 1], 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j], 1);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t'Mismatch, copy greatest value from left or above',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\t\tthis.unhighlight(7, 2);\n\t\t\t\t\tthis.unhighlight(7, 4);\n\n\t\t\t\t\tif (this.tableVals[i][j + 1] > this.tableVals[i + 1][j]) {\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j], 0);\n\t\t\t\t\t\tthis.unhighlight(7, 1);\n\n\t\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i][j + 1];\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\t\tthis.tableVals[i][j + 1],\n\t\t\t\t\t\t\tthis.tableXPos[i][j + 1],\n\t\t\t\t\t\t\tthis.tableYPos[i][j + 1],\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.unhighlight(7, 3);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i][j + 1], 0);\n\t\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i + 1][j];\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\t\tthis.tableVals[i + 1][j],\n\t\t\t\t\t\t\tthis.tableXPos[i + 1][j],\n\t\t\t\t\t\t\tthis.tableYPos[i + 1][j],\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.bringToTop, moveID, 1);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\tthis.tableXPos[i + 1][j + 1],\n\t\t\t\t\t\tthis.tableYPos[i + 1][j + 1],\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setText, this.tableID[i + 1][j + 1], this.tableVals[i + 1][j + 1]);\n\t\t\t\t\tthis.cmd(act.delete, moveID);\n\t\t\t\t\tif (this.tableVals[i][j + 1] > this.tableVals[i + 1][j]) {\n\t\t\t\t\t\tthis.unhighlight(7, 3);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i][j + 1], 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.unhighlight(7, 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j], 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j + 1], 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.highlight(9, 0);\n\t\tthis.highlight(10, 0);\n\t\tthis.highlight(11, 0);\n\t\tthis.highlight(12, 0);\n\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Finished building table, can now find LCS');\n\t\tthis.cmd(act.step);\n\n\t\tthis.buildLCSFromTable(str1, str2);\n\n\t\tthis.unhighlight(24, 0);\n\t\tthis.highlight(25, 0);\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Done');\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(25, 0);\n\n\t\treturn this.commands;\n\t}\n\n\tbuildTable(str1, str2) {\n\t\tconst x = str1.length;\n\t\tconst y = str2.length;\n\t\tthis.tableID = new Array(x + 1);\n\t\tthis.tableVals = new Array(x + 1);\n\t\tthis.tableXPos = new Array(x + 1);\n\t\tthis.tableYPos = new Array(x + 1);\n\n\t\tlet i, j;\n\n\t\tthis.S1TableID = new Array(x);\n\t\tfor (i = 0; i <= x; i++) {\n\t\t\tif (i > 0) {\n\t\t\t\tthis.S1TableID[i - 1] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.S1TableID[i - 1],\n\t\t\t\t\tstr1.charAt(i - 1),\n\t\t\t\t\tTABLE_START_X + i * TABLE_ELEM_WIDTH,\n\t\t\t\t\tTABLE_START_Y - 2 * TABLE_ELEM_HEIGHT,\n\t\t\t\t);\n\t\t\t\tthis.oldIDs.push(this.S1TableID[i - 1]);\n\t\t\t}\n\t\t\tconst index = this.nextIndex++;\n\t\t\tthis.oldIDs.push(index);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tindex,\n\t\t\t\ti - 1 === -1 ? '\\u2205' : i - 1,\n\t\t\t\tTABLE_START_X + i * TABLE_ELEM_WIDTH,\n\t\t\t\tTABLE_START_Y - 1 * TABLE_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, index, '#0000FF');\n\t\t}\n\n\t\tthis.S2TableID = new Array(y);\n\t\tfor (i = 0; i <= y; i++) {\n\t\t\tif (i > 0) {\n\t\t\t\tthis.S2TableID[i - 1] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.S2TableID[i - 1],\n\t\t\t\t\tstr2.charAt(i - 1),\n\t\t\t\t\tTABLE_START_X - 2 * TABLE_ELEM_WIDTH,\n\t\t\t\t\tTABLE_START_Y + i * TABLE_ELEM_HEIGHT,\n\t\t\t\t);\n\t\t\t\tthis.oldIDs.push(this.S2TableID[i - 1]);\n\t\t\t}\n\t\t\tconst index = this.nextIndex++;\n\t\t\tthis.oldIDs.push(index);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tindex,\n\t\t\t\ti - 1 === -1 ? '\\u2205' : i - 1,\n\t\t\t\tTABLE_START_X - 1 * TABLE_ELEM_WIDTH,\n\t\t\t\tTABLE_START_Y + i * TABLE_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, index, '#0000FF');\n\t\t}\n\n\t\tfor (i = 0; i <= x; i++) {\n\t\t\tthis.tableID[i] = new Array(y + 1);\n\t\t\tthis.tableVals[i] = new Array(y + 1);\n\t\t\tthis.tableXPos[i] = new Array(y + 1);\n\t\t\tthis.tableYPos[i] = new Array(y + 1);\n\n\t\t\tfor (j = 0; j <= y; j++) {\n\t\t\t\tthis.tableID[i][j] = this.nextIndex++;\n\t\t\t\tthis.tableVals[i][j] = -1;\n\t\t\t\tthis.oldIDs.push(this.tableID[i][j]);\n\n\t\t\t\tthis.tableXPos[i][j] = TABLE_START_X + i * TABLE_ELEM_WIDTH;\n\t\t\t\tthis.tableYPos[i][j] = TABLE_START_Y + j * TABLE_ELEM_HEIGHT;\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.tableID[i][j],\n\t\t\t\t\t'',\n\t\t\t\t\tTABLE_ELEM_WIDTH,\n\t\t\t\t\tTABLE_ELEM_HEIGHT,\n\t\t\t\t\tthis.tableXPos[i][j],\n\t\t\t\t\tthis.tableYPos[i][j],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tclearOldIDs() {\n\t\tfor (let i = 0; i < this.oldIDs.length; i++) {\n\t\t\tthis.cmd(act.delete, this.oldIDs[i]);\n\t\t}\n\t\tthis.oldIDs = [];\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tbuildLCSFromTable(str1, str2) {\n\t\tlet currX = this.tableVals.length - 1;\n\t\tlet currY = this.tableVals[0].length - 1;\n\n\t\tconst sequence = [];\n\n\t\tconst header = this.nextIndex++;\n\t\tthis.oldIDs.push(header);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\theader,\n\t\t\t'Longest Common Subsequence:',\n\t\t\tSEQUENCE_START_X,\n\t\t\tSEQUENCE_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, header, '#003300');\n\n\t\tfor (let i = 1; i <= str1.length; i++) {\n\t\t\tfor (let j = 1; j <= str2.length; j++) {\n\t\t\t\tconst topThick = this.tableVals[i][j] !== this.tableVals[i][j - 1];\n\t\t\t\tconst leftThick = this.tableVals[i][j] !== this.tableVals[i - 1][j];\n\t\t\t\tif (topThick || leftThick) {\n\t\t\t\t\tthis.cmd(act.setRectangleEdgeThickness, this.tableID[i][j], [\n\t\t\t\t\t\ttopThick,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tleftThick,\n\t\t\t\t\t]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(9, 0);\n\t\tthis.unhighlight(10, 0);\n\t\tthis.unhighlight(11, 0);\n\t\tthis.unhighlight(12, 0);\n\n\t\twhile (currX > 0 && currY > 0) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.tableID[currX][currY], LCS_CELL_COLOR);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.unhighlight(14, 1);\n\t\t\tthis.unhighlight(15, 1);\n\t\t\tfor (let i = 16; i < 24; i++) {\n\t\t\t\tthis.unhighlight(i, 0);\n\t\t\t}\n\n\t\t\tthis.highlight(14, 1);\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 1);\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 1);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.unhighlight(14, 1);\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 0);\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 0);\n\n\t\t\tif (this.tableVals[currX - 1][currY] === this.tableVals[currX][currY - 1]) {\n\t\t\t\tthis.highlight(15, 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY - 1], 1);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.unhighlight(15, 1);\n\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY], 0);\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY - 1], 0);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.tableVals[currX - 1][currY] === this.tableVals[currX][currY - 1] &&\n\t\t\t\tthis.tableVals[currX - 1][currY] !== this.tableVals[currX][currY]\n\t\t\t) {\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[currX - 1], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[currY - 1], 1);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Hit a corner, move diagonally and add current character to LCS',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[currX - 1], 0);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[currY - 1], 0);\n\t\t\t} else {\n\t\t\t\tif (this.tableVals[currX - 1][currY] > this.tableVals[currX][currY - 1]) {\n\t\t\t\t\tthis.highlight(20, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 1);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tthis.unhighlight(20, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 0);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 0);\n\t\t\t\t\tthis.highlight(21, 0);\n\n\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Move left');\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlight(23, 0);\n\n\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Move up');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.tableVals[currX - 1][currY] === this.tableVals[currX][currY - 1] &&\n\t\t\t\tthis.tableVals[currX - 1][currY] !== this.tableVals[currX][currY]\n\t\t\t) {\n\t\t\t\tconst nextSequenceID = this.nextIndex++;\n\t\t\t\tthis.oldIDs.push(nextSequenceID);\n\t\t\t\tsequence.push(nextSequenceID);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tnextSequenceID,\n\t\t\t\t\tstr1.charAt(currX - 1),\n\t\t\t\t\tSEQUENCE_START_X + (sequence.length - 1) * SEQUENCE_DELTA_X + 4,\n\t\t\t\t\tSEQUENCE_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, nextSequenceID, '#0000FF');\n\n\t\t\t\tfor (let i = sequence.length - 1; i >= 0; i--) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tsequence[i],\n\t\t\t\t\t\tSEQUENCE_START_X + (sequence.length - 1 - i) * SEQUENCE_DELTA_X + 4,\n\t\t\t\t\t\tSEQUENCE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis.highlight(16, 0);\n\t\t\t\tthis.highlight(17, 0);\n\t\t\t\tthis.highlight(18, 0);\n\n\t\t\t\tcurrX = currX - 1;\n\t\t\t\tcurrY = currY - 1;\n\t\t\t} else {\n\t\t\t\tif (this.tableVals[currX - 1][currY] > this.tableVals[currX][currY - 1]) {\n\t\t\t\t\tcurrX = currX - 1;\n\t\t\t\t\tthis.highlight(21, 0);\n\t\t\t\t} else {\n\t\t\t\t\tcurrY = currY - 1;\n\t\t\t\t\tthis.highlight(23, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let i = 16; i < 24; i++) {\n\t\t\tthis.unhighlight(i, 0);\n\t\t}\n\t\tthis.highlight(24, 0);\n\t\tthis.cmd(act.step);\n\t}\n\n\thighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\n\t}\n\n\tunhighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { LARGE_SIZE, SMALL_SIZE } from './Graph.js';\nimport { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst SMALL_COST_TABLE_WIDTH = 30;\nconst SMALL_COST_TABLE_HEIGHT = 30;\nconst SMALL_COST_TABLE_START_X = 40;\nconst SMALL_COST_TABLE_START_Y = 70;\n\nconst SMALL_PATH_TABLE_WIDTH = 30;\nconst SMALL_PATH_TABLE_HEIGHT = 30;\nconst SMALL_PATH_TABLE_START_X = 330;\nconst SMALL_PATH_TABLE_START_Y = 70;\n\nconst SMALL_NODE_1_X_POS = 50;\nconst SMALL_NODE_1_Y_POS = 400;\nconst SMALL_NODE_2_X_POS = 150;\nconst SMALL_NODE_2_Y_POS = 350;\nconst SMALL_NODE_3_X_POS = 250;\nconst SMALL_NODE_3_Y_POS = 400;\n\nconst SMALL_MESSAGE_X = 400;\nconst SMALL_MESSAGE_Y = 350;\n\nconst LARGE_COST_TABLE_WIDTH = 20;\nconst LARGE_COST_TABLE_HEIGHT = 20;\nconst LARGE_COST_TABLE_START_X = 40;\nconst LARGE_COST_TABLE_START_Y = 50;\n\nconst LARGE_PATH_TABLE_WIDTH = 20;\nconst LARGE_PATH_TABLE_HEIGHT = 20;\nconst LARGE_PATH_TABLE_START_X = 500;\nconst LARGE_PATH_TABLE_START_Y = 50;\n\nconst LARGE_NODE_1_X_POS = 50;\nconst LARGE_NODE_1_Y_POS = 500;\nconst LARGE_NODE_2_X_POS = 150;\nconst LARGE_NODE_2_Y_POS = 450;\nconst LARGE_NODE_3_X_POS = 250;\nconst LARGE_NODE_3_Y_POS = 500;\n\nconst LARGE_MESSAGE_X = 300;\nconst LARGE_MESSAGE_Y = 450;\n\nexport default class Floyd extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, [], false, false, true);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t\tthis.smallGraphButton.onclick = this.smallGraphCallback.bind(this);\n\t\tthis.largeGraphButton.onclick = this.largeGraphCallback.bind(this);\n\t}\n\n\treset() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tthis.costTable[i][j] = this.adj_matrix[i][j];\n\t\t\t\tif (this.costTable[i][j] >= 0) {\n\t\t\t\t\tthis.pathTable[i][j] = i;\n\t\t\t\t} else {\n\t\t\t\t\tthis.pathTable[i][j] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsmallGraphCallback() {\n\t\tif (this.size !== SMALL_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\t\tthis.logicalButton.disabled = false;\n\t\t\tthis.adjacencyListButton.disabled = false;\n\t\t\tthis.adjacencyMatrixButton.disabled = false;\n\t\t\tthis.setup_small();\n\t\t}\n\t}\n\n\tlargeGraphCallback() {\n\t\tif (this.size !== LARGE_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\t//this.animationManager.setAllLayers([0]);\n\t\t\tthis.logicalButton.disabled = true;\n\t\t\tthis.adjacencyListButton.disabled = true;\n\t\t\tthis.adjacencyMatrixButton.disabled = true;\n\t\t\tthis.setup_large();\n\t\t}\n\t}\n\n\tgetCostLabel(value, alwaysUseINF) {\n\t\talwaysUseINF = alwaysUseINF === undefined ? false : alwaysUseINF;\n\t\tif (value >= 0) {\n\t\t\treturn String(value);\n\t\t} else if (this.size === SMALL_SIZE || alwaysUseINF) {\n\t\t\treturn 'INF';\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tsetup_small() {\n\t\tthis.cost_table_width = SMALL_COST_TABLE_WIDTH;\n\t\tthis.cost_table_height = SMALL_COST_TABLE_HEIGHT;\n\t\tthis.cost_table_start_x = SMALL_COST_TABLE_START_X;\n\t\tthis.cost_table_start_y = SMALL_COST_TABLE_START_Y;\n\n\t\tthis.path_table_width = SMALL_PATH_TABLE_WIDTH;\n\t\tthis.path_table_height = SMALL_PATH_TABLE_HEIGHT;\n\t\tthis.path_table_start_x = SMALL_PATH_TABLE_START_X;\n\t\tthis.path_table_start_y = SMALL_PATH_TABLE_START_Y;\n\n\t\tthis.node_1_x_pos = SMALL_NODE_1_X_POS;\n\t\tthis.node_1_y_pos = SMALL_NODE_1_Y_POS;\n\t\tthis.node_2_x_pos = SMALL_NODE_2_X_POS;\n\t\tthis.node_2_y_pos = SMALL_NODE_2_Y_POS;\n\t\tthis.node_3_x_pos = SMALL_NODE_3_X_POS;\n\t\tthis.node_3_y_pos = SMALL_NODE_3_Y_POS;\n\n\t\tthis.message_x = SMALL_MESSAGE_X;\n\t\tthis.message_y = SMALL_MESSAGE_Y;\n\t\tsuper.setup_small();\n\t}\n\n\tsetup_large() {\n\t\tthis.cost_table_width = LARGE_COST_TABLE_WIDTH;\n\t\tthis.cost_table_height = LARGE_COST_TABLE_HEIGHT;\n\t\tthis.cost_table_start_x = LARGE_COST_TABLE_START_X;\n\t\tthis.cost_table_start_y = LARGE_COST_TABLE_START_Y;\n\n\t\tthis.path_table_width = LARGE_PATH_TABLE_WIDTH;\n\t\tthis.path_table_height = LARGE_PATH_TABLE_HEIGHT;\n\t\tthis.path_table_start_x = LARGE_PATH_TABLE_START_X;\n\t\tthis.path_table_start_y = LARGE_PATH_TABLE_START_Y;\n\n\t\tthis.node_1_x_pos = LARGE_NODE_1_X_POS;\n\t\tthis.node_1_y_pos = LARGE_NODE_1_Y_POS;\n\t\tthis.node_2_x_pos = LARGE_NODE_2_X_POS;\n\t\tthis.node_2_y_pos = LARGE_NODE_2_Y_POS;\n\t\tthis.node_3_x_pos = LARGE_NODE_3_X_POS;\n\t\tthis.node_3_y_pos = LARGE_NODE_3_Y_POS;\n\n\t\tthis.message_x = LARGE_MESSAGE_X;\n\t\tthis.message_y = LARGE_MESSAGE_Y;\n\n\t\tsuper.setup_large();\n\t}\n\n\tsetup() {\n\t\tsuper.setup();\n\t\tthis.commands = [];\n\n\t\tthis.costTable = new Array(this.size);\n\t\tthis.pathTable = new Array(this.size);\n\t\tthis.costTableID = new Array(this.size);\n\t\tthis.pathTableID = new Array(this.size);\n\t\tthis.pathIndexXID = new Array(this.size);\n\t\tthis.pathIndexYID = new Array(this.size);\n\t\tthis.costIndexXID = new Array(this.size);\n\t\tthis.costIndexYID = new Array(this.size);\n\n\t\tthis.node1ID = this.nextIndex++;\n\t\tthis.node2ID = this.nextIndex++;\n\t\tthis.node3ID = this.nextIndex++;\n\n\t\tlet i;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.costTable[i] = new Array(this.size);\n\t\t\tthis.pathTable[i] = new Array(this.size);\n\t\t\tthis.costTableID[i] = new Array(this.size);\n\t\t\tthis.pathTableID[i] = new Array(this.size);\n\t\t}\n\n\t\tconst costTableHeader = this.nextIndex++;\n\t\tconst pathTableHeader = this.nextIndex++;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tcostTableHeader,\n\t\t\t'Cost Table',\n\t\t\tthis.cost_table_start_x,\n\t\t\tthis.cost_table_start_y - 2 * this.cost_table_height,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tpathTableHeader,\n\t\t\t'Path Table',\n\t\t\tthis.path_table_start_x,\n\t\t\tthis.path_table_start_y - 2 * this.path_table_height,\n\t\t\t0,\n\t\t);\n\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.pathIndexXID[i] = this.nextIndex++;\n\t\t\tthis.pathIndexYID[i] = this.nextIndex++;\n\t\t\tthis.costIndexXID[i] = this.nextIndex++;\n\t\t\tthis.costIndexYID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.pathIndexXID[i],\n\t\t\t\ti,\n\t\t\t\tthis.path_table_start_x + i * this.path_table_width,\n\t\t\t\tthis.path_table_start_y - this.path_table_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.pathIndexXID[i], '#0000FF');\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.pathIndexYID[i],\n\t\t\t\ti,\n\t\t\t\tthis.path_table_start_x - this.path_table_width,\n\t\t\t\tthis.path_table_start_y + i * this.path_table_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.pathIndexYID[i], '#0000FF');\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.costIndexXID[i],\n\t\t\t\ti,\n\t\t\t\tthis.cost_table_start_x + i * this.cost_table_width,\n\t\t\t\tthis.cost_table_start_y - this.cost_table_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.costIndexXID[i], '#0000FF');\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.costIndexYID[i],\n\t\t\t\ti,\n\t\t\t\tthis.cost_table_start_x - this.cost_table_width,\n\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.costIndexYID[i], '#0000FF');\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tthis.costTable[i][j] = this.adj_matrix[i][j];\n\t\t\t\tif (this.costTable[i][j] >= 0) {\n\t\t\t\t\tthis.pathTable[i][j] = i;\n\t\t\t\t} else {\n\t\t\t\t\tthis.pathTable[i][j] = -1;\n\t\t\t\t}\n\t\t\t\tthis.costTableID[i][j] = this.nextIndex++;\n\t\t\t\tthis.pathTableID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.costTableID[i][j],\n\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true),\n\t\t\t\t\tthis.cost_table_width,\n\t\t\t\t\tthis.cost_table_height,\n\t\t\t\t\tthis.cost_table_start_x + j * this.cost_table_width,\n\t\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.pathTableID[i][j],\n\t\t\t\t\tthis.pathTable[i][j],\n\t\t\t\t\tthis.path_table_width,\n\t\t\t\t\tthis.path_table_height,\n\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\n\t\t\t\t\tthis.path_table_start_y + i * this.path_table_height,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tif (this.size === LARGE_SIZE) {\n\t\t\tthis.animationManager.setAllLayers([0]);\n\t\t}\n\t}\n\n\tstartCallback() {\n\t\tthis.implementAction(this.doFloydWarshall.bind(this));\n\t}\n\n\tdoFloydWarshall() {\n\t\tthis.commands = [];\n\n\t\tconst oldIndex = this.nextIndex;\n\t\tconst messageID = this.nextIndex++;\n\t\tconst moveLabel1ID = this.nextIndex++;\n\t\tconst moveLabel2ID = this.nextIndex++;\n\n\t\tthis.cmd(act.createCircle, this.node1ID, '', this.node_1_x_pos, this.node_1_y_pos);\n\t\tthis.cmd(act.createCircle, this.node2ID, '', this.node_2_x_pos, this.node_2_y_pos);\n\t\tthis.cmd(act.createCircle, this.node3ID, '', this.node_3_x_pos, this.node_3_y_pos);\n\t\tthis.cmd(act.createLabel, messageID, '', this.message_x, this.message_y, 0);\n\n\t\tfor (let k = 0; k < this.size; k++) {\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\t\tif (i !== j && j !== k && i !== k) {\n\t\t\t\t\t\tthis.cmd(act.setText, this.node1ID, i);\n\t\t\t\t\t\tthis.cmd(act.setText, this.node2ID, k);\n\t\t\t\t\t\tthis.cmd(act.setText, this.node3ID, j);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.node1ID,\n\t\t\t\t\t\t\tthis.node2ID,\n\t\t\t\t\t\t\t'#009999',\n\t\t\t\t\t\t\t-0.1,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.node2ID,\n\t\t\t\t\t\t\tthis.node3ID,\n\t\t\t\t\t\t\t'#9900CC',\n\t\t\t\t\t\t\t-0.1,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.node1ID,\n\t\t\t\t\t\t\tthis.node3ID,\n\t\t\t\t\t\t\t'#CC0000',\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][k], 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[k][j], 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][j], 1);\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][k], '#009999');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[k][j], '#9900CC');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][j], '#CC0000');\n\t\t\t\t\t\tif (this.costTable[i][k] >= 0 && this.costTable[k][j] >= 0) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.costTable[i][j] < 0 ||\n\t\t\t\t\t\t\t\tthis.costTable[i][k] + this.costTable[k][j] < this.costTable[i][j]\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tmessageID,\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\n\t\t\t\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.costTable[i][j] = this.costTable[i][k] + this.costTable[k][j];\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.pathTableID[i][j], '');\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.costTableID[i][j], '');\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tmoveLabel1ID,\n\t\t\t\t\t\t\t\t\tthis.pathTable[k][j],\n\t\t\t\t\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\n\t\t\t\t\t\t\t\t\tthis.path_table_start_y + k * this.path_table_height,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\tmoveLabel1ID,\n\t\t\t\t\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\n\t\t\t\t\t\t\t\t\tthis.path_table_start_y + i * this.path_table_height,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tmoveLabel2ID,\n\t\t\t\t\t\t\t\t\tthis.costTable[i][j],\n\t\t\t\t\t\t\t\t\tthis.message_x,\n\t\t\t\t\t\t\t\t\tthis.message_y,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, moveLabel2ID, 1);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\tmoveLabel2ID,\n\t\t\t\t\t\t\t\t\tthis.cost_table_start_x + j * this.cost_table_width,\n\t\t\t\t\t\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.pathTable[i][j] = this.pathTable[k][j];\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.costTableID[i][j], this.costTable[i][j]);\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.pathTableID[i][j], this.pathTable[i][j]);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, moveLabel1ID);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, moveLabel2ID);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tmessageID,\n\t\t\t\t\t\t\t\t\t'!(' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\n\t\t\t\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true) +\n\t\t\t\t\t\t\t\t\t\t')',\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tmessageID,\n\t\t\t\t\t\t\t\t'!(' +\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\n\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\n\t\t\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true) +\n\t\t\t\t\t\t\t\t\t')',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][k], '#000000');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[k][j], '#000000');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][j], '#000000');\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.node1ID, this.node2ID);\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.node2ID, this.node3ID);\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.node1ID, this.node3ID);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][k], 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[k][j], 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][j], 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.delete, this.node1ID);\n\t\tthis.cmd(act.delete, this.node2ID);\n\t\tthis.cmd(act.delete, this.node3ID);\n\t\tthis.cmd(act.delete, messageID);\n\t\tthis.nextIndex = oldIndex;\n\n\t\treturn this.commands;\n\t}\n}\n","import React from 'react';\n\n// Include the ClassName of algorithms that should have an example modal\nexport default {\n\tAVL: (\n\t\t<ul>\n\t\t\t<li>To cause a left rotation, add 1, 2 and 3, in that order</li>\n\t\t\t<li>To cause a right rotation, add 3, 2 and 1, in that order</li>\n\t\t\t<li>To cause a left-right rotation, add 3, 1 and 2, in that order</li>\n\t\t\t<li>To cause a right-left rotation, add 1, 3 and 2, in that order</li>\n\t\t</ul>\n\t),\n\tBoyerMoore: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a text with only one letter and a pattern with that\n\t\t\t\tsame letter, but a different first letter (for example, &quot;aaaaaaaaa&quot; for\n\t\t\t\ttext and &quot;baaaa&quot; for pattern), since we will only mismatch on the last\n\t\t\t\tcomparison\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tWhen incorporating the Galil Rule, we can use logic similar to that of KMP to\n\t\t\t\toptimize our shifts. After finding a full match, instead of shifting by 1 we shift\n\t\t\t\tby the period <i>k</i>. After that shift, we don't need to compare the first{' '}\n\t\t\t\t<i>k</i> characters in the pattern because we've already compared them and know that\n\t\t\t\tthey match!\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tBruteForce: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a text with only one letter and a pattern with that\n\t\t\t\tsame letter, but a different last letter (for example, &quot;aaaaaaaaa&quot; for\n\t\t\t\ttext and &quot;aaaab&quot; for pattern), since we will only mismatch on the last\n\t\t\t\tcomparison\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tBST: (\n\t\t<ul>\n\t\t\t<li>To get a degenerate BST, you can add ascending data, such as 1, 2, 3, ...</li>\n\t\t\t<li>To get a full BST, you can add 2, 1, 4, 3, 5, in that order</li>\n\t\t\t<li>To get a complete BST, you can add 3, 2, 4, 1, in that order</li>\n\t\t\t<li>To get a full and complete BST, you can add 4, 2, 5, 1, 3, in that order</li>\n\t\t</ul>\n\t),\n\tBTree: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tTo cause overflow and trigger a promotion, add more than 3 data (for example 1, 2, 3\n\t\t\t\tand 4)\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tTo remove from a leaf node, add 1, 2, 3 and 4, in that order, then remove 3 or 4\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tTo remove from an inner node and use the predecessor, add 1, 3, 4, 5 and 2, in that\n\t\t\t\torder, then remove 3\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tTo cause underflow and trigger a rotation/transfer, add 1, 2, 3 and 4, in that\n\t\t\t\torder, then remove 1\n\t\t\t</li>\n\t\t\t<li>To cause underflow and trigger a fusion, follow the steps above then remove 2</li>\n\t\t</ul>\n\t),\n\tBubbleSort: (\n\t\t<ul>\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\n\t\t\t\t<p className=\"equation\">\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\n\t\t\t\t</p>\n\t\t\t\tcomparisons)\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tCocktailSort: (\n\t\t<ul>\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\n\t\t\t\t<p className=\"equation\">\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\n\t\t\t\t</p>\n\t\t\t\tcomparisons)\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tEven though Cocktail Shaker Sort has the same big-O as Bubble Sort, it is still\n\t\t\t\tfaster; one case where it significantly outperforms Bubble Sort is when we have a\n\t\t\t\tsorted array, except for the last element which is the smallest, for example [2, 3,\n\t\t\t\t4, 5, 6, 7, 8, 9, 1]\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tInsertionSort: (\n\t\t<ul>\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\n\t\t\t\t<p className=\"equation\">\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\n\t\t\t\t</p>\n\t\t\t\tcomparisons)\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tQuickSelect: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case occurs when we pick a bad pivot everytime (for example, the smallest\n\t\t\t\tor largest element), since we can no longer subvide the array\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tQuickSort: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case occurs when we pick a bad pivot everytime (for example, the smallest\n\t\t\t\tor largest element), since we can no longer subvide the array and the algorithms\n\t\t\t\tbecomes similar to Selection Sort\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tSkipList: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tYou can get a degenerate SkipList by always adding with a constant amount of heads,\n\t\t\t\tfor example 0 or 4.\n\t\t\t</li>\n\t\t</ul>\n\t),\n};\n","import '../css/AlgoScreen.css';\nimport '../css/App.css';\nimport AnimationManager from '../anim/AnimationMain';\nimport Footer from '../components/Footer';\nimport Header from '../components/Header';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ReactGA from 'react-ga';\nimport { algoMap } from '../AlgoList';\nimport modals from '../examples/ExampleModals';\nimport { Toggle } from 'react-hook-theme';\nimport 'react-hook-theme/dist/styles/style.css';\n\nclass AlgoScreen extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tconst algoName = props.location.pathname.slice(1);\n\t\tthis.canvasRef = React.createRef();\n\t\tthis.animBarRef = React.createRef();\n\n\t\tthis.state = {\n\t\t\talgoName: algoName,\n\t\t\texamplesEnabled: false,\n\t\t\twidth: 0,\n\t\t};\n\t\tReactGA.pageview(algoName);\n\t}\n\n\tcomponentDidMount() {\n\t\tif (algoMap[this.state.algoName]) {\n\t\t\tthis.animManag = new AnimationManager(this.canvasRef, this.animBarRef);\n\n\t\t\tthis.currentAlg = new algoMap[this.state.algoName][1](\n\t\t\t\tthis.animManag,\n\t\t\t\tthis.canvasRef.current.width,\n\t\t\t\tthis.canvasRef.current.height,\n\t\t\t);\n\t\t\twindow.addEventListener('resize', this.updateDimensions);\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener('resize', this.updateDimensions);\n\t}\n\n\tupdateDimensions = () => {\n\t\tthis.animManag.changeSize(document.body.clientWidth);\n\t};\n\n\trender() {\n\t\tconst algoName = this.state.algoName;\n\t\tif (!algoMap[algoName]) {\n\t\t\treturn (\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<Header />\n\t\t\t\t\t<div className=\"content\">\n\t\t\t\t\t\t<div className=\"four-o-four\">\n\t\t\t\t\t\t\t<h1>404!</h1>\n\t\t\t\t\t\t\t<h3>\n\t\t\t\t\t\t\t\tAlgorithm not found! Click <Link to=\"/\">here</Link> to return to the\n\t\t\t\t\t\t\t\thome screen and choose another algorithm.\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Footer />\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\tconst header = algoMap[algoName][2] ? algoMap[algoName][2] : algoMap[algoName][0];\n\t\treturn (\n\t\t\t<div className=\"VisualizationMainPage\">\n\t\t\t\t<div id=\"container\">\n\t\t\t\t\t<div id=\"header\">\n\t\t\t\t\t\t<h1>\n\t\t\t\t\t\t\t<Link to=\"/\">&#x3008;</Link>&nbsp;&nbsp;{header}\n\t\t\t\t\t\t\t<div id='toggle'>\n\t\t\t\t\t\t\t\t<Toggle />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</h1>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div id=\"mainContent\">\n\t\t\t\t\t\t<div id=\"algoControlSection\">\n\t\t\t\t\t\t\t<table id=\"AlgorithmSpecificControls\"></table>\n\t\t\t\t\t\t\t{modals[algoName] && (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={this.state.examplesEnabled ? 'selected' : ''}\n\t\t\t\t\t\t\t\t\tid=\"examplesButton\"\n\t\t\t\t\t\t\t\t\tonClick={this.toggleExamples}\n\t\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"viewport\">\n\t\t\t\t\t\t\t<canvas\n\t\t\t\t\t\t\t\tid=\"canvas\"\n\t\t\t\t\t\t\t\twidth={this.state.width}\n\t\t\t\t\t\t\t\theight=\"505\"\n\t\t\t\t\t\t\t\tref={this.canvasRef}\n\t\t\t\t\t\t\t></canvas>\n\t\t\t\t\t\t\t{this.state.examplesEnabled && (\n\t\t\t\t\t\t\t\t<div className=\"modal\">\n\t\t\t\t\t\t\t\t\t<div className=\"modal-content\">{modals[algoName]}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div id=\"generalAnimationControlSection\">\n\t\t\t\t\t\t\t<table id=\"GeneralAnimationControls\" ref={this.animBarRef}></table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div id=\"footer\">\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t<Link to=\"/\">Return to Home Page</Link>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\ttoggleExamples = () => this.setState(state => ({ examplesEnabled: !state.examplesEnabled }));\n}\n\nAlgoScreen.propTypes = {\n\tlocation: PropTypes.object,\n};\n\nexport default AlgoScreen;\n","import React from 'react';\n\nconst AboutScreen = () => (\n\t<div className=\"about\">\n\t\t<p>\n\t\t\tThis is a tool to help you visualize and understand the data structures and algorithms\n\t\t\tcovered in Georgia Tech's CS1332 course. It is based on the{' '}\n\t\t\t<a href=\"https://www.cs.usfca.edu/~galles/visualization/about.html\">\n\t\t\t\tData Structures Visualizations website\n\t\t\t</a>{' '}\n\t\t\tby David Gales.\n\t\t</p>\n\t\t<p>\n\t\t\tThe CS1332 Visualization Tool was adapted and expanded by{' '}\n\t\t\t<a href=\"https://rodrigodlpontes.github.io/website/\">Rodrigo Pontes</a>, under the\n\t\t\tsupervision of Dr. Mary Hudachek-Buswell, to include data structures and algorithms\n\t\t\tcovered in the course. It has since received many additions and revisions from{' '}\n\t\t\t<a href=\"https://github.com/RodrigoDLPontes/visualization-tool#contributors-\">\n\t\t\t\tmany other wonderful contributors\n\t\t\t</a>\n\t\t\t.\n\t\t</p>\n\t\t<p>\n\t\t\tIt also includes icons from{' '}\n\t\t\t<a href=\"https://material.io/resources/icons/?style=baseline\">\n\t\t\t\tGoogle&#39;s Material Icons\n\t\t\t</a>\n\t\t\t, and components from <a href=\"https://material-ui.com/\">Material UI </a>\n\t\t\tand <a href='https://www.npmjs.com/package/react-hook-theme/v/1.2.5'>react-hook-theme</a>.\n\t\t</p>\n\t</div>\n);\n\nexport default AboutScreen;\n","import '../css/App.css';\nimport { Link, Route, Switch } from 'react-router-dom';\nimport { algoList, algoMap } from '../AlgoList';\nimport AboutScreen from './AboutScreen';\nimport Footer from '../components/Footer';\nimport Header from '../components/Header';\nimport React from 'react';\n\nconst HomeScreen = () => (\n\t<div className=\"container\">\n\t\t<Header />\n\t\t<div className=\"content\">\n\t\t\t<Switch>\n\t\t\t\t<Route exact path=\"/\">\n\t\t\t\t\t<div className=\"outer-flex\">\n\t\t\t\t\t\t<div className=\"inner-flex\">\n\t\t\t\t\t\t\t{algoList.map((name, idx) =>\n\t\t\t\t\t\t\t\talgoMap[name] ? (\n\t\t\t\t\t\t\t\t\t<Link to={`/${name}`} key={idx}>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"button\"\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\tvalue={algoMap[name][0]}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<div key={idx} className=\"divider\">\n\t\t\t\t\t\t\t\t\t\t<span>{name}</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Route>\n\t\t\t\t<Route path=\"/about\">\n\t\t\t\t\t<AboutScreen />\n\t\t\t\t</Route>\n\t\t\t</Switch>\n\t\t</div>\n\t\t<Footer />\n\t</div>\n);\n\nexport default HomeScreen;\n","import './css/App.css';\nimport { Route, BrowserRouter as Router, Switch } from 'react-router-dom';\nimport AlgoScreen from './screens/AlgoScreen';\nimport HomeScreen from './screens/HomeScreen';\nimport React from 'react';\nimport ReactGA from 'react-ga';\n\nconst App = () => {\n\tReactGA.initialize('UA-164374852-1');\n\tReactGA.pageview('home');\n\n\treturn (\n\t\t<Router basename={process.env.PUBLIC_URL + '/'}>\n\t\t\t<Switch>\n\t\t\t\t<Route exact path={['/', '/about']} component={HomeScreen} />\n\t\t\t\t<Route component={AlgoScreen} />\n\t\t\t</Switch>\n\t\t</Router>\n\t);\n};\n\nexport default App;\n","import App from './App';\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { ThemeProvider } from 'react-hook-theme';\n\nconst root = ReactDOM.createRoot(document.getElementById(\"root\")); \nroot.render(\n    <ThemeProvider\n    \toptions={{\n        \ttheme: 'light',\n        \tsave: true,\n    \t}}\n\t>\n        <App />\n    </ThemeProvider>\n);\n"],"sourceRoot":""}