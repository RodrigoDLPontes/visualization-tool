{"version":3,"sources":["anim/SingleAnimation.js","anim/UndoFunctions.js","anim/CustomEvents.js","anim/AnimatedObject.js","anim/AnimatedBTreeNode.js","anim/AnimatedCircle.js","anim/AnimatedCircularlyLinkedListNode.js","anim/AnimatedDoublyLinkedListNode.js","anim/AnimatedHighlightCircle.js","anim/AnimatedLabel.js","anim/AnimatedLine.js","anim/AnimatedLinkedListNode.js","anim/AnimatedRectangle.js","anim/AnimatedSkipListNode.js","anim/ObjectManager.js","anim/AnimationMain.js","components/Footer.js","components/Header.js","algo/Algorithm.js","algo/AVL.js","algo/LVA.js","algo/ArrayList.js","algo/util/GraphValues.js","algo/Graph.js","algo/BFS.js","algo/BST.js","algo/BTree.js","algo/BogoSort.js","algo/BoyerMoore.js","algo/BruteForce.js","algo/BubbleSort.js","algo/CircularlyLinkedList.js","algo/Hash.js","algo/ClosedHash.js","algo/CocktailSort.js","algo/DFS.js","algo/LCS.js","algo/DequeArray.js","algo/DequeLL.js","algo/util/PriorityQueue.js","algo/Dijkstras.js","algo/DoublyLinkedList.js","algo/Floyd.js","algo/Heap.js","algo/InsertionSort.js","algo/KMP.js","algo/Kruskals.js","algo/LSDRadix.js","algo/LinkedList.js","algo/MergeSort.js","algo/OpenHash.js","algo/Prims.js","algo/QueueArray.js","algo/QueueLL.js","algo/QuickSelect.js","algo/QuickSort.js","algo/RabinKarp.js","algo/SelectionSort.js","algo/SkipList.js","algo/SplayTree.js","algo/StackArray.js","algo/StackLL.js","algo/HeapSort.js","joke-algo/NonLinearProbing.js","AlgoList.js","examples/ExampleModals.js","screens/AlgoScreen.js","screens/AboutScreen.js","screens/HomeScreen.js","App.js","index.js"],"names":["SingleAnimation","id","fromX","fromY","toX","toY","this","objectID","UndoBlock","UndoMove","fmX","fmy","tx","ty","animationList","nextAnim","push","UndoCreate","world","removeObject","UndoHighlight","val","color","highlightValue","setHighlight","UndoSetHeight","height","setHeight","UndoSetWidth","width","setWidth","UndoSetNumElements","obj","newNumElems","sizeBeforeChange","getNumElements","sizeAfterChange","labels","Array","colors","i","getText","getTextColor","setNumElements","setText","setTextColor","UndoSetAlpha","alph","alphaVal","setAlpha","UndoSetNull","nv","nullVal","setNull","UndoSetPrevNull","setPrevNull","UndoSetNextNull","setNextNull","UndoSetForegroundColor","setForegroundColor","UndoSetBackgroundColor","setBackgroundColor","UndoSetHighlightIndex","index","setHighlightIndex","UndoSetText","str","newText","labelIndex","UndoSetTextColor","UndoHighlightEdge","from","to","fromID","toID","setEdgeHighlight","UndoSetEdgeThickness","thickness","setEdgeThickness","UndoSetEdgeColor","oldColor","setEdgeColor","UndoSetEdgeAlpha","oldAplha","alpha","setEdgeAlpha","UndoSetPosition","x","y","setNodePosition","UndoSetAlwaysOnTop","onTop","setAlwaysOnTop","UndoSetRectangleEdgeThickness","thicknessArray","setRectangleEdgeThickness","EventListener","events","kind","scope","func","scopeFunctions","length","functions","splice","undefined","event","objects","functs","j","call","AnimatedObject","backgroundColor","foregroundColor","highlighted","label","labelColor","layer","minHeightDiff","range","highlightIndex","highlightIndexDirty","addedToScene","newColor","newAlpha","value","highlightColor","Error","otherObject","right","getWidth","centerY","left","centerX","top","getHeight","bottom","xDelta","yDelta","xPos","yPos","frameNum","frameMod","delta","Math","abs","highlightDiff","hlIndex","AnimatedBTreeNode","widthPerElement","h","numLabels","labelColors","newNumElements","context","startX","isNaN","startY","strokeStyle","fillStyle","beginPath","moveTo","lineTo","closePath","stroke","fill","textAlign","textBaseline","labelX","labelY","fillText","anchor","textIndex","UndoDeleteBTreeNode","addBTreeNode","setLayer","AnimatedCircle","radius","getHeadPointerAttachPos","newWidth","xVec","yVec","len","sqrt","globalAlpha","arc","PI","lineWidth","font","strList","split","leftWidth","measureText","substring","centerWidth","textWidth","startingXForHighlight","leftStr","highlightStr","rightStr","mid","UndoDeleteCircle","addCircleObject","AnimatedCircularlyLinkedListNode","w","linkPercent","nullPointer","labelPosX","labelPosY","np","getClosestCardinalPoint","resetTextPosition","UndoDeleteCircularlyLinkedList","addCircularlyLinkedListObject","AnimatedDoublyLinkedListNode","prevNullPointer","nextNullPointer","closest","UndoDeleteDoublyLinkedList","pnp","nnp","addDoublyLinkedListObject","AnimatedHighlightCircle","UndoDeleteHighlightCircle","addHighlightCircleObject","AnimatedLabel","centered","initialWidth","strokeText","offset","indexOf","UndoDeleteLabel","addLabelObject","AnimatedLine","curve","directed","edgeLabel","anchorPoint","dirty","arrowHeight","arrowWidth","highlightVal","LINE_MAX_HEIGHT_DIFF","n","fromPos","getTailPointerAttachPos","toPos","deltaX","deltaY","midX","midY","controlX","controlY","quadraticCurveTo","midLen","sign","drawArrow","UndoConnect","createConnection","connectEdge","disconnect","AnimatedLinkedListNode","vertical","linkPosEnd","UndoDeleteLinkedList","addLinkedListObject","AnimatedRectangle","xJustify","yJustify","textColor","UndoDeleteRectangle","addRectangleObject","AnimatedSkipListNode","UndoDeleteSkipList","addSkipListObject","ObjectManager","canvasRef","nodes","edges","backEdges","activeLayers","ctx","current","getContext","framenum","statusReport","clearRect","alwaysOnTop","draw","pulseHighlight","shown","layers","resetLayers","objectColor","String","newNode","oldAlpha","nodeID","getAlpha","nextEdge","getHighlight","getHighlightIndex","objectIDfrom","objectIDto","undo","createUndoConnect","pop","deleted","undoStack","node2ID","identifier","len2","node1ID","oldObject","objectLabel","text","max","getTextWidth","lab","connectionPoint","fromObj","toObj","l","getNull","getLeftNull","getRightNull","setColor","id1","id2","alignTop","alignLeft","alignRight","getAlignRightPos","getAlignLeftPos","alignBottom","oldTop","oldHighlight","oldThickness","setThickness","oldEdgeThickness","getEdgeThickness","centering","newLabel","nodeLabel","linkPer","verticalOrientation","numElems","widthPerElem","newX","newY","getCookie","cookieName","cookies","document","cookie","substr","replace","unescape","setCookie","expireDays","exDate","Date","setDate","getDate","ANIMATION_SPEED_DEFAULT","addControlToAnimationBar","animBarRef","type","name","callback","element","createElement","setAttribute","onclick","onkeydown","tableEntry","appendChild","addDivisorToAnimationBar","divisorLeft","divisorRight","AnimationManager","objectManager","animatedObjects","animationPaused","awaitingStep","currentlyAnimating","animationSteps","currentAnimation","previousAnimationSteps","currFrame","animationBlockLength","currentBlock","doingUndo","undoAnimationStepIndices","undoAnimationStepIndicesStack","paused","canvas","skipBackButton","skipBack","stepBackButton","stepBack","playPauseBackButton","doPlayPause","stepForwardButton","step","skipForwardButton","skipForward","speed","parseInt","slider","Slider","defaultValue","onChange","e","setSpeed","controlBar","getElementById","newTable","midLevel","bottomLevel","ReactDOM","render","align","txtNode","createTextNode","heightEntry","field","changeSize","documentElement","clientWidth","intOnly","maxSize","size","keyASCII","window","keyCode","which","controlKey","sizeButton","addListener","animStarted","animEnded","animWaiting","animUndoUnavailable","percent","pausedValue","uppercase","toUpperCase","clr","charAt","newSpeed","floor","fireEvent","undoBlock","stopTimer","update","foundBreak","anyAnimations","act","params","commands","startNextBlock","startTimer","undoLastBlock","keepUndoing","finishUndoBlock","clearHistory","clearAllObjects","runFast","undoInitialStep","animateNext","addUndoAnimation","setAllLayers","lerp","getNodeX","getNodeY","disabled","timer","setTimeout","timeout","setPaused","clearInterval","move","removedEdges","deleteIncident","concat","getObject","createUndoDelete","connect","connectNext","connectPrev","connectCurve","connectSkipList","undoConnect","createCircle","createHighlightCircle","createRectangle","createLabel","createLinkedListNode","isArray","map","createDoublyLinkedListNode","createCircularlyLinkedListNode","createSkipListNode","createBTreeNode","oldText","oldThicknessArray","oldHeight","oldWidth","oldNull","oldElem","setPosition","oldX","oldY","oldIndex","bringToTop","moveToAlignRight","newXY","Footer","className","href","Header","state","menuVisible","toggleMenu","setState","Fragment","onClick","null","true","false","React","Component","addLabelToAlgorithmBar","labelName","group","addCheckboxToAlgorithmBar","boxLabel","checked","span","addRadioButtonGroupToAlgorithmBar","buttonNames","groupName","buttonList","button","topLevelTableEntry","addControlToAlgorithmBar","addDivisorToAlgorithmBar","addGroupToAlgorithmBar","horizontal","parentGroup","Algorithm","am","animationManager","disableUI","enableUI","canvasWidth","canvasHeight","actionHistory","recordAnimation","code","start_x","start_y","line_height","standard_color","codeID","console","log","nextIndex","cmd","ind1","ind2","reset","args","next","retVal","startNewAnimation","input","maxLen","test","funct","maxsize","newHeight","prototype","returnSubmitFloat","addReturnSubmit","action","returnSubmit","AVL","first_print_pos_y","PRINT_VERTICAL_GAP","print_max","startingX","addControls","EXPLANITORY_TEXT_X","EXPLANITORY_TEXT_Y","controls","insertField","insertCallback","bind","insertButton","deleteField","deleteCallback","deleteButton","findField","findCallback","findButton","printButton","printCallback","clearButton","clearCallback","predSuccButtonList","predButton","succButton","predSucc","treeRoot","insertedValue","normalizeNumber","implementAction","add","deletedValue","remove","findValue","findElement","printTree","clear","highlightID","firstLabel","HIGHLIGHT_COLOR","xPosOfNextLabel","FIRST_PRINT_POS_X","yPosOfNextLabel","printTreeRec","tree","nextLabelID","data","PRINT_COLOR","PRINT_HORIZONTAL_GAP","doFind","graphicID","curr","LINK_COLOR","remakeTree","addH","resizeTree","treeNodeID","heightLabelID","bfLabelID","STARTING_Y","FOREGROUND_COLOR","BACKGROUND_COLOR","HEIGHT_LABEL_COLOR","AVLNode","parent","connectSmart","balance","some","LINK_OPACITY","updateHeightAndBF","bf","HIGHLIGHT_LABEL_COLOR","singleRotateRight","singleRotateLeft","B","A","t2","isLeftChild","removeH","deleteNode","dummy","removeSucc","removePred","startingPoint","resizeWidths","rightWidth","setNewPositions","animateNewPositions","xPosition","yPosition","side","heightLabelX","bfLabelX","heightLabelY","bfLabelY","HEIGHT_DELTA","WIDTH_DELTA","recClear","hid","bfid","initialX","initialY","node","r","HIGHLIGHT_LINK_COLOR","HIGHLIGHT_CIRCLE_COLOR","LVA","rightLeftButtonList","rightButton","leftButton","rightLeft","LVANode","ArrayList","setup","addVerticalGroup","addTopHorizontalGroup","addBottomHorizontalGroup","addValueField","addIndexCallback","addIndexField","addFrontButton","addFrontCallback","addBackButton","addBackCallback","addIndexButton","removeVerticalGroup","removeTopHorizontalGroup","removeBottomHorizontalGroup","removeField","removeIndexCallback","removeIndexButton","removeFrontButton","removeFrontCallback","removeBackButton","removeBackCallback","arrayID","arrayLabelID","arrayData","xpos","ypos","highlight1ID","addVal","resize","clearAll","elemToAdd","labPushID","labPushValID","arrayMoveID","labPopValID","labPushResizeID","arrayIDNew","arrayLabelIDNew","arrayDataNew","xposinit","yposinit","LARGE_ALLOWED","LARGE_CURVE","LARGE_X_POS_LOGICAL","LARGE_Y_POS_LOGICAL","SMALL_ALLLOWED","SMALL_CURVE","SMALL_X_POS_LOGICAL","SMALL_Y_POS_LOGICAL","BFS_DFS_ADJ_LIST","row","DIJKSTRAS_ADJ_LIST","Number","PRIMS_KRUSKALS_ADJ_LIST","KRUSKALS_DS_COLORS","Graph","defaultEdges","dir","dag","costs","currentLayer","isDAG","showEdgeCosts","setup_small","addDirection","verticalGroup","newGraphButton","newGraphCallback","defaultGraphButton","defaultGraphCallback","radioButtonList","undirectedGraphButton","directedGraphCallback","directedGraphButton","smallGraphButton","smallGraphCallback","largeGraphButton","largeGraphCallback","logicalButton","graphRepChangedCallback","adjacencyListButton","adjacencyMatrixButton","newDirected","resetAll","setup_large","newLayer","adj_matrix","adj_list_edges","adj_matrixID","circleID","highlightCircleL","x_pos_logical","y_pos_logical","highlightCircleAL","adj_list_x_start","adj_list_width","adj_list_y_start","adj_list_height","highlightCircleAM","adj_matrix_x_start","adj_matrix_width","adj_matrix_y_start","adj_matrix_height","clearEdges","buildEdges","adjustCurveForDirectedEdges","allowed","adj_list_elem_width","adj_list_elem_height","adj_list_spacing_after_list","adj_list_spacing_between_nodes","isLarge","bidirectional","toStr","edgePercent","random","buildAdjList","buildAdjMatrix","adj_matrix_index_x","adj_matrix_index_y","adj_list_list","adj_list_index","lastElem","nextXPos","hasEdges","vertex","fromCharCode","control","BFS","startField","startCallback","startButton","adjMatrix","messageID","visited","queueID","listID","visitedID","infoLabelID","VISITED_START_X","VISITED_START_Y","LIST_START_X","LIST_START_Y","QUEUE_START_X","QUEUE_START_Y","lastIndex","startvalue","charCodeAt","doBFS","startVetex","queue","rebuildEdges","shift","visitVertex","neighbor","highlightEdge","leaveVertex","BST","toClear","traversalButtonList","preOrderSelect","inOrderSelect","postOrderSelect","levelOrderSelect","traversal","traverseButton","traverseCallback","traverse","passedCodeID","unhighlight","highlight","preOrderRec","clearOldObjects","levelOrder","setUpPseudocode","postOrderRec","forEach","BSTNode","tailoredCode","MESSAGE_X","MESSAGE_Y","BTree","starting_x","preemptiveSplit","max_keys","min_keys","split_index","max_degree","moveLabel1ID","moveLabel2ID","splitIndexButtonList","splitSecondSelect","splitThirdSelect","predCallback","succCallback","ignoreInputs","newMaxDegree","changeDegree","insertElement","deleteElement","clearTree","premptiveSplitBox","changePreemtiveSplit","newValue","isLeaf","numKeys","keys","getLabelX","children","deleteTree","degree","newDegree","maxDegreeRadioButtons","findInTree","BTreeNode","insertNotFull","insert","insertValue","insertIndex","findIndex","newTree","insertRepair","rightNode","currentParent","parentIndex","risingNode","leftNode","doDeleteNotEmpty","doDelete","nextNode","stealFromLeft","mergeRight","stealFromRight","maxNode","minNode","repairAfterDelete","parentNode","rightSib","fromParentIndex","tmpLabel1","tmpLabel2","leftSib","WIDTH_PER_ELEM","leftEdge","priorWidth","widths","treeWidth","BogoSort","horizontalGroup","listField","sortCallback","sortButton","displayData","iPointerID","jPointerID","comparisonCountID","warningID","iterations","removeCode","list","filter","sort","slice","elemCounts","Map","letterMap","count","has","get","set","toString","currChar","cell","sorted","shuffle","iXPos","jXPos","swap","temp","galilRuleEnabled","BoyerMoore","textField","patternField","blotButton","buildLastOccurrenceTableCallback","galilButton","toggleGalilRule","textRowID","comparisonMatrixID","patternTableLabelID","patternTableCharacterID","patternTableIndexID","lastTableLabelID","lastTableCharacterID","lastTableValueID","periodLabelID","compCount","period","pattern","find","onlyBuildLastOccurrenceTable","maxRows","getMaxRows","cellSize","col","lastTable","buildLastTable","buildFailureTable","k","textLength","labelsX","PATTERN_START_Y","LAST_TABLE_START_Y","patternTableStartX","lotStartX","lotPointerID","Object","char","startIndex","failureTableLabelID","failureTableCharacterID","failureTableValueID","FAILURE_TABLE_START_Y","tableStartX","failureTable","ftPeriodLabel","BruteForce","lastSwapEnabled","BubbleSort","lastSwapCheckbox","toggleLastSwap","addCodeToCanvasBase","ARRAY_START_X","end","lastSwapped","movePointers","iLabelID","jLabelID","CircularlyLinkedList","initialIndex","linkedListElemID","leftoverLabelID","resetNodePositions","labCopiedValID","copiedData","firstNodeID","lastX","lastY","LINKED_LIST_ELEM_HEIGHT","nextX","nextY","labPopID","nodePosX","LINKED_LIST_START_X","secondNodeY","LINKED_LIST_START_Y","removedNodeIndex","Hash","hashingIntegers","keyField","valueField","loadField","changeLoadFactor","loadButton","loadFactorCallBack","hashIntegerButton","changeHashTypeCallback","hashStringButton","newHashingIntegers","changeHashType","newHashingIntegerValue","labelID1","labelID2","table_size","currHash","HASH_LABEL_X","indexXPos","indexYPos","label1","wordToHashID","wordToHash","digits","hashValue","nextByte","nextByteID","resultDigits","floatingDigits","floatingVals","operatorID","barID","nextChar","carry","HASH_NUMBER_START_X","label2","HASH_NUMBER_START_Y","insertedKey","newLF","ELEMS_PER_ROW","ClosedHash","elements_per_row","linearProblingButton","linearProbeCallback","quadraticProbingButton","quadraticProbeCallback","doubleHashingButton","doubleHashingCallback","currentHashingTypeButtonState","newProbingType","skipDist","changeProbeType","key","entry","MapEntry","elem","load_factor","ExplainLabel","doHash","getEmptyIndex","hashTableValues","labID","hashTableVisual","empty","DelIndexLabel","labelID","skipVal","nextLowestPrime","HashID","resetSkipDist","probes","removedIndex","start","HashIndexID","foundIndex","candidateIndex","getElemIndex","fromCycle","resizeLabel","loadFactorID","oldHashTableVisual","oldHashTableValues","oldskipDist","oldempty","olddeleted","oldIndexXPos","oldIndexYPos","oldindexLabelID","indexLabelID","nextYPos","elementsMoved","oldElement","LF","resetIndex","HASH2_LABEL_X","HASH2_LABEL_Y","CocktailSort","DFS","physicalStack","recursiveStackButton","stackCallback","physicalStackButton","stackID","stackLabelID","physical","doDFSStack","doDFSRecursive","startVertex","stack","stackStartY","stackSpacing","vertexID","recursionSpacingX","recursionSpacingY","currentID","dfsVisit","currVertex","messageX","nextMessage","LCS","S1Field","runCallback","S2Field","tableButton","oldIDs","string1","string2","run","str1","str2","clearOldIDs","buildTable","moveID","tableID","tableVals","S1TableID","S2TableID","tableXPos","tableYPos","buildLCSFromTable","TABLE_START_Y","TABLE_START_X","currX","currY","sequence","header","SEQUENCE_START_Y","topThick","leftThick","nextSequenceID","DequeArray","addField","addFirstButton","addFirstCallBack","addLastButton","addLastCallback","removeFirstButton","removeFirstCallback","removeLastButton","removeLastCallback","frontID","frontLabelID","frontPointerID","sizeID","sizeLabelID","front","ARRAY_START_Y","pushVal","addLast","removeFirst","removeLast","addFirst","elemToAddLast","labAddLastID","labAddLastValID","addIndex","QUEUE_LABEL_X","labelAddID","labelAddIDVal","frontxpos","frontypos","labremoveFirstID","labremoveFirstValID","removeFirstdVal","remLabelID","remLabelValID","remIndex","highlight2ID","removedVal","elemToEnqueue","isFront","labEnqueueID","labEnqueueValID","labEnqueueResizeID","frontOffset","extra","QUEUE_RESIZE_LABEL_X","labEnqueueValIDNew","DequeLL","addFirstCallback","PriorityQueue","backingArray","priority","a","b","Dijkstras","distance","distanceID","pq","tableEntryHeight","comparisonMessageID","doDijkstra","enqueue","includes","dequeue","pqIDs","getIDs","curDist","edgDist","newDist","oldDist","oldDistStr","newPqIDs","DoublyLinkedList","Floyd","costTable","pathTable","alwaysUseINF","cost_table_width","cost_table_height","cost_table_start_x","cost_table_start_y","path_table_width","path_table_height","path_table_start_x","path_table_start_y","node_1_x_pos","node_1_y_pos","node_2_x_pos","node_2_y_pos","node_3_x_pos","node_3_y_pos","message_x","message_y","costTableID","pathTableID","pathIndexXID","pathIndexYID","costIndexXID","costIndexYID","node3ID","costTableHeader","pathTableHeader","getCostLabel","doFloydWarshall","LENGTH","HEAP_X_POSITIONS","HEAP_Y_POSITIONS","Heap","array_size","order","removeButton","removeCallback","buildHeapField","buildHeapCallback","buildHeapButton","minMaxButtonList","minHeapButton","minHeapCallback","maxHeapButton","maxHeapCallback","isMinHeap","arrayLabels","arrayRects","circleObjs","arrayXPositions","currentHeapSize","swapLabel1","swapLabel2","swapLabel3","swapLabel4","descriptLabel1","descriptLabel2","descriptLabel3","createArray","buildHeap","index1","index2","tmp","childIndex","setIndexHighlight","downheapCheckRightChild","downheapCompare","pushDown","unshift","min","nextElem","MAX_SIZE","currentIndex","upheapCompare","resizeLabelID","oldSize","newArrayData","newArrayLabels","newArrayRects","newCircleObjs","newArrayXPositions","InsertionSort","KMP","bftButton","buildFailureTableCallback","onlyBuildFailureTable","fjPointerID","f0PointerID","f1PointerID","nextAlignment","Kruskals","setID","setIndexID","setData","edgesListLeftID","edgesListRightID","SET_ARRAY_START_X","messageLabelID","SET_ARRAY_START_Y","edgesListLeft","edgesListRight","doKruskal","recolorGraph","EDGE_LIST_START_X","tmpLeftID","tmpRightID","tmpLeft","tmpRight","edgeCount","findLabelLeft","findLabelRight","highlightCircle1","highlightCircle2","highlightCircle3","edgesAdded","nextListIndex","CURRENT_LABEL_X","CURRENT_LABEL_Y","newPos","leftRoot","rightRoot","minRoot","maxRoot","firstMatch","LSDRadix","arrayDisplay","bucketsData","bucketsID","bucketsDisplay","greatest","log10","longData","display","digit","nthDigit","idBucket","dataBucket","displayBucket","BUCKETS_START_Y","pow","LinkedList","topID","topLabelID","MergeSort","kPointerID","ceil","leftHelper","rightHelper","merge","prevOffset","tempArrayID","drawArrayAndCopy","extraOffset","copyData","currOffset","leftOffset","rightOffset","currArrayID","tempArray","tempDisplay","bottomYPos","kXPos","topYPos","movePointer","fromIndex","toIndex","fromOffset","toOffset","fromRow","toRow","cellID","pointerID","fromXPos","fromYPos","toXPos","toYPos","POINTER_ARRAY_ELEM_WIDTH","OpenHash","POINTER_ARRAY_ELEM_Y","hashTableIndices","nextID","LinkedListNode","old","found","prev","compareIndex","EXPLAIN_LABEL_Y","repositionList","POINTER_ARRAY_ELEM_START_X","RESIZE_POINTER_ARRAY_ELEM_START_X","tmpPrev","oldHashTableIndices","repositionResizeList","Prims","doPrim","weight","edge","edgeID","edgeStr","QueueArray","enqueueField","enqueueCallback","enqueueButton","dequeueButton","dequeueCallback","labIndexID","labIndexValID","newTail","labDequeueID","labDequeueValID","dequeuedVal","QueueLL","tail_pos_y","tail_label_y","headID","headLabelID","tailID","tailLabelID","elemToPush","resetLinkedListPositions","QuickSelect","kField","pivotButtonList","randomPivotSelect","minPivotSelect","firstPivotSelect","perfectPivotSelect","pivotType","pPointerID","helper","pivot","midIndex","pXPos","swapPivot","other","moveJ","lLabelID","lXPos","pLabelID","QuickSort","RabinKarp","baseField","baseButton","baseCallback","baseLabelID","characterValuesLabelID","textHashLabelID","textHashCalculationID","patternHashLabelID","patternHashCalculationID","baseValue","toLowerCase","textCalculation","textHash","patternCalculation","patternHash","base","runningBase","calculationsX","SelectionSort","minButton","minCallback","maxButton","maxCallback","isMin","circleShift","toSwap","compare","SkipList","topHorizontalGroup","bottomHorizontalGroup","verticalGroupRandom","topHorizontalGroupRandom","bottomHorizontalGroupRandom","addWithHeadsCallback","headsField","addWithHeadsButton","addValueFieldRandom","addRandomlyCallback","addRandomlyButton","getField","getCallback","getButton","NEGATIVE_INFINITY","POSITIVE_INFINITY","SKIP_LIST_START_X","heads","valueLabelId","valueStringId","cfLabelId","cfStringId","expLabelID","headsString","rightPhantomsCol","newCol","foundDuplicate","nextCol","getNextCol","shiftColumns","prevCol","getPrevCol","removedCol","maxHeight","leftPhantomID","rightPhantomID","SplayTree","splay","zigZigRight","doubleRotateRight","zigZigLeft","doubleRotateLeft","treeRot","splayUp","insertElem","treeDelete","valueToDelete","inTree","oldGraphicID","largestLeft","findMax","C","t3","StackArray","pushField","pushCallback","pushButton","popButton","popCallback","clearData","popVal","StackLL","HeapSort","heapArrayData","heapArrayID","heapArrayLabelID","heapTreeObj","displayDataTemp","createHeap","heapArrayXPositions","remData","removedElementID","ARRAY_INITIAL_Y","compareWithLetters","num1","num2","EQUATIONS","equation","sin","NonLinearProbing","fillButton","fillCallback","indexEqYPos","nextEqYPos","fillMap","emptySpaces","algoMap","algos","Dijkstra","Prim","Kruskal","jokeAlgo","algoList","style","listStyle","src","alt","role","aria-label","AlgoScreen","props","updateDimensions","animManag","body","toggleExamples","examplesEnabled","algoName","location","pathname","createRef","ReactGA","pageview","currentAlg","addEventListener","removeEventListener","modals","ref","AboutScreen","HomeScreen","exact","path","idx","App","initialize","basename","component"],"mappings":"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AAI+qB,EAAMC,EA5iB3B,IAyjBxB,OAVAltB,KAAK8sB,QAAU9sB,KAAK6tB,WACpB7tB,KAAK+sB,aAAe/sB,KAAK8tB,gBACzB9tB,KAAKgtB,UAAYhtB,KAAK+tB,aAET,MAATtqB,IACHzD,KAAKkjB,UAAYljB,KAAKkjB,UAAYljB,KAAK0a,MAGxC1a,KAAK0a,KAAO1a,KAAK0a,KAAO,EAEjB1a,KAAKsc,W,iCAIZtc,KAAKsc,SAAW,GAChB,IAAK,IAAIpa,EAAI,EAAGA,EAAIlC,KAAK0a,KAAMxY,IAC9BlC,KAAKmjB,IAAI/G,GAAI9Z,QAAStC,KAAK8sB,QAAQ5qB,GAAI,IACvClC,KAAKgtB,UAAU9qB,GAAK,KAGrB,OADAlC,KAAK0a,KAAO,EACL1a,KAAKsc,W,kCAIZ,IAAK,IAAIpa,EAAI,EAAGA,EAAIlC,KAAK8kB,SAAS9e,OAAQ9D,IACzClC,KAAK8kB,SAAS5iB,GAAGob,UAAW,I,iCAK7B,IAAK,IAAIpb,EAAI,EAAGA,EAAIlC,KAAK8kB,SAAS9e,OAAQ9D,IACzClC,KAAK8kB,SAAS5iB,GAAGob,UAAW,M,GA/jBQ2E,I,QCrDjCiM,GAAgB,CACrB,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GAED,EACC,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAIIC,GAAc,CACnB,CAAC,EAAG,GAAI,GAAK,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAAM,EAAG,EAAG,GAC1D,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,GAAK,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,KACrD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,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","file":"static/js/main.e96df827.chunk.js","sourcesContent":["export default class SingleAnimation {\n\tconstructor(id, fromX, fromY, toX, toY) {\n\t\tthis.objectID = id;\n\t\tthis.fromX = fromX;\n\t\tthis.fromY = fromY;\n\t\tthis.toX = toX;\n\t\tthis.toY = toY;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Base \"class\": UndoBlock\n\nimport SingleAnimation from './SingleAnimation';\n\nexport class UndoBlock {\n\taddUndoAnimation() {\n\t\treturn false;\n\t}\n\n\tundoInitialStep() {}\n}\n\nexport class UndoMove extends UndoBlock {\n\tconstructor(id, fmX, fmy, tx, ty) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.fromX = fmX;\n\t\tthis.fromY = fmy;\n\t\tthis.toX = tx;\n\t\tthis.toY = ty;\n\t}\n\n\taddUndoAnimation(animationList) {\n\t\tconst nextAnim = new SingleAnimation(\n\t\t\tthis.objectID,\n\t\t\tthis.fromX,\n\t\t\tthis.fromY,\n\t\t\tthis.toX,\n\t\t\tthis.toY,\n\t\t);\n\t\tanimationList.push(nextAnim);\n\t\treturn true;\n\t}\n}\n\nexport class UndoCreate extends UndoBlock {\n\tconstructor(id) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.removeObject(this.objectID);\n\t}\n}\n\nexport class UndoHighlight extends UndoBlock {\n\tconstructor(id, val, color) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.highlightValue = val;\n\t\tthis.color = color;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setHighlight(this.objectID, this.highlightValue, this.color);\n\t}\n}\n\nexport class UndoSetHeight extends UndoBlock {\n\tconstructor(id, val) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.height = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setHeight(this.objectID, this.height);\n\t}\n}\n\nexport class UndoSetWidth extends UndoBlock {\n\tconstructor(id, val) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.width = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setWidth(this.objectID, this.width);\n\t}\n}\n\nexport class UndoSetNumElements extends UndoBlock {\n\tconstructor(obj, newNumElems) {\n\t\tsuper();\n\t\tthis.objectID = obj.objectID;\n\t\tthis.sizeBeforeChange = obj.getNumElements();\n\t\tthis.sizeAfterChange = newNumElems;\n\t\tif (this.sizeBeforeChange > this.sizeAfterChange) {\n\t\t\tthis.labels = new Array(this.sizeBeforeChange - this.sizeAfterChange);\n\t\t\tthis.colors = new Array(this.sizeBeforeChange - this.sizeAfterChange);\n\t\t\tfor (let i = 0; i < this.sizeBeforeChange - this.sizeAfterChange; i++) {\n\t\t\t\tthis.labels[i] = obj.getText(i + this.sizeAfterChange);\n\t\t\t\tthis.colors[i] = obj.getTextColor(i + this.sizeAfterChange);\n\t\t\t}\n\t\t}\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNumElements(this.objectID, this.sizeBeforeChange);\n\t\tif (this.sizeBeforeChange > this.sizeAfterChange) {\n\t\t\tfor (let i = 0; i < this.sizeBeforeChange - this.sizeAfterChange; i++) {\n\t\t\t\tworld.setText(this.objectID, this.labels[i], i + this.sizeAfterChange);\n\t\t\t\tworld.setTextColor(this.objectID, this.colors[i], i + this.sizeAfterChange);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class UndoSetAlpha extends UndoBlock {\n\tconstructor(id, alph) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.alphaVal = alph;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setAlpha(this.objectID, this.alphaVal);\n\t}\n}\n\nexport class UndoSetNull extends UndoBlock {\n\tconstructor(id, nv) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.nullVal = nv;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNull(this.objectID, this.nullVal);\n\t}\n}\n\nexport class UndoSetPrevNull extends UndoBlock {\n\tconstructor(id, nv) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.nullVal = nv;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setPrevNull(this.objectID, this.nullVal);\n\t}\n}\n\nexport class UndoSetNextNull extends UndoBlock {\n\tconstructor(id, nv) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.nullVal = nv;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNextNull(this.objectID, this.nullVal);\n\t}\n}\n\nexport class UndoSetForegroundColor extends UndoBlock {\n\tconstructor(id, color) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.color = color;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setForegroundColor(this.objectID, this.color);\n\t}\n}\n\nexport class UndoSetBackgroundColor extends UndoBlock {\n\tconstructor(id, color) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.color = color;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setBackgroundColor(this.objectID, this.color);\n\t}\n}\n\nexport class UndoSetHighlightIndex extends UndoBlock {\n\tconstructor(id, index) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.index = index;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setHighlightIndex(this.objectID, this.index);\n\t}\n}\n\nexport class UndoSetText extends UndoBlock {\n\tconstructor(id, str, index) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.newText = str;\n\t\tthis.labelIndex = index;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setText(this.objectID, this.newText, this.labelIndex);\n\t}\n}\n\nexport class UndoSetTextColor extends UndoBlock {\n\tconstructor(id, color, index) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.color = color;\n\t\tthis.index = index;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setTextColor(this.objectID, this.color, this.index);\n\t}\n}\n\nexport class UndoHighlightEdge extends UndoBlock {\n\tconstructor(from, to, val) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.highlightValue = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeHighlight(this.fromID, this.toID, this.highlightValue);\n\t}\n}\n\nexport class UndoSetEdgeThickness extends UndoBlock {\n\tconstructor(from, to, val) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.thickness = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeThickness(this.fromID, this.toID, this.thickness);\n\t}\n}\n\nexport class UndoSetEdgeColor extends UndoBlock {\n\tconstructor(from, to, oldColor) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.color = oldColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeColor(this.fromID, this.toID, this.color);\n\t}\n}\n\nexport class UndoSetEdgeAlpha extends UndoBlock {\n\tconstructor(from, to, oldAplha) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.alpha = oldAplha;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeAlpha(this.fromID, this.toID, this.alpha);\n\t}\n}\n\nexport class UndoSetPosition extends UndoBlock {\n\tconstructor(id, x, y) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t}\n}\n\nexport class UndoSetAlwaysOnTop extends UndoBlock {\n\tconstructor(id, onTop) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.onTop = onTop;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setAlwaysOnTop(this.objectID, this.onTop);\n\t}\n}\n\nexport class UndoSetRectangleEdgeThickness extends UndoBlock {\n\tconstructor(id, thicknessArray) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.thicknessArray = thicknessArray;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setRectangleEdgeThickness(this.objectID, this.thicknessArray);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nexport default class EventListener {\n\tconstructor() {\n\t\tthis.events = [];\n\t}\n\n\tremoveListener(kind, scope, func) {\n\t\tif (this.events[kind] == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet scopeFunctions = null;\n\t\tlet i;\n\t\tfor (i = 0; i < this.events[kind].length; i++) {\n\t\t\tif (this.events[kind][i].scope === scope) {\n\t\t\t\tscopeFunctions = this.events[kind][i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (scopeFunctions == null) {\n\t\t\treturn;\n\t\t}\n\t\tfor (i = 0; i < scopeFunctions.functions.length; i++) {\n\t\t\tif (scopeFunctions.functions[i] === func) {\n\t\t\t\tscopeFunctions.functions.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\taddListener(kind, scope, func) {\n\t\tif (this.events[kind] === undefined) {\n\t\t\tthis.events[kind] = [];\n\t\t}\n\t\tlet i;\n\t\tlet scopeFunctions = null;\n\t\tfor (i = 0; i < this.events[kind].length; i++) {\n\t\t\tif (this.events[kind][i].scope === scope) {\n\t\t\t\tscopeFunctions = this.events[kind][i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (scopeFunctions === null) {\n\t\t\tthis.events[kind].push({ scope: scope, functions: [] });\n\t\t\tscopeFunctions = this.events[kind][this.events[kind].length - 1];\n\t\t}\n\t\tfor (i = 0; i < scopeFunctions.functions.length; i++) {\n\t\t\tif (scopeFunctions.functions[i] === func) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tscopeFunctions.functions.push(func);\n\t}\n\n\tfireEvent(kind, event) {\n\t\t// TODO:  Should add a deep clone here ...\n\t\tif (this.events[kind] !== undefined) {\n\t\t\tfor (let i = 0; i < this.events[kind].length; i++) {\n\t\t\t\tconst objects = this.events[kind][i];\n\t\t\t\tconst functs = objects.functions;\n\t\t\t\tconst scope = objects.scope;\n\t\t\t\tfor (let j = 0; j < functs.length; j++) {\n\t\t\t\t\tconst func = functs[j];\n\t\t\t\t\tfunc.call(scope, event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nexport default class AnimatedObject {\n\tconstructor() {\n\t\tthis.objectID = -1;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\n\t\tthis.backgroundColor = '#FFFFFF';\n\t\tthis.foregroundColor = '#000000';\n\t\tthis.highlighted = false;\n\n\t\tthis.label = '';\n\t\tthis.labelColor = '#000000';\n\n\t\tthis.layer = 0;\n\t\tthis.alpha = 1.0;\n\t\tthis.minHeightDiff = 3;\n\t\tthis.range = 5;\n\n\t\tthis.highlightIndex = -1;\n\t\tthis.highlightIndexDirty = true;\n\n\t\tthis.addedToScene = true;\n\t}\n\n\tsetBackgroundColor(newColor) {\n\t\tthis.backgroundColor = newColor;\n\t}\n\n\tsetNull() {}\n\n\tgetNull() {\n\t\treturn false;\n\t}\n\n\tsetAlpha(newAlpha) {\n\t\tthis.alpha = newAlpha;\n\t}\n\n\tgetAlpha() {\n\t\treturn this.alpha;\n\t}\n\n\tsetForegroundColor(newColor) {\n\t\tthis.foregroundColor = newColor;\n\t\tthis.labelColor = newColor;\n\t}\n\n\tgetHighlight() {\n\t\treturn this.highlighted;\n\t}\n\n\tgetWidth() {\n\t\t// TODO:  Do we want to throw here?  Should always override this ...\n\t\treturn 0;\n\t}\n\n\tgetHeight() {\n\t\t// TODO:  Do we want to throw here?  Should always override this ...\n\t\treturn 0;\n\t}\n\n\tsetHighlight(value, color) {\n\t\tthis.highlighted = value;\n\t\tthis.highlightColor = color || '#ff0000';\n\t}\n\n\tcenterX() {\n\t\treturn this.x;\n\t}\n\n\tsetWidth() {\n\t\tthrow new Error('setWidth() should be implemented in a base class');\n\t}\n\n\tcenterY() {\n\t\treturn this.y;\n\t}\n\n\tgetAlignLeftPos(otherObject) {\n\t\treturn [otherObject.right() + this.getWidth() / 2, otherObject.centerY()];\n\t}\n\n\tgetAlignRightPos(otherObject) {\n\t\treturn [otherObject.left() - this.getWidth() / 2, otherObject.centerY()];\n\t}\n\n\tgetAlignTopPos(otherObject) {\n\t\treturn [otherObject.centerX(), otherObject.top() - this.getHeight() / 2];\n\t}\n\n\tgetAlignBottomPos(otherObject) {\n\t\treturn [otherObject.centerX(), otherObject.bottom() + this.getHeight() / 2];\n\t}\n\n\talignLeft(otherObject) {\n\t\t// Assuming centering.  Overridden method could modify if not centered\n\t\t//  (See AnimatedLabel, for instance)\n\t\tthis.y = otherObject.centerY();\n\t\tthis.x = otherObject.right() + this.getWidth() / 2;\n\t}\n\n\talignRight(otherObject) {\n\t\t// Assuming centering.  Overridden method could modify if not centered\n\t\t//  (See AnimatedLabel, for instance)\n\t\tthis.y = otherObject.centerY();\n\t\tthis.x = otherObject.left() - this.getWidth() / 2;\n\t}\n\n\talignTop(otherObject) {\n\t\t// Assuming centering.  Overridden method could modify if not centered\n\t\tthis.x = otherObject.centerX();\n\t\tthis.y = otherObject.top() - this.getHeight() / 2;\n\t}\n\n\talignBottom(otherObject) {\n\t\tthis.x = otherObject.centerX();\n\t\tthis.y = otherObject.bottom() + this.getHeight() / 2;\n\t}\n\n\tgetClosestCardinalPoint(fromX, fromY) {\n\t\tlet xDelta;\n\t\tlet yDelta;\n\t\tlet xPos;\n\t\tlet yPos;\n\n\t\tif (fromX < this.left()) {\n\t\t\txDelta = this.left() - fromX;\n\t\t\txPos = this.left();\n\t\t} else if (fromX > this.right()) {\n\t\t\txDelta = fromX - this.right();\n\t\t\txPos = this.right();\n\t\t} else {\n\t\t\txDelta = 0;\n\t\t\txPos = this.centerX();\n\t\t}\n\n\t\tif (fromY < this.top()) {\n\t\t\tyDelta = this.top() - fromY;\n\t\t\tyPos = this.top();\n\t\t} else if (fromY > this.bottom()) {\n\t\t\tyDelta = fromY - this.bottom();\n\t\t\tyPos = this.bottom();\n\t\t} else {\n\t\t\tyDelta = 0;\n\t\t\tyPos = this.centerY();\n\t\t}\n\n\t\tif (yDelta > xDelta) {\n\t\t\txPos = this.centerX();\n\t\t} else {\n\t\t\tyPos = this.centerY();\n\t\t}\n\n\t\treturn [xPos, yPos];\n\t}\n\n\tcentered() {\n\t\treturn false;\n\t}\n\n\tpulseHighlight(frameNum) {\n\t\tif (this.highlighted) {\n\t\t\tconst frameMod = frameNum / 7.0;\n\t\t\tconst delta = Math.abs((frameMod % (2 * this.range - 2)) - this.range + 1);\n\t\t\tthis.highlightDiff = delta + this.minHeightDiff;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos() {\n\t\treturn [this.x, this.y];\n\t}\n\n\tgetHeadPointerAttachPos() {\n\t\treturn [this.x, this.y];\n\t}\n\n\tidentifier() {\n\t\treturn this.objectID;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColor;\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColor = color;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t}\n\n\tsetHighlightIndex(hlIndex) {\n\t\tthis.highlightIndex = hlIndex;\n\t\tthis.highlightIndexDirty = true;\n\t}\n\n\tgetHighlightIndex() {\n\t\treturn this.highlightIndex;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nconst MIN_WIDTH = 10;\nconst EDGE_POINTER_DISPLACEMENT = 5;\n\nexport default class AnimatedBTreeNode extends AnimatedObject {\n\tconstructor(objectID, widthPerElement, h, numLabels, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\n\t\tthis.widthPerElement = widthPerElement;\n\t\tthis.h = h;\n\t\tthis.numLabels = numLabels;\n\t\tthis.labels = [];\n\t\tthis.labelColors = [];\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tthis.labelColors[i] = this.foregroundColor;\n\t\t}\n\t}\n\n\tgetNumElements() {\n\t\treturn this.numLabels;\n\t}\n\n\tgetWidth() {\n\t\tif (this.numLabels > 0) {\n\t\t\treturn this.widthPerElement * this.numLabels;\n\t\t} else {\n\t\t\treturn MIN_WIDTH;\n\t\t}\n\t}\n\n\tsetNumElements(newNumElements) {\n\t\tif (this.numLabels < newNumElements) {\n\t\t\tfor (let i = this.numLabels; i < newNumElements; i++) {\n\t\t\t\tthis.labels[i] = '';\n\t\t\t\tthis.labelColors[i] = this.foregroundColor;\n\t\t\t}\n\t\t\tthis.numLabels = newNumElements;\n\t\t} else if (this.numLabels > newNumElements) {\n\t\t\tfor (let i = newNumElements; i < this.numLabels; i++) {\n\t\t\t\tthis.labels[i] = null;\n\t\t\t}\n\t\t\tthis.numLabels = newNumElements;\n\t\t}\n\t}\n\n\tleft() {\n\t\treturn this.x - this.getWidth() / 2.0;\n\t}\n\n\tright() {\n\t\treturn this.x + this.getWidth() / 2.0;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2.0;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2.0;\n\t}\n\n\tdraw(context) {\n\t\tlet startX;\n\n\t\tstartX = this.left();\n\t\tif (isNaN(startX)) {\n\t\t\tstartX = 0;\n\t\t}\n\t\tconst startY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\tcontext.fillStyle = '#FF0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.getWidth() + this.highlightDiff,\n\t\t\t\tstartY - this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.getWidth() + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.getWidth(), startY);\n\t\tcontext.lineTo(startX + this.getWidth(), startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.textBaseline = 'middle';\n\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tconst labelX =\n\t\t\t\tthis.x -\n\t\t\t\t(this.widthPerElement * this.numLabels) / 2 +\n\t\t\t\tthis.widthPerElement / 2 +\n\t\t\t\ti * this.widthPerElement;\n\t\t\tconst labelY = this.y;\n\n\t\t\tcontext.fillStyle = this.labelColors[i];\n\t\t\tcontext.fillText(this.labels[i], labelX, labelY);\n\t\t}\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tsetForegroundColor(newColor) {\n\t\tthis.foregroundColor = newColor;\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tthis.labelColor[i] = newColor;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tif (anchor === 0) {\n\t\t\treturn [this.left() + EDGE_POINTER_DISPLACEMENT, this.y];\n\t\t} else if (anchor === this.numLabels) {\n\t\t\treturn [this.right() - EDGE_POINTER_DISPLACEMENT, this.y];\n\t\t} else {\n\t\t\treturn [this.left() + anchor * this.widthPerElement, this.y];\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tif (fromY < this.y - this.h / 2) {\n\t\t\treturn [this.x, this.y - this.h / 2];\n\t\t} else if (this.fromY > this.y + this.h / 2) {\n\t\t\treturn [this.x, this.y + this.h / 2];\n\t\t} else if (fromX < this.x - this.getWidth() / 2) {\n\t\t\treturn [this.x - this.getWidth() / 2, this.y];\n\t\t} else {\n\t\t\treturn [this.x + this.getWidth() / 2, this.y];\n\t\t}\n\t}\n\n\tgetTextColor(textIndex) {\n\t\ttextIndex = textIndex || 0;\n\t\treturn this.labelColors[textIndex];\n\t}\n\n\tgetText(index) {\n\t\tindex = index || 0;\n\t\treturn this.labels[index];\n\t}\n\n\tsetTextColor(color, textIndex) {\n\t\ttextIndex = textIndex || 0;\n\t\tthis.labelColors[textIndex] = color;\n\t}\n\n\tsetText(newText, textIndex) {\n\t\ttextIndex = textIndex || 0;\n\t\tthis.labels[textIndex] = newText;\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteBTreeNode(\n\t\t\tthis.objectID,\n\t\t\tthis.numLabels,\n\t\t\tthis.labels,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.widthPerElement,\n\t\t\tthis.h,\n\t\t\tthis.labelColors,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteBTreeNode extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tnumLabels,\n\t\tlabels,\n\t\tx,\n\t\ty,\n\t\twidthPerElement,\n\t\th,\n\t\tlabelColors,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlayer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.numLabels = numLabels;\n\t\tthis.labels = labels;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.widthPerElement = widthPerElement;\n\t\tthis.h = h;\n\t\tthis.labelColors = labelColors;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.layer = layer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addBTreeNode(\n\t\t\tthis.objectID,\n\t\t\tthis.widthPerElement,\n\t\t\tthis.h,\n\t\t\tthis.numLabels,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tworld.setText(this.objectID, this.labels[i], i);\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\n\t\t}\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject';\nimport { UndoBlock } from './UndoFunctions';\n\nexport default class AnimatedCircle extends AnimatedObject {\n\tconstructor(objectID, label) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.label = label;\n\n\t\tthis.radius = 20;\n\t\tthis.thickness = 3;\n\t\tthis.highlightIndex = -1;\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY) {\n\t\treturn this.getHeadPointerAttachPos(fromX, fromY);\n\t}\n\n\tgetWidth() {\n\t\treturn this.radius * 2;\n\t}\n\n\tsetWidth(newWidth) {\n\t\tthis.radius = newWidth / 2;\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tconst xVec = fromX - this.x;\n\t\tconst yVec = fromY - this.y;\n\t\tconst len = Math.sqrt(xVec * xVec + yVec * yVec);\n\t\tif (len === 0) return [this.x, this.y];\n\t\treturn [this.x + (xVec / len) * this.radius, this.y + (yVec / len) * this.radius];\n\t}\n\n\tsetHighlightIndex(hlIndex) {\n\t\tthis.highlightIndex = hlIndex;\n\t\tthis.highlightIndexDirty = true;\n\t}\n\n\tdraw(context) {\n\t\tcontext.globalAlpha = this.alpha;\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.fillStyle = this.highlightColor;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.arc(this.x, this.y, this.radius + this.highlightDiff, 0, Math.PI * 2, true);\n\t\t\tcontext.closePath();\n\t\t\tcontext.fill();\n\t\t}\n\n\t\tcontext.fillStyle = this.backgroundColor;\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.lineWidth = 1.2;\n\t\tcontext.beginPath();\n\t\tcontext.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true);\n\t\tcontext.closePath();\n\t\tcontext.fill();\n\t\tcontext.stroke();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\t\tcontext.fillStyle = this.foregroundColor;\n\t\tconst strList = this.label.split('\\n');\n\t\tif (strList.length === 1) {\n\t\t\tif (this.highlightIndexDirty && this.highlightIndex !== -1) {\n\t\t\t\tthis.leftWidth = context.measureText(\n\t\t\t\t\tthis.label.substring(0, this.highlightIndex),\n\t\t\t\t).width;\n\t\t\t\tthis.centerWidth = context.measureText(\n\t\t\t\t\tthis.label.substring(this.highlightIndex, this.highlightIndex + 1),\n\t\t\t\t).width;\n\t\t\t\tthis.textWidth = context.measureText(this.label).width;\n\t\t\t\tthis.highlightIndexDirty = false;\n\t\t\t}\n\t\t\tif (this.highlightIndex !== -1 && this.highlightIndex < this.label.length) {\n\t\t\t\tconst startingXForHighlight = this.x - this.textWidth / 2;\n\t\t\t\tcontext.textAlign = 'left';\n\t\t\t\tconst leftStr = this.label.substring(0, this.highlightIndex);\n\t\t\t\tconst highlightStr = this.label.substring(\n\t\t\t\t\tthis.highlightIndex,\n\t\t\t\t\tthis.highlightIndex + 1,\n\t\t\t\t);\n\t\t\t\tconst rightStr = this.label.substring(this.highlightIndex + 1);\n\t\t\t\tcontext.fillText(leftStr, startingXForHighlight, this.y);\n\t\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\t\tcontext.fillStyle = '#FF0000';\n\t\t\t\tcontext.fillText(highlightStr, startingXForHighlight + this.leftWidth, this.y);\n\n\t\t\t\tcontext.strokeStyle = this.labelColor;\n\t\t\t\tcontext.fillStyle = this.labelColor;\n\t\t\t\tcontext.fillText(\n\t\t\t\t\trightStr,\n\t\t\t\t\tstartingXForHighlight + this.leftWidth + this.centerWidth,\n\t\t\t\t\tthis.y,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tcontext.fillText(this.label, this.x, this.y);\n\t\t\t}\n\t\t} else if (strList.length % 2 === 0) {\n\t\t\tconst mid = strList.length / 2;\n\t\t\tfor (let i = 0; i < strList.length / 2; i++) {\n\t\t\t\tcontext.fillText(strList[mid - i - 1], this.x, this.y - (i + 0.5) * 12);\n\t\t\t\tcontext.fillText(strList[mid + i], this.x, this.y + (i + 0.5) * 12);\n\t\t\t}\n\t\t} else {\n\t\t\tconst mid = (strList.length - 1) / 2;\n\t\t\tcontext.fillText(strList[mid], this.x, this.y);\n\t\t\tfor (let i = 0; i < mid; i++) {\n\t\t\t\tcontext.fillText(strList[mid - (i + 1)], this.x, this.y - (i + 1) * 12);\n\t\t\t\tcontext.fillText(strList[mid + (i + 1)], this.x, this.y + (i + 1) * 12);\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteCircle(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.radius,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteCircle extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tx,\n\t\ty,\n\t\tforegroundColor,\n\t\tbackgroundColor,\n\t\tlayer,\n\t\tradius,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.layer = layer;\n\t\tthis.radius = radius;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addCircleObject(this.objectID, this.label);\n\t\tworld.setWidth(this.objectID, this.radius * 2);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setForegroundColor(this.objectID, this.foregroundColor);\n\t\tworld.setBackgroundColor(this.objectID, this.backgroundColor);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedCircularlyLinkedListNode extends AnimatedObject {\n\tconstructor(objectID, label, w, h, linkPercent, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.nullPointer = false;\n\n\t\tthis.label = label;\n\t\tthis.labelPosX = 0;\n\t\tthis.labelPosY = 0;\n\t\tthis.labelColor = foregroundColor;\n\t}\n\n\tsetNull(np) {\n\t\tif (this.nullPointer !== np) {\n\t\t\tthis.nullPointer = np;\n\t\t}\n\t}\n\n\tgetNull() {\n\t\treturn this.nullPointer;\n\t}\n\n\tleft() {\n\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\n\t}\n\n\tright() {\n\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2.0;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2.0;\n\t}\n\n\tresetTextPosition() {\n\t\tthis.labelPosX = this.x;\n\t\tthis.labelPosY = this.y;\n\t}\n\n\tgetTailPointerAttachPos() {\n\t\treturn [this.x + this.w / 2.0, this.y];\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tif (fromX < this.x) {\n\t\t\treturn this.getClosestCardinalPoint(fromX, fromY); // Normal anchor\n\t\t} else {\n\t\t\treturn [this.x, this.bottom()]; // Curved pointer coming from the right, connect to bottom\n\t\t}\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t\tthis.resetTextPosition();\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tstartX = this.left();\n\t\tstartY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\tcontext.fillStyle = '#FF0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tstartX = this.right() - this.w * this.linkPercent;\n\t\tstartY = this.top();\n\n\t\tcontext.lineWidth = 1;\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tif (this.nullPointer) {\n\t\t\tcontext.lineTo(this.right(), startY + this.h);\n\t\t}\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\n\t\tthis.resetTextPosition();\n\t\tcontext.fillStyle = this.labelColor;\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColor = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColor;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteCircularlyLinkedList(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.labelColor,\n\t\t\tthis.layer,\n\t\t\tthis.nullPointer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteCircularlyLinkedList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlinkPercent,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlabelColor,\n\t\tlayer,\n\t\tnullPointer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.labelColor = labelColor;\n\t\tthis.layer = layer;\n\t\tthis.nullPointer = nullPointer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addCircularlyLinkedListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setNull(this.objectID, this.nullPointer);\n\t\tworld.setTextColor(this.objectID, this.labelColor);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedDoublyLinkedListNode extends AnimatedObject {\n\tconstructor(objectID, label, w, h, linkPercent, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.prevNullPointer = false;\n\t\tthis.nextNullPointer = false;\n\n\t\tthis.label = label;\n\t\tthis.labelPosX = 0;\n\t\tthis.labelPosY = 0;\n\t\tthis.labelColor = foregroundColor;\n\t}\n\n\tsetPrevNull(np) {\n\t\tif (this.prevNullPointer !== np) {\n\t\t\tthis.prevNullPointer = np;\n\t\t}\n\t}\n\n\tsetNextNull(np) {\n\t\tif (this.nextNullPointer !== np) {\n\t\t\tthis.nextNullPointer = np;\n\t\t}\n\t}\n\n\tgetLeftNull() {\n\t\treturn this.prevNullPointer;\n\t}\n\n\tgetRightNull() {\n\t\treturn this.nextNullPointer;\n\t}\n\n\tleft() {\n\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\n\t}\n\n\tright() {\n\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2.0;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2.0;\n\t}\n\n\tresetTextPosition() {\n\t\tthis.labelPosY = this.y;\n\t\tthis.labelPosX = this.left() + this.w * (this.linkPercent * 2);\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tif (anchor === 0) {\n\t\t\treturn [this.x + this.w / 2.0, this.y - this.h * 0.2];\n\t\t} else {\n\t\t\treturn [this.left() + (this.w * this.linkPercent) / 2, this.y + this.h * 0.2];\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tconst closest = this.getClosestCardinalPoint(fromX, fromY);\n\t\tif (closest[1] === this.y) {\n\t\t\tif (closest[0] === this.left()) {\n\t\t\t\treturn [closest[0], this.y - this.h * 0.2];\n\t\t\t} else {\n\t\t\t\treturn [closest[0], this.y + this.h * 0.2];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [closest[0], closest[1]];\n\t\t}\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t\tthis.resetTextPosition();\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tstartX = this.left();\n\t\tstartY = this.top();\n\n\t\t// Highlighted edges\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\tcontext.fillStyle = '#FF0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\n\t\t// Node edges\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.lineWidth = 1;\n\t\t// Left inner line between node and pointer area\n\t\tstartX = this.left() + this.w * this.linkPercent;\n\t\tstartY = this.top();\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tif (this.prevNullPointer) {\n\t\t\t// Left null marker\n\t\t\tcontext.moveTo(this.left(), startY);\n\t\t\tcontext.lineTo(this.left() + this.w * this.linkPercent, startY + this.h);\n\t\t}\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\n\t\t// Right inner line between node and pointer area\n\t\tstartX = this.right() - this.w * this.linkPercent;\n\t\tstartY = this.top();\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tif (this.nextNullPointer) {\n\t\t\t// Right null marker\n\t\t\tcontext.moveTo(this.right() - this.w * this.linkPercent, startY);\n\t\t\tcontext.lineTo(this.right(), startY + this.h);\n\t\t}\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\n\t\t// Label\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\t\tthis.resetTextPosition();\n\t\tcontext.fillStyle = this.labelColor;\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColors = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColors;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteDoublyLinkedList(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.labelColor,\n\t\t\tthis.layer,\n\t\t\tthis.prevNullPointer,\n\t\t\tthis.nextNullPointer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteDoublyLinkedList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlinkPercent,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlabelColor,\n\t\tlayer,\n\t\tpnp,\n\t\tnnp,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.labelColors = labelColor;\n\t\tthis.layer = layer;\n\t\tthis.prevNullPointer = pnp;\n\t\tthis.nextNullPointer = nnp;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addDoublyLinkedListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setPrevNull(this.objectID, this.prevNullPointer);\n\t\tworld.setNextNull(this.objectID, this.nextNullPointer);\n\t\tworld.setTextColor(this.objectID, this.labelColor);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// \"Class\" animatedCircle\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedHighlightCircle extends AnimatedObject {\n\tconstructor(objectID, foregroundColor, radius) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.radius = radius;\n\t\tthis.thickness = 4;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t}\n\n\tdraw(context) {\n\t\tcontext.globalAlpha = this.alpha;\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.lineWidth = this.thickness;\n\t\tcontext.beginPath();\n\t\tcontext.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteHighlightCircle(\n\t\t\tthis.objectID,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.radius,\n\t\t\tthis.layer,\n\t\t\tthis.alpha,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteHighlightCircle extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tx,\n\t\ty,\n\t\tforegroundColor,\n\t\tradius,\n\t\tlayer,\n\t\talpha,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.radius = radius;\n\t\tthis.layer = layer;\n\t\tthis.alpha = alpha;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addHighlightCircleObject(this.objectID, this.foregroundColor, this.radius);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setAlpha(this.objectID, this.alpha);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedLabel extends AnimatedObject {\n\tconstructor(objectID, label, centered, initialWidth) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.textWidth = initialWidth || 0;\n\n\t\tthis.label = label;\n\t\tthis.labelColor = '#000000';\n\t\tthis.highlighted = false;\n\t\tthis.centered = centered;\n\n\t\tthis.leftWidth = -1;\n\t\tthis.centerWidth = -1;\n\t\tthis.highlightIndex = -1;\n\t}\n\n\tcentered() {\n\t\treturn this.centered;\n\t}\n\n\tdraw(context) {\n\t\tif (!this.addedToScene) return;\n\n\t\tcontext.globalAlpha = this.alpha;\n\t\tcontext.font = '12px Arial';\n\n\t\tlet startingXForHighlight = this.x;\n\n\t\tif (this.highlightIndex >= this.label.length) {\n\t\t\tthis.highlightIndex = -1;\n\t\t}\n\t\tif (this.highlightIndexDirty && this.highlightIndex !== -1) {\n\t\t\tthis.leftWidth = context.measureText(\n\t\t\t\tthis.label.substring(0, this.highlightIndex),\n\t\t\t).width;\n\t\t\tthis.centerWidth = context.measureText(\n\t\t\t\tthis.label.substring(this.highlightIndex, this.highlightIndex + 1),\n\t\t\t).width;\n\t\t\tthis.highlightIndexDirty = false;\n\t\t}\n\n\t\tif (this.centered) {\n\t\t\tif (this.highlightIndex !== -1) {\n\t\t\t\tstartingXForHighlight = this.x - this.width / 2;\n\t\t\t\tcontext.textAlign = 'left';\n\t\t\t\tcontext.textBaseline = 'middle';\n\t\t\t} else {\n\t\t\t\tcontext.textAlign = 'center';\n\t\t\t\tcontext.textBaseline = 'middle';\n\t\t\t}\n\t\t} else {\n\t\t\tcontext.textAlign = 'left';\n\t\t\tcontext.textBaseline = 'top';\n\t\t}\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FFAAAA';\n\t\t\tcontext.fillStyle = '#FF0000';\n\t\t\tcontext.lineWidth = this.highlightDiff;\n\t\t\tcontext.strokeText(this.label, this.x, this.y);\n\t\t}\n\t\tcontext.strokeStyle = this.labelColor;\n\t\tcontext.fillStyle = this.labelColor;\n\t\tcontext.lineWidth = 2;\n\t\tconst strList = this.label.split('\\n');\n\t\tif (strList.length === 1) {\n\t\t\tif (this.highlightIndex === -1) {\n\t\t\t\tcontext.fillText(this.label, this.x, this.y);\n\t\t\t} else {\n\t\t\t\tconst leftStr = this.label.substring(0, this.highlightIndex);\n\t\t\t\tconst highlightStr = this.label.substring(\n\t\t\t\t\tthis.highlightIndex,\n\t\t\t\t\tthis.highlightIndex + 1,\n\t\t\t\t);\n\t\t\t\tconst rightStr = this.label.substring(this.highlightIndex + 1);\n\t\t\t\tcontext.fillText(leftStr, startingXForHighlight, this.y);\n\t\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\t\tcontext.fillStyle = '#FF0000';\n\t\t\t\tcontext.fillText(highlightStr, startingXForHighlight + this.leftWidth, this.y);\n\n\t\t\t\tcontext.strokeStyle = this.labelColor;\n\t\t\t\tcontext.fillStyle = this.labelColor;\n\t\t\t\tcontext.fillText(\n\t\t\t\t\trightStr,\n\t\t\t\t\tstartingXForHighlight + this.leftWidth + this.centerWidth,\n\t\t\t\t\tthis.y,\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tconst offset = this.centered ? (1.0 - strList.length) / 2.0 : 0;\n\t\t\tfor (let i = 0; i < strList.length; i++) {\n\t\t\t\tcontext.fillText(strList[i], this.x, this.y + offset + i * 12);\n\t\t\t}\n\t\t}\n\t\tcontext.closePath();\n\t}\n\n\tgetAlignLeftPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.left() - this.textWidth / 2, (this.y = otherObject.centerY())];\n\t\t} else {\n\t\t\treturn [otherObject.left() - this.textWidth, otherObject.centerY() - 5];\n\t\t}\n\t}\n\n\talignLeft(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.centerY();\n\t\t\tthis.x = otherObject.left() - this.textWidth / 2;\n\t\t} else {\n\t\t\tthis.y = otherObject.centerY() - 5;\n\t\t\tthis.x = otherObject.left() - this.textWidth;\n\t\t}\n\t}\n\n\talignRight(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.centerY();\n\t\t\tthis.x = otherObject.right() + this.textWidth / 2;\n\t\t} else {\n\t\t\tthis.y = otherObject.centerY() - 5;\n\t\t\tthis.x = otherObject.right();\n\t\t}\n\t}\n\n\tgetAlignRightPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.right() + this.textWidth / 2, otherObject.centerY()];\n\t\t} else {\n\t\t\treturn [otherObject.right(), otherObject.centerY() - 5];\n\t\t}\n\t}\n\n\talignTop(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.top() - 5;\n\t\t\tthis.x = otherObject.centerX();\n\t\t} else {\n\t\t\tthis.y = otherObject.top() - 10;\n\t\t\tthis.x = otherObject.centerX() - this.textWidth / 2;\n\t\t}\n\t}\n\n\tgetAlignTopPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.centerX(), otherObject.top() - 5];\n\t\t} else {\n\t\t\treturn [otherObject.centerX() - this.textWidth / 2, otherObject.top() - 10];\n\t\t}\n\t}\n\n\talignBottom(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.bottom() + 5;\n\t\t\tthis.x = otherObject.centerX();\n\t\t} else {\n\t\t\tthis.y = otherObject.bottom();\n\t\t\tthis.x = otherObject.centerX() - this.textWidth / 2;\n\t\t}\n\t}\n\n\tgetAlignBottomPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.centerX(), otherObject.bottom() + 5];\n\t\t} else {\n\t\t\treturn [otherObject.centerX() - this.textWidth / 2, otherObject.bottom()];\n\t\t}\n\t}\n\n\tgetWidth() {\n\t\treturn this.textWidth;\n\t}\n\n\tgetHeight() {\n\t\treturn 10; // HACK!  HACK!  HACK!  HACK!\n\t}\n\n\tsetHighlight(value) {\n\t\tthis.highlighted = value;\n\t}\n\n\tcenterX() {\n\t\tif (this.centered) {\n\t\t\treturn this.x;\n\t\t} else {\n\t\t\treturn this.x + this.textWidth;\n\t\t}\n\t}\n\n\tcenterY() {\n\t\tif (this.centered) {\n\t\t\treturn this.y;\n\t\t} else {\n\t\t\treturn this.y + 5;\n\t\t}\n\t}\n\n\ttop() {\n\t\tif (this.centered) {\n\t\t\treturn this.y - 5; //TODO: Un-Hardwire\n\t\t} else {\n\t\t\treturn this.y;\n\t\t}\n\t}\n\n\tbottom() {\n\t\tif (this.centered) {\n\t\t\treturn this.y + 5; // TODO: + height / 2;\n\t\t} else {\n\t\t\treturn this.y + 10; // TODO: + hieght;\n\t\t}\n\t}\n\n\tright() {\n\t\tif (this.centered) {\n\t\t\treturn this.x + this.textWidth / 2; // TODO: + width / 2;\n\t\t} else {\n\t\t\treturn this.x + this.textWidth; // TODO: + width;\n\t\t}\n\t}\n\n\tleft() {\n\t\tif (this.centered) {\n\t\t\treturn this.x - this.textWidth / 2;\n\t\t} else {\n\t\t\treturn this.x; // TODO:  - a little?\n\t\t}\n\t}\n\n\tsetHighlightIndex(hlIndex) {\n\t\t// Only allow highlight index for labels that don't have End-Of-Line\n\t\tif (this.label.indexOf('\\n') === -1 && this.label.length > hlIndex) {\n\t\t\tthis.highlightIndex = hlIndex;\n\t\t\tthis.highlightIndexDirty = true;\n\t\t} else {\n\t\t\tthis.highlightIndex = -1;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tsetText(newText, textIndex, initialWidth) {\n\t\tthis.label = newText;\n\t\tif (initialWidth != null) {\n\t\t\tthis.textWidth = initialWidth;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteLabel(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.centered,\n\t\t\tthis.labelColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlightIndex,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteLabel extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tx,\n\t\ty,\n\t\tcentered,\n\t\tlabelColor,\n\t\tlayer,\n\t\thighlightIndex,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.centered = centered;\n\t\tthis.labelColor = labelColor;\n\t\tthis.layer = layer;\n\t\tthis.highlightIndex = highlightIndex;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addLabelObject(this.objectID, this.label, this.centered);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setForegroundColor(this.objectID, this.labelColor);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// This class handles links between vertices in graphs, pointers in linked lists, and so on.\n\nconst LINE_MAX_HEIGHT_DIFF = 5;\nconst LINE_MIN_HEIGHT_DIFF = 3;\nconst LINE_RANGE = LINE_MAX_HEIGHT_DIFF - LINE_MIN_HEIGHT_DIFF + 1;\n\nexport default class AnimatedLine {\n\tconstructor(fromID, toID, color, curve, directed, edgeLabel, anchorPoint, thickness) {\n\t\tthis.fromID = fromID;\n\t\tthis.toID = toID;\n\n\t\tthis.foregroundColor = color;\n\t\tthis.edgeLabel = edgeLabel;\n\t\tthis.highlighted = false;\n\t\tthis.highlightDiff = 0;\n\n\t\tthis.dirty = false;\n\t\tthis.directed = directed;\n\t\tthis.anchorPoint = anchorPoint;\n\n\t\tthis.alpha = 1.0;\n\t\tthis.thickness = thickness;\n\t\tthis.arrowHeight = 8;\n\t\tthis.arrowWidth = 4;\n\t\tthis.curve = curve;\n\t}\n\n\tcolor() {\n\t\treturn this.foregroundColor;\n\t}\n\n\tsetColor(newColor) {\n\t\tthis.foregroundColor = newColor;\n\t\tthis.dirty = true;\n\t}\n\n\tsetHighlight(highlightVal, color) {\n\t\tthis.highlighted = highlightVal;\n\t\tthis.highlightColor = color || '#FF0000';\n\t}\n\n\tsetThickness(thickness) {\n\t\tthis.thickness = thickness;\n\t}\n\n\tpulseHighlight(frameNum) {\n\t\tif (this.highlighted) {\n\t\t\tconst frameMod = frameNum / 14.0;\n\t\t\tconst delta = Math.abs((frameMod % (2 * LINE_RANGE - 2)) - LINE_RANGE + 1);\n\t\t\tthis.highlightDiff = delta + this.thickness + LINE_MIN_HEIGHT_DIFF;\n\t\t\tthis.dirty = true;\n\t\t}\n\t}\n\n\thasNode(n) {\n\t\treturn this.fromID === n || this.toID === n;\n\t}\n\n\tsign(n) {\n\t\tif (n > 0) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tdrawArrow(thickness, color, context) {\n\t\tcontext.strokeStyle = color;\n\t\tcontext.fillStyle = color;\n\t\tcontext.lineWidth = thickness;\n\n\t\tconst fromPos = this.fromID.getTailPointerAttachPos(\n\t\t\tthis.toID.x,\n\t\t\tthis.toID.y,\n\t\t\tthis.anchorPoint,\n\t\t);\n\t\tconst toPos = this.toID.getHeadPointerAttachPos(this.fromID.x, this.fromID.y);\n\n\t\tconst deltaX = toPos[0] - fromPos[0];\n\t\tconst deltaY = toPos[1] - fromPos[1];\n\t\tconst midX = deltaX / 2.0 + fromPos[0];\n\t\tconst midY = deltaY / 2.0 + fromPos[1];\n\t\tconst controlX = midX - deltaY * this.curve;\n\n\t\tconst controlY = midY + deltaX * this.curve;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(fromPos[0], fromPos[1]);\n\t\tcontext.quadraticCurveTo(controlX, controlY, toPos[0], toPos[1]);\n\t\tcontext.stroke();\n\n\t\t// Position of the edge label:  First, we will place it right along the\n\t\t// middle of the curve (or the middle of the line, for curve == 0)\n\t\tlet labelPosX = 0.25 * fromPos[0] + 0.5 * controlX + 0.25 * toPos[0];\n\t\tlet labelPosY = 0.25 * fromPos[1] + 0.5 * controlY + 0.25 * toPos[1];\n\n\t\t// Next, we push the edge position label out just a little in the direction of\n\t\t// the curve, so that the label doesn't intersect the cuve (as long as the label\n\t\t// is only a few characters, that is)\n\t\tconst midLen = Math.sqrt(deltaY * deltaY + deltaX * deltaX);\n\t\tif (midLen !== 0) {\n\t\t\tlabelPosX += ((-deltaY * this.sign(this.curve)) / midLen) * 10;\n\t\t\tlabelPosY += ((deltaX * this.sign(this.curve)) / midLen) * 10;\n\t\t}\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.fillText(this.edgeLabel, labelPosX, labelPosY);\n\n\t\tif (this.directed) {\n\t\t\tlet xVec = controlX - toPos[0];\n\t\t\tlet yVec = controlY - toPos[1];\n\t\t\tconst len = Math.sqrt(xVec * xVec + yVec * yVec);\n\n\t\t\tif (len > 0) {\n\t\t\t\txVec = xVec / len;\n\t\t\t\tyVec = yVec / len;\n\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(toPos[0], toPos[1]);\n\t\t\t\tcontext.lineTo(\n\t\t\t\t\ttoPos[0] + xVec * this.arrowHeight - yVec * this.arrowWidth,\n\t\t\t\t\ttoPos[1] + yVec * this.arrowHeight + xVec * this.arrowWidth,\n\t\t\t\t);\n\t\t\t\tcontext.lineTo(\n\t\t\t\t\ttoPos[0] + xVec * this.arrowHeight + yVec * this.arrowWidth,\n\t\t\t\t\ttoPos[1] + yVec * this.arrowHeight - xVec * this.arrowWidth,\n\t\t\t\t);\n\t\t\t\tcontext.lineTo(toPos[0], toPos[1]);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.stroke();\n\t\t\t\tcontext.fill();\n\t\t\t}\n\t\t}\n\t}\n\n\tdraw(context) {\n\t\tcontext.globalAlpha = this.alpha;\n\n\t\tif (this.highlighted) this.drawArrow(this.highlightDiff, this.highlightColor, context);\n\t\tthis.drawArrow(this.thickness, this.foregroundColor, context);\n\t}\n\n\tcreateUndoConnect() {\n\t\treturn new UndoConnect(\n\t\t\tthis.fromID.objectID,\n\t\t\tthis.toID.objectID,\n\t\t\ttrue,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.curve,\n\t\t\tthis.directed,\n\t\t\tthis.edgeLabel,\n\t\t\tthis.anchorPoint,\n\t\t\tthis.thickness,\n\t\t\tthis.highlighted,\n\t\t);\n\t}\n}\n\nexport class UndoConnect {\n\tconstructor(\n\t\tfromID,\n\t\ttoID,\n\t\tcreateConnection,\n\t\tcolor,\n\t\tcurve,\n\t\tdirected,\n\t\tedgeLabel,\n\t\tanchorPoint,\n\t\tthickness,\n\t\thighlighted,\n\t) {\n\t\tthis.fromID = fromID;\n\t\tthis.toID = toID;\n\t\tthis.createConnection = createConnection;\n\t\tthis.color = color;\n\t\tthis.curve = curve;\n\t\tthis.directed = directed;\n\t\tthis.edgeLabel = edgeLabel;\n\t\tthis.anchorPoint = anchorPoint;\n\t\tthis.thickness = thickness;\n\t\tthis.highlighted = highlighted;\n\t}\n\n\tundoInitialStep(world) {\n\t\tif (this.createConnection) {\n\t\t\tworld.connectEdge(\n\t\t\t\tthis.fromID,\n\t\t\t\tthis.toID,\n\t\t\t\tthis.color,\n\t\t\t\tthis.curve,\n\t\t\t\tthis.directed,\n\t\t\t\tthis.edgeLabel,\n\t\t\t\tthis.anchorPoint,\n\t\t\t\tthis.thickness,\n\t\t\t);\n\t\t\tworld.setEdgeHighlight(this.fromID, this.toID, this.highlighted);\n\t\t} else {\n\t\t\tworld.disconnect(this.fromID, this.toID);\n\t\t}\n\t}\n\n\taddUndoAnimation() {\n\t\treturn false;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedLinkedListNode extends AnimatedObject {\n\tconstructor(\n\t\tobjectID,\n\t\tlabels,\n\t\tw,\n\t\th,\n\t\tlinkPercent,\n\t\tvertical,\n\t\tlinkPosEnd,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.vertical = vertical;\n\t\tthis.linkPosEnd = linkPosEnd;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.nullPointer = false;\n\n\t\tthis.labels = labels;\n\t\tthis.labelPosX = [0];\n\t\tthis.labelPosY = [0];\n\t\tthis.labelColors = [foregroundColor];\n\t}\n\n\tleft() {\n\t\tif (this.vertical) {\n\t\t\treturn this.x - this.w / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\n\t\t} else {\n\t\t\treturn this.x - (this.w * (this.linkPercent + 1)) / 2;\n\t\t}\n\t}\n\n\tsetNull(np) {\n\t\tif (this.nullPointer !== np) {\n\t\t\tthis.nullPointer = np;\n\t\t}\n\t}\n\n\tgetNull() {\n\t\treturn this.nullPointer;\n\t}\n\n\tright() {\n\t\tif (this.vertical) {\n\t\t\treturn this.x + this.w / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\n\t\t} else {\n\t\t\treturn this.x + (this.w * (1 - this.linkPercent)) / 2;\n\t\t}\n\t}\n\n\ttop() {\n\t\tif (!this.vertical) {\n\t\t\treturn this.y - this.h / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.y - (this.h * (1 - this.linkPercent)) / 2;\n\t\t} else {\n\t\t\treturn this.y - (this.h * (1 + this.linkPercent)) / 2;\n\t\t}\n\t}\n\n\tbottom() {\n\t\tif (!this.vertical) {\n\t\t\treturn this.y + this.h / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.y + (this.h * (1 + this.linkPercent)) / 2;\n\t\t} else {\n\t\t\treturn this.y + (this.h * (1 - this.linkPercent)) / 2;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tif (this.vertical && this.linkPosEnd) {\n\t\t\treturn [this.x, this.y + this.h / 2.0];\n\t\t} else if (this.vertical && !this.linkPosEnd) {\n\t\t\treturn [this.x, this.y - this.h / 2.0];\n\t\t} else if (!this.vertical && this.linkPosEnd) {\n\t\t\treturn [this.x + this.w / 2.0, this.y];\n\t\t} else {\n\t\t\t// !this.vertical && !this.linkPosEnd\n\t\t\treturn [this.x - this.w / 2.0, this.y];\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tstartX = this.left();\n\t\tstartY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#ff0000';\n\t\t\tcontext.fillStyle = '#ff0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tif (this.vertical) {\n\t\t\tstartX = this.left();\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tstartY = this.y + this.h * (1 - this.linkPercent) * (i / this.labels.length - 0.5);\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(startX, startY);\n\t\t\t\tcontext.lineTo(startX + this.w, startY);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t} else {\n\t\t\tstartY = this.top();\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tstartX = this.x + this.w * (1 - this.linkPercent) * (i / this.labels.length - 0.5);\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(startX, startY);\n\t\t\t\tcontext.lineTo(startX, startY + this.h);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t}\n\n\t\tcontext.lineWidth = 1;\n\t\tif (this.vertical && this.linkPosEnd) {\n\t\t\tstartX = this.left();\n\t\t\tstartY = this.bottom() - this.h * this.linkPercent;\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(this.startX + this.w, this.bottom());\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t} else if (this.vertical && !this.linkPosEnd) {\n\t\t\tstartX = this.left();\n\t\t\tstartY = this.top() + this.h * this.linkPercent;\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(startX + this.w, this.top());\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t} else if (!this.vertical && this.linkPosEnd) {\n\t\t\tstartX = this.right() - this.w * this.linkPercent;\n\t\t\tstartY = this.top();\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(this.right(), startY + this.h);\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t} else {\n\t\t\t// !vertical && !linkPosEnd\n\t\t\tstartX = this.left() + this.w * this.linkPercent;\n\t\t\tstartY = this.top();\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(this.left(), startY);\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t}\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\n\t\tif (this.vertical) {\n\t\t\tthis.labelPosX[0] = this.x;\n\t\t\tthis.labelPosY[0] =\n\t\t\t\tthis.y + ((this.h * (1 - this.linkPercent)) / 2) * (1 / this.labels.length - 1);\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tthis.labelPosX[i] = this.x;\n\t\t\t\tthis.labelPosY[i] =\n\t\t\t\t\tthis.labelPosY[i - 1] + (this.h * (1 - this.linkPercent)) / this.labels.length;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.labelPosY[0] = this.y;\n\t\t\tthis.labelPosX[0] =\n\t\t\t\tthis.x + ((this.w * (1 - this.linkPercent)) / 2) * (1 / this.labels.length - 1);\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tthis.labelPosY[i] = this.y;\n\t\t\t\tthis.labelPosX[i] =\n\t\t\t\t\tthis.labelPosX[i - 1] + (this.w * (1 - this.linkPercent)) / this.labels.length;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this.labels.length; i++) {\n\t\t\tcontext.fillStyle = this.labelColors[i];\n\t\t\tcontext.fillText(this.labels[i], this.labelPosX[i], this.labelPosY[i]);\n\t\t}\n\t}\n\n\tsetTextColor(color, index) {\n\t\tthis.labelColors[index] = color;\n\t}\n\n\tgetTextColor(index) {\n\t\treturn this.labelColors[index];\n\t}\n\n\tgetText(index) {\n\t\treturn this.labels[index];\n\t}\n\n\tsetText(newText, index) {\n\t\tthis.labels[index] = newText;\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteLinkedList(\n\t\t\tthis.objectID,\n\t\t\tthis.labels,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.linkPercent,\n\t\t\tthis.vertical,\n\t\t\tthis.linkPosEnd,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.labelColors,\n\t\t\tthis.layer,\n\t\t\tthis.nullPointer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteLinkedList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabels,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlinkPercent,\n\t\tvertical,\n\t\tlinkPosEnd,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlabelColors,\n\t\tlayer,\n\t\tnullPointer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.labels = labels;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.vertical = vertical;\n\t\tthis.linkPosEnd = linkPosEnd;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.labelColors = labelColors;\n\t\tthis.layer = layer;\n\t\tthis.nullPointer = nullPointer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addLinkedListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.labels,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.linkPercent,\n\t\t\tthis.vertical,\n\t\t\tthis.linkPosEnd,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setNull(this.objectID, this.nullPointer);\n\t\tfor (let i = 0; i < this.labels.length; i++) {\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\n\t\t}\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.a\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Values for xJust / yJust:  \"center\", \"left\", \"right\", \"top\", \"bottom\"\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedRectangle extends AnimatedObject {\n\tconstructor(objectID, label, w, h, xJustify, yJustify, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.xJustify = xJustify;\n\t\tthis.yJustify = yJustify;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.textColor = foregroundColor;\n\t\tthis.highlighted = false;\n\t\tthis.thicknessArray = [false, false, false, false];\n\n\t\tthis.label = label;\n\n\t\tthis.nullPointer = false;\n\t}\n\n\tsetNull(np) {\n\t\tthis.nullPointer = np;\n\t}\n\n\tgetNull() {\n\t\treturn this.nullPointer;\n\t}\n\n\tleft() {\n\t\tif (this.xJustify === 'left') {\n\t\t\treturn this.x;\n\t\t} else if (this.xJustify === 'center') {\n\t\t\treturn this.x - this.w / 2.0;\n\t\t} else {\n\t\t\t// right\n\t\t\treturn this.x - this.w;\n\t\t}\n\t}\n\n\tcenterX() {\n\t\tif (this.xJustify === 'center') {\n\t\t\treturn this.x;\n\t\t} else if (this.xJustify === 'left') {\n\t\t\treturn this.x + this.w / 2.0;\n\t\t} else {\n\t\t\t// right\n\t\t\treturn this.x - this.w / 2.0;\n\t\t}\n\t}\n\n\tcenterY() {\n\t\tif (this.yJustify === 'center') {\n\t\t\treturn this.y;\n\t\t} else if (this.yJustify === 'top') {\n\t\t\treturn this.y + this.h / 2.0;\n\t\t} else {\n\t\t\t// bottom\n\t\t\treturn this.y - this.w / 2.0;\n\t\t}\n\t}\n\n\ttop() {\n\t\tif (this.yJustify === 'top') {\n\t\t\treturn this.y;\n\t\t} else if (this.yJustify === 'center') {\n\t\t\treturn this.y - this.h / 2.0;\n\t\t} else {\n\t\t\t// bottom\n\t\t\treturn this.y - this.h;\n\t\t}\n\t}\n\n\tbottom() {\n\t\tif (this.yJustify === 'top') {\n\t\t\treturn this.y + this.h;\n\t\t} else if (this.yJustify === 'center') {\n\t\t\treturn this.y + this.h / 2.0;\n\t\t} else {\n\t\t\t// bottom\n\t\t\treturn this.y;\n\t\t}\n\t}\n\n\tright() {\n\t\tif (this.xJustify === 'left') {\n\t\t\treturn this.x + this.w;\n\t\t} else if (this.xJustify === 'center') {\n\t\t\treturn this.x + this.w / 2.0;\n\t\t} else {\n\t\t\t// right\n\t\t\treturn this.x;\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tswitch (anchor) {\n\t\t\tcase 0: // Default\n\t\t\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t\t\tcase 1: // Top\n\t\t\t\treturn [this.x, this.top()];\n\t\t\tcase 2: // Bottom\n\t\t\t\treturn [this.x, this.bottom()];\n\t\t\tcase 3: // Left\n\t\t\t\treturn [this.left(), this.y];\n\t\t\tcase 4: // Right\n\t\t\t\treturn [this.right(), this.y];\n\t\t\tdefault:\n\t\t\t\treturn null;\n\t\t}\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tif (!this.addedToScene) return;\n\n\t\tcontext.globalAlpha = this.alpha;\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tif (this.xJustify === 'left') {\n\t\t\tstartX = this.x;\n\t\t} else if (this.xJustify === 'center') {\n\t\t\tstartX = this.x - this.w / 2.0;\n\t\t} else if (this.xJustify === 'right') {\n\t\t\tstartX = this.x - this.w;\n\t\t}\n\t\tif (this.yJustify === 'top') {\n\t\t\tstartY = this.y;\n\t\t} else if (this.yJustify === 'center') {\n\t\t\tstartY = this.y - this.h / 2.0;\n\t\t} else if (this.yJustify === 'bottom') {\n\t\t\tstartY = this.y - this.h;\n\t\t}\n\n\t\tcontext.lineWidth = 2;\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#ff0000';\n\t\t\tcontext.fillStyle = '#ff0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\t// Thick edges\n\t\t// Top edge\n\t\tif (this.thicknessArray[0]) {\n\t\t\tcontext.lineWidth = 3;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY);\n\t\t\tcontext.lineTo(startX + this.w, startY);\n\t\t\tcontext.stroke();\n\t\t\tcontext.closePath();\n\t\t}\n\t\t// Right edge\n\t\tif (this.thicknessArray[1]) {\n\t\t\tcontext.lineWidth = 3;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY);\n\t\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\t\tcontext.stroke();\n\t\t\tcontext.closePath();\n\t\t}\n\t\t// Bottom edge\n\t\tif (this.thicknessArray[2]) {\n\t\t\tcontext.lineWidth = 3;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY + this.h);\n\t\t\tcontext.stroke();\n\t\t\tcontext.closePath();\n\t\t}\n\t\t// Left edge\n\t\tif (this.thicknessArray[3]) {\n\t\t\tcontext.lineWidth = 3;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tcontext.stroke();\n\t\t\tcontext.closePath();\n\t\t}\n\n\t\tcontext.lineWidth = 1.2;\n\t\tif (this.nullPointer) {\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY);\n\t\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t}\n\n\t\tcontext.fillStyle = this.textColor;\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\t\tcontext.fillText(this.label, this.x, this.y);\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.textColor = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.textColor;\n\t}\n\n\tsetHighlight(value) {\n\t\tthis.highlighted = value;\n\t}\n\n\tsetEdgeThickness(thicknessArray) {\n\t\tthis.thicknessArray = thicknessArray;\n\t}\n\n\tgetEdgeThickness() {\n\t\treturn this.thicknessArray;\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteRectangle(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.xJustify,\n\t\t\tthis.yJustify,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteRectangle extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tx,\n\t\ty,\n\t\tw,\n\t\th,\n\t\txJustify,\n\t\tyJustify,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlayer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.xJustify = xJustify;\n\t\tthis.yJustify = yJustify;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.layer = layer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addRectangleObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.xJustify,\n\t\t\tthis.yJustify,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nconst NINF = '\\u2212\\u221E'; // Negative infinity\nconst PINF = '\\u221E'; // Positive infinity\n\nexport default class AnimatedSkipListNode extends AnimatedObject {\n\tconstructor(objectID, label, w, h, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.label = label;\n\t\tthis.labelPosX = 0;\n\t\tthis.labelPosY = 0;\n\t\tthis.labelColor = foregroundColor;\n\t}\n\n\tleft() {\n\t\treturn this.x - this.w / 2;\n\t}\n\n\tright() {\n\t\treturn this.x + this.w / 2;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2;\n\t}\n\n\tresetTextPosition() {\n\t\tthis.labelPosY = this.y;\n\t\tthis.labelPosX = this.x;\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tswitch (anchor) {\n\t\t\tcase 0: // Top\n\t\t\t\treturn [this.x, this.top()];\n\t\t\tcase 1: // Bottom\n\t\t\t\treturn [this.x, this.bottom()];\n\t\t\tcase 2: // Left\n\t\t\t\treturn [this.left(), this.y];\n\t\t\tcase 3: // Right\n\t\t\t\treturn [this.right(), this.y];\n\t\t\tdefault:\n\t\t\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY); // Normal anchor\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t\tthis.resetTextPosition();\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tconst startX = this.left();\n\t\tconst startY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#ff0000';\n\t\t\tcontext.fillStyle = '#ff0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff,\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\n\t\tthis.resetTextPosition();\n\t\tcontext.fillStyle = this.labelColor;\n\t\tif (this.label === NINF || this.label === PINF) {\n\t\t\tcontext.font = '18px sans-serif';\n\t\t}\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColor = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColor;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteSkipList(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.labelColor,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor,\n\t\t);\n\t}\n}\n\nclass UndoDeleteSkipList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlabelColor,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlayer,\n\t\thighlighted,\n\t\thighlightColor,\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.labelColor = labelColor;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.layer = layer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addSkipListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t);\n\t\tworld.setTextColor(this.objectID, this.labelColor);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Object Manager\n//\n// Manage all of our animated objects.  Control any animated object should occur through\n// this interface (not language enforced, because enforcing such things in Javascript is\n// problematic.)\n//\n// This class is only accessed through:\n//\n//  AnimationMain\n//  Undo objects (which are themselves controlled by AnimationMain)\n\nimport AnimatedBTreeNode from './AnimatedBTreeNode';\nimport AnimatedCircle from './AnimatedCircle';\nimport AnimatedCircularlyLinkedListNode from './AnimatedCircularlyLinkedListNode';\nimport AnimatedDoublyLinkedListNode from './AnimatedDoublyLinkedListNode';\nimport AnimatedHighlightCircle from './AnimatedHighlightCircle';\nimport AnimatedLabel from './AnimatedLabel';\nimport AnimatedLine from './AnimatedLine';\nimport AnimatedLinkedListNode from './AnimatedLinkedListNode';\nimport AnimatedRectangle from './AnimatedRectangle';\nimport AnimatedSkipListNode from './AnimatedSkipListNode';\n\nexport default class ObjectManager {\n\tconstructor(canvasRef) {\n\t\tthis.nodes = [];\n\t\tthis.edges = [];\n\t\tthis.backEdges = [];\n\t\tthis.activeLayers = [];\n\t\tthis.activeLayers[0] = true;\n\t\tthis.ctx = canvasRef.current.getContext('2d');\n\t\tthis.framenum = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.statusReport = new AnimatedLabel(-1, 'XXX', false, 30);\n\t\tthis.statusReport.x = 30;\n\t}\n\n\tdraw() {\n\t\tthis.framenum++;\n\t\tif (this.framenum > 1000) this.framenum = 0;\n\n\t\tthis.ctx.clearRect(0, 0, this.width, this.height); // clear canvas\n\t\tthis.statusReport.y = this.height - 15;\n\n\t\tlet i;\n\t\tlet j;\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\t!this.nodes[i].highlighted &&\n\t\t\t\tthis.nodes[i].addedToScene &&\n\t\t\t\t!this.nodes[i].alwaysOnTop\n\t\t\t) {\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\tthis.nodes[i].highlighted &&\n\t\t\t\t!this.nodes[i].alwaysOnTop &&\n\t\t\t\tthis.nodes[i].addedToScene\n\t\t\t) {\n\t\t\t\tthis.nodes[i].pulseHighlight(this.framenum);\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\t!this.nodes[i].highlighted &&\n\t\t\t\tthis.nodes[i].alwaysOnTop &&\n\t\t\t\tthis.nodes[i].addedToScene\n\t\t\t) {\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\tthis.nodes[i].highlighted &&\n\t\t\t\tthis.nodes[i].alwaysOnTop &&\n\t\t\t\tthis.nodes[i].addedToScene\n\t\t\t) {\n\t\t\t\tthis.nodes[i].pulseHighlight(this.framenum);\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.edges.length; i++) {\n\t\t\tif (this.edges[i] != null) {\n\t\t\t\tfor (j = 0; j < this.edges[i].length; j++) {\n\t\t\t\t\tif (this.edges[i][j].addedToScene) {\n\t\t\t\t\t\tthis.edges[i][j].pulseHighlight(this.framenum);\n\t\t\t\t\t\tthis.edges[i][j].draw(this.ctx);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.statusReport.draw(this.ctx);\n\t}\n\n\tupdate() {}\n\n\tsetLayers(shown, layers) {\n\t\tfor (let i = 0; i < layers.length; i++) {\n\t\t\tthis.activeLayers[layers[i]] = shown;\n\t\t}\n\t\tthis.resetLayers();\n\t}\n\n\taddHighlightCircleObject(objectID, objectColor, radius) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error(\n\t\t\t\t'addHighlightCircleObject: object with same ID (' +\n\t\t\t\t\tString(objectID) +\n\t\t\t\t\t') already exists!',\n\t\t\t);\n\t\t}\n\t\tconst newNode = new AnimatedHighlightCircle(objectID, objectColor, radius);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tsetEdgeAlpha(fromID, toID, alphaVal) {\n\t\tlet oldAlpha = 1.0;\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldAlpha = this.edges[fromID][i].alpha;\n\t\t\t\t\tthis.edges[fromID][i].alpha = alphaVal;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldAlpha;\n\t}\n\n\tsetAlpha(nodeID, alphaVal) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tthis.nodes[nodeID].setAlpha(alphaVal);\n\t\t}\n\t}\n\n\tgetAlpha(nodeID) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\treturn this.nodes[nodeID].getAlpha();\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tgetTextColor(nodeID, index) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\treturn this.nodes[nodeID].getTextColor(index);\n\t\t} else {\n\t\t\treturn '#000000';\n\t\t}\n\t}\n\n\tsetTextColor(nodeID, color, index) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tthis.nodes[nodeID].setTextColor(color, index);\n\t\t}\n\t}\n\n\tsetHighlightIndex(nodeID, index) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tthis.nodes[nodeID].setHighlightIndex(index);\n\t\t}\n\t}\n\n\tsetAllLayers(layers) {\n\t\tthis.activeLayers = [];\n\t\tfor (let i = 0; i < layers.length; i++) {\n\t\t\tthis.activeLayers[layers[i]] = true;\n\t\t}\n\t\tthis.resetLayers();\n\t}\n\n\tresetLayers() {\n\t\tlet i;\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (this.nodes[i] != null && this.nodes[i] !== undefined) {\n\t\t\t\tthis.nodes[i].addedToScene = this.activeLayers[this.nodes[i].layer] === true;\n\t\t\t}\n\t\t}\n\t\tfor (i = this.edges.length - 1; i >= 0; i--) {\n\t\t\tif (this.edges[i] != null && this.edges[i] !== undefined) {\n\t\t\t\tfor (let j = 0; j < this.edges[i].length; j++) {\n\t\t\t\t\tif (this.edges[i][j] != null && this.edges[i][j] !== undefined) {\n\t\t\t\t\t\tthis.edges[i][j].addedToScene =\n\t\t\t\t\t\t\tthis.activeLayers[this.edges[i][j].fromID.layer] === true &&\n\t\t\t\t\t\t\tthis.activeLayers[this.edges[i][j].toID.layer] === true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetLayer(objectID, layer) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].layer = layer;\n\t\t\tif (this.activeLayers[layer]) {\n\t\t\t\tthis.nodes[objectID].addedToScene = true;\n\t\t\t} else {\n\t\t\t\tthis.nodes[objectID].addedToScene = false;\n\t\t\t}\n\t\t\tif (this.edges[objectID] != null && this.edges[objectID] !== undefined) {\n\t\t\t\tfor (let i = 0; i < this.edges[objectID].length; i++) {\n\t\t\t\t\tconst nextEdge = this.edges[objectID][i];\n\t\t\t\t\tif (nextEdge != null && nextEdge !== undefined) {\n\t\t\t\t\t\tnextEdge.addedToScene =\n\t\t\t\t\t\t\tnextEdge.fromID.addedToScene && nextEdge.toID.addedToScene;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.backEdges[objectID] != null && this.backEdges[objectID] !== undefined) {\n\t\t\t\tfor (let i = 0; i < this.backEdges[objectID].length; i++) {\n\t\t\t\t\tconst nextEdge = this.backEdges[objectID][i];\n\t\t\t\t\tif (nextEdge != null && nextEdge !== undefined) {\n\t\t\t\t\t\tnextEdge.addedToScene =\n\t\t\t\t\t\t\tnextEdge.fromID.addedToScene && nextEdge.toID.addedToScene;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclearAllObjects() {\n\t\tthis.nodes = [];\n\t\tthis.edges = [];\n\t\tthis.backEdges = [];\n\t}\n\n\tsetForegroundColor(objectID, color) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setForegroundColor(color);\n\t\t}\n\t}\n\n\tsetBackgroundColor(objectID, color) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthis.nodes[objectID].setBackgroundColor(color);\n\t\t}\n\t}\n\n\tsetHighlight(nodeID, val, color) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].setHighlight(val, color);\n\t}\n\n\tgetHighlight(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn false;\n\t\t}\n\t\treturn this.nodes[nodeID].getHighlight();\n\t}\n\n\tgetHighlightIndex(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn false;\n\t\t}\n\t\treturn this.nodes[nodeID].getHighlightIndex();\n\t}\n\n\tsetWidth(nodeID, val) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].setWidth(val);\n\t}\n\n\tsetHeight(nodeID, val) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].setHeight(val);\n\t}\n\n\tgetHeight(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn -1;\n\t\t}\n\t\treturn this.nodes[nodeID].getHeight();\n\t}\n\n\tgetWidth(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn -1;\n\t\t}\n\t\treturn this.nodes[nodeID].getWidth();\n\t}\n\n\tbackgroundColor(objectID) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\treturn this.nodes[objectID].backgroundColor;\n\t\t} else {\n\t\t\treturn '#000000';\n\t\t}\n\t}\n\n\tforegroundColor(objectID) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\treturn this.nodes[objectID].foregroundColor;\n\t\t} else {\n\t\t\treturn '#000000';\n\t\t}\n\t}\n\n\tdisconnect(objectIDfrom, objectIDto) {\n\t\tlet undo = null;\n\t\tlet len;\n\t\tlet deleted;\n\t\tif (this.edges[objectIDfrom] != null) {\n\t\t\tlen = this.edges[objectIDfrom].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[objectIDfrom][i] != null &&\n\t\t\t\t\tthis.edges[objectIDfrom][i].toID === this.nodes[objectIDto]\n\t\t\t\t) {\n\t\t\t\t\tdeleted = this.edges[objectIDfrom][i];\n\t\t\t\t\tundo = deleted.createUndoConnect();\n\t\t\t\t\tthis.edges[objectIDfrom][i] = this.edges[objectIDfrom][len - 1];\n\t\t\t\t\tlen -= 1;\n\t\t\t\t\tthis.edges[objectIDfrom].pop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.backEdges[objectIDto] != null) {\n\t\t\tlen = this.backEdges[objectIDto].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.backEdges[objectIDto][i] != null &&\n\t\t\t\t\tthis.backEdges[objectIDto][i].fromID === this.nodes[objectIDfrom]\n\t\t\t\t) {\n\t\t\t\t\tdeleted = this.backEdges[objectIDto][i];\n\t\t\t\t\t// Note:  Don't need to remove this child, did it above on the regular edge\n\t\t\t\t\tthis.backEdges[objectIDto][i] = this.backEdges[objectIDto][len - 1];\n\t\t\t\t\tlen -= 1;\n\t\t\t\t\tthis.backEdges[objectIDto].pop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undo;\n\t}\n\n\tdeleteIncident(objectID) {\n\t\tconst undoStack = [];\n\t\tlet len;\n\t\tlet deleted;\n\t\tif (this.edges[objectID] != null) {\n\t\t\tlen = this.edges[objectID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tdeleted = this.edges[objectID][i];\n\t\t\t\tconst node2ID = deleted.toID.identifier();\n\t\t\t\tundoStack.push(deleted.createUndoConnect());\n\n\t\t\t\tlet len2 = this.backEdges[node2ID].length;\n\t\t\t\tfor (let j = len2 - 1; j >= 0; j--) {\n\t\t\t\t\tif (this.backEdges[node2ID][j] === deleted) {\n\t\t\t\t\t\tthis.backEdges[node2ID][j] = this.backEdges[node2ID][len2 - 1];\n\t\t\t\t\t\tlen2 -= 1;\n\t\t\t\t\t\tthis.backEdges[node2ID].pop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.edges[objectID] = null;\n\t\t}\n\t\tif (this.backEdges[objectID] != null) {\n\t\t\tlen = this.backEdges[objectID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tdeleted = this.backEdges[objectID][i];\n\t\t\t\tconst node1ID = deleted.fromID.identifier();\n\t\t\t\tundoStack.push(deleted.createUndoConnect());\n\n\t\t\t\tlet len2 = this.edges[node1ID].length;\n\t\t\t\tfor (let j = len2 - 1; j >= 0; j--) {\n\t\t\t\t\tif (this.edges[node1ID][j] === deleted) {\n\t\t\t\t\t\tthis.edges[node1ID][j] = this.edges[node1ID][len2 - 1];\n\t\t\t\t\t\tlen2 -= 1;\n\t\t\t\t\t\tthis.edges[node1ID].pop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.backEdges[objectID] = null;\n\t\t}\n\t\treturn undoStack;\n\t}\n\n\tremoveObject(objectID) {\n\t\tconst oldObject = this.nodes[objectID];\n\t\tif (objectID === this.nodes.length - 1) {\n\t\t\tthis.nodes.pop();\n\t\t} else {\n\t\t\tthis.nodes[objectID] = null;\n\t\t}\n\t\treturn oldObject;\n\t}\n\n\tgetObject(objectID) {\n\t\tif (this.nodes[objectID] == null || this.nodes[objectID] === undefined) {\n\t\t\tthrow new Error('getObject:Object with ID (' + String(objectID) + ') does not exist');\n\t\t}\n\t\treturn this.nodes[objectID];\n\t}\n\n\taddCircleObject(objectID, objectLabel) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error(\n\t\t\t\t'addCircleObject: object with same ID (' + String(objectID) + ') already exists!',\n\t\t\t);\n\t\t}\n\t\tconst newNode = new AnimatedCircle(objectID, objectLabel);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tgetNodeX(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('Getting x position of an object that does not exist');\n\t\t}\n\t\treturn this.nodes[nodeID].x;\n\t}\n\n\tgetTextWidth(text) {\n\t\t// TODO:  Need to make fonts more flexible, and less hardwired.\n\t\tthis.ctx.font = '12px Arial';\n\t\tconst strList = text.split('\\n');\n\t\tlet width = 0;\n\t\tif (strList.length === 1) {\n\t\t\twidth = this.ctx.measureText(text).width;\n\t\t} else {\n\t\t\tfor (let i = 0; i < strList.length; i++) {\n\t\t\t\twidth = Math.max(width, this.ctx.measureText(strList[i]).width);\n\t\t\t}\n\t\t}\n\n\t\treturn width;\n\t}\n\n\tsetText(nodeID, text, index) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('setting text of an object that does not exist');\n\t\t}\n\t\tthis.nodes[nodeID].setText(text, index, this.getTextWidth(text));\n\t}\n\n\tgetText(nodeID, index) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('getting text of an object that does not exist');\n\t\t}\n\t\treturn this.nodes[nodeID].getText(index);\n\t}\n\n\tgetNodeY(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('getting y position of an object that does not exist');\n\t\t}\n\t\treturn this.nodes[nodeID].y;\n\t}\n\n\tconnectEdge(objectIDfrom, objectIDto, color, curve, directed, lab, connectionPoint, thickness) {\n\t\tconst fromObj = this.nodes[objectIDfrom];\n\t\tconst toObj = this.nodes[objectIDto];\n\t\tif (fromObj == null || toObj == null) {\n\t\t\tthrow new Error(\"Tried to connect two nodes, one didn't exist!\");\n\t\t}\n\t\tconst l = new AnimatedLine(\n\t\t\tfromObj,\n\t\t\ttoObj,\n\t\t\tcolor,\n\t\t\tcurve,\n\t\t\tdirected,\n\t\t\tlab,\n\t\t\tconnectionPoint,\n\t\t\tthickness,\n\t\t);\n\t\tif (this.edges[objectIDfrom] == null) {\n\t\t\tthis.edges[objectIDfrom] = [];\n\t\t}\n\t\tif (this.backEdges[objectIDto] == null) {\n\t\t\tthis.backEdges[objectIDto] = [];\n\t\t}\n\t\tl.addedToScene = fromObj.addedToScene && toObj.addedToScene;\n\t\tthis.edges[objectIDfrom].push(l);\n\t\tthis.backEdges[objectIDto].push(l);\n\t}\n\n\tsetNull(objectID, nullVal) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setNull(nullVal);\n\t\t}\n\t}\n\n\tsetPrevNull(objectID, nullVal) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setPrevNull(nullVal);\n\t\t}\n\t}\n\n\tsetNextNull(objectID, nullVal) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setNextNull(nullVal);\n\t\t}\n\t}\n\n\tgetNull(objectID) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\treturn this.nodes[objectID].getNull();\n\t\t}\n\t\treturn false; // TODO:  Error here?\n\t}\n\n\tgetLeftNull(objectID) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\treturn this.nodes[objectID].getLeftNull();\n\t\t}\n\t\treturn false; // TODO:  Error here?\n\t}\n\n\tgetRightNull(objectID) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\treturn this.nodes[objectID].getRightNull();\n\t\t}\n\t\treturn false; // TODO:  Error here?\n\t}\n\n\tsetEdgeColor(\n\t\tfromID,\n\t\ttoID,\n\t\tcolor, // returns old color\n\t) {\n\t\tlet oldColor = '#000000';\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldColor = this.edges[fromID][i].color();\n\t\t\t\t\tthis.edges[fromID][i].setColor(color);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldColor;\n\t}\n\n\talignTop(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignTop(this.nodes[id2]);\n\t}\n\n\talignLeft(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignLeft(this.nodes[id2]);\n\t}\n\n\talignRight(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignRight(this.nodes[id2]);\n\t}\n\n\tgetAlignRightPos(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\treturn this.nodes[id1].getAlignRightPos(this.nodes[id2]);\n\t}\n\n\tgetAlignLeftPos(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\treturn this.nodes[id1].getAlignLeftPos(this.nodes[id2]);\n\t}\n\n\talignBottom(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Trying to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2),\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignBottom(this.nodes[id2]);\n\t}\n\n\tsetAlwaysOnTop(nodeID, onTop) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tconst oldTop = this.nodes[nodeID].alwaysOnTop;\n\t\t\tthis.nodes[nodeID].alwaysOnTop = onTop;\n\t\t\treturn oldTop;\n\t\t} else {\n\t\t\tthrow new Error(\"Trying to bring node that doesn't exist to top\");\n\t\t}\n\t}\n\n\tsetEdgeHighlight(fromID, toID, val, color) {\n\t\tlet oldHighlight = false;\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldHighlight = this.edges[fromID][i].highlighted;\n\t\t\t\t\tthis.edges[fromID][i].setHighlight(val, color);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldHighlight;\n\t}\n\n\tsetEdgeThickness(fromID, toID, val) {\n\t\tlet oldThickness = 1;\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldThickness = this.edges[fromID][i].thickness;\n\t\t\t\t\tthis.edges[fromID][i].setThickness(val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldThickness;\n\t}\n\n\tsetRectangleEdgeThickness(nodeID, thicknessArray) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tconst oldEdgeThickness = this.nodes[nodeID].getEdgeThickness();\n\t\t\tthis.nodes[nodeID].setEdgeThickness(thicknessArray);\n\t\t\treturn oldEdgeThickness;\n\t\t} else {\n\t\t\tthrow new Error(\"Trying to bring node that doesn't exist to top\");\n\t\t}\n\t}\n\n\taddLabelObject(objectID, objectLabel, centering) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error('addLabelObject: object already exists!');\n\t\t}\n\n\t\tconst newLabel = new AnimatedLabel(\n\t\t\tobjectID,\n\t\t\tobjectLabel,\n\t\t\tcentering,\n\t\t\tthis.getTextWidth(objectLabel),\n\t\t);\n\t\tthis.nodes[objectID] = newLabel;\n\t}\n\n\taddLinkedListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tlinkPer,\n\t\tverticalOrientation,\n\t\tlinkPosEnd,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addLinkedListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedLinkedListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkPer,\n\t\t\tverticalOrientation,\n\t\t\tlinkPosEnd,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddDoublyLinkedListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tlinkPer,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addDoublyLinkedListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedDoublyLinkedListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkPer,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddCircularlyLinkedListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tlinkPer,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addCircularlyLinkedListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedCircularlyLinkedListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkPer,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddSkipListObject(objectID, nodeLabel, width, height, backgroundColor, foregroundColor) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addSkipListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedSkipListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tgetNumElements(objectID) {\n\t\treturn this.nodes[objectID].getNumElements();\n\t}\n\n\tsetNumElements(objectID, numElems) {\n\t\tthis.nodes[objectID].setNumElements(numElems);\n\t}\n\n\taddBTreeNode(objectID, widthPerElem, height, numElems, backgroundColor, foregroundColor) {\n\t\tbackgroundColor = backgroundColor === undefined ? '#FFFFFF' : backgroundColor;\n\t\tforegroundColor = foregroundColor === undefined ? '#FFFFFF' : foregroundColor;\n\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error('addBTreeNode: object with same ID already exists!');\n\t\t}\n\n\t\tconst newNode = new AnimatedBTreeNode(\n\t\t\tobjectID,\n\t\t\twidthPerElem,\n\t\t\theight,\n\t\t\tnumElems,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddRectangleObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\txJustify,\n\t\tyJustify,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error('addRectangleObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedRectangle(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\txJustify,\n\t\t\tyJustify,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor,\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tsetNodePosition(nodeID, newX, newY) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tif (newX === undefined || newY === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].x = newX;\n\t\tthis.nodes[nodeID].y = newY;\n\t\t/* Don't need to dirty anything, since we repaint everything every frame\n\t\t (TODO:  Revisit if we do conditional redraws) */\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Global timer used for doing animation callbacks.\n//  TODO:  Make this an instance variable of Animation Manager.\n\n/* global canvas */\n\nimport {\n\tUndoCreate,\n\tUndoHighlight,\n\tUndoHighlightEdge,\n\tUndoMove,\n\tUndoSetAlpha,\n\tUndoSetAlwaysOnTop,\n\tUndoSetBackgroundColor,\n\tUndoSetEdgeAlpha,\n\tUndoSetEdgeColor,\n\tUndoSetEdgeThickness,\n\tUndoSetForegroundColor,\n\tUndoSetHeight,\n\tUndoSetHighlightIndex,\n\tUndoSetNextNull,\n\tUndoSetNull,\n\tUndoSetNumElements,\n\tUndoSetPosition,\n\tUndoSetPrevNull,\n\tUndoSetRectangleEdgeThickness,\n\tUndoSetText,\n\tUndoSetTextColor,\n\tUndoSetWidth,\n} from './UndoFunctions.js';\nimport EventListener from './CustomEvents.js';\nimport ObjectManager from './ObjectManager.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport SingleAnimation from './SingleAnimation.js';\nimport { Slider } from '@material-ui/core';\nimport { UndoConnect } from './AnimatedLine.js';\n\n// Utility function to read a cookie\nfunction getCookie(cookieName) {\n\tlet i, x, y;\n\tconst cookies = document.cookie.split(';');\n\tfor (i = 0; i < cookies.length; i++) {\n\t\tx = cookies[i].substr(0, cookies[i].indexOf('='));\n\t\ty = cookies[i].substr(cookies[i].indexOf('=') + 1);\n\t\tx = x.replace(/^\\s+|\\s+$/g, '');\n\t\tif (x === cookieName) {\n\t\t\treturn unescape(y);\n\t\t}\n\t}\n}\n\n// Utility function to write a cookie\nfunction setCookie(cookieName, value, expireDays) {\n\tconst exDate = new Date();\n\texDate.setDate(exDate.getDate() + expireDays);\n\tdocument.cookie = cookieName + '=' + value;\n}\n\nconst ANIMATION_SPEED_DEFAULT = 75;\n\n// TODO:  Move these out of global space into animation manager?\n\nfunction controlKey(keyASCII) {\n\treturn (\n\t\tkeyASCII === 8 ||\n\t\tkeyASCII === 9 ||\n\t\tkeyASCII === 37 ||\n\t\tkeyASCII === 38 ||\n\t\tkeyASCII === 39 ||\n\t\tkeyASCII === 40 ||\n\t\tkeyASCII === 46\n\t);\n}\n\nfunction returnSubmit(field, func, maxSize, intOnly) {\n\tif (maxSize !== undefined) {\n\t\tfield.size = maxSize;\n\t}\n\treturn function (event) {\n\t\tlet keyASCII = 0;\n\t\tif (window.event) {\n\t\t\t// IE\n\t\t\tkeyASCII = event.keyCode;\n\t\t} else if (event.which) {\n\t\t\t// Netscape/Firefox/Opera\n\t\t\tkeyASCII = event.which;\n\t\t}\n\n\t\tif (keyASCII === 13) {\n\t\t\tfunc();\n\t\t\treturn false;\n\t\t} else if (\n\t\t\tkeyASCII === 59 ||\n\t\t\tkeyASCII === 45 ||\n\t\t\tkeyASCII === 46 ||\n\t\t\tkeyASCII === 190 ||\n\t\t\tkeyASCII === 173\n\t\t) {\n\t\t\treturn false;\n\t\t} else if (\n\t\t\t(maxSize !== undefined && field.value.length >= maxSize) ||\n\t\t\t(intOnly && !((keyASCII >= 48 && keyASCII <= 57) || (keyASCII >= 96 && keyASCII <= 105)))\n\t\t) {\n\t\t\tif (!controlKey(keyASCII)) return false;\n\t\t}\n\t\treturn true;\n\t};\n}\n\nfunction addControlToAnimationBar(animBarRef, type, name, callback) {\n\tconst element = document.createElement('input');\n\n\telement.setAttribute('type', type);\n\telement.setAttribute('value', name);\n\tif (type === 'Button') {\n\t\telement.onclick = callback;\n\t} else if (type === 'Text') {\n\t\telement.onkeydown = callback;\n\t}\n\n\tconst tableEntry = document.createElement('td');\n\n\ttableEntry.appendChild(element);\n\n\tanimBarRef.current.appendChild(tableEntry);\n\treturn element;\n}\n\nfunction addDivisorToAnimationBar(animBarRef) {\n\tconst divisorLeft = document.createElement('td');\n\tdivisorLeft.setAttribute('class', 'divisorLeft');\n\n\tconst divisorRight = document.createElement('td');\n\tdivisorRight.setAttribute('class', 'divisorRight');\n\n\tanimBarRef.current.appendChild(divisorLeft);\n\tanimBarRef.current.appendChild(divisorRight);\n}\n\nexport default class AnimationManager extends EventListener {\n\tconstructor(canvasRef, animBarRef) {\n\t\tsuper();\n\n\t\tthis.objectManager = new ObjectManager(canvasRef);\n\t\t// Holder for all animated objects.\n\t\t// All animation is done by manipulating objects in\n\t\t// this container\n\t\tthis.animatedObjects = this.objectManager;\n\n\t\t// Control variables for stopping / starting animation\n\t\tthis.animationPaused = false;\n\t\tthis.awaitingStep = false;\n\t\tthis.currentlyAnimating = false;\n\n\t\t// Array holding the code for the animation.  This is\n\t\t// an array of strings, each of which is an animation command\n\t\t// currentAnimation is an index into this array\n\t\tthis.animationSteps = [];\n\t\tthis.currentAnimation = 0;\n\n\t\tthis.previousAnimationSteps = [];\n\n\t\t// Control variables for where we are in the current animation block.\n\t\t// currFrame holds the frame number of the current animation block,\n\t\t// while animationBlockLength holds the length of the current animation\n\t\t// block (in frame numbers).\n\t\tthis.currFrame = 0;\n\t\tthis.animationBlockLength = 0;\n\n\t\t//  The animation block that is currently running.  Array of singleAnimations\n\t\tthis.currentBlock = null;\n\n\t\t////////////////////////////////////\n\t\t// Variables for handling undo.\n\t\t////////////////////////////////////\n\t\t//  A stack of UndoBlock objects (subclassed, UndoBlock is an abstract base class)\n\t\t//  each of which can undo a single animation element\n\t\tthis.undoStack = [];\n\t\tthis.doingUndo = false;\n\n\t\t// A stack containing the beginning of each animation block, as an index\n\t\t// into the animationSteps array\n\t\tthis.undoAnimationStepIndices = [];\n\t\tthis.undoAnimationStepIndicesStack = [];\n\n\t\tthis.animationBlockLength = 10;\n\n\t\tthis.paused = false;\n\n\t\tthis.canvas = canvasRef;\n\n\t\tthis.skipBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Skip Back', () =>\n\t\t\tthis.skipBack(),\n\t\t);\n\t\tthis.stepBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Step Back', () =>\n\t\t\tthis.stepBack(),\n\t\t);\n\t\tthis.playPauseBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Pause', () =>\n\t\t\tthis.doPlayPause(),\n\t\t);\n\t\tthis.playPauseBackButton.setAttribute('style', 'width: 80px');\n\t\tthis.stepForwardButton = addControlToAnimationBar(\n\t\t\tanimBarRef,\n\t\t\t'Button',\n\t\t\t'Step Forward',\n\t\t\t() => this.step(),\n\t\t);\n\t\tthis.skipForwardButton = addControlToAnimationBar(\n\t\t\tanimBarRef,\n\t\t\t'Button',\n\t\t\t'Skip Forward',\n\t\t\t() => this.skipForward(),\n\t\t);\n\n\t\taddDivisorToAnimationBar(animBarRef);\n\n\t\tconst element = document.createElement('div');\n\t\telement.setAttribute('display', 'inline-block');\n\t\telement.setAttribute('float', 'left');\n\n\t\tlet speed = getCookie('VisualizationSpeed');\n\t\tif (speed == null || speed === '') {\n\t\t\tspeed = ANIMATION_SPEED_DEFAULT;\n\t\t} else {\n\t\t\tspeed = parseInt(speed);\n\t\t}\n\n\t\tconst slider = (\n\t\t\t<Slider\n\t\t\t\tdefaultValue={speed}\n\t\t\t\tonChange={(e, val) => {\n\t\t\t\t\tthis.setSpeed(val);\n\t\t\t\t\tsetCookie('VisualizationSpeed', String(val), 30);\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\n\t\tlet tableEntry = document.createElement('td');\n\n\t\tconst controlBar = document.getElementById('GeneralAnimationControls');\n\n\t\tconst newTable = document.createElement('table');\n\n\t\tlet midLevel = document.createElement('tr');\n\t\tlet bottomLevel = document.createElement('td');\n\t\tmidLevel.appendChild(bottomLevel);\n\t\tReactDOM.render(slider, bottomLevel);\n\t\tnewTable.appendChild(midLevel);\n\n\t\tmidLevel = document.createElement('tr');\n\t\tbottomLevel = document.createElement('td');\n\t\tbottomLevel.align = 'center';\n\t\tlet txtNode = document.createTextNode('Animation Speed');\n\t\tmidLevel.appendChild(bottomLevel);\n\t\tbottomLevel.appendChild(txtNode);\n\t\tnewTable.appendChild(midLevel);\n\n\t\ttableEntry.appendChild(newTable);\n\n\t\t// Append the element in page (in span)\n\t\tcontrolBar.appendChild(tableEntry);\n\n\t\tthis.setSpeed(speed);\n\n\t\telement.setAttribute('style', 'width:200px');\n\n\t\taddDivisorToAnimationBar(animBarRef);\n\n\t\tlet width = getCookie('VisualizationWidth');\n\t\twidth = width == null || width === '' ? 1500 : parseInt(width);\n\n\t\tlet height = getCookie('VisualizationHeight');\n\t\theight = height == null || height === '' ? 505 : parseInt(height);\n\n\t\tcanvas.width = width;\n\t\tcanvas.height = height;\n\n\t\ttableEntry = document.createElement('td');\n\t\ttxtNode = document.createTextNode('h:');\n\t\ttableEntry.appendChild(txtNode);\n\t\tcontrolBar.appendChild(tableEntry);\n\n\t\tthis.heightEntry = addControlToAnimationBar(animBarRef, 'Text', canvas.height, () =>\n\t\t\treturnSubmit(\n\t\t\t\tthis.heightEntry,\n\t\t\t\t() =>\n\t\t\t\t\tthis.changeSize(\n\t\t\t\t\t\tdocument.documentElement.clientWidth,\n\t\t\t\t\t\tparseInt(this.heightEntry.value),\n\t\t\t\t\t),\n\t\t\t\t4,\n\t\t\t\ttrue,\n\t\t\t),\n\t\t);\n\n\t\tthis.heightEntry.size = 4;\n\t\tthis.sizeButton = addControlToAnimationBar(animBarRef, 'Button', 'Change Canvas Size', () =>\n\t\t\tthis.changeSize(),\n\t\t);\n\n\t\tthis.addListener('AnimationStarted', this, this.animStarted);\n\t\tthis.addListener('AnimationEnded', this, this.animEnded);\n\t\tthis.addListener('AnimationWaiting', this, this.animWaiting);\n\t\tthis.addListener('AnimationUndoUnavailable', this, this.animUndoUnavailable);\n\t\tthis.objectManager.width = canvas.width;\n\t\tthis.objectManager.height = canvas.height;\n\t}\n\n\tlerp(from, to, percent) {\n\t\treturn (to - from) * percent + from;\n\t}\n\n\t// Pause / unpause animation\n\tsetPaused(pausedValue) {\n\t\tthis.animationPaused = pausedValue;\n\t\tif (!this.animationPaused) {\n\t\t\tthis.step();\n\t\t}\n\t}\n\n\tparseBool(str) {\n\t\tconst uppercase = str.toUpperCase();\n\t\tconst returnVal = !(\n\t\t\tuppercase === 'False' ||\n\t\t\tuppercase === 'f' ||\n\t\t\tuppercase === ' 0' ||\n\t\t\tuppercase === '0' ||\n\t\t\tuppercase === ''\n\t\t);\n\t\treturn returnVal;\n\t}\n\n\tparseColor(clr) {\n\t\tif (clr.charAt(0) === '#') {\n\t\t\treturn clr;\n\t\t} else if (clr.substring(0, 2) === '0x') {\n\t\t\treturn '#' + clr.substring(2);\n\t\t}\n\t}\n\n\t// Set the speed of the animation, from 0 (slow) to 100 (fast)\n\tsetSpeed(newSpeed) {\n\t\tthis.animationBlockLength = Math.floor((100 - newSpeed) / 2);\n\t}\n\n\tchangeSize(\n\t\twidth = document.documentElement.clientWidth,\n\t\theight = parseInt(this.heightEntry.value),\n\t) {\n\t\tif (width > 100) {\n\t\t\tcanvas.width = width;\n\t\t\tthis.animatedObjects.width = width;\n\t\t\tsetCookie('VisualizationWidth', String(width), 30);\n\t\t}\n\t\tif (height > 100) {\n\t\t\tcanvas.height = height;\n\t\t\tthis.animatedObjects.height = height;\n\t\t\tsetCookie('VisualizationHeight', String(height), 30);\n\t\t}\n\t\tthis.heightEntry.value = canvas.height;\n\n\t\tthis.animatedObjects.draw();\n\t\tthis.fireEvent('CanvasSizeChanged', { width: canvas.width, height: canvas.height });\n\t}\n\n\tstartNextBlock() {\n\t\tthis.awaitingStep = false;\n\t\tthis.currentBlock = [];\n\t\tthis.undoBlock = [];\n\t\tif (this.currentAnimation === this.animationSteps.length) {\n\t\t\tthis.currentlyAnimating = false;\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\t\t\treturn;\n\t\t}\n\t\tthis.undoAnimationStepIndices.push(this.currentAnimation);\n\n\t\tthis.foundBreak = false;\n\t\tthis.anyAnimations = false;\n\n\t\twhile (this.currentAnimation < this.animationSteps.length && !this.foundBreak) {\n\t\t\tconst [act, params] = this.animationSteps[this.currentAnimation];\n\t\t\tact.call(this, params);\n\t\t\tthis.currentAnimation++;\n\t\t}\n\t\tthis.currFrame = 0;\n\n\t\t// Hack:  If there are not any animations, and we are currently paused,\n\t\t// then set the current frame to the end of the animation, so that we will\n\t\t// advance immediately upon the next step button.  If we are not paused, then\n\t\t// animate as normal.\n\t\tif (\n\t\t\t(!this.anyAnimations && this.animationPaused) ||\n\t\t\t(!this.anyAnimations && this.currentAnimation === this.animationSteps.length)\n\t\t) {\n\t\t\tthis.currFrame = this.animationBlockLength;\n\t\t}\n\n\t\tthis.undoStack.push(this.undoBlock);\n\t}\n\n\t//  Start a new animation.  The input parameter commands is an array of strings,\n\t//  which represents the animation to start\n\tstartNewAnimation(commands) {\n\t\tthis.stopTimer();\n\t\tif (this.animationSteps !== null) {\n\t\t\tthis.previousAnimationSteps.push(this.animationSteps);\n\t\t\tthis.undoAnimationStepIndicesStack.push(this.undoAnimationStepIndices);\n\t\t}\n\t\tif (commands === undefined || commands.length === 0) {\n\t\t\tthis.animationSteps = [[act.step, []]];\n\t\t} else {\n\t\t\tthis.animationSteps = commands;\n\t\t}\n\t\tthis.undoAnimationStepIndices = [];\n\t\tthis.currentAnimation = 0;\n\t\tthis.startNextBlock();\n\t\tthis.currentlyAnimating = true;\n\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\tthis.startTimer();\n\t}\n\n\t// Step backwards one step.  A no-op if the animation is not currently paused\n\tstepBack() {\n\t\tif (this.awaitingStep && this.undoStack !== null && this.undoStack.length !== 0) {\n\t\t\t//  TODO:  Get events working correctly!\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\t\tthis.stopTimer();\n\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.undoLastBlock();\n\t\t\t// Re-kick the timer.  The timer may or may not be running at this point,\n\t\t\t// so to be safe we'll kill it and start it again.\n\t\t\tthis.stopTimer();\n\t\t\tthis.startTimer();\n\t\t} else if (\n\t\t\t!this.currentlyAnimating &&\n\t\t\tthis.animationPaused &&\n\t\t\tthis.undoAnimationStepIndices !== null\n\t\t) {\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\t\tthis.currentlyAnimating = true;\n\t\t\tthis.undoLastBlock();\n\t\t\t// Re-kick the timer.  The timer may or may not be running at this point,\n\t\t\t// so to be safe we'll kill it and start it again.\n\t\t\tthis.stopTimer();\n\t\t\tthis.startTimer();\n\t\t}\n\t}\n\n\t// Step forwards one step.  A no-op if the animation is not currently paused\n\tstep() {\n\t\tif (this.awaitingStep) {\n\t\t\tthis.startNextBlock();\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\t\tthis.currentlyAnimating = true;\n\t\t\t// Re-kick the timer.  The timer should be going now, but we've had some difficulty with\n\t\t\t// it timing itself out, so we'll be safe and kick it now.\n\t\t\tthis.stopTimer();\n\t\t\tthis.startTimer();\n\t\t}\n\t}\n\n\t/// WARNING:  Could be dangerous to call while an animation is running ...\n\tclearHistory() {\n\t\tthis.undoStack = [];\n\t\tthis.undoAnimationStepIndices = null;\n\t\tthis.previousAnimationSteps = [];\n\t\tthis.undoAnimationStepIndicesStack = [];\n\t\tthis.animationSteps = null;\n\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\n\t\tthis.stopTimer();\n\t\tthis.animatedObjects.update();\n\t\tthis.animatedObjects.draw();\n\t}\n\n\tskipBack() {\n\t\tlet keepUndoing =\n\t\t\tthis.undoAnimationStepIndices !== null && this.undoAnimationStepIndices.length !== 0;\n\t\tif (keepUndoing) {\n\t\t\tlet i;\n\t\t\tfor (i = 0; this.currentBlock !== null && i < this.currentBlock.length; i++) {\n\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\tobjectID,\n\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (this.doingUndo) {\n\t\t\t\tthis.finishUndoBlock(this.undoStack.pop());\n\t\t\t}\n\t\t\twhile (keepUndoing) {\n\t\t\t\tthis.undoLastBlock();\n\t\t\t\tfor (i = 0; i < this.currentBlock.length; i++) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tobjectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tkeepUndoing = this.finishUndoBlock(this.undoStack.pop());\n\t\t\t}\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\t\t\tif (this.undoStack == null || this.undoStack.length === 0) {\n\t\t\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\n\t\t\t}\n\t\t}\n\t}\n\n\tresetAll() {\n\t\tthis.clearHistory();\n\t\tthis.animatedObjects.clearAllObjects();\n\t\tthis.animatedObjects.draw();\n\t\tthis.stopTimer();\n\t}\n\n\tskipForward() {\n\t\tif (this.currentlyAnimating) {\n\t\t\tthis.animatedObjects.runFast = true;\n\t\t\twhile (\n\t\t\t\tthis.animationSteps !== null &&\n\t\t\t\tthis.currentAnimation < this.animationSteps.length\n\t\t\t) {\n\t\t\t\tfor (let i = 0; this.currentBlock !== null && i < this.currentBlock.length; i++) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tobjectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (this.doingUndo) {\n\t\t\t\t\tthis.finishUndoBlock(this.undoStack.pop());\n\t\t\t\t}\n\t\t\t\tthis.startNextBlock();\n\t\t\t\tfor (let i = 0; i < this.currentBlock.length; i++) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tobjectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.currentlyAnimating = false;\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.doingUndo = false;\n\n\t\t\tthis.animatedObjects.runFast = false;\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\t\t}\n\t}\n\n\tfinishUndoBlock(undoBlock) {\n\t\tfor (let i = undoBlock.length - 1; i >= 0; i--) {\n\t\t\tundoBlock[i].undoInitialStep(this.animatedObjects);\n\t\t}\n\t\tthis.doingUndo = false;\n\n\t\t// If we are at the final end of the animation ...\n\t\tif (this.undoAnimationStepIndices.length === 0) {\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.currentlyAnimating = false;\n\t\t\tthis.undoAnimationStepIndices = this.undoAnimationStepIndicesStack.pop();\n\t\t\tthis.animationSteps = this.previousAnimationSteps.pop();\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\n\t\t\tthis.fireEvent('AnimationUndo', 'NoData');\n\t\t\tthis.currentBlock = [];\n\t\t\tif (this.undoStack == null || this.undoStack.length === 0) {\n\t\t\t\tthis.currentlyAnimating = false;\n\t\t\t\tthis.awaitingStep = false;\n\t\t\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\n\t\t\t}\n\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tundoLastBlock() {\n\t\tif (this.undoAnimationStepIndices.length === 0) {\n\t\t\t// Nothing on the undo stack.  Return\n\t\t\treturn;\n\t\t}\n\t\tif (this.undoAnimationStepIndices.length > 0) {\n\t\t\tthis.doingUndo = true;\n\t\t\tlet anyAnimations = false;\n\t\t\tthis.currentAnimation = this.undoAnimationStepIndices.pop();\n\t\t\tthis.currentBlock = [];\n\t\t\tconst undo = this.undoStack[this.undoStack.length - 1];\n\t\t\tlet i;\n\t\t\tfor (i = undo.length - 1; i >= 0; i--) {\n\t\t\t\tconst animateNext = undo[i].addUndoAnimation(this.currentBlock);\n\t\t\t\tanyAnimations = anyAnimations || animateNext;\n\t\t\t}\n\t\t\tthis.currFrame = 0;\n\n\t\t\t// Hack:  If there are not any animations, and we are currently paused,\n\t\t\t// then set the current frame to the end of the animation, so that we will\n\t\t\t// advance immediately upon the next step button.  If we are not paused, then\n\t\t\t// animate as normal.\n\t\t\tif (!anyAnimations && this.animationPaused) {\n\t\t\t\tthis.currFrame = this.animationBlockLength;\n\t\t\t}\n\t\t\tthis.currentlyAnimating = true;\n\t\t}\n\t}\n\n\tsetLayer(shown, layers) {\n\t\tthis.animatedObjects.setLayer(shown, layers);\n\t\t// Drop in an extra draw call here, just in case we are not\n\t\t// in the middle of an update loop when this changes\n\t\tthis.animatedObjects.draw();\n\t}\n\n\tsetAllLayers(layers) {\n\t\tthis.animatedObjects.setAllLayers(layers);\n\t\t// Drop in an extra draw call here, just in case we are not\n\t\t// in the middle of an update loop when this changes\n\t\tthis.animatedObjects.draw();\n\t}\n\n\tupdate() {\n\t\tif (this.currentlyAnimating) {\n\t\t\tthis.currFrame = this.currFrame + 1;\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < this.currentBlock.length; i++) {\n\t\t\t\tif (\n\t\t\t\t\tthis.currFrame === this.animationBlockLength ||\n\t\t\t\t\t(this.currFrame === 1 && this.animationBlockLength === 0)\n\t\t\t\t) {\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tthis.currentBlock[i].objectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t);\n\t\t\t\t} else if (this.currFrame < this.animationBlockLength) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tconst percent = 1 / (this.animationBlockLength - this.currFrame);\n\t\t\t\t\tconst newX = this.lerp(\n\t\t\t\t\t\tthis.animatedObjects.getNodeX(objectID),\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tpercent,\n\t\t\t\t\t);\n\t\t\t\t\tconst newY = this.lerp(\n\t\t\t\t\t\tthis.animatedObjects.getNodeY(objectID),\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t\tpercent,\n\t\t\t\t\t);\n\t\t\t\t\tthis.animatedObjects.setNodePosition(objectID, newX, newY);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.currFrame >= this.animationBlockLength) {\n\t\t\t\tif (this.doingUndo) {\n\t\t\t\t\tif (this.finishUndoBlock(this.undoStack.pop())) {\n\t\t\t\t\t\tthis.awaitingStep = true;\n\t\t\t\t\t\tthis.fireEvent('AnimationWaiting', 'NoData');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.animationPaused &&\n\t\t\t\t\t\tthis.currentAnimation < this.animationSteps.length\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.awaitingStep = true;\n\t\t\t\t\t\tthis.fireEvent('AnimationWaiting', 'NoData');\n\t\t\t\t\t\tthis.currentBlock = [];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.startNextBlock();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.animatedObjects.update();\n\t\t}\n\t}\n\n\tanimWaiting() {\n\t\tthis.stepForwardButton.disabled = false;\n\t\tif (this.skipBackButton.disabled === false) {\n\t\t\tthis.stepBackButton.disabled = false;\n\t\t}\n\t\tthis.objectManager.statusReport.setText('Animation Paused');\n\t\tthis.objectManager.statusReport.setForegroundColor('#FF0000');\n\t}\n\n\tanimStarted() {\n\t\tthis.skipForwardButton.disabled = false;\n\t\tthis.skipBackButton.disabled = false;\n\t\tthis.stepForwardButton.disabled = true;\n\t\tthis.stepBackButton.disabled = true;\n\t\tthis.objectManager.statusReport.setText('Animation Running');\n\t\tthis.objectManager.statusReport.setForegroundColor('#009900');\n\t}\n\n\tanimEnded() {\n\t\tthis.skipForwardButton.disabled = true;\n\t\tthis.stepForwardButton.disabled = true;\n\t\tif (this.skipBackButton.disabled === false && this.paused) {\n\t\t\tthis.stepBackButton.disabled = false;\n\t\t}\n\t\tthis.objectManager.statusReport.setText('Animation Completed');\n\t\tthis.objectManager.statusReport.setForegroundColor('#000000');\n\t}\n\n\tanimUndoUnavailable() {\n\t\tthis.skipBackButton.disabled = true;\n\t\tthis.stepBackButton.disabled = true;\n\t}\n\n\ttimeout() {\n\t\t// We need to set the timeout *first*, otherwise if we\n\t\t// try to clear it later, we get behavior we don't want ...\n\t\tthis.timer = setTimeout(() => this.timeout(), 30);\n\t\tthis.update();\n\t\tthis.objectManager.draw();\n\t}\n\n\tdoPlayPause() {\n\t\tthis.paused = !this.paused;\n\t\tif (this.paused) {\n\t\t\tthis.playPauseBackButton.setAttribute('value', 'Play');\n\t\t\tif (this.skipBackButton.disabled === false) {\n\t\t\t\tthis.stepBackButton.disabled = false;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.playPauseBackButton.setAttribute('value', 'Pause');\n\t\t}\n\t\tthis.setPaused(this.paused);\n\t}\n\n\tstartTimer() {\n\t\tthis.timer = setTimeout(() => this.timeout(), 30);\n\t}\n\n\tstopTimer() {\n\t\tclearInterval(this.timer);\n\t}\n}\n\nexport const act = {\n\tstep() {\n\t\tthis.foundBreak = true;\n\t},\n\tmove(params) {\n\t\t// id, x, y\n\t\tconst nextAnim = new SingleAnimation(\n\t\t\tparams[0],\n\t\t\tthis.animatedObjects.getNodeX(params[0]),\n\t\t\tthis.animatedObjects.getNodeY(params[0]),\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t);\n\t\tthis.currentBlock.push(nextAnim);\n\t\tthis.undoBlock.push(\n\t\t\tnew UndoMove(\n\t\t\t\tnextAnim.objectID,\n\t\t\t\tnextAnim.toX,\n\t\t\t\tnextAnim.toY,\n\t\t\t\tnextAnim.fromX,\n\t\t\t\tnextAnim.fromY,\n\t\t\t),\n\t\t);\n\t\tthis.anyAnimations = true;\n\t},\n\tdelete(params) {\n\t\t// id\n\t\tconst removedEdges = this.animatedObjects.deleteIncident(params[0]);\n\t\tif (removedEdges.length > 0) {\n\t\t\tthis.undoBlock = this.undoBlock.concat(removedEdges);\n\t\t}\n\t\tconst obj = this.animatedObjects.getObject(params[0]);\n\t\tif (obj !== null) {\n\t\t\tthis.undoBlock.push(obj.createUndoDelete());\n\t\t\tthis.animatedObjects.removeObject(params[0]);\n\t\t}\n\t},\n\tconnect(params) {\n\t\t// fromID, toID | color, curve, directed, label, anchorPos, thickness\n\t\tparams[2] = params[2] || '#000000';\n\t\tparams[3] = params[3] || 0.0;\n\t\tparams[4] = params[4] !== false && params[4] !== 0;\n\t\tparams[5] = params[5] === undefined ? '' : params[5];\n\t\tparams[6] = params[6] || 0;\n\t\tparams[7] = params[7] === undefined ? 1 : params[7];\n\t\tthis.animatedObjects.connectEdge(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[4],\n\t\t\tString(params[5]),\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectNext(params) {\n\t\t// fromID, toID\n\t\tthis.animatedObjects.connectEdge(params[0], params[1], '#000000', 0.0, true, '', 0);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectPrev(params) {\n\t\t// fromID, toID\n\t\tthis.animatedObjects.connectEdge(params[0], params[1], '#000000', 0.0, true, '', 1);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectCurve(params) {\n\t\t// fromID, toID, curve\n\t\tthis.animatedObjects.connectEdge(params[0], params[1], '#000000', params[2], true, '', 1);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectSkipList(params) {\n\t\t// fromID, toID, anchorPos\n\t\tthis.animatedObjects.connectEdge(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\t'#000000',\n\t\t\t0.0,\n\t\t\tfalse,\n\t\t\t'',\n\t\t\tparams[2],\n\t\t);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tdisconnect(params) {\n\t\t// fromID, toID\n\t\tconst undoConnect = this.animatedObjects.disconnect(params[0], params[1]);\n\t\tif (undoConnect !== null) this.undoBlock.push(undoConnect);\n\t},\n\tcreateCircle(params) {\n\t\t// id, label | x, y\n\t\tparams[2] = params[2] || 0;\n\t\tparams[3] = params[3] || 0;\n\t\tthis.animatedObjects.addCircleObject(params[0], String(params[1]));\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparseInt(params[0]),\n\t\t\tparseInt(params[2]),\n\t\t\tparseInt(params[3]),\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateHighlightCircle(params) {\n\t\t// id, color | x, y, radius\n\t\tparams[2] = params[2] || 0;\n\t\tparams[3] = params[3] || 0;\n\t\tparams[4] = params[4] === undefined ? 20 : params[4];\n\t\tthis.animatedObjects.addHighlightCircleObject(params[0], params[1], params[4]);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparseInt(params[0]),\n\t\t\tparseInt(params[2]),\n\t\t\tparseInt(params[3]),\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateRectangle(params) {\n\t\t// id, label, w, h | x, y, xJustify, yJustify, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] || 'center';\n\t\tparams[7] = params[7] || 'center';\n\t\tparams[8] = params[8] || '#FFFFFF';\n\t\tparams[9] = params[9] || '#000000';\n\t\tthis.animatedObjects.addRectangleObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t\tparams[9],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateLabel(params) {\n\t\t// id, label | x, y, centered\n\t\tparams[2] = params[2] || 0;\n\t\tparams[3] = params[3] || 0;\n\t\tparams[4] = params[4] !== false && params[4] !== 0;\n\t\tthis.animatedObjects.addLabelObject(params[0], String(params[1]), params[4]);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[2], params[3]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateLinkedListNode(params) {\n\t\t// id, label, w, h | x, y, linkPercent, vertical, linkPosEnd, bgColor, fgColor\n\t\tparams[1] = Array.isArray(params[1]) ? params[1].map(x => String(x)) : [String(params[1])];\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] === undefined ? 0.25 : params[6];\n\t\tparams[7] = params[7] !== false && params[7] !== 0;\n\t\tparams[8] = params[8] || false;\n\t\tparams[9] = params[9] || '#FFFFFF';\n\t\tparams[10] = params[10] || '#000000';\n\t\tthis.animatedObjects.addLinkedListObject(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t\tparams[9],\n\t\t\tparams[10],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateDoublyLinkedListNode(params) {\n\t\t// id, label, w, h | x, y, linkPercent, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] === undefined ? 0.25 : params[6];\n\t\tparams[7] = params[7] || '#FFFFFF';\n\t\tparams[8] = params[8] || '#000000';\n\t\tthis.animatedObjects.addDoublyLinkedListObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateCircularlyLinkedListNode(params) {\n\t\t// id, label, w, h | x, y, linkPercent, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] === undefined ? 0.25 : params[6];\n\t\tparams[7] = params[7] || '#FFFFFF';\n\t\tparams[8] = params[8] || '#000000';\n\t\tthis.animatedObjects.addCircularlyLinkedListObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateSkipListNode(params) {\n\t\t// id, label, w, h | x, y, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] || '#FFFFFF';\n\t\tparams[7] = params[7] || '#000000';\n\t\tthis.animatedObjects.addSkipListObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateBTreeNode(params) {\n\t\t// id, widthPerElement, height, numLabels, x, y, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] || '#FFFFFF';\n\t\tparams[7] = params[7] || '#000000';\n\t\tthis.animatedObjects.addBTreeNode(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[4], params[5]);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tsetText(params) {\n\t\t// id, text | textIndex\n\t\tparams[2] = params[2] || 0;\n\t\tconst oldText = this.animatedObjects.getText(params[0], params[2]);\n\t\tthis.animatedObjects.setText(params[0], String(params[1]), params[2]);\n\t\tif (oldText !== undefined) {\n\t\t\tthis.undoBlock.push(new UndoSetText(params[0], oldText, params[2]));\n\t\t}\n\t},\n\tsetTextColor(params) {\n\t\t// id, color, textIndex\n\t\tparams[2] = params[2] || 0;\n\t\tconst oldColor = this.animatedObjects.getTextColor(params[0], params[2]);\n\t\tthis.animatedObjects.setTextColor(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetTextColor(params[0], oldColor, params[2]));\n\t},\n\tsetForegroundColor(params) {\n\t\t// id, color\n\t\tconst oldColor = this.animatedObjects.foregroundColor(params[0]);\n\t\tthis.animatedObjects.setForegroundColor(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetForegroundColor(params[0], oldColor));\n\t},\n\tsetBackgroundColor(params) {\n\t\t// id, color\n\t\tconst oldColor = this.animatedObjects.backgroundColor(params[0]);\n\t\tthis.animatedObjects.setBackgroundColor(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetBackgroundColor(params[0], oldColor));\n\t},\n\tsetHighlight(params) {\n\t\t// id, highlight, color\n\t\tthis.animatedObjects.setHighlight(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoHighlight(params[0], !params[1], params[2]));\n\t},\n\tsetAlpha(params) {\n\t\t// id, alpha\n\t\tconst oldAlpha = this.animatedObjects.getAlpha(params[0]);\n\t\tthis.animatedObjects.setAlpha(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetAlpha(params[0], oldAlpha));\n\t},\n\tsetEdgeColor(params) {\n\t\t// fromID, toID, newColor\n\t\tconst oldColor = this.animatedObjects.setEdgeColor(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetEdgeColor(params[0], params[1], oldColor));\n\t},\n\tsetEdgeAlpha(params) {\n\t\t// fromID, toID, alpha\n\t\tconst oldAlpha = this.animatedObjects.setEdgeAlpha(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetEdgeAlpha(params[0], params[1], oldAlpha));\n\t},\n\tsetEdgeHighlight(params) {\n\t\t// fromID, toID, highlight\n\t\tconst oldHighlight = this.animatedObjects.setEdgeHighlight(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t);\n\t\tthis.undoBlock.push(new UndoHighlightEdge(params[0], params[1], oldHighlight));\n\t},\n\tsetEdgeThickness(params) {\n\t\t// fromID, toID, thickness\n\t\tconst oldThickness = this.animatedObjects.setEdgeThickness(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetEdgeThickness(params[0], params[1], oldThickness));\n\t},\n\tsetRectangleEdgeThickness(params) {\n\t\t//id, thicknessArray\n\t\tconst oldThicknessArray = this.animatedObjects.setRectangleEdgeThickness(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t);\n\t\tthis.undoBlock.push(new UndoSetRectangleEdgeThickness(params[0], oldThicknessArray));\n\t},\n\tsetHeight(params) {\n\t\t// id, height\n\t\tconst oldHeight = this.animatedObjects.getHeight(params[0]);\n\t\tthis.animatedObjects.setHeight(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetHeight(params[0], oldHeight));\n\t},\n\tsetWidth(params) {\n\t\t// id, width\n\t\tconst oldWidth = this.animatedObjects.getWidth(params[0]);\n\t\tthis.animatedObjects.setWidth(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetWidth(params[0], oldWidth));\n\t},\n\tsetLayer(params) {\n\t\t// id, height\n\t\tthis.animatedObjects.setLayer(params[0], params[1]);\n\t\t//TODO: Add undo information here\n\t},\n\tsetNull(params) {\n\t\t// id, null\n\t\tconst oldNull = this.animatedObjects.getNull(params[0]);\n\t\tthis.animatedObjects.setNull(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetNull(params[0], oldNull));\n\t},\n\tsetPrevNull(params) {\n\t\t// id, null\n\t\tconst oldNull = this.animatedObjects.getLeftNull(params[0]);\n\t\tthis.animatedObjects.setPrevNull(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPrevNull(params[0], oldNull));\n\t},\n\tsetNextNull(params) {\n\t\t// id, null\n\t\tconst oldNull = this.animatedObjects.getRightNull(params[0]);\n\t\tthis.animatedObjects.setNextNull(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetNextNull(params[0], oldNull));\n\t},\n\tsetNumElements(params) {\n\t\t// id, numElements\n\t\tconst oldElem = this.animatedObjects.getObject(params[0]);\n\t\tthis.undoBlock.push(new UndoSetNumElements(oldElem, params[1]));\n\t\tthis.animatedObjects.setNumElements(params[0], params[1]);\n\t},\n\tsetPosition(params) {\n\t\t// id, x, y\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.setNodePosition(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\tsetHighlightIndex(params) {\n\t\tconst oldIndex = this.animatedObjects.getHighlightIndex(params[0]);\n\t\tthis.undoBlock.push(new UndoSetHighlightIndex(params[0], oldIndex));\n\t\tthis.animatedObjects.setHighlightIndex(params[0], params[1]);\n\t},\n\talignRight(params) {\n\t\t// id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignRight(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\talignLeft(params) {\n\t\t// id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignLeft(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\talignTop(params) {\n\t\t// id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignTop(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\talignBottom(params) {\n\t\t// id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignBottom(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\tbringToTop(params) {\n\t\tconst oldTop = this.animatedObjects.setAlwaysOnTop(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetAlwaysOnTop(params[0], oldTop));\n\t},\n\tmoveToAlignRight(params) {\n\t\t// id, otherID\n\t\tconst newXY = this.animatedObjects.getAlignRightPos(params[0], params[1]);\n\t\tconst nextAnim = new SingleAnimation(\n\t\t\tparams[0],\n\t\t\tthis.animatedObjects.getNodeX(params[0]),\n\t\t\tthis.animatedObjects.getNodeY(params[0]),\n\t\t\tnewXY[0],\n\t\t\tnewXY[1],\n\t\t);\n\t\tthis.currentBlock.push(nextAnim);\n\t\tthis.undoBlock.push(\n\t\t\tnew UndoMove(\n\t\t\t\tnextAnim.objectID,\n\t\t\t\tnextAnim.toX,\n\t\t\t\tnextAnim.toY,\n\t\t\t\tnextAnim.fromX,\n\t\t\t\tnextAnim.fromY,\n\t\t\t),\n\t\t);\n\t\tthis.anyAnimations = true;\n\t},\n};\n","import React from 'react';\n\nconst Footer = () => (\n\t<div className=\"footer\">\n\t\tCopyright 2019 <a href=\"https://rodrigodlpontes.github.io/website/\">Rodrigo Pontes</a>,\n\t\tCopyright 2011 <a href=\"http://www.cs.usfca.edu/galles\">David Galles</a>\n\t</div>\n);\n\nexport default Footer;\n","import { Link } from 'react-router-dom';\nimport React from 'react';\n\nclass Header extends React.Component {\n\tstate = { menuVisible: null };\n\n\trender() {\n\t\tconst menuClass = { null: '', true: 'show', false: 'hide' };\n\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<div className=\"header\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName={this.state.menuVisible ? 'selected' : ''}\n\t\t\t\t\t\tonClick={this.toggleMenu}\n\t\t\t\t\t></button>\n\t\t\t\t\t<h1>CS1332 Data Structures and Algorithms Visualizations</h1>\n\t\t\t\t</div>\n\t\t\t\t<div className={`menu ${menuClass[this.state.menuVisible]}`}>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<Link to=\"/\" onClick={this.toggleMenu}>\n\t\t\t\t\t\t\t\tHome\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<Link to=\"/about\" onClick={this.toggleMenu}>\n\t\t\t\t\t\t\t\tAbout\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href=\"https://github.com/RodrigoDLPontes/visualization-tool\">\n\t\t\t\t\t\t\t\tSource Code\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n\n\ttoggleMenu = () => this.setState(state => ({ menuVisible: !state.menuVisible }));\n}\n\nexport default Header;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport { act } from '../anim/AnimationMain';\n\nexport function addLabelToAlgorithmBar(labelName, group) {\n\tconst element = document.createElement('p');\n\telement.appendChild(document.createTextNode(labelName));\n\n\tif (!group) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(element);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\t// Append the element in page (in span)\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tgroup.appendChild(element);\n\t\telement.setAttribute('class', 'groupChild');\n\t}\n\n\treturn element;\n}\n\nexport function addCheckboxToAlgorithmBar(boxLabel, checked, group) {\n\tconst element = document.createElement('input');\n\n\telement.setAttribute('type', 'checkbox');\n\telement.setAttribute('id', boxLabel);\n\telement.setAttribute('name', boxLabel);\n\telement.setAttribute('value', boxLabel);\n\tchecked && element.setAttribute('checked', 'true');\n\n\tconst label = document.createElement('label');\n\tlabel.setAttribute('for', boxLabel);\n\tconst txtNode = document.createTextNode(boxLabel);\n\tlabel.appendChild(txtNode);\n\n\tif (!group) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(element);\n\t\ttableEntry.appendChild(label);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tconst span = document.createElement('span');\n\t\tspan.appendChild(element);\n\t\tspan.appendChild(label);\n\n\t\tgroup.appendChild(span);\n\t\tspan.setAttribute('class', 'groupChild');\n\t}\n\n\treturn element;\n}\n\nexport function addRadioButtonGroupToAlgorithmBar(buttonNames, groupName, group) {\n\tconst buttonList = [];\n\tconst newTable = document.createElement('table');\n\n\tfor (let i = 0; i < buttonNames.length; i++) {\n\t\tconst midLevel = document.createElement('tr');\n\t\tconst bottomLevel = document.createElement('td');\n\n\t\tconst button = document.createElement('input');\n\t\tbutton.setAttribute('type', 'radio');\n\t\tbutton.setAttribute('name', groupName);\n\t\tbutton.setAttribute('id', buttonNames[i]);\n\t\tbutton.setAttribute('value', buttonNames[i]);\n\t\tbottomLevel.appendChild(button);\n\t\tmidLevel.appendChild(bottomLevel);\n\t\tconst label = document.createElement('label');\n\t\tlabel.setAttribute('for', buttonNames[i]);\n\t\tconst txtNode = document.createTextNode(' ' + buttonNames[i]);\n\t\tlabel.appendChild(txtNode);\n\t\tbottomLevel.appendChild(label);\n\t\tnewTable.appendChild(midLevel);\n\t\tbuttonList.push(button);\n\t}\n\n\tif (!group) {\n\t\tconst topLevelTableEntry = document.createElement('td');\n\t\ttopLevelTableEntry.appendChild(newTable);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(topLevelTableEntry);\n\t} else {\n\t\tgroup.appendChild(newTable);\n\t\tnewTable.setAttribute('class', 'groupChild');\n\t}\n\n\treturn buttonList;\n}\n\nexport function addControlToAlgorithmBar(type, value, group) {\n\tconst element = document.createElement('input');\n\n\telement.setAttribute('type', type);\n\telement.setAttribute('value', value);\n\n\tif (!group) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(element);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tgroup.appendChild(element);\n\t\telement.setAttribute('class', 'groupChild');\n\t}\n\n\treturn element;\n}\n\nexport function addDivisorToAlgorithmBar() {\n\tconst divisorLeft = document.createElement('td');\n\tdivisorLeft.setAttribute('class', 'divisorLeft');\n\n\tconst divisorRight = document.createElement('td');\n\tdivisorRight.setAttribute('class', 'divisorRight');\n\n\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\tcontrolBar.appendChild(divisorLeft);\n\tcontrolBar.appendChild(divisorRight);\n}\n\nexport function addGroupToAlgorithmBar(horizontal, parentGroup) {\n\tconst group = document.createElement('div');\n\n\tgroup.setAttribute('class', horizontal ? 'hgroup' : 'vgroup');\n\n\tif (!parentGroup) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(group);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tparentGroup.appendChild(group);\n\t}\n\n\treturn group;\n}\n\nconst CODE_LINE_HEIGHT = 14;\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\nconst CODE_STANDARD_COLOR = '#000000';\n\nexport default class Algorithm {\n\tconstructor(am, w, h) {\n\t\tif (am == null) {\n\t\t\treturn;\n\t\t}\n\t\tthis.animationManager = am;\n\t\tam.addListener('AnimationStarted', this, this.disableUI);\n\t\tam.addListener('AnimationEnded', this, this.enableUI);\n\t\tam.addListener('AnimationUndo', this, this.undo);\n\t\tthis.canvasWidth = w;\n\t\tthis.canvasHeight = h;\n\n\t\tthis.actionHistory = [];\n\t\tthis.recordAnimation = true;\n\t\tthis.commands = [];\n\t}\n\n\taddCodeToCanvasBase(code, start_x, start_y, line_height, standard_color, layer) {\n\t\tline_height = typeof line_height !== 'undefined' ? line_height : CODE_LINE_HEIGHT;\n\t\tstandard_color =\n\t\t\ttypeof standard_color !== 'undefined' ? standard_color : CODE_STANDARD_COLOR;\n\t\tlayer = typeof layer !== 'undefined' ? layer : 0;\n\t\tconst codeID = Array(code.length);\n\t\tconsole.log(this.nextIndex);\n\t\tlet i, j;\n\t\tfor (i = 0; i < code.length; i++) {\n\t\t\tcodeID[i] = new Array(code[i].length);\n\t\t\tfor (j = 0; j < code[i].length; j++) {\n\t\t\t\tcodeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tcodeID[i][j],\n\t\t\t\t\tcode[i][j],\n\t\t\t\t\tstart_x,\n\t\t\t\t\tstart_y + i * line_height,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, codeID[i][j], standard_color);\n\t\t\t\tthis.cmd(act.setLayer, codeID[i][j], layer);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, codeID[i][j], codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn codeID;\n\t}\n\n\thighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\n\t}\n\n\tunhighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\n\t}\n\n\tremoveCode(codeID) {\n\t\tfor (let i = 0; i < codeID.length; i++) {\n\t\t\tfor (let j = 0; j < codeID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, codeID[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetCodeAlpha(code, newAlpha) {\n\t\tfor (let i = 0; i < code.length; i++) {\n\t\t\tfor (let j = 0; j < code[i].length; j++) {\n\t\t\t\tthis.cmd(act.setAlpha, code[i][j], newAlpha);\n\t\t\t}\n\t\t}\n\t}\n\n\tcmd(act, ...params) {\n\t\t// Helper method to add command to stack\n\t\tif (this.recordAnimation) {\n\t\t\tthis.commands.push([act, params]);\n\t\t}\n\t}\n\n\tclearHistory() {\n\t\tthis.actionHistory = [];\n\t}\n\n\tundo() {\n\t\t// Remove the last action (the one that we are going to undo)\n\t\tthis.actionHistory.pop();\n\t\t// Clear out our data structure.  Be sure to implement reset in\n\t\t// every AlgorithmAnimation subclass!\n\t\tthis.reset();\n\t\t//  Redo all actions from the beginning, throwing out the animation\n\t\t//  commands (the animation manager will update the animation on its own).\n\t\t//  Note that if you do something non-deterministic, you might cause problems!\n\t\t//  Be sure if you do anything non-deterministic (that is, calls to a random\n\t\t//  number generator) you clear out the undo stack here and in the animation\n\t\t//  manager.\n\n\t\t//  If this seems horribly inefficient -- it is! However, it seems to work well\n\t\t//  in practice, and you get undo for free for all algorithms, which is a non-trivial\n\t\t//  gain.\n\t\tconst len = this.actionHistory.length;\n\t\tthis.recordAnimation = false;\n\t\tfor (let i = 0; i < len; i++) {\n\t\t\tthis.actionHistory[i][0](...this.actionHistory[i][1]);\n\t\t}\n\t\tthis.recordAnimation = true;\n\t}\n\n\timplementAction(func, ...args) {\n\t\tconst next = [func, args];\n\t\tthis.actionHistory.push(next);\n\t\tconst retVal = func(...args);\n\t\tthis.animationManager.startNewAnimation(retVal);\n\t}\n\n\tnormalizeNumber(input, maxLen) {\n\t\tconst isAllDigits = str => !/\\D/.test(str);\n\t\tif (!isAllDigits(input) || input === '') {\n\t\t\treturn input;\n\t\t}\n\t\treturn input.substr(-maxLen);\n\t}\n\n\treturnSubmit(field, funct, maxsize, intOnly) {\n\t\tif (maxsize !== undefined) {\n\t\t\tfield.size = maxsize;\n\t\t}\n\t\treturn function (event) {\n\t\t\tlet keyASCII = 0;\n\t\t\tif (window.event) {\n\t\t\t\t// IE\n\t\t\t\tkeyASCII = event.keyCode;\n\t\t\t} else if (event.which) {\n\t\t\t\t// Netscape/Firefox/Opera\n\t\t\t\tkeyASCII = event.which;\n\t\t\t}\n\n\t\t\tif (keyASCII === 13 && funct != null) {\n\t\t\t\tfunct();\n\t\t\t} else if (\n\t\t\t\tkeyASCII === 190 ||\n\t\t\t\tkeyASCII === 59 ||\n\t\t\t\tkeyASCII === 173 ||\n\t\t\t\tkeyASCII === 189\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t} else if (\n\t\t\t\t(maxsize !== undefined && field.value.length >= maxsize) ||\n\t\t\t\t(intOnly && !((keyASCII >= 48 && keyASCII <= 57) || (keyASCII >= 96 && keyASCII <= 105)))\n\t\t\t) {\n\t\t\t\tif (!controlKey(keyASCII)) return false;\n\t\t\t}\n\t\t};\n\t}\n\n\t// Abstract methods - these should be implemented in the base class\n\n\t// eslint-disable-next-line no-unused-vars\n\tsizeChanged(newWidth, newHeight) {\n\t\tthrow new Error('sizeChanged() should be implemented in base class');\n\t}\n\n\t// eslint-disable-next-line no-unused-vars\n\tdisableUI(event) {\n\t\tthrow new Error('disableUI() should be implemented in base class');\n\t}\n\n\t// eslint-disable-next-line no-unused-vars\n\tenableUI(event) {\n\t\tthrow new Error('enableUI() should be implemented in base class');\n\t}\n\n\treset() {\n\t\tthrow new Error('reset() should be implemented in base class');\n\t}\n}\n\nexport function controlKey(keyASCII) {\n\treturn (\n\t\tkeyASCII === 8 ||\n\t\tkeyASCII === 9 ||\n\t\tkeyASCII === 37 ||\n\t\tkeyASCII === 38 ||\n\t\tkeyASCII === 39 ||\n\t\tkeyASCII === 40 ||\n\t\tkeyASCII === 46\n\t);\n}\n\nAlgorithm.prototype.returnSubmitFloat = function (field, funct, maxsize) {\n\tif (maxsize !== undefined) {\n\t\tfield.size = maxsize;\n\t}\n\treturn function (event) {\n\t\tlet keyASCII = 0;\n\t\tif (window.event) {\n\t\t\t// IE\n\t\t\tkeyASCII = event.keyCode;\n\t\t} else if (event.which) {\n\t\t\t// Netscape/Firefox/Opera\n\t\t\tkeyASCII = event.which;\n\t\t}\n\t\t// Submit on return\n\t\tif (keyASCII === 13) {\n\t\t\tfunct();\n\t\t}\n\t\t// Control keys (arrows, del, etc) are always OK\n\t\telse if (controlKey(keyASCII)) {\n\t\t\treturn;\n\t\t}\n\t\t// - (minus sign) only OK at beginning of number\n\t\t//  (For now we will allow anywhere -- hard to see where the beginning of the\n\t\t//   number is ...)\n\t\t//else if (keyASCII == 109 && field.value.length  == 0)\n\t\telse if (keyASCII === 109) {\n\t\t\treturn;\n\t\t}\n\t\t// Digis are OK if we have enough space\n\t\telse if (\n\t\t\t(maxsize !== undefined || field.value.length < maxsize) &&\n\t\t\tkeyASCII >= 48 &&\n\t\t\tkeyASCII <= 57\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\t// . (Decimal point) is OK if we haven't had one yet, and there is space\n\t\telse if (\n\t\t\t(maxsize !== undefined || field.value.length < maxsize) &&\n\t\t\tkeyASCII === 190 &&\n\t\t\tfield.value.indexOf('.') === -1\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\t// Nothing else is OK\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t};\n};\n\nAlgorithm.prototype.addReturnSubmit = function (field, action) {\n\tfield.onkeydown = this.returnSubmit(field, action, 4, false);\n};\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nexport default class AVL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.first_print_pos_y = h - 2 * AVL.PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\t\tthis.startingX = w / 2;\n\t\tthis.addControls();\n\t\tthis.nextIndex = 1;\n\t\tthis.commands = [];\n\t\tthis.edges = [];\n\t\tthis.cmd(act.createLabel, 0, '', AVL.EXPLANITORY_TEXT_X, AVL.EXPLANITORY_TEXT_Y, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst predSuccButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Predecessor', 'Successor'],\n\t\t\t'Predecessor/Successor',\n\t\t);\n\n\t\tthis.predButton = predSuccButtonList[0];\n\t\tthis.succButton = predSuccButtonList[1];\n\t\tthis.predButton.onclick = () => (this.predSucc = 'pred');\n\t\tthis.succButton.onclick = () => (this.predSucc = 'succ');\n\t\tthis.succButton.checked = true;\n\t\tthis.predSucc = 'succ';\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t\tthis.edges = [];\n\t}\n\n\tinsertCallback() {\n\t\tlet insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tlet findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tfindValue = this.normalizeNumber(findValue, 4);\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t\t}\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tsizeChanged(newWidth) {\n\t\tthis.startingX = newWidth / 2;\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tAVL.HIGHLIGHT_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y,\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = AVL.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.cmd(act.delete, i);\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, AVL.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += AVL.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = AVL.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += AVL.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tif (tree.right != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\treturn;\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tthis.doFind(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searchiing for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Found:' + value);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tAVL.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.left, value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t' Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tAVL.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.right, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t' Searching for ' + value + ' : < Empty Tree > (Element not found)',\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, ' Searching for ' + value + ' :  (Element not found)');\n\t\t}\n\t}\n\n\tremakeTree(curr) {\n\t\tif (curr == null) return;\n\t\tif (curr.left != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.left.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.left);\n\t\t}\n\t\tif (curr.right != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.right.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.right);\n\t\t}\n\t}\n\n\tadd(data) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, ' Inserting ' + data);\n\t\tthis.treeRoot = this.addH(data, this.treeRoot);\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\taddH(data, curr) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, 'Null found, inserting new node');\n\t\t\tconst treeNodeID = this.nextIndex++;\n\t\t\tconst heightLabelID = this.nextIndex++;\n\t\t\tconst bfLabelID = this.nextIndex++;\n\t\t\tthis.cmd(act.createCircle, treeNodeID, data, 30, AVL.STARTING_Y);\n\n\t\t\tthis.cmd(act.setForegroundColor, treeNodeID, AVL.FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, treeNodeID, AVL.BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.createLabel, heightLabelID, 0, 30 - 20, AVL.STARTING_Y - 20);\n\t\t\tthis.cmd(act.setForegroundColor, heightLabelID, AVL.HEIGHT_LABEL_COLOR);\n\n\t\t\tthis.cmd(act.createLabel, bfLabelID, 0, 30 + 20, AVL.STARTING_Y - 20);\n\t\t\tthis.cmd(act.setForegroundColor, bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn new AVLNode(data, treeNodeID, heightLabelID, bfLabelID, 0, 0);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking at left subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.addH(data, curr.left);\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking at right subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.addH(data, curr.right);\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, `${data} == ${curr.data}. Ignoring duplicate!`);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tconnectSmart(id1, id2) {\n\t\tif (!this.edges.some(e => e[0] === id1 && e[1] === id2)) {\n\t\t\tthis.cmd(act.connect, id1, id2, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, id1, id2, AVL.LINK_OPACITY);\n\t\t\tthis.edges.push([id1, id2]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tbalance(curr) {\n\t\tcurr.updateHeightAndBF();\n\t\tthis.cmd(act.setText, curr.heightLabelID, curr.height);\n\t\tthis.cmd(act.setText, curr.bfLabelID, curr.bf);\n\t\tthis.cmd(act.setText, 0, 'Adjusting height and balance factor after recursive call');\n\t\tthis.cmd(act.step);\n\n\t\tif (curr.bf < -1) {\n\t\t\tthis.cmd(act.setText, 0, 'Balance factor < -1');\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (curr.right != null && curr.right.bf > 0) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Right child balance factor > 0');\n\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Right-left rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\t\tcurr.right = this.singleRotateRight(curr.right);\n\t\t\t} else {\n\t\t\t\tif (curr.right != null) {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'Right child balance factor <= 0');\n\t\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'No right child');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setText, 0, 'Left rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tcurr = this.singleRotateLeft(curr);\n\t\t} else if (curr.bf > 1) {\n\t\t\tthis.cmd(act.setText, 0, 'Balance factor > 1');\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (curr.left != null && curr.left.bf < 0) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Left child balance factor < 0');\n\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Left-right rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\t\tcurr.left = this.singleRotateLeft(curr.left);\n\t\t\t} else {\n\t\t\t\tif (curr.left != null) {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'Left child balance factor >= 0');\n\t\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'No left child');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setText, 0, 'Right rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\t}\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tcurr = this.singleRotateRight(curr);\n\t\t}\n\t\treturn curr;\n\t}\n\n\tsingleRotateRight(tree) {\n\t\tconst B = tree;\n\t\tconst A = tree.left;\n\t\tconst t2 = A.right;\n\n\t\t// this.cmd(act.setText, 0, 'Single Rotate Right');\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, B.graphicID, t2.graphicID, AVL.LINK_OPACITY);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, AVL.LINK_COLOR);\n\t\tthis.cmd(act.setEdgeAlpha, A.graphicID, B.graphicID, AVL.LINK_OPACITY);\n\t\tA.parent = B.parent;\n\t\tif (this.treeRoot === B) {\n\t\t\tthis.treeRoot = A;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, B.parent.graphicID, B.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.connect, B.parent.graphicID, A.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, B.parent.graphicID, A.graphicID, AVL.LINK_OPACITY);\n\n\t\t\tif (B.isLeftChild()) {\n\t\t\t\tB.parent.left = A;\n\t\t\t} else {\n\t\t\t\tB.parent.right = A;\n\t\t\t}\n\t\t}\n\t\tA.right = B;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tthis.cmd(act.setHighlight, A.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, B.graphicID, 0);\n\t\tB.updateHeightAndBF();\n\t\tthis.cmd(act.setText, B.heightLabelID, B.height);\n\t\tthis.cmd(act.setText, B.bfLabelID, B.bf);\n\t\tA.updateHeightAndBF();\n\t\tthis.cmd(act.setText, A.heightLabelID, A.height);\n\t\tthis.cmd(act.setText, A.bfLabelID, A.bf);\n\t\tthis.resizeTree();\n\t\treturn A;\n\t}\n\n\tsingleRotateLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\tconst t2 = B.left;\n\n\t\t// this.cmd(act.setText, 0, 'Single Rotate Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, A.graphicID, t2.graphicID, AVL.LINK_OPACITY);\n\n\t\t\tt2.parent = A;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, AVL.LINK_COLOR);\n\t\tthis.cmd(act.setEdgeAlpha, B.graphicID, A.graphicID, AVL.LINK_OPACITY);\n\n\t\tB.parent = A.parent;\n\t\tif (this.treeRoot === A) {\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, A.parent.graphicID, B.graphicID, AVL.LINK_OPACITY);\n\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t}\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tA.right = t2;\n\t\tthis.cmd(act.setHighlight, A.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, B.graphicID, 0);\n\t\tA.updateHeightAndBF();\n\t\tthis.cmd(act.setText, A.heightLabelID, A.height);\n\t\tthis.cmd(act.setText, A.bfLabelID, A.bf);\n\t\tB.updateHeightAndBF();\n\t\tthis.cmd(act.setText, B.heightLabelID, B.height);\n\t\tthis.cmd(act.setText, B.bfLabelID, B.bf);\n\n\t\tthis.resizeTree();\n\t\treturn B;\n\t}\n\n\tgetHeight(tree) {\n\t\tif (tree == null) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn tree.height;\n\t}\n\n\tresetHeight(tree) {\n\t\tif (tree != null) {\n\t\t\tconst newHeight = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\n\t\t\tif (tree.height !== newHeight) {\n\t\t\t\ttree.height = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\n\t\t\t\tthis.cmd(act.setText, tree.heightLabelID, newHeight);\n\t\t\t}\n\t\t}\n\t}\n\n\tdeleteNode(curr) {\n\t\tthis.cmd(act.delete, curr.graphicID);\n\t\tthis.cmd(act.delete, curr.heightLabelID);\n\t\tthis.cmd(act.delete, curr.bfLabelID);\n\t}\n\n\tremove(data) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, 0, `Deleting ${data}`);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, ' ');\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeRoot = this.removeH(this.treeRoot, data);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\tremoveH(curr, data) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, `${data} not found in the tree`);\n\t\t\treturn;\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking left`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.removeH(curr.left, data);\n\t\t\tif (curr.left != null) {\n\t\t\t\tcurr.left.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking right`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.removeH(curr.right, data);\n\t\t\tif (curr.right != null) {\n\t\t\t\tcurr.right.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else {\n\t\t\tif (curr.left == null && curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Element to delete is a leaf node');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn null;\n\t\t\t} else if (curr.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with right child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.right;\n\t\t\t} else if (curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with left child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.left;\n\t\t\t} else {\n\t\t\t\tconst dummy = [];\n\t\t\t\tif (this.predSucc === 'succ') {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with successor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.right = this.removeSucc(curr.right, dummy);\n\t\t\t\t\tcurr.right && this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with predecessor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.left = this.removePred(curr.left, dummy);\n\t\t\t\t\tcurr.left && this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\t}\n\t\t\t\tthis.resizeTree();\n\t\t\t\tcurr.data = dummy[0];\n\t\t\t\tthis.cmd(act.setText, curr.graphicID, curr.data);\n\t\t\t}\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tremoveSucc(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.left == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No left child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.right;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Left child exists, look left');\n\t\tthis.cmd(act.step);\n\t\tcurr.left = this.removeSucc(curr.left, dummy);\n\t\tif (curr.left != null) {\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\treturn curr;\n\t}\n\n\tremovePred(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.right == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No right child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.left;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Right child exists, look right');\n\t\tthis.cmd(act.step);\n\t\tcurr.right = this.removePred(curr.right, dummy);\n\t\tif (curr.right != null) {\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\treturn curr;\n\t}\n\n\tresizeTree() {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, AVL.STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t} else {\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\ttree.heightLabelY = tree.y - 20;\n\t\t\ttree.bfLabelY = tree.y - 20;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + AVL.HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + AVL.HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.cmd(act.move, tree.heightLabelID, tree.heightLabelX, tree.heightLabelY);\n\t\t\tthis.cmd(act.move, tree.bfLabelID, tree.bfLabelX, tree.bfLabelY);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), AVL.WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), AVL.WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.cmd(act.delete, curr.heightLabelID);\n\t\t\tthis.cmd(act.delete, curr.bfLabelID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n\nclass AVLNode {\n\tconstructor(val, id, hid, bfid, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.heightLabelID = hid;\n\t\tthis.bfLabelID = bfid;\n\t\tthis.height = 0;\n\t\tthis.bf = 0;\n\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n\n\tupdateHeightAndBF() {\n\t\tconst h = node => (node == null ? -1 : node.height);\n\t\tconst l = h(this.left);\n\t\tconst r = h(this.right);\n\t\tthis.height = Math.max(l, r) + 1;\n\t\tthis.bf = l - r;\n\t}\n\n\tisLeftChild() {\n\t\tif (this.parent == null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.parent.left === this;\n\t}\n}\n\n// Various constants\n\nAVL.HIGHLIGHT_LABEL_COLOR = '#FF0000';\nAVL.HIGHLIGHT_LINK_COLOR = '#FF0000';\n\nAVL.HIGHLIGHT_COLOR = '#007700';\nAVL.HEIGHT_LABEL_COLOR = '#065e9d';\n\nAVL.LINK_COLOR = '#00B000';\nAVL.LINK_OPACITY = 0.25;\nAVL.HIGHLIGHT_CIRCLE_COLOR = '#007700';\nAVL.FOREGROUND_COLOR = '#007700';\nAVL.BACKGROUND_COLOR = '#DDFFDD';\nAVL.PRINT_COLOR = AVL.FOREGROUND_COLOR;\n\nAVL.WIDTH_DELTA = 50;\nAVL.HEIGHT_DELTA = 50;\nAVL.STARTING_Y = 50;\n\nAVL.FIRST_PRINT_POS_X = 50;\nAVL.PRINT_VERTICAL_GAP = 20;\nAVL.PRINT_HORIZONTAL_GAP = 50;\nAVL.EXPLANITORY_TEXT_X = 10;\nAVL.EXPLANITORY_TEXT_Y = 10;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nexport default class LVA extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.first_print_pos_y = h - 2 * LVA.PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\t\tthis.startingX = w / 2;\n\t\tthis.addControls();\n\t\tthis.nextIndex = 1;\n\t\tthis.commands = [];\n\t\tthis.edges = [];\n\t\tthis.cmd(act.createLabel, 0, '', LVA.EXPLANITORY_TEXT_X, LVA.EXPLANITORY_TEXT_Y, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst rightLeftButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Right-LVA', 'Left-LVA'],\n\t\t\t'rlva/llva',\n\t\t);\n\n\t\tthis.rightButton = rightLeftButtonList[0];\n\t\tthis.leftButton = rightLeftButtonList[1];\n\t\tthis.rightButton.onclick = () => {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.rightLeft = 'right';\n\t\t}\n\t\tthis.leftButton.onclick = () => {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.rightLeft = 'left';\n\t\t}\n\t\tthis.rightButton.checked = true;\n\t\tthis.rightLeft = 'right';\n\t\tthis.predSucc = 'pred'; //Doesn't matter lol\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t\tthis.edges = [];\n\t}\n\n\tinsertCallback() {\n\t\tlet insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tlet findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tfindValue = this.normalizeNumber(findValue, 4);\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t\t}\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tsizeChanged(newWidth) {\n\t\tthis.startingX = newWidth / 2;\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tLVA.HIGHLIGHT_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y,\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = LVA.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.cmd(act.delete, i);\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, LVA.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += LVA.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = LVA.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += LVA.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tif (tree.right != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\treturn;\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tthis.doFind(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searchiing for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Found:' + value);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tLVA.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.left, value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t' Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tLVA.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.right, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t' Searching for ' + value + ' : < Empty Tree > (Element not found)',\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, ' Searching for ' + value + ' :  (Element not found)');\n\t\t}\n\t}\n\n\tremakeTree(curr) {\n\t\tif (curr == null) return;\n\t\tif (curr.left != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.left.graphicID, LVA.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.left);\n\t\t}\n\t\tif (curr.right != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.right.graphicID, LVA.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.right);\n\t\t}\n\t}\n\n\tadd(data) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, ' Inserting ' + data);\n\t\tthis.treeRoot = this.addH(data, this.treeRoot);\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\taddH(data, curr) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, 'Null found, inserting new node');\n\t\t\tconst treeNodeID = this.nextIndex++;\n\t\t\tconst heightLabelID = this.nextIndex++;\n\t\t\tconst bfLabelID = this.nextIndex++;\n\t\t\tthis.cmd(act.createCircle, treeNodeID, data, 30, LVA.STARTING_Y);\n\n\t\t\tthis.cmd(act.setForegroundColor, treeNodeID, LVA.FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, treeNodeID, LVA.BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.createLabel, heightLabelID, 0, 30 - 20, LVA.STARTING_Y - 20);\n\t\t\tthis.cmd(act.setForegroundColor, heightLabelID, LVA.HEIGHT_LABEL_COLOR);\n\n\t\t\tthis.cmd(act.createLabel, bfLabelID, 0, 30 + 20, LVA.STARTING_Y - 20);\n\t\t\tthis.cmd(act.setForegroundColor, bfLabelID, LVA.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn new LVANode(data, treeNodeID, heightLabelID, bfLabelID, 0, 0);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking at left subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.addH(data, curr.left);\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking at right subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.addH(data, curr.right);\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, `${data} == ${curr.data}. Ignoring duplicate!`);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tconnectSmart(id1, id2) {\n\t\tif (!this.edges.some(e => e[0] === id1 && e[1] === id2)) {\n\t\t\tthis.cmd(act.connect, id1, id2, LVA.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, id1, id2, LVA.LINK_OPACITY);\n\t\t\tthis.edges.push([id1, id2]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tbalance(curr) {\n\t\tcurr.updateHeightAndBF();\n\t\tthis.cmd(act.setText, curr.heightLabelID, curr.height);\n\t\tthis.cmd(act.setText, curr.bfLabelID, curr.bf);\n\t\tthis.cmd(act.setText, 0, 'Adjusting height and balance factor after recursive call');\n\t\tthis.cmd(act.step);\n\n\t\tif (this.rightLeft === 'right') {\n\t\t\tif (curr.left != null) {\n\t\t\t\tcurr = this.singleRotateRight(curr);\n\t\t\t}\n\t\t} else {\n\t\t\tif (curr.right != null) {\n\t\t\t\tcurr = this.singleRotateLeft(curr);\n\t\t\t}\n\t\t}\n\n\t\t/*if (curr.bf < -1) {\n\t\t\tthis.cmd(act.setText, 0, 'Balance factor < -1');\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, LVA.HIGHLIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (curr.right != null && curr.right.bf > 0) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Right child balance factor > 0');\n\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, LVA.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Right-left rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, LVA.HEIGHT_LABEL_COLOR);\n\t\t\t\tcurr.right = this.singleRotateRight(curr.right);\n\t\t\t} else {\n\t\t\t\tif (curr.right != null) {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'Right child balance factor <= 0');\n\t\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, LVA.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'No right child');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setText, 0, 'Left rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, LVA.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, LVA.HEIGHT_LABEL_COLOR);\n\t\t\tcurr = this.singleRotateLeft(curr);\n\t\t} else if (curr.bf > 1) {\n\t\t\tthis.cmd(act.setText, 0, 'Balance factor > 1');\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, LVA.HIGHLIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (curr.left != null && curr.left.bf < 0) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Left child balance factor < 0');\n\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, LVA.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Left-right rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, LVA.HEIGHT_LABEL_COLOR);\n\t\t\t\tcurr.left = this.singleRotateLeft(curr.left);\n\t\t\t} else {\n\t\t\t\tif (curr.left != null) {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'Left child balance factor >= 0');\n\t\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, LVA.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'No left child');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setText, 0, 'Right rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, LVA.HEIGHT_LABEL_COLOR);\n\t\t\t}\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, LVA.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, LVA.HEIGHT_LABEL_COLOR);\n\t\t\tcurr = this.singleRotateRight(curr);\n\t\t}*/\n\t\treturn curr;\n\t}\n\n\tsingleRotateRight(tree) {\n\t\tconst B = tree;\n\t\tconst A = tree.left;\n\t\tconst t2 = A.right;\n\n\t\t// this.cmd(act.setText, 0, 'Single Rotate Right');\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, LVA.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, B.graphicID, t2.graphicID, LVA.LINK_OPACITY);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, LVA.LINK_COLOR);\n\t\tthis.cmd(act.setEdgeAlpha, A.graphicID, B.graphicID, LVA.LINK_OPACITY);\n\t\tA.parent = B.parent;\n\t\tif (this.treeRoot === B) {\n\t\t\tthis.treeRoot = A;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, B.parent.graphicID, B.graphicID, LVA.LINK_COLOR);\n\t\t\tthis.cmd(act.connect, B.parent.graphicID, A.graphicID, LVA.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, B.parent.graphicID, A.graphicID, LVA.LINK_OPACITY);\n\n\t\t\tif (B.isLeftChild()) {\n\t\t\t\tB.parent.left = A;\n\t\t\t} else {\n\t\t\t\tB.parent.right = A;\n\t\t\t}\n\t\t}\n\t\tA.right = B;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tthis.cmd(act.setHighlight, A.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, B.graphicID, 0);\n\t\tB.updateHeightAndBF();\n\t\tthis.cmd(act.setText, B.heightLabelID, B.height);\n\t\tthis.cmd(act.setText, B.bfLabelID, B.bf);\n\t\tA.updateHeightAndBF();\n\t\tthis.cmd(act.setText, A.heightLabelID, A.height);\n\t\tthis.cmd(act.setText, A.bfLabelID, A.bf);\n\t\tthis.resizeTree();\n\t\treturn A;\n\t}\n\n\tsingleRotateLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\tconst t2 = B.left;\n\n\t\t// this.cmd(act.setText, 0, 'Single Rotate Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LVA.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, A.graphicID, t2.graphicID, LVA.LINK_OPACITY);\n\n\t\t\tt2.parent = A;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LVA.LINK_COLOR);\n\t\tthis.cmd(act.setEdgeAlpha, B.graphicID, A.graphicID, LVA.LINK_OPACITY);\n\n\t\tB.parent = A.parent;\n\t\tif (this.treeRoot === A) {\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID, LVA.LINK_COLOR);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, LVA.LINK_COLOR);\n\t\t\tthis.cmd(act.setEdgeAlpha, A.parent.graphicID, B.graphicID, LVA.LINK_OPACITY);\n\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t}\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tA.right = t2;\n\t\tthis.cmd(act.setHighlight, A.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, B.graphicID, 0);\n\t\tA.updateHeightAndBF();\n\t\tthis.cmd(act.setText, A.heightLabelID, A.height);\n\t\tthis.cmd(act.setText, A.bfLabelID, A.bf);\n\t\tB.updateHeightAndBF();\n\t\tthis.cmd(act.setText, B.heightLabelID, B.height);\n\t\tthis.cmd(act.setText, B.bfLabelID, B.bf);\n\n\t\tthis.resizeTree();\n\t\treturn B;\n\t}\n\n\tgetHeight(tree) {\n\t\tif (tree == null) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn tree.height;\n\t}\n\n\tresetHeight(tree) {\n\t\tif (tree != null) {\n\t\t\tconst newHeight = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\n\t\t\tif (tree.height !== newHeight) {\n\t\t\t\ttree.height = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\n\t\t\t\tthis.cmd(act.setText, tree.heightLabelID, newHeight);\n\t\t\t}\n\t\t}\n\t}\n\n\tdeleteNode(curr) {\n\t\tthis.cmd(act.delete, curr.graphicID);\n\t\tthis.cmd(act.delete, curr.heightLabelID);\n\t\tthis.cmd(act.delete, curr.bfLabelID);\n\t}\n\n\tremove(data) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, 0, `Deleting ${data}`);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, ' ');\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeRoot = this.removeH(this.treeRoot, data);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\tremoveH(curr, data) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, `${data} not found in the tree`);\n\t\t\treturn;\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking left`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.removeH(curr.left, data);\n\t\t\tif (curr.left != null) {\n\t\t\t\tcurr.left.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking right`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.removeH(curr.right, data);\n\t\t\tif (curr.right != null) {\n\t\t\t\tcurr.right.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else {\n\t\t\tif (curr.left == null && curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Element to delete is a leaf node');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn null;\n\t\t\t} else if (curr.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with right child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.right;\n\t\t\t} else if (curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with left child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.left;\n\t\t\t} else {\n\t\t\t\tconst dummy = [];\n\t\t\t\tif (this.predSucc === 'succ') {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with successor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.right = this.removeSucc(curr.right, dummy);\n\t\t\t\t\tcurr.right && this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with predecessor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.left = this.removePred(curr.left, dummy);\n\t\t\t\t\tcurr.left && this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\t}\n\t\t\t\tthis.resizeTree();\n\t\t\t\tcurr.data = dummy[0];\n\t\t\t\tthis.cmd(act.setText, curr.graphicID, curr.data);\n\t\t\t}\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tremoveSucc(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.left == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No left child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.right;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Left child exists, look left');\n\t\tthis.cmd(act.step);\n\t\tcurr.left = this.removeSucc(curr.left, dummy);\n\t\tif (curr.left != null) {\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\treturn curr;\n\t}\n\n\tremovePred(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.right == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No right child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.left;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Right child exists, look right');\n\t\tthis.cmd(act.step);\n\t\tcurr.right = this.removePred(curr.right, dummy);\n\t\tif (curr.right != null) {\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\treturn curr;\n\t}\n\n\tresizeTree() {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, LVA.STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t} else {\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\ttree.heightLabelY = tree.y - 20;\n\t\t\ttree.bfLabelY = tree.y - 20;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + LVA.HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + LVA.HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.cmd(act.move, tree.heightLabelID, tree.heightLabelX, tree.heightLabelY);\n\t\t\tthis.cmd(act.move, tree.bfLabelID, tree.bfLabelX, tree.bfLabelY);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), LVA.WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), LVA.WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.cmd(act.delete, curr.heightLabelID);\n\t\t\tthis.cmd(act.delete, curr.bfLabelID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n\nclass LVANode {\n\tconstructor(val, id, hid, bfid, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.heightLabelID = hid;\n\t\tthis.bfLabelID = bfid;\n\t\tthis.height = 0;\n\t\tthis.bf = 0;\n\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n\n\tupdateHeightAndBF() {\n\t\tconst h = node => (node == null ? -1 : node.height);\n\t\tconst l = h(this.left);\n\t\tconst r = h(this.right);\n\t\tthis.height = Math.max(l, r) + 1;\n\t\tthis.bf = l - r;\n\t}\n\n\tisLeftChild() {\n\t\tif (this.parent == null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.parent.left === this;\n\t}\n}\n\n// Various constants\n\nLVA.HIGHLIGHT_LABEL_COLOR = '#FF0000';\nLVA.HIGHLIGHT_LINK_COLOR = '#FF0000';\n\nLVA.HIGHLIGHT_COLOR = '#007700';\nLVA.HEIGHT_LABEL_COLOR = '#065e9d';\n\nLVA.LINK_COLOR = '#00B000';\nLVA.LINK_OPACITY = 0.25;\nLVA.HIGHLIGHT_CIRCLE_COLOR = '#007700';\nLVA.FOREGROUND_COLOR = '#007700';\nLVA.BACKGROUND_COLOR = '#DDFFDD';\nLVA.PRINT_COLOR = LVA.FOREGROUND_COLOR;\n\nLVA.WIDTH_DELTA = 50;\nLVA.HEIGHT_DELTA = 50;\nLVA.STARTING_Y = 50;\n\nLVA.FIRST_PRINT_POS_X = 50;\nLVA.PRINT_VERTICAL_GAP = 20;\nLVA.PRINT_HORIZONTAL_GAP = 50;\nLVA.EXPLANITORY_TEXT_X = 10;\nLVA.EXPLANITORY_TEXT_Y = 10;\n","/* eslint-disable lines-between-class-members */\n// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 150;\nconst RESIZE_ARRAY_START_X = 100;\nconst RESIZE_ARRAY_START_Y = 280;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRAY_ELEMS_PER_LINE = 14;\nconst ARRAY_LINE_SPACING = 130;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\nconst PUSH_RESIZE_LABEL_X = 60;\nconst PUSH_RESIZE_LABEL_Y = 60;\n\nconst SIZE = 7;\nconst MAX_SIZE = 30;\n\nexport default class ArrayList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Front',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Back',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add at Index',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Index',\n\t\t\tremoveTopHorizontalGroup,\n\t\t);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Front',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Back',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tthis.size = 0;\n\t\tthis.length = SIZE;\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], '#0000FF');\n\t\t}\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.size = 0;\n\t\tthis.length = SIZE;\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.highlight1ID = this.nextIndex++;\n\t}\n\n\taddIndexCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\tthis.addIndexField.value !== '' &&\n\t\t\t!(this.length === this.size && this.length * 2 > MAX_SIZE)\n\t\t) {\n\t\t\tconst addVal = this.addValueField.value;\n\t\t\tconst index = this.addIndexField.value;\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tif (this.size === this.length) {\n\t\t\t\t\tthis.implementAction(this.resize.bind(this), addVal, index);\n\t\t\t\t} else {\n\t\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\t!(this.length === this.size && this.length * 2 > MAX_SIZE)\n\t\t) {\n\t\t\tconst addVal = this.addValueField.value;\n\t\t\tthis.addValueField.value = '';\n\t\t\tif (this.size === this.length) {\n\t\t\t\tthis.implementAction(this.resize.bind(this), addVal, 0);\n\t\t\t} else {\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\t!(this.length === this.size && this.length * 2 > MAX_SIZE)\n\t\t) {\n\t\t\tconst addVal = this.addValueField.value;\n\t\t\tthis.addValueField.value = '';\n\t\t\tif (this.size === this.length) {\n\t\t\t\tthis.implementAction(this.resize.bind(this), addVal, this.size);\n\t\t\t} else {\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.clearAll();\n\t\treturn this.commands;\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = this.size; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\tif (index !== this.size) {\n\t\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\t\tconst ypos =\n\t\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\t\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], this.arrayData[i + 1], xpos, ypos);\n\t\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos + ARRAY_ELEM_WIDTH, ypos);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\t\tthis.cmd(act.setText, this.arrayID[i + 1], this.arrayData[i + 1]);\n\t\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\t'#0000FF',\n\t\t\tPUSH_ELEMENT_X,\n\t\t\tPUSH_ELEMENT_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (parseInt(index) % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(parseInt(index) / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos);\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\tif (index != null) {\n\t\t\tthis.nextIndex = this.nextIndex - (this.size - index) - 2;\n\t\t} else {\n\t\t\tthis.nextIndex = this.nextIndex - 2;\n\t\t}\n\n\t\tthis.size = this.size + 1;\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tconst xpos = (index % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos = Math.floor(index / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, '#0000FF', xpos, ypos);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[index], '');\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos - 100);\n\t\tthis.cmd(act.move, labPopValID, xpos, ypos - 100);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t}\n\t\tthis.arrayData[this.size] = null;\n\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\tfor (let i = index + 1; i < this.size; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], this.arrayData[i - 1], xpos, ypos);\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos - ARRAY_ELEM_WIDTH, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = index + 1; i < this.size; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i - 1], this.arrayData[i - 1]);\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tif (index != null) {\n\t\t\tthis.nextIndex = this.nextIndex - (this.size - index);\n\t\t} else {\n\t\t\tthis.nextIndex = this.nextIndex - 2;\n\t\t}\n\n\t\tthis.size = this.size - 1;\n\n\t\treturn this.commands;\n\t}\n\n\tresize(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tconst labPushResizeID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPushResizeID,\n\t\t\t'(Resize Required)',\n\t\t\tPUSH_RESIZE_LABEL_X,\n\t\t\tPUSH_RESIZE_LABEL_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayIDNew = new Array(this.size * 2);\n\t\tthis.arrayLabelIDNew = new Array(this.size * 2);\n\t\tthis.arrayDataNew = new Array(this.size * 2);\n\n\t\tthis.length = this.length * 2;\n\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tthis.arrayIDNew[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelIDNew[i] = this.nextIndex++;\n\t\t\tif (i < index) {\n\t\t\t\tthis.arrayDataNew[i] = this.arrayData[i];\n\t\t\t} else if (i > index && i <= this.size) {\n\t\t\t\tthis.arrayDataNew[i] = this.arrayData[i - 1];\n\t\t\t}\n\t\t}\n\n\t\tthis.arrayDataNew[index] = elemToAdd;\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\t//Create new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayIDNew[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelIDNew[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelIDNew[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\t//Move elements before index from old array\n\t\tfor (let i = 0; i < index; i++) {\n\t\t\tconst xposinit = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yposinit =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], this.arrayData[i], xposinit, yposinit);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//delete movement id objects and set text\n\t\tfor (let i = 0; i < index; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\tthis.cmd(act.setText, this.arrayIDNew[i], this.arrayData[i]);\n\t\t}\n\n\t\t//Add elemToAdd at the index\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\t'#0000FF',\n\t\t\tPUSH_ELEMENT_X,\n\t\t\tPUSH_ELEMENT_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos =\n\t\t\t(parseInt(index) % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(parseInt(index) / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\tRESIZE_ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos);\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayIDNew[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\t//Move elements after index from old array\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tconst xposinit = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yposinit =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tconst xpos = (i % (ARRAY_ELEMS_PER_LINE - 1)) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / (ARRAY_ELEMS_PER_LINE - 1)) * ARRAY_LINE_SPACING +\n\t\t\t\tRESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], this.arrayData[i], xposinit, yposinit);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos + ARRAY_ELEM_WIDTH, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//delete movement id objects\n\t\tfor (let i = index; i <= this.size; i++) {\n\t\t\tif (i < this.size) {\n\t\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\t}\n\t\t\tthis.cmd(act.setText, this.arrayIDNew[i], this.arrayData[i - 1]);\n\t\t}\n\n\t\tthis.cmd(act.setText, this.arrayIDNew[index], elemToAdd);\n\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.delete, labPushResizeID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t\tthis.cmd(act.delete, this.arrayLabelID[i]);\n\t\t}\n\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tthis.cmd(act.move, this.arrayIDNew[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.arrayLabelIDNew[i], xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t}\n\n\t\tthis.arrayID = this.arrayIDNew;\n\t\tthis.arrayLabelID = this.arrayLabelIDNew;\n\t\tthis.arrayData = this.arrayDataNew;\n\n\t\tif (index != null) {\n\t\t\tthis.nextIndex = this.nextIndex - this.size;\n\t\t}\n\n\t\tthis.size = this.size + 1;\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t\tthis.arrayData[i] = null;\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// General\n\nconst LARGE_ALLOWED = [\n\t[\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t],\n\t[\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t],\n\t[\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\tfalse,\n\t\ttrue,\n\t\tfalse,\n\t\ttrue,\n\t\ttrue,\n\t\tfalse,\n\t],\n];\n\nconst LARGE_CURVE = [\n\t[0, 0, -0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.25, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[-0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.4],\n\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, 0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.4, 0, 0],\n];\n\nconst LARGE_X_POS_LOGICAL = [\n\t600,\n\t700,\n\t800,\n\t900,\n\t650,\n\t750,\n\t850,\n\t600,\n\t700,\n\t800,\n\t900,\n\t650,\n\t750,\n\t850,\n\t600,\n\t700,\n\t800,\n\t900,\n];\n\nconst LARGE_Y_POS_LOGICAL = [\n\t50,\n\t50,\n\t50,\n\t50,\n\t150,\n\t150,\n\t150,\n\t250,\n\t250,\n\t250,\n\t250,\n\t350,\n\t350,\n\t350,\n\t450,\n\t450,\n\t450,\n\t450,\n];\n\nconst SMALL_ALLLOWED = [\n\t[false, true, true, true, true, false, false, false],\n\t[true, false, true, true, false, true, true, false],\n\t[true, true, false, false, true, true, true, false],\n\t[true, true, false, false, false, true, false, true],\n\t[true, false, true, false, false, false, true, true],\n\t[false, true, true, true, false, false, true, true],\n\t[false, true, true, false, true, true, false, true],\n\t[false, false, false, true, true, true, true, false],\n];\n\nconst SMALL_CURVE = [\n\t[0, 0.001, 0, 0.5, -0.5, 0, 0, 0],\n\t[0, 0, 0, 0.001, 0, 0.001, -0.2, 0],\n\t[0, 0.001, 0, 0, 0, 0.2, 0, 0],\n\t[-0.5, 0, 0, 0, 0, 0.001, 0, 0.5],\n\t[0.5, 0, 0, 0, 0, 0, 0, -0.5],\n\t[0, 0, -0.2, 0, 0, 0, 0.001, 0.001],\n\t[0, 0.2, 0, 0, 0, 0, 0, 0],\n\t[0, 0, 0, -0.5, 0.5, 0, 0, 0],\n];\n\nconst SMALL_X_POS_LOGICAL = [800, 725, 875, 650, 950, 725, 875, 800];\nconst SMALL_Y_POS_LOGICAL = [25, 125, 125, 225, 225, 325, 325, 425];\n\n// BFS / DFS\n\nconst BFS_DFS_ADJ_LIST =\n\t//A     B      C     D      E     F      G      H\n\t/*A*/ [\n\t\t[0, 1, 1, 1, 1, 0, 0, 0],\n\t\t/*B*/ [1, 0, 0, 0, 0, 0, 1, 0],\n\t\t/*C*/ [1, 0, 0, 0, 0, 0, 0, 0],\n\t\t/*D*/ [1, 0, 0, 0, 0, 1, 0, 0],\n\t\t/*E*/ [1, 0, 0, 0, 0, 0, 1, 0],\n\t\t/*F*/ [0, 0, 0, 1, 0, 0, 1, 0],\n\t\t/*G*/ [0, 1, 0, 0, 1, 1, 0, 1],\n\t\t/*H*/ [0, 0, 0, 0, 0, 0, 1, 0],\n\t].map(row => row.map(x => x || -1)); // Turn 0s to -1s\n\n// Dijkstra's\n\nconst DIJKSTRAS_ADJ_LIST =\n\t//A     B      C     D      E     F      G      H\n\t/*A*/ [\n\t\t[0, 8, 2, 5, 0, 0, 0, 0],\n\t\t/*B*/ [8, 0, 1, 1, 0, 0, 7, 0],\n\t\t/*C*/ [2, 1, 0, 0, 3, 0, 0, 0],\n\t\t/*D*/ [5, 1, 0, 0, 0, 4, 0, 0],\n\t\t/*E*/ [0, 0, 3, 0, 0, 0, 2, 0],\n\t\t/*F*/ [0, 0, 0, 4, 0, 0, '0', 1], // Hacky way to get actual 0 in final matrix\n\t\t/*G*/ [0, 7, 0, 0, 2, '0', 0, 1],\n\t\t/*H*/ [0, 0, 0, 0, 0, 1, 1, 0],\n\t].map(row => row.map(x => Number(x || -1))); // '0' is truthy, so we can cast it after the ||\n\n// Prim's / Kruskal's\n\nconst PRIMS_KRUSKALS_ADJ_LIST =\n\t//A     B      C     D      E     F      G      H\n\t/*A*/ [\n\t\t[0, 1, 5, 0, 0, 0, 0, 0],\n\t\t/*B*/ [1, 0, 7, 9, 0, 0, 1, 0],\n\t\t/*C*/ [5, 7, 0, 0, 0, 0, 13, 0],\n\t\t/*D*/ [0, 9, 0, 0, 0, 4, 0, 0],\n\t\t/*E*/ [0, 0, 0, 0, 0, 0, 10, 0],\n\t\t/*F*/ [0, 0, 0, 4, 0, 0, 2, '0'],\n\t\t/*G*/ [0, 1, 13, 0, 10, 2, 0, 3],\n\t\t/*H*/ [0, 0, 0, 0, 0, '0', 3, 0],\n\t].map(row => row.map(x => Number(x || -1)));\n\n// Color coding for Disjoint Set in Kruskal's\n\nconst KRUSKALS_DS_COLORS = [\n\t'#9b9bd4',\n\t'#6aaf6a',\n\t'#f07575',\n\t'#ffe866',\n\t'#b8f9b8',\n\t'#ff99ff',\n\t'#99ffff',\n\t'#ffccd4',\n];\n\nexport {\n\tLARGE_ALLOWED,\n\tLARGE_CURVE,\n\tLARGE_X_POS_LOGICAL,\n\tLARGE_Y_POS_LOGICAL,\n\tSMALL_X_POS_LOGICAL,\n\tSMALL_Y_POS_LOGICAL,\n\tSMALL_ALLLOWED,\n\tSMALL_CURVE,\n\tBFS_DFS_ADJ_LIST,\n\tDIJKSTRAS_ADJ_LIST,\n\tPRIMS_KRUSKALS_ADJ_LIST,\n\tKRUSKALS_DS_COLORS,\n};\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// TODO:  UNDO (all the way) is BROKEN.  Redo reset ...\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport {\n\tLARGE_ALLOWED,\n\tLARGE_CURVE,\n\tLARGE_X_POS_LOGICAL,\n\tLARGE_Y_POS_LOGICAL,\n\tSMALL_ALLLOWED,\n\tSMALL_CURVE,\n\tSMALL_X_POS_LOGICAL,\n\tSMALL_Y_POS_LOGICAL,\n} from './util/GraphValues.js';\nimport { act } from '../anim/AnimationMain';\n\nconst SMALL_ADJ_MATRIX_X_START = 700;\nconst SMALL_ADJ_MATRIX_Y_START = 45;\nconst SMALL_ADJ_MATRIX_WIDTH = 30;\nconst SMALL_ADJ_MATRIX_HEIGHT = 30;\n\nconst SMALL_ADJ_LIST_X_START = 600;\nconst SMALL_ADJ_LIST_Y_START = 30;\n\nconst SMALL_ADJ_LIST_ELEM_WIDTH = 80;\nconst SMALL_ADJ_LIST_ELEM_HEIGHT = 30;\n\nconst SMALL_ADJ_LIST_HEIGHT = 36;\nconst SMALL_ADJ_LIST_WIDTH = 36;\n\nconst SMALL_ADJ_LIST_SPACING_AFTER_LIST = 15;\nconst SMALL_ADJ_LIST_SPACING_BETWEEN_NODES = 15;\n\nconst LARGE_ADJ_MATRIX_X_START = 575;\nconst LARGE_ADJ_MATRIX_Y_START = 40;\nconst LARGE_ADJ_MATRIX_WIDTH = 23;\nconst LARGE_ADJ_MATRIX_HEIGHT = 23;\n\nconst LARGE_ADJ_LIST_X_START = 600;\nconst LARGE_ADJ_LIST_Y_START = 30;\n\nconst LARGE_ADJ_LIST_ELEM_WIDTH = 80;\nconst LARGE_ADJ_LIST_ELEM_HEIGHT = 20;\n\nconst LARGE_ADJ_LIST_HEIGHT = 25;\nconst LARGE_ADJ_LIST_WIDTH = 20;\n\nconst LARGE_ADJ_LIST_SPACING_AFTER_LIST = 25;\nconst LARGE_ADJ_LIST_SPACING_BETWEEN_NODES = 15;\n\nexport const VERTEX_INDEX_COLOR = '#0000FF';\nexport const EDGE_COLOR = '#000000';\n\nconst HIGHLIGHT_CIRCLE_COLOR = '#000000';\n\nexport const SMALL_SIZE = 8;\nexport const LARGE_SIZE = 18;\n\nexport default class Graph extends Algorithm {\n\tconstructor(am, w, h, defaultEdges, dir, dag, costs) {\n\t\tsuper(am, w, h);\n\t\tthis.controls = [];\n\t\tdefaultEdges = defaultEdges === [] ? undefined : defaultEdges;\n\t\tdir = dir === undefined ? false : dir;\n\t\tdag = dag === undefined ? false : dag;\n\t\tcosts = costs === undefined ? false : costs;\n\n\t\tthis.nextIndex = 0;\n\n\t\tthis.currentLayer = 1;\n\t\tthis.defaultEdges = defaultEdges;\n\t\tthis.directed = dir;\n\t\tthis.isDAG = dag;\n\t\tthis.showEdgeCosts = costs;\n\t\tthis.currentLayer = 1;\n\n\t\tthis.setup_small(this.defaultEdges);\n\t}\n\n\taddControls(addDirection) {\n\t\tif (addDirection == null) {\n\t\t\taddDirection = true;\n\t\t}\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\t\tthis.newGraphButton = addControlToAlgorithmBar('Button', 'New Graph', verticalGroup);\n\t\tthis.newGraphButton.onclick = this.newGraphCallback.bind(this);\n\t\tthis.controls.push(this.newGraphButton);\n\t\tthis.defaultGraphButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Default Graph',\n\t\t\tverticalGroup,\n\t\t);\n\t\tthis.defaultGraphButton.onclick = this.defaultGraphCallback.bind(this);\n\t\tthis.defaultGraphButton.disabled = true;\n\t\tthis.controls.push(this.defaultGraphButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tif (addDirection) {\n\t\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t\t['Undirected Graph', 'Directed Graph'],\n\t\t\t\t'GraphType',\n\t\t\t);\n\n\t\t\tthis.undirectedGraphButton = radioButtonList[0];\n\t\t\tthis.undirectedGraphButton.onclick = this.directedGraphCallback.bind(this, false);\n\t\t\tthis.undirectedGraphButton.checked = !this.directed;\n\t\t\tthis.controls.push(this.undirectedGraphButton);\n\n\t\t\tthis.directedGraphButton = radioButtonList[1];\n\t\t\tthis.directedGraphButton.onclick = this.directedGraphCallback.bind(this, true);\n\t\t\tthis.directedGraphButton.checked = this.directed;\n\t\t\tthis.controls.push(this.directedGraphButton);\n\n\t\t\taddDivisorToAlgorithmBar();\n\t\t}\n\n\t\tlet radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Small Graph', 'Large Graph'],\n\t\t\t'GraphSize',\n\t\t);\n\n\t\tthis.smallGraphButton = radioButtonList[0];\n\t\tthis.smallGraphButton.onclick = this.smallGraphCallback.bind(this);\n\t\tthis.smallGraphButton.checked = true;\n\t\tthis.controls.push(this.smallGraphButton);\n\n\t\tthis.largeGraphButton = radioButtonList[1];\n\t\tthis.largeGraphButton.onclick = this.largeGraphCallback.bind(this);\n\t\tthis.controls.push(this.largeGraphButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// We are explicitly not adding the buttons below to this.controls\n\t\t// since we don't want them to be disabled\n\t\tradioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t[\n\t\t\t\t'Logical Representation',\n\t\t\t\t'Adjacency List Representation',\n\t\t\t\t'Adjacency Matrix Representation',\n\t\t\t],\n\t\t\t'GraphRepresentation',\n\t\t);\n\n\t\tthis.logicalButton = radioButtonList[0];\n\t\tthis.logicalButton.onclick = this.graphRepChangedCallback.bind(this, 1);\n\n\t\tthis.adjacencyListButton = radioButtonList[1];\n\t\tthis.adjacencyListButton.onclick = this.graphRepChangedCallback.bind(this, 2);\n\n\t\tthis.adjacencyMatrixButton = radioButtonList[2];\n\t\tthis.adjacencyMatrixButton.onclick = this.graphRepChangedCallback.bind(this, 3);\n\t\tthis.logicalButton.checked = true;\n\t}\n\n\tdirectedGraphCallback(newDirected) {\n\t\tif (newDirected !== this.directed) {\n\t\t\tthis.defaultGraphButton.disabled = newDirected;\n\t\t\tthis.directed = newDirected;\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup();\n\t\t}\n\t}\n\n\tsmallGraphCallback() {\n\t\tif (this.size !== SMALL_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup_small();\n\t\t}\n\t}\n\n\tlargeGraphCallback() {\n\t\tif (this.size !== LARGE_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup_large();\n\t\t}\n\t}\n\n\tnewGraphCallback() {\n\t\tthis.animationManager.resetAll();\n\t\tthis.setup();\n\t}\n\n\tdefaultGraphCallback() {\n\t\tthis.animationManager.resetAll();\n\t\tthis.setup(this.defaultEdges);\n\t}\n\n\tgraphRepChangedCallback(newLayer) {\n\t\tthis.animationManager.setAllLayers([0, newLayer]);\n\t\tthis.currentLayer = newLayer;\n\t}\n\n\trecolorGraph() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tthis.setEdgeColor(i, j, EDGE_COLOR);\n\t\t\t\t\tthis.setEdgeThickness(i, j, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thighlightEdge(i, j, highlightVal, color) {\n\t\tthis.cmd(act.setHighlight, this.adj_list_edges[i][j], highlightVal, color);\n\t\tthis.cmd(act.setHighlight, this.adj_matrixID[i][j], highlightVal, color);\n\t\tthis.cmd(act.setEdgeHighlight, this.circleID[i], this.circleID[j], highlightVal, color);\n\t\tif (!this.directed) {\n\t\t\tthis.cmd(act.setEdgeHighlight, this.circleID[j], this.circleID[i], highlightVal, color);\n\t\t}\n\t}\n\n\tvisitVertex(i) {\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightCircleL,\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\tthis.x_pos_logical[i],\n\t\t\tthis.y_pos_logical[i],\n\t\t);\n\t\tthis.cmd(act.setLayer, this.highlightCircleL, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightCircleAL,\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\n\t\t);\n\t\tthis.cmd(act.setLayer, this.highlightCircleAL, 2);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightCircleAM,\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height,\n\t\t);\n\t\tthis.cmd(act.setLayer, this.highlightCircleAM, 3);\n\t}\n\n\tleaveVertex() {\n\t\tthis.cmd(act.delete, this.highlightCircleL);\n\t\tthis.cmd(act.delete, this.highlightCircleAM);\n\t\tthis.cmd(act.delete, this.highlightCircleAL);\n\t}\n\n\tsetEdgeColor(i, j, color) {\n\t\tthis.cmd(act.setForegroundColor, this.adj_list_edges[i][j], color);\n\t\tthis.cmd(act.setTextColor, this.adj_matrixID[i][j], color);\n\t\tthis.cmd(act.setEdgeColor, this.circleID[i], this.circleID[j], color);\n\t\tif (!this.directed) {\n\t\t\tthis.cmd(act.setEdgeColor, this.circleID[j], this.circleID[i], color);\n\t\t}\n\t}\n\n\tsetEdgeThickness(i, j, thickness) {\n\t\tthis.cmd(act.setEdgeThickness, this.circleID[i], this.circleID[j], thickness);\n\t\tif (!this.directed) {\n\t\t\tthis.cmd(act.setEdgeThickness, this.circleID[j], this.circleID[i], thickness);\n\t\t}\n\t}\n\n\tclearEdges() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tthis.cmd(act.disconnect, this.circleID[i], this.circleID[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trebuildEdges() {\n\t\tthis.clearEdges();\n\t\tthis.buildEdges();\n\t}\n\n\tbuildEdges() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tconst edgeLabel = this.showEdgeCosts ? String(this.adj_matrix[i][j]) : '';\n\t\t\t\t\tif (this.directed) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[i],\n\t\t\t\t\t\t\tthis.circleID[j],\n\t\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t\tthis.adjustCurveForDirectedEdges(\n\t\t\t\t\t\t\t\tthis.curve[i][j],\n\t\t\t\t\t\t\t\tthis.adj_matrix[j][i] >= 0,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tedgeLabel,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (i < j) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[i],\n\t\t\t\t\t\t\tthis.circleID[j],\n\t\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t\tthis.curve[i][j],\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tedgeLabel,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetup_small(adj_matrix) {\n\t\tthis.allowed = SMALL_ALLLOWED;\n\t\tthis.curve = SMALL_CURVE;\n\t\tthis.x_pos_logical = SMALL_X_POS_LOGICAL;\n\t\tthis.y_pos_logical = SMALL_Y_POS_LOGICAL;\n\t\tthis.adj_matrix_x_start = SMALL_ADJ_MATRIX_X_START;\n\t\tthis.adj_matrix_y_start = SMALL_ADJ_MATRIX_Y_START;\n\t\tthis.adj_matrix_width = SMALL_ADJ_MATRIX_WIDTH;\n\t\tthis.adj_matrix_height = SMALL_ADJ_MATRIX_HEIGHT;\n\t\tthis.adj_list_x_start = SMALL_ADJ_LIST_X_START;\n\t\tthis.adj_list_y_start = SMALL_ADJ_LIST_Y_START;\n\t\tthis.adj_list_elem_width = SMALL_ADJ_LIST_ELEM_WIDTH;\n\t\tthis.adj_list_elem_height = SMALL_ADJ_LIST_ELEM_HEIGHT;\n\t\tthis.adj_list_height = SMALL_ADJ_LIST_HEIGHT;\n\t\tthis.adj_list_width = SMALL_ADJ_LIST_WIDTH;\n\t\tthis.adj_list_spacing_after_list = SMALL_ADJ_LIST_SPACING_AFTER_LIST;\n\t\tthis.adj_list_spacing_between_nodes = SMALL_ADJ_LIST_SPACING_BETWEEN_NODES;\n\t\tthis.size = SMALL_SIZE;\n\t\tthis.isLarge = false;\n\t\tthis.highlightCircleL = this.nextIndex++;\n\t\tthis.highlightCircleAL = this.nextIndex++;\n\t\tthis.highlightCircleAM = this.nextIndex++;\n\t\tthis.setup(adj_matrix);\n\t}\n\n\tsetup_large() {\n\t\tthis.allowed = LARGE_ALLOWED;\n\t\tthis.curve = LARGE_CURVE;\n\t\tthis.x_pos_logical = LARGE_X_POS_LOGICAL;\n\t\tthis.y_pos_logical = LARGE_Y_POS_LOGICAL;\n\t\tthis.adj_matrix_x_start = LARGE_ADJ_MATRIX_X_START;\n\t\tthis.adj_matrix_y_start = LARGE_ADJ_MATRIX_Y_START;\n\t\tthis.adj_matrix_width = LARGE_ADJ_MATRIX_WIDTH;\n\t\tthis.adj_matrix_height = LARGE_ADJ_MATRIX_HEIGHT;\n\t\tthis.adj_list_x_start = LARGE_ADJ_LIST_X_START;\n\t\tthis.adj_list_y_start = LARGE_ADJ_LIST_Y_START;\n\t\tthis.adj_list_elem_width = LARGE_ADJ_LIST_ELEM_WIDTH;\n\t\tthis.adj_list_elem_height = LARGE_ADJ_LIST_ELEM_HEIGHT;\n\t\tthis.adj_list_height = LARGE_ADJ_LIST_HEIGHT;\n\t\tthis.adj_list_width = LARGE_ADJ_LIST_WIDTH;\n\t\tthis.adj_list_spacing_after_list = LARGE_ADJ_LIST_SPACING_AFTER_LIST;\n\t\tthis.adj_list_spacing_between_nodes = LARGE_ADJ_LIST_SPACING_BETWEEN_NODES;\n\t\tthis.size = LARGE_SIZE;\n\t\tthis.isLarge = true;\n\t\tthis.highlightCircleL = this.nextIndex++;\n\t\tthis.highlightCircleAL = this.nextIndex++;\n\t\tthis.highlightCircleAM = this.nextIndex++;\n\t\tthis.setup();\n\t}\n\n\tadjustCurveForDirectedEdges(curve, bidirectional) {\n\t\tif (!this.directed || !bidirectional || Math.abs(curve) > 0.01) {\n\t\t\treturn curve;\n\t\t} else {\n\t\t\treturn 0.1;\n\t\t}\n\t}\n\n\tsetup(adj_matrix) {\n\t\tthis.commands = [];\n\t\tthis.circleID = new Array(this.size);\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.circleID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircle,\n\t\t\t\tthis.circleID[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tthis.x_pos_logical[i],\n\t\t\t\tthis.y_pos_logical[i],\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.circleID[i], VERTEX_INDEX_COLOR, 0);\n\n\t\t\tthis.cmd(act.setLayer, this.circleID[i], 1);\n\t\t}\n\n\t\tif (adj_matrix) {\n\t\t\tthis.adj_matrix = adj_matrix;\n\t\t\tthis.adj_matrixID = new Array(this.size);\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tthis.adj_matrixID[i] = new Array(this.size);\n\t\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.buildEdges();\n\t\t} else {\n\t\t\tthis.adj_matrix = new Array(this.size);\n\t\t\tthis.adj_matrixID = new Array(this.size);\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tthis.adj_matrix[i] = new Array(this.size);\n\t\t\t\tthis.adj_matrixID[i] = new Array(this.size);\n\t\t\t}\n\n\t\t\tlet edgePercent;\n\t\t\tif (this.size === SMALL_SIZE) {\n\t\t\t\tif (this.directed) {\n\t\t\t\t\tedgePercent = 0.4;\n\t\t\t\t} else {\n\t\t\t\t\tedgePercent = 0.5;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.directed) {\n\t\t\t\t\tedgePercent = 0.35;\n\t\t\t\t} else {\n\t\t\t\t\tedgePercent = 0.6;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.directed) {\n\t\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tthis.allowed[i][j] &&\n\t\t\t\t\t\t\tMath.random() <= edgePercent &&\n\t\t\t\t\t\t\t(i < j ||\n\t\t\t\t\t\t\t\tMath.abs(this.curve[i][j]) < 0.01 ||\n\t\t\t\t\t\t\t\tthis.adj_matrixID[j][i] === -1) &&\n\t\t\t\t\t\t\t(!this.isDAG || i < j)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (this.showEdgeCosts) {\n\t\t\t\t\t\t\t\tthis.adj_matrix[i][j] = Math.floor(Math.random() * 9) + 1;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.adj_matrix[i][j] = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.buildEdges();\n\t\t\t} else {\n\t\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\t\tfor (let j = i + 1; j < this.size; j++) {\n\t\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\t\t\tthis.adj_matrixID[j][i] = this.nextIndex++;\n\n\t\t\t\t\t\tif (this.allowed[i][j] && Math.random() <= edgePercent) {\n\t\t\t\t\t\t\tif (this.showEdgeCosts) {\n\t\t\t\t\t\t\t\tthis.adj_matrix[i][j] = Math.floor(Math.random() * 9) + 1;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.adj_matrix[i][j] = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.adj_matrix[j][i] = this.adj_matrix[i][j];\n\t\t\t\t\t\t\tlet edgeLabel;\n\t\t\t\t\t\t\tif (this.showEdgeCosts) {\n\t\t\t\t\t\t\t\tedgeLabel = String(this.adj_matrix[i][j]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tedgeLabel = '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\t\tthis.circleID[i],\n\t\t\t\t\t\t\t\tthis.circleID[j],\n\t\t\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t\t\tthis.curve[i][j],\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\tedgeLabel,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = -1;\n\t\t\t\t\t\t\tthis.adj_matrix[j][i] = -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.buildEdges();\n\n\t\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\t\tthis.adj_matrix[i][i] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Create Adj List\n\n\t\tthis.buildAdjList();\n\n\t\t// Create Adj Matrix\n\n\t\tthis.buildAdjMatrix();\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.clearHistory();\n\t}\n\n\tresetAll() {}\n\n\tbuildAdjMatrix() {\n\t\tthis.adj_matrix_index_x = new Array(this.size);\n\t\tthis.adj_matrix_index_y = new Array(this.size);\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.adj_matrix_index_x[i] = this.nextIndex++;\n\t\t\tthis.adj_matrix_index_y[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.adj_matrix_index_x[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tthis.adj_matrix_x_start + i * this.adj_matrix_width,\n\t\t\t\tthis.adj_matrix_y_start - this.adj_matrix_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.adj_matrix_index_x[i], VERTEX_INDEX_COLOR);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.adj_matrix_index_y[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.adj_matrix_index_y[i], VERTEX_INDEX_COLOR);\n\t\t\tthis.cmd(act.setLayer, this.adj_matrix_index_x[i], 3);\n\t\t\tthis.cmd(act.setLayer, this.adj_matrix_index_y[i], 3);\n\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\tlet lab;\n\t\t\t\tif (this.adj_matrix[i][j] < 0) {\n\t\t\t\t\tlab = '';\n\t\t\t\t} else {\n\t\t\t\t\tlab = String(this.adj_matrix[i][j]);\n\t\t\t\t}\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.adj_matrixID[i][j],\n\t\t\t\t\tlab,\n\t\t\t\t\tthis.adj_matrix_width,\n\t\t\t\t\tthis.adj_matrix_height,\n\t\t\t\t\tthis.adj_matrix_x_start + j * this.adj_matrix_width,\n\t\t\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setLayer, this.adj_matrixID[i][j], 3);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveAdjList() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.adj_list_list[i], 'RAL1');\n\t\t\tthis.cmd(act.delete, this.adj_list_index[i], 'RAL2');\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] > 0) {\n\t\t\t\t\tthis.cmd(act.delete, this.adj_list_edges[i][j], 'RAL3');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildAdjList() {\n\t\tthis.adj_list_index = new Array(this.size);\n\t\tthis.adj_list_list = new Array(this.size);\n\t\tthis.adj_list_edges = new Array(this.size);\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.adj_list_index[i] = this.nextIndex++;\n\t\t\tthis.adj_list_edges[i] = new Array(this.size);\n\t\t\tthis.adj_list_index[i] = this.nextIndex++;\n\t\t\tthis.adj_list_list[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.adj_list_list[i],\n\t\t\t\t'',\n\t\t\t\tthis.adj_list_width,\n\t\t\t\tthis.adj_list_height,\n\t\t\t\tthis.adj_list_x_start,\n\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setLayer, this.adj_list_list[i], 2);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.adj_list_index[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.adj_list_index[i], VERTEX_INDEX_COLOR);\n\t\t\tthis.cmd(act.setLayer, this.adj_list_index[i], 2);\n\t\t\tlet lastElem = this.adj_list_list[i];\n\t\t\tlet nextXPos =\n\t\t\t\tthis.adj_list_x_start +\n\t\t\t\tthis.adj_list_width +\n\t\t\t\tthis.adj_list_spacing_after_list +\n\t\t\t\tthis.adj_list_spacing_between_nodes;\n\t\t\tlet hasEdges = false;\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\thasEdges = true;\n\t\t\t\t\tthis.adj_list_edges[i][j] = this.nextIndex++;\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLinkedListNode,\n\t\t\t\t\t\tthis.adj_list_edges[i][j],\n\t\t\t\t\t\t[this.toStr(j), this.adj_matrix[i][j]],\n\t\t\t\t\t\tthis.adj_list_elem_width,\n\t\t\t\t\t\tthis.adj_list_elem_height,\n\t\t\t\t\t\tnextXPos,\n\t\t\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\n\t\t\t\t\t\t0.25,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t1,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.setNull, this.adj_list_edges[i][j], 1);\n\t\t\t\t\tthis.cmd(act.setTextColor, this.adj_list_edges[i][j], VERTEX_INDEX_COLOR, 0);\n\t\t\t\t\tthis.cmd(act.setLayer, this.adj_list_edges[i][j], 2);\n\n\t\t\t\t\tnextXPos =\n\t\t\t\t\t\tnextXPos + this.adj_list_elem_width + this.adj_list_spacing_between_nodes;\n\t\t\t\t\tthis.cmd(act.connect, lastElem, this.adj_list_edges[i][j]);\n\t\t\t\t\tthis.cmd(act.setNull, lastElem, 0);\n\t\t\t\t\tlastElem = this.adj_list_edges[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!hasEdges) {\n\t\t\t\tthis.cmd(act.setNull, this.adj_list_list[i], 1);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Should be overwritten in child\n\treset() {\n\t\tthrow new Error('reset() should be implemented in child');\n\t}\n\n\ttoStr(vertex) {\n\t\treturn String.fromCharCode(65 + vertex);\n\t}\n\n\tenableUI() {\n\t\tfor (const control of this.controls) {\n\t\t\tif (\n\t\t\t\tcontrol === this.defaultGraphButton &&\n\t\t\t\t(this.directed || this.isLarge || this.adj_matrix === this.defaultEdges)\n\t\t\t) {\n\t\t\t\tcontrol.disabled = true;\n\t\t\t} else {\n\t\t\t\tcontrol.disabled = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (const control of this.controls) {\n\t\t\tcontrol.disabled = true;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { BFS_DFS_ADJ_LIST } from './util/GraphValues';\nimport Graph from './Graph.js';\nimport { act } from '../anim/AnimationMain';\n\nconst BFS_QUEUE_HEAD_COLOR = '#0000FF';\nconst VISITED_COLOR = '#99CCFF';\n\nconst INFO_MSG_X = 25;\nconst INFO_MSG_Y = 15;\n\nconst LIST_START_X = 30;\nconst LIST_START_Y = 65;\nconst LIST_SPACING = 20;\n\nconst VISITED_START_X = 30;\nconst VISITED_START_Y = 115;\n\nconst CURRENT_VERTEX_LABEL_X = 25;\nconst CURRENT_VERTEX_LABEL_Y = 140;\nconst CURRENT_VERTEX_X = 115;\nconst CURRENT_VERTEX_Y = 146;\n\nconst QUEUE_START_X = 30;\nconst QUEUE_START_Y = 190;\nconst QUEUE_SPACING = 20;\n\nexport default class BFS extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, BFS_DFS_ADJ_LIST);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start vertex: ');\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse,\n\t\t);\n\t\tthis.startField.size = 2;\n\t\tthis.controls.push(this.startField);\n\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\t\tthis.commands = [];\n\t\tthis.messageID = [];\n\n\t\tthis.visited = [];\n\n\t\tthis.queueID = [];\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited Set:',\n\t\t\tVISITED_START_X - 5,\n\t\t\tVISITED_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'List:',\n\t\t\tLIST_START_X - 5,\n\t\t\tLIST_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current vertex:',\n\t\t\tCURRENT_VERTEX_LABEL_X,\n\t\t\tCURRENT_VERTEX_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Queue:',\n\t\t\tQUEUE_START_X - 5,\n\t\t\tQUEUE_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.listID = [];\n\t\tthis.messageID = [];\n\t\tthis.visitedID = [];\n\t}\n\n\tstartCallback() {\n\t\tif (this.startField.value !== '') {\n\t\t\tlet startvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size) {\n\t\t\t\tthis.implementAction(this.doBFS.bind(this), startvalue);\n\t\t\t}\n\t\t}\n\t}\n\n\tdoBFS(startVetex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.queue = [];\n\t\tthis.queueID = [];\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\n\t\tthis.rebuildEdges();\n\n\t\tlet vertex = startVetex;\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Enqueueing ' + this.toStr(vertex) + ' and adding to visited set',\n\t\t);\n\t\tthis.visited[vertex] = true;\n\t\tthis.visitedID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(vertex),\n\t\t\tVISITED_START_X,\n\t\t\tVISITED_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[vertex], VISITED_COLOR);\n\t\tthis.queue.push(vertex);\n\t\tthis.queueID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(vertex),\n\t\t\tQUEUE_START_X,\n\t\t\tQUEUE_START_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\twhile (this.queue.length > 0 && this.listID.length < this.size) {\n\t\t\tvertex = this.queue.shift();\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.infoLabelID,\n\t\t\t\t'Dequeueing ' + this.toStr(vertex) + ' and adding to list',\n\t\t\t);\n\n\t\t\tthis.cmd(act.setTextColor, this.queueID[0], BFS_QUEUE_HEAD_COLOR);\n\t\t\tthis.cmd(act.move, this.queueID[0], CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\t\t\tfor (let i = 1; i < this.queueID.length; i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.queueID[i],\n\t\t\t\t\tQUEUE_START_X + (i - 1) * QUEUE_SPACING,\n\t\t\t\t\tQUEUE_START_Y,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.listID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tthis.toStr(vertex),\n\t\t\t\tLIST_START_X + (this.listID.length - 1) * LIST_SPACING,\n\t\t\t\tLIST_START_Y,\n\t\t\t);\n\n\t\t\tthis.visitVertex(vertex);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\tif (this.adj_matrix[vertex][neighbor] > 0) {\n\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 1);\n\t\t\t\t\tif (!this.visited[neighbor]) {\n\t\t\t\t\t\tthis.visited[neighbor] = true;\n\t\t\t\t\t\tthis.visitedID.push(this.nextIndex);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\tthis.toStr(neighbor) +\n\t\t\t\t\t\t\t\t' has not yet been visited, enqueueing and adding to visited set',\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\tthis.toStr(neighbor),\n\t\t\t\t\t\t\tVISITED_START_X + (this.visitedID.length - 1) * LIST_SPACING,\n\t\t\t\t\t\t\tVISITED_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[neighbor], VISITED_COLOR);\n\t\t\t\t\t\tthis.queue.push(neighbor);\n\t\t\t\t\t\tthis.queueID.push(this.nextIndex);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\tthis.toStr(neighbor),\n\t\t\t\t\t\t\tQUEUE_START_X + (this.queue.length - 1) * QUEUE_SPACING,\n\t\t\t\t\t\t\tQUEUE_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\tthis.toStr(neighbor) + ' has already been visited, skipping',\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.cmd(act.delete, this.queueID.shift());\n\n\t\t\tthis.leaveVertex();\n\t\t}\n\n\t\tif (this.queue.length > 0) {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'All vertices have been visited, done');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Queue is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], '#FFFFFF');\n\t\t\tthis.visited[i] = false;\n\t\t}\n\t\tfor (let i = 0; i < this.listID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.listID[i]);\n\t\t}\n\t\tfor (let i = 0; i < this.visitedID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.visitedID[i]);\n\t\t}\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.messageID = [];\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst CODE_START_X = 25;\nconst CODE_START_Y = 35;\nconst CODE_LINE_HEIGHT = 14;\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\nconst CODE_STANDARD_COLOR = '#000000';\n\nexport default class BST extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.first_print_pos_y = h - 2 * BST.PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\t\tthis.startingX = w / 2;\n\t\tthis.addControls();\n\t\tthis.nextIndex = 1;\n\t\tthis.commands = [];\n\t\tthis.edges = [];\n\t\tthis.toClear = [];\n\t\tthis.cmd(act.createLabel, 0, '', BST.EXPLANITORY_TEXT_X, BST.EXPLANITORY_TEXT_Y, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst traversalButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Pre-order', 'In-order', 'Post-order', 'Level order'],\n\t\t\t'Traversals',\n\t\t);\n\n\t\tthis.preOrderSelect = traversalButtonList[0];\n\t\tthis.inOrderSelect = traversalButtonList[1];\n\t\tthis.postOrderSelect = traversalButtonList[2];\n\t\tthis.levelOrderSelect = traversalButtonList[3];\n\t\tthis.preOrderSelect.onclick = () => (this.traversal = 'pre');\n\t\tthis.inOrderSelect.onclick = () => (this.traversal = 'in');\n\t\tthis.postOrderSelect.onclick = () => (this.traversal = 'post');\n\t\tthis.levelOrderSelect.onclick = () => (this.traversal = 'level');\n\t\tthis.preOrderSelect.checked = true;\n\t\tthis.traversal = 'pre';\n\n\t\tthis.traverseButton = addControlToAlgorithmBar('Button', 'Traverse');\n\t\tthis.traverseButton.onclick = this.traverseCallback.bind(this);\n\t\tthis.controls.push(this.traverseButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst predSuccButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Predecessor', 'Successor'],\n\t\t\t'Predecessor/Successor',\n\t\t);\n\n\t\tthis.predButton = predSuccButtonList[0];\n\t\tthis.succButton = predSuccButtonList[1];\n\t\tthis.predButton.onclick = () => (this.predSucc = 'pred');\n\t\tthis.succButton.onclick = () => (this.predSucc = 'succ');\n\t\tthis.succButton.checked = true;\n\t\tthis.predSucc = 'succ';\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t\tthis.edges = [];\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tconst deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t\t}\n\t}\n\n\ttraverseCallback() {\n\t\tthis.implementAction(this.traverse.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tsizeChanged(newWidth) {\n\t\tthis.startingX = newWidth / 2;\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y,\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.cmd(act.delete, i);\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\n\n\tpreOrderRec(tree, passedCodeID) {\n\t\tthis.codeID = passedCodeID;\n\t\tthis.cmd(act.step);\n\n\t\tconst nextLabelID = this.nextIndex++;\n\n\t\tthis.unhighlight(3,0)\n\t\tthis.unhighlight(4,0)\n\t\tthis.highlight(2,0);\n\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, BST.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += BST.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += BST.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tthis.unhighlight(2,0);\n\n\t\tif (tree.left != null) {\n\t\t\tthis.highlight(3,0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.preOrderRec(tree.left, passedCodeID);\n\t\t\t\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(3,0);\n\n\t\tif (tree.right != null) {\n\t\t\tthis.highlight(4,0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.preOrderRec(tree.right, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(4,0);\n\n\n\t\treturn;\n\t}\n\n\tlevelOrder(tree) {\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\t// const firstLabel = this.nextIndex;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightID,\n\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\tthis.treeRoot.x,\n\t\t\tthis.treeRoot.y,\n\t\t);\n\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\n\t\tconst queue = [tree];\n\n\t\twhile (queue.length !== 0) {\n\t\t\tconst curr = queue.shift();\n\n\t\t\tconst nextLabelID = this.nextIndex++;\n\t\t\tthis.cmd(act.move, this.highlightID, curr.x, curr.y);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.createLabel, nextLabelID, curr.data, curr.x, curr.y);\n\t\t\tthis.cmd(act.setForegroundColor, nextLabelID, BST.PRINT_COLOR);\n\t\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.xPosOfNextLabel += BST.PRINT_HORIZONTAL_GAP;\n\t\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\t\tthis.yPosOfNextLabel += BST.PRINT_VERTICAL_GAP;\n\t\t\t}\n\n\t\t\tif (curr.left != null) {\n\t\t\t\tqueue.push(curr.left);\n\t\t\t}\n\n\t\t\tif (curr.right != null) {\n\t\t\t\tqueue.push(curr.right);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, this.highlightID);\n\t\tthis.cmd(act.step);\n\t\t// for (let i = firstLabel; i < this.nextIndex; i++) this.cmd(act.delete, i);\n\t\t// this.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t}\n\n\ttraverse() {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\n\t\tif (this.treeRoot == null) {\n\t\t\treturn this.commands;\n\t\t}\n\n\t\tif (this.traversal === 'level') {\n\t\t\tthis.levelOrder(this.treeRoot);\n\t\t}\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\tconst firstLabel = this.nextIndex;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightID,\n\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\tthis.treeRoot.x,\n\t\t\tthis.treeRoot.y,\n\t\t);\n\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\n\t\tif (this.traversal === 'pre') {\n\t\t\tthis.codeID = this.setUpPseudocode(\n\t\t\t\t[\n\t\t\t\t\t['procedure preOrder(Node node)'],\n\t\t\t\t\t['     if node is not null:'],\n\t\t\t\t\t['          look at data in the node'],\n\t\t\t\t\t['          recurse left'],\n\t\t\t\t\t['          recurse right'],\n\t\t\t\t\t['end procedure']\n\t\t\t\t]\n\t\t\t);\n\t\t\tthis.preOrderRec(this.treeRoot, this.codeID);\n\t\t} else if (this.traversal === 'in') {\n\t\t\tthis.codeID = this.setUpPseudocode(\n\t\t\t\t[\n\t\t\t\t\t['procedure inOrder(Node node)'],\n\t\t\t\t\t['     if node is not null:'],\n\t\t\t\t\t['          recurse left'],\n\t\t\t\t\t['          look at data in the node'],\n\t\t\t\t\t['          recurse right'],\n\t\t\t\t\t['end procedure']\n\t\t\t\t]\n\t\t\t);\n\t\t\tthis.printTreeRec(this.treeRoot, this.codeID);\n\t\t} else if (this.traversal === 'post') {\n\t\t\tthis.codeID = this.setUpPseudocode(\n\t\t\t\t[\n\t\t\t\t\t['procedure postOrder(Node node)'],\n\t\t\t\t\t['     if node is not null:'],\n\t\t\t\t\t['          recurse left'],\n\t\t\t\t\t['          recurse right'],\n\t\t\t\t\t['          look at data in the node'],\n\t\t\t\t\t['end procedure']\n\t\t\t\t]\n\t\t\t);\n\t\t\tthis.postOrderRec(this.treeRoot, this.codeID);\n\t\t}\n\n\t\tthis.cmd(act.delete, this.highlightID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.toClear.push(i);\n\t\t// this.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\n\t\treturn this.commands;\n\t}\n\n\n\tpostOrderRec(tree, passedCodeID) {\n\t\tthis.codeID = passedCodeID;\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.unhighlight(3,0)\n\t\t\tthis.highlight(2,0)\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.postOrderRec(tree.left, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(2,0)\n\n\n\t\tif (tree.right != null) {\n\t\t\tthis.unhighlight(2,0)\n\t\t\tthis.highlight(3,0)\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.postOrderRec(tree.right, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(3,0)\n\n\t\tthis.highlight(4,0)\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, BST.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += BST.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += BST.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tthis.unhighlight(4,0)\n\n\t\treturn;\n\t}\n\n\tprintTreeRec(tree, passedCodeID) {\n\t\tthis.codeID = passedCodeID;\n\t\t\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(2,0);\n\n\t\tthis.unhighlight(4,0);\n\t\tthis.highlight(3,0);\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, BST.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += BST.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += BST.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tthis.unhighlight(3,0);\n\n\t\tif (tree.right != null) {\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right, passedCodeID);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(4,0);\n\n\t\treturn;\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tthis.doFind(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searching for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Found:' + value);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.left, value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t' Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.right, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t'Searching for ' + value + ' : < Empty Tree > (Element not found)',\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, 'Searching for ' + value + ' :  (Element not found)');\n\t\t}\n\t}\n\n\tremakeTree(curr) {\n\t\tif (curr == null) return;\n\t\tif (curr.left != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.left.graphicID, BST.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.left);\n\t\t}\n\t\tif (curr.right != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.right.graphicID, BST.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.right);\n\t\t}\n\t}\n\n\tclearOldObjects() {\n\t\tthis.toClear.forEach(i => this.cmd(act.delete, i));\n\t\tthis.toClear = [];\n\t}\n\n\tadd(data) {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\t\tthis.cmd(act.setText, 0, 'Inserting ' + data);\n\t\tthis.treeRoot = this.addH(data, this.treeRoot);\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\taddH(data, curr) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, 'Null found, inserting new node');\n\t\t\tconst treeNodeID = this.nextIndex++;\n\t\t\tthis.cmd(act.createCircle, treeNodeID, data, 30, BST.STARTING_Y);\n\n\t\t\tthis.cmd(act.setForegroundColor, treeNodeID, BST.FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, treeNodeID, BST.BACKGROUND_COLOR);\n\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn new BSTNode(data, treeNodeID, 0, 0);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking at left subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.addH(data, curr.left);\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking at right subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.addH(data, curr.right);\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, `${data} == ${curr.data}. Ignoring duplicate!`);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tconnectSmart(id1, id2) {\n\t\tif (!this.edges.some(e => e[0] === id1 && e[1] === id2)) {\n\t\t\tthis.cmd(act.connect, id1, id2, BST.LINK_COLOR);\n\t\t\tthis.edges.push([id1, id2]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tdeleteNode(curr) {\n\t\tthis.cmd(act.delete, curr.graphicID);\n\t}\n\n\tremove(data) {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\n\t\tthis.cmd(act.setText, 0, `Deleting ${data}`);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, ' ');\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeRoot = this.removeH(this.treeRoot, data);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\tremoveH(curr, data) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, `${data} not found in the tree`);\n\t\t\treturn;\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking left`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.removeH(curr.left, data);\n\t\t\tif (curr.left != null) {\n\t\t\t\tcurr.left.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking right`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.removeH(curr.right, data);\n\t\t\tif (curr.right != null) {\n\t\t\t\tcurr.right.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else {\n\t\t\tif (curr.left == null && curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Element to delete is a leaf node');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn null;\n\t\t\t} else if (curr.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with right child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.right;\n\t\t\t} else if (curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with left child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.left;\n\t\t\t} else {\n\t\t\t\tconst dummy = [];\n\t\t\t\tif (this.predSucc === 'succ') {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with successor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.right = this.removeSucc(curr.right, dummy);\n\t\t\t\t\tcurr.right && this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with predecessor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.left = this.removePred(curr.left, dummy);\n\t\t\t\t\tcurr.left && this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\t}\n\t\t\t\tthis.resizeTree();\n\t\t\t\tcurr.data = dummy[0];\n\t\t\t\tthis.cmd(act.setText, curr.graphicID, curr.data);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tremoveSucc(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.left == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No left child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.right;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Left child exists, look left');\n\t\tcurr.left = this.removeSucc(curr.left, dummy);\n\t\tif (curr.left != null) {\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0, '#0000ff');\n\t\treturn curr;\n\t}\n\n\tremovePred(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.right == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No right child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.left;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Right child exists, look right');\n\t\tthis.cmd(act.step);\n\t\tcurr.right = this.removePred(curr.right, dummy);\n\t\tif (curr.right != null) {\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0, '#0000ff');\n\t\treturn curr;\n\t}\n\n\tresizeTree() {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, BST.STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + BST.HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + BST.HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), BST.WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), BST.WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.clearOldObjects();\n\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\n\tsetUpPseudocode(tailoredCode) {\n\t\tthis.code = tailoredCode;\n\n\t\tthis.codeID = Array(this.code.length);\n\t\tlet i, j;\n\t\tfor (i = 0; i < this.code.length; i++) {\n\t\t\tthis.codeID[i] = new Array(this.code[i].length);\n\t\t\tfor (j = 0; j < this.code[i].length; j++) {\n\t\t\t\tthis.codeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.codeID[i][j],\n\t\t\t\t\tthis.code[i][j],\n\t\t\t\t\tCODE_START_X,\n\t\t\t\t\tCODE_START_Y + i * CODE_LINE_HEIGHT,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[i][j], CODE_STANDARD_COLOR);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, this.codeID[i][j], this.codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.codeID;\n\n\t}\n\n\thighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\n\t}\n\n\tunhighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\n\t}\n}\n\nclass BSTNode {\n\tconstructor(val, id, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n}\n\n// Various constants\n\nBST.HIGHLIGHT_LABEL_COLOR = '#FF0000';\nBST.HIGHLIGHT_LINK_COLOR = '#FF0000';\n\nBST.HIGHLIGHT_COLOR = '#007700';\nBST.HEIGHT_LABEL_COLOR = '#007700';\n\nBST.LINK_COLOR = '#00B000';\nBST.HIGHLIGHT_CIRCLE_COLOR = '#007700';\nBST.FOREGROUND_COLOR = '#007700';\nBST.BACKGROUND_COLOR = '#DDFFDD';\nBST.PRINT_COLOR = BST.FOREGROUND_COLOR;\n\nBST.WIDTH_DELTA = 50;\nBST.HEIGHT_DELTA = 50;\nBST.STARTING_Y = 50;\n\nBST.FIRST_PRINT_POS_X = 50;\nBST.PRINT_VERTICAL_GAP = 20;\nBST.PRINT_HORIZONTAL_GAP = 50;\nBST.EXPLANITORY_TEXT_X = 10;\nBST.EXPLANITORY_TEXT_Y = 10;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst FIRST_PRINT_POS_X = 50;\nconst PRINT_VERTICAL_GAP = 20;\nconst PRINT_MAX = 990;\nconst PRINT_HORIZONTAL_GAP = 50;\n\nconst MIN_MAX_DEGREE = 4;\n\nconst HEIGHT_DELTA = 50;\nconst NODE_SPACING = 3;\nconst STARTING_Y = 30;\nconst WIDTH_PER_ELEM = 40;\nconst NODE_HEIGHT = 20;\n\nconst MESSAGE_X = 5;\nconst MESSAGE_Y = 10;\n\nconst FOREGROUND_COLOR = '#007700';\nconst BACKGROUND_COLOR = '#EEFFEE';\nconst PRINT_COLOR = FOREGROUND_COLOR;\n\nexport default class BTree extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.nextIndex = 0;\n\n\t\tthis.starting_x = w / 2;\n\n\t\tthis.preemptiveSplit = false;\n\n\t\tthis.addControls();\n\n\t\tthis.max_keys = 3;\n\t\tthis.min_keys = 1;\n\t\tthis.split_index = 1;\n\n\t\tthis.max_degree = 4;\n\n\t\tthis.messageID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.messageID, '', MESSAGE_X, MESSAGE_Y, 0);\n\t\tthis.moveLabel1ID = this.nextIndex++;\n\t\tthis.moveLabel2ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.commands = [];\n\n\t\tthis.first_print_pos_y = h - 3 * PRINT_VERTICAL_GAP;\n\n\t\tthis.xPosOfNextLabel = 100;\n\t\tthis.yPosOfNextLabel = 200;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\t\taddLabelToAlgorithmBar('Promote with');\n\t\tconst splitIndexButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['second data', 'third data'],\n\t\t\t'Split Index',\n\t\t);\n\n\t\tthis.splitSecondSelect = splitIndexButtonList[0];\n\t\tthis.splitThirdSelect = splitIndexButtonList[1];\n\t\tthis.splitSecondSelect.onclick = () => (this.split_index = 1);\n\t\tthis.splitThirdSelect.onclick = () => (this.split_index = 2);\n\t\tthis.splitSecondSelect.checked = true;\n\t\tthis.split_index = 1;\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst predSuccButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Predecessor', 'Successor'],\n\t\t\t'Predecessor/Successor',\n\t\t);\n\n\t\tthis.predButton = predSuccButtonList[0];\n\t\tthis.succButton = predSuccButtonList[1];\n\n\t\tthis.predButton.onclick = this.predCallback.bind(this);\n\t\tthis.succButton.onclick = this.succCallback.bind(this);\n\t\tthis.succButton.checked = true;\n\t\tthis.predSucc = 'succ';\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 3;\n\t\tthis.max_degree = 4;\n\t\tthis.max_keys = 3;\n\t\tthis.min_keys = 1;\n\t\tthis.split_index = 1;\n\t\t// NOTE: The order of these last two this.commands matters!\n\t\tthis.treeRoot = null;\n\t\tthis.ignoreInputs = true;\n\t\tthis.ignoreInputs = false;\n\t}\n\n\tenableUI() {\n\t\tlet i;\n\t\tfor (i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tmaxDegreeChangedHandler(newMaxDegree) {\n\t\tif (this.max_degree !== newMaxDegree) {\n\t\t\tthis.implementAction(this.changeDegree.bind(this), newMaxDegree);\n\t\t\tthis.animationManager.skipForward();\n\t\t\tthis.animationManager.clearHistory();\n\t\t}\n\t}\n\n\tpredCallback() {\n\t\tif (this.predSucc !== 'pred') {\n\t\t\tthis.predSucc = 'pred';\n\t\t\t//this.commands = this.clearCallback();  maybe this isn't necessary?\n\t\t}\n\t}\n\n\tsuccCallback() {\n\t\tif (this.predSucc !== 'succ') {\n\t\t\tthis.predSucc = 'succ';\n\t\t\t//this.commands = this.clearCallback();\n\t\t}\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.normalizeNumber(this.insertField.value, 4);\n\t\tif (insertedValue !== '') {\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(this.deleteField.value, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.deleteElement.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearTree.bind(this));\n\t}\n\n\tpremtiveSplitCallback() {\n\t\tif (this.preemptiveSplit !== this.premptiveSplitBox.checked) {\n\t\t\tthis.implementAction(\n\t\t\t\tthis.changePreemtiveSplit.bind(this),\n\t\t\t\tthis.premptiveSplitBox.checked,\n\t\t\t);\n\t\t}\n\t}\n\n\tchangePreemtiveSplit(newValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.step);\n\t\tthis.preemptiveSplit = newValue;\n\t\tif (this.premptiveSplitBox.checked !== this.preemptiveSplit) {\n\t\t\tthis.premptiveSplitBox.checked = this.preemptiveSplit;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.messageID, 'Printing tree');\n\t\tconst firstLabel = this.nextIndex;\n\n\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\n\t\tthis.printTreeRec(this.treeRoot);\n\t\tthis.cmd(act.step);\n\t\tfor (let i = firstLabel; i < this.nextIndex; i++) {\n\t\t\tthis.cmd(act.delete, i);\n\t\t}\n\t\tthis.nextIndex = firstLabel;\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tlet nextLabelID;\n\t\tif (tree.isLeaf) {\n\t\t\tfor (let i = 0; i < tree.numKeys; i++) {\n\t\t\t\tnextLabelID = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tnextLabelID,\n\t\t\t\t\ttree.keys[i],\n\t\t\t\t\tthis.getLabelX(tree, i),\n\t\t\t\t\ttree.y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, nextLabelID, PRINT_COLOR);\n\t\t\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\n\t\t\t\tif (this.xPosOfNextLabel > PRINT_MAX) {\n\t\t\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t} else {\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[0].graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[0].graphicID, 0);\n\t\t\tthis.printTreeRec(tree.children[0]);\n\t\t\tfor (let i = 0; i < tree.numKeys; i++) {\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\t\tnextLabelID = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tnextLabelID,\n\t\t\t\t\ttree.keys[i],\n\t\t\t\t\tthis.getLabelX(tree, i),\n\t\t\t\t\ttree.y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, nextLabelID, PRINT_COLOR);\n\t\t\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\n\t\t\t\tif (this.xPosOfNextLabel > PRINT_MAX) {\n\t\t\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i + 1].graphicID, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i + 1].graphicID, 0);\n\t\t\t\tthis.printTreeRec(tree.children[i + 1]);\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t}\n\t}\n\n\tclearTree() {\n\t\tthis.commands = [];\n\t\tthis.deleteTree(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\tthis.nextIndex = 3;\n\t\treturn this.commands;\n\t}\n\n\tdeleteTree(tree) {\n\t\tif (tree != null) {\n\t\t\tif (!tree.isLeaf) {\n\t\t\t\tfor (let i = 0; i <= tree.numKeys; i++) {\n\t\t\t\t\tthis.cmd(act.disconnect, tree.graphicID, tree.children[i].graphicID);\n\t\t\t\t\tthis.deleteTree(tree.children[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.delete, tree.graphicID);\n\t\t}\n\t}\n\n\tchangeDegree(degree) {\n\t\tthis.commands = [];\n\t\tthis.deleteTree(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\tthis.nextIndex = 3;\n\t\tconst newDegree = degree;\n\t\tthis.ignoreInputs = true;\n\t\tthis.maxDegreeRadioButtons[newDegree - MIN_MAX_DEGREE].checked = true;\n\n\t\tthis.ignoreInputs = false;\n\t\tthis.max_degree = newDegree;\n\t\tthis.max_keys = newDegree - 1;\n\t\tthis.min_keys = Math.floor((newDegree + 1) / 2) - 1;\n\t\tthis.split_index = Math.floor((newDegree - 1) / 2);\n\t\tif (this.commands.length === 0) {\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tif (newDegree % 2 !== 0 && this.preemptiveSplit) {\n\t\t\tthis.preemptiveSplit = false;\n\t\t\tthis.premptiveSplitBox.checked = false;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.normalizeNumber(this.findField.value, 4);\n\t\tthis.findField.value = '';\n\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.messageID, 'Finding ' + findValue);\n\t\tthis.findInTree(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tfindInTree(tree, val) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\n\t\t\tif (i === tree.numKeys) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t1,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t\tthis.findInTree(tree.children[tree.numKeys], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' is not in the tree');\n\t\t\t\t}\n\t\t\t} else if (tree.keys[i] > val) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\t\t\t\t\tthis.findInTree(tree.children[i], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' is not in the tree');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, '#FF0000', i);\n\t\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' found');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' is not in the tree');\n\t\t}\n\t}\n\n\tinsertElement(insertedValue) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.messageID, 'Inserting ' + insertedValue);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.treeRoot == null) {\n\t\t\tthis.treeRoot = new BTreeNode(this.nextIndex++, this.starting_x, STARTING_Y);\n\t\t\tthis.cmd(\n\t\t\t\tact.createBTreeNode,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\tWIDTH_PER_ELEM,\n\t\t\t\tNODE_HEIGHT,\n\t\t\t\t1,\n\t\t\t\tthis.starting_x,\n\t\t\t\tSTARTING_Y,\n\t\t\t\tBACKGROUND_COLOR,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t);\n\t\t\tthis.treeRoot.keys[0] = insertedValue;\n\t\t\tthis.cmd(act.setText, this.treeRoot.graphicID, insertedValue, 0);\n\t\t} else {\n\t\t\tif (this.preemptiveSplit) {\n\t\t\t\tif (this.treeRoot.numKeys === this.max_keys) {\n\t\t\t\t\tthis.split(this.treeRoot);\n\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.insertNotFull(this.treeRoot, insertedValue);\n\t\t\t} else {\n\t\t\t\tthis.insert(this.treeRoot, insertedValue);\n\t\t\t}\n\t\t\tif (!this.treeRoot.isLeaf) {\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.setText, this.messageID, '');\n\n\t\treturn this.commands;\n\t}\n\n\tinsertNotFull(tree, insertValue) {\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tif (tree.isLeaf) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.messageID,\n\t\t\t\t'Inserting ' + insertValue + '.  Inserting into a leaf',\n\t\t\t);\n\t\t\ttree.numKeys++;\n\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\tlet insertIndex = tree.numKeys - 1;\n\t\t\twhile (insertIndex > 0 && tree.keys[insertIndex - 1] > insertValue) {\n\t\t\t\ttree.keys[insertIndex] = tree.keys[insertIndex - 1];\n\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\t\tinsertIndex--;\n\t\t\t}\n\t\t\ttree.keys[insertIndex] = insertValue;\n\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.resizeTree();\n\t\t} else {\n\t\t\tlet findIndex = 0;\n\t\t\twhile (findIndex < tree.numKeys && tree.keys[findIndex] < insertValue) {\n\t\t\t\tfindIndex++;\n\t\t\t}\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 0);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tif (tree.children[findIndex].numKeys === this.max_keys) {\n\t\t\t\tconst newTree = this.split(tree.children[findIndex]);\n\t\t\t\tthis.resizeTree();\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.insertNotFull(newTree, insertValue);\n\t\t\t} else {\n\t\t\t\tthis.insertNotFull(tree.children[findIndex], insertValue);\n\t\t\t}\n\t\t}\n\t}\n\n\tinsert(tree, insertValue) {\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tif (tree.isLeaf) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.messageID,\n\t\t\t\t'Inserting ' + insertValue + '.  Inserting into a leaf',\n\t\t\t);\n\t\t\ttree.numKeys++;\n\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\tlet insertIndex = tree.numKeys - 1;\n\t\t\twhile (insertIndex > 0 && tree.keys[insertIndex - 1] > insertValue) {\n\t\t\t\ttree.keys[insertIndex] = tree.keys[insertIndex - 1];\n\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\t\tinsertIndex--;\n\t\t\t}\n\t\t\ttree.keys[insertIndex] = insertValue;\n\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.resizeTree();\n\t\t\tthis.insertRepair(tree);\n\t\t} else {\n\t\t\tlet findIndex = 0;\n\t\t\twhile (findIndex < tree.numKeys && tree.keys[findIndex] < insertValue) {\n\t\t\t\tfindIndex++;\n\t\t\t}\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 0);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.insert(tree.children[findIndex], insertValue);\n\t\t}\n\t}\n\n\tinsertRepair(tree) {\n\t\tif (tree.numKeys <= this.max_keys) {\n\t\t\treturn;\n\t\t} else if (tree.parent == null) {\n\t\t\tthis.treeRoot = this.split(tree);\n\t\t\treturn;\n\t\t} else {\n\t\t\tconst newNode = this.split(tree);\n\t\t\tthis.insertRepair(newNode);\n\t\t}\n\t}\n\n\tsplit(tree) {\n\t\tthis.cmd(act.setText, this.messageID, 'Node now contains too many keys.  Splittig ...');\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\tconst rightNode = new BTreeNode(this.nextIndex++, tree.x + 100, tree.y);\n\t\trightNode.numKeys = tree.numKeys - this.split_index - 1;\n\t\tconst risingNode = tree.keys[this.split_index];\n\t\tlet currentParent;\n\t\tlet parentIndex;\n\t\tif (tree.parent != null) {\n\t\t\tcurrentParent = tree.parent;\n\t\t\tfor (\n\t\t\t\tparentIndex = 0;\n\t\t\t\tparentIndex < currentParent.numKeys + 1 &&\n\t\t\t\tcurrentParent.children[parentIndex] !== tree;\n\t\t\t\tparentIndex++\n\t\t\t);\n\t\t\tif (parentIndex === currentParent.numKeys + 1) {\n\t\t\t\tthrow new Error(\"Couldn't find which child we were!\");\n\t\t\t}\n\t\t\tthis.cmd(act.setNumElements, currentParent.graphicID, currentParent.numKeys + 1);\n\t\t\tfor (let i = currentParent.numKeys; i > parentIndex; i--) {\n\t\t\t\tcurrentParent.children[i + 1] = currentParent.children[i];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tcurrentParent.graphicID,\n\t\t\t\t\tcurrentParent.children[i].graphicID,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tcurrentParent.graphicID,\n\t\t\t\t\tcurrentParent.children[i].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti + 1,\n\t\t\t\t);\n\n\t\t\t\tcurrentParent.keys[i] = currentParent.keys[i - 1];\n\t\t\t\tthis.cmd(act.setText, currentParent.graphicID, currentParent.keys[i], i);\n\t\t\t}\n\t\t\tcurrentParent.numKeys++;\n\t\t\tcurrentParent.keys[parentIndex] = risingNode;\n\t\t\tthis.cmd(act.setText, currentParent.graphicID, '', parentIndex);\n\t\t\tthis.moveLabel1ID = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.moveLabel1ID,\n\t\t\t\trisingNode,\n\t\t\t\tthis.getLabelX(tree, this.split_index),\n\t\t\t\ttree.y,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.moveLabel1ID, FOREGROUND_COLOR);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.moveLabel1ID,\n\t\t\t\tthis.getLabelX(currentParent, parentIndex),\n\t\t\t\tcurrentParent.y,\n\t\t\t);\n\n\t\t\tcurrentParent.children[parentIndex + 1] = rightNode;\n\t\t\trightNode.parent = currentParent;\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.createBTreeNode,\n\t\t\trightNode.graphicID,\n\t\t\tWIDTH_PER_ELEM,\n\t\t\tNODE_HEIGHT,\n\t\t\ttree.numKeys - this.split_index - 1,\n\t\t\ttree.x,\n\t\t\ttree.y,\n\t\t\tBACKGROUND_COLOR,\n\t\t\tFOREGROUND_COLOR,\n\t\t);\n\n\t\tfor (let i = this.split_index + 1; i < tree.numKeys + 1; i++) {\n\t\t\trightNode.children[i - this.split_index - 1] = tree.children[i];\n\t\t\tif (tree.children[i] != null) {\n\t\t\t\trightNode.isLeaf = false;\n\t\t\t\tthis.cmd(act.disconnect, tree.graphicID, tree.children[i].graphicID);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\trightNode.graphicID,\n\t\t\t\t\trightNode.children[i - this.split_index - 1].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti - this.split_index - 1,\n\t\t\t\t);\n\t\t\t\tif (tree.children[i] != null) {\n\t\t\t\t\ttree.children[i].parent = rightNode;\n\t\t\t\t}\n\t\t\t\ttree.children[i] = null;\n\t\t\t}\n\t\t}\n\t\tfor (let i = this.split_index + 1; i < tree.numKeys; i++) {\n\t\t\trightNode.keys[i - this.split_index - 1] = tree.keys[i];\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\trightNode.graphicID,\n\t\t\t\trightNode.keys[i - this.split_index - 1],\n\t\t\t\ti - this.split_index - 1,\n\t\t\t);\n\t\t}\n\t\tconst leftNode = tree;\n\t\tleftNode.numKeys = this.split_index;\n\t\tfor (let i = this.split_index; i < tree.numKeys; i++) {\n\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t}\n\t\tthis.cmd(act.setNumElements, tree.graphicID, this.split_index);\n\n\t\tif (tree.parent != null) {\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tcurrentParent.graphicID,\n\t\t\t\trightNode.graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\tparentIndex + 1,\n\t\t\t);\n\t\t\tthis.resizeTree();\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\tthis.cmd(act.setText, currentParent.graphicID, risingNode, parentIndex);\n\t\t\treturn tree.parent;\n\t\t} else {\n\t\t\tthis.treeRoot = new BTreeNode(this.nextIndex++, this.starting_x, STARTING_Y);\n\t\t\tthis.cmd(\n\t\t\t\tact.createBTreeNode,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\tWIDTH_PER_ELEM,\n\t\t\t\tNODE_HEIGHT,\n\t\t\t\t1,\n\t\t\t\tthis.starting_x,\n\t\t\t\tSTARTING_Y,\n\t\t\t\tBACKGROUND_COLOR,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t);\n\t\t\tthis.treeRoot.keys[0] = risingNode;\n\t\t\tthis.cmd(act.setText, this.treeRoot.graphicID, risingNode, 0);\n\t\t\tthis.treeRoot.children[0] = leftNode;\n\t\t\tthis.treeRoot.children[1] = rightNode;\n\t\t\tleftNode.parent = this.treeRoot;\n\t\t\trightNode.parent = this.treeRoot;\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\tleftNode.graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\t0,\n\t\t\t); // Connection Point\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\trightNode.graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\t1,\n\t\t\t); // Connection Point\n\t\t\tthis.treeRoot.isLeaf = false;\n\t\t\treturn this.treeRoot;\n\t\t}\n\t}\n\n\tdeleteElement(deletedValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Deleting ' + deletedValue);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.cmd(act.setText, 0, '');\n\t\tif (this.preemptiveSplit) {\n\t\t\tthis.doDeleteNotEmpty(this.treeRoot, deletedValue);\n\t\t} else {\n\t\t\tthis.doDelete(this.treeRoot, deletedValue);\n\t\t}\n\t\tif (this.treeRoot.numKeys === 0) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, this.treeRoot.graphicID);\n\t\t\tthis.treeRoot = this.treeRoot.children[0];\n\t\t\tthis.treeRoot.parent = null;\n\t\t\tthis.resizeTree();\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tdoDeleteNotEmpty(tree, val) {\n\t\tif (tree != null) {\n\t\t\tlet nextNode;\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\n\t\t\tif (i === tree.numKeys) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t1,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\n\t\t\t\t\tif (tree.children[tree.numKeys].numKeys === this.min_keys) {\n\t\t\t\t\t\tif (tree.children[tree.numKeys - 1].numKeys > this.min_keys) {\n\t\t\t\t\t\t\tnextNode = this.stealFromLeft(\n\t\t\t\t\t\t\t\ttree.children[tree.numKeys],\n\t\t\t\t\t\t\t\ttree.numKeys,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[tree.numKeys - 1]);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.doDeleteNotEmpty(tree.children[tree.numKeys], val);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else if (tree.keys[i] > val) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\n\t\t\t\t\tif (tree.children[i].numKeys > this.min_keys) {\n\t\t\t\t\t\tthis.doDeleteNotEmpty(tree.children[i], val);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tree.children[i + 1].numKeys > this.min_keys) {\n\t\t\t\t\t\t\tnextNode = this.stealFromRight(tree.children[i], i);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[i]);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, 'FF0000', i);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\tfor (let j = i; j < tree.numKeys - 1; j++) {\n\t\t\t\t\t\ttree.keys[j] = tree.keys[j + 1];\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[j], j);\n\t\t\t\t\t}\n\t\t\t\t\ttree.numKeys--;\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\tthis.cmd(act.setText, this.messageID, '');\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t'Checking to see if tree to left of element to delete \\nhas an extra key',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\t\t\t\t\tlet maxNode = tree.children[i];\n\n\t\t\t\t\tif (tree.children[i].numKeys === this.min_keys) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t'Tree to left of element to delete does not have an extra key.  \\nLooking to the right ...',\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\t\ttree.children[i + 1].graphicID,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\t\ttree.children[i + 1].graphicID,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t);\n\t\t\t\t\t\t// Trees to left and right of node to delete don't have enough keys\n\t\t\t\t\t\t// Do a merge, and then recursively delete the element\n\t\t\t\t\t\tif (tree.children[i + 1].numKeys === this.min_keys) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t\t'Neither subtree has extra nodes.  Mergeing around the key to delete, \\nand recursively deleting ...',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[i]);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t\t'Tree to right of element to delete does have an extra key. \\nFinding the smallest key in that subtree ...',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\tlet minNode = tree.children[i + 1];\n\t\t\t\t\t\t\twhile (!minNode.isLeaf) {\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 1);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 0);\n\t\t\t\t\t\t\t\tif (minNode.children[0].numKeys === this.min_keys) {\n\t\t\t\t\t\t\t\t\tif (minNode.children[1].numKeys === this.min_keys) {\n\t\t\t\t\t\t\t\t\t\tminNode = this.mergeRight(minNode.children[0]);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tminNode = this.stealFromRight(minNode.children[0], 0);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tminNode = minNode.children[0];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 1);\n\t\t\t\t\t\t\ttree.keys[i] = minNode.keys[0];\n\t\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\t\tthis.cmd(act.setText, minNode.graphicID, '', 0);\n\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\t\tminNode.keys[0],\n\t\t\t\t\t\t\t\tthis.getLabelX(minNode, 0),\n\t\t\t\t\t\t\t\tminNode.y,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t\t\t\t\t\tfor (i = 1; i < minNode.numKeys; i++) {\n\t\t\t\t\t\t\t\tminNode.keys[i - 1] = minNode.keys[i];\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tminNode.graphicID,\n\t\t\t\t\t\t\t\t\tminNode.keys[i - 1],\n\t\t\t\t\t\t\t\t\ti - 1,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.cmd(act.setText, minNode.graphicID, '', minNode.numKeys - 1);\n\n\t\t\t\t\t\t\tminNode.numKeys--;\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 0);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\t\t\t\tthis.cmd(act.setNumElements, minNode.graphicID, minNode.numKeys);\n\t\t\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\t\t\tthis.cmd(act.setText, this.messageID, '');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t'Tree to left of element to delete does have \\nan extra key. Finding the largest key in that subtree ...',\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\twhile (!maxNode.isLeaf) {\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\t\tif (maxNode.children[maxNode.numKeys].numKeys === this.min_keys) {\n\t\t\t\t\t\t\t\tif (maxNode.children[maxNode.numKeys - 1] > this.min_keys) {\n\t\t\t\t\t\t\t\t\tmaxNode = this.stealFromLeft(\n\t\t\t\t\t\t\t\t\t\tmaxNode.children[maxNode.numKeys],\n\t\t\t\t\t\t\t\t\t\tmaxNode.numKeys,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tmaxNode = this.mergeRight(maxNode.children[maxNode.numKeys - 1]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmaxNode = maxNode.children[maxNode.numKeys];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\ttree.keys[i] = maxNode.keys[maxNode.numKeys - 1];\n\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, '', maxNode.numKeys - 1);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\ttree.keys[i],\n\t\t\t\t\t\t\tthis.getLabelX(maxNode, maxNode.numKeys - 1),\n\t\t\t\t\t\t\tmaxNode.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t\t\t\t\tmaxNode.numKeys--;\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\t\t\tthis.cmd(act.setNumElements, maxNode.graphicID, maxNode.numKeys);\n\t\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\t\tthis.cmd(act.setText, this.messageID, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdoDelete(tree, val) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\n\t\t\tif (i === tree.numKeys) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t1,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t\tthis.doDelete(tree.children[tree.numKeys], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else if (tree.keys[i] > val) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\t\t\t\t\tthis.doDelete(tree.children[i], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, '#FF0000', i);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\tfor (let j = i; j < tree.numKeys - 1; j++) {\n\t\t\t\t\t\ttree.keys[j] = tree.keys[j + 1];\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[j], j);\n\t\t\t\t\t}\n\t\t\t\t\ttree.numKeys--;\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.repairAfterDelete(tree);\n\t\t\t\t} else {\n\t\t\t\t\tlet maxNode;\n\t\t\t\t\tif (this.predSucc === 'pred') {\n\t\t\t\t\t\tmaxNode = tree.children[i];\n\t\t\t\t\t\twhile (!maxNode.isLeaf) {\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\t\tmaxNode = maxNode.children[maxNode.numKeys];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\ttree.keys[i] = maxNode.keys[maxNode.numKeys - 1];\n\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, '', maxNode.numKeys - 1);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\ttree.keys[i],\n\t\t\t\t\t\t\tthis.getLabelX(maxNode, maxNode.numKeys - 1),\n\t\t\t\t\t\t\tmaxNode.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmaxNode = tree.children[i + 1];\n\t\t\t\t\t\twhile (!maxNode.isLeaf) {\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\t\tmaxNode = maxNode.children[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\ttree.keys[i] = maxNode.keys[0];\n\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, '', 0);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\ttree.keys[i],\n\t\t\t\t\t\t\tthis.getLabelX(maxNode, 0),\n\t\t\t\t\t\t\tmaxNode.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t\t\t\tmaxNode.numKeys--;\n\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\t\t/* When setNumElements is called with the new #, it cuts of the last element\n\t\t\t\t\t(like removeFromBack in an array). Removing the successor is more like \n\t\t\t\t\tremoveFromFront so you need to shift elements left by 1*/\n\t\t\t\t\tif (this.predSucc === 'succ') {\n\t\t\t\t\t\tfor (let j = 0; j < maxNode.numKeys; j++) {\n\t\t\t\t\t\t\tmaxNode.keys[j] = maxNode.keys[j + 1];\n\t\t\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, maxNode.keys[j], j);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.setNumElements, maxNode.graphicID, maxNode.numKeys);\n\t\t\t\t\tthis.repairAfterDelete(maxNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tmergeRight(tree) {\n\t\tthis.cmd(act.setText, this.messageID, 'Merging node');\n\n\t\tconst parentNode = tree.parent;\n\t\tlet parentIndex = 0;\n\t\tfor (parentIndex = 0; parentNode.children[parentIndex] !== tree; parentIndex++);\n\t\tconst rightSib = parentNode.children[parentIndex + 1];\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.setHighlight, parentNode.graphicID, 1);\n\t\tthis.cmd(act.setHighlight, rightSib.graphicID, 1);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys + rightSib.numKeys + 1);\n\t\ttree.x = (tree.x + rightSib.x) / 2;\n\t\tthis.cmd(act.setPosition, tree.graphicID, tree.x, tree.y);\n\n\t\ttree.keys[tree.numKeys] = parentNode.keys[parentIndex];\n\t\tconst fromParentIndex = tree.numKeys;\n\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.moveLabel1ID,\n\t\t\tparentNode.keys[parentIndex],\n\t\t\tthis.getLabelX(parentNode, parentIndex),\n\t\t\tparentNode.y,\n\t\t);\n\n\t\tfor (let i = 0; i < rightSib.numKeys; i++) {\n\t\t\ttree.keys[tree.numKeys + 1 + i] = rightSib.keys[i];\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\ttree.graphicID,\n\t\t\t\ttree.keys[tree.numKeys + 1 + i],\n\t\t\t\ttree.numKeys + 1 + i,\n\t\t\t);\n\t\t\tthis.cmd(act.setText, rightSib.graphicID, '', i);\n\t\t}\n\t\tif (!tree.isLeaf) {\n\t\t\tfor (let i = 0; i <= rightSib.numKeys; i++) {\n\t\t\t\tthis.cmd(act.disconnect, rightSib.graphicID, rightSib.children[i].graphicID);\n\t\t\t\ttree.children[tree.numKeys + 1 + i] = rightSib.children[i];\n\t\t\t\ttree.children[tree.numKeys + 1 + i].parent = tree;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\ttree.graphicID,\n\t\t\t\t\ttree.children[tree.numKeys + 1 + i].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ttree.numKeys + 1 + i,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.disconnect, parentNode.graphicID, rightSib.graphicID);\n\t\tfor (let i = parentIndex + 1; i < parentNode.numKeys; i++) {\n\t\t\tthis.cmd(act.disconnect, parentNode.graphicID, parentNode.children[i + 1].graphicID);\n\t\t\tparentNode.children[i] = parentNode.children[i + 1];\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tparentNode.graphicID,\n\t\t\t\tparentNode.children[i].graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\ti,\n\t\t\t);\n\t\t\tparentNode.keys[i - 1] = parentNode.keys[i];\n\t\t\tthis.cmd(act.setText, parentNode.graphicID, parentNode.keys[i - 1], i - 1);\n\t\t}\n\t\tthis.cmd(act.setText, parentNode.graphicID, '', parentNode.numKeys - 1);\n\t\tparentNode.numKeys--;\n\t\tthis.cmd(act.setNumElements, parentNode.graphicID, parentNode.numKeys);\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, parentNode.graphicID, 0);\n\n\t\tthis.cmd(act.delete, rightSib.graphicID);\n\t\ttree.numKeys = tree.numKeys + rightSib.numKeys + 1;\n\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, fromParentIndex), tree.y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[fromParentIndex], fromParentIndex);\n\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn tree;\n\t}\n\n\tstealFromRight(tree, parentIndex) {\n\t\t// Steal from right sibling\n\t\tconst parentNode = tree.parent;\n\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys + 1);\n\n\t\tthis.cmd(act.setText, this.messageID, 'Stealing from right sibling');\n\n\t\tconst rightSib = parentNode.children[parentIndex + 1];\n\t\ttree.numKeys++;\n\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\n\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys - 1);\n\t\tthis.cmd(act.setText, parentNode.graphicID, '', parentIndex);\n\t\tthis.cmd(act.setText, rightSib.graphicID, '', 0);\n\n\t\tconst tmpLabel1 = this.nextIndex++;\n\t\tconst tmpLabel2 = this.nextIndex++;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel1,\n\t\t\trightSib.keys[0],\n\t\t\tthis.getLabelX(rightSib, 0),\n\t\t\trightSib.y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel2,\n\t\t\tparentNode.keys[parentIndex],\n\t\t\tthis.getLabelX(parentNode, parentIndex),\n\t\t\tparentNode.y,\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel1, FOREGROUND_COLOR);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel2, FOREGROUND_COLOR);\n\n\t\tthis.cmd(act.move, tmpLabel1, this.getLabelX(parentNode, parentIndex), parentNode.y);\n\t\tthis.cmd(act.move, tmpLabel2, this.getLabelX(tree, tree.numKeys - 1), tree.y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, tmpLabel1);\n\t\tthis.cmd(act.delete, tmpLabel2);\n\t\ttree.keys[tree.numKeys - 1] = parentNode.keys[parentIndex];\n\t\tparentNode.keys[parentIndex] = rightSib.keys[0];\n\n\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[tree.numKeys - 1], tree.numKeys - 1);\n\t\tthis.cmd(act.setText, parentNode.graphicID, parentNode.keys[parentIndex], parentIndex);\n\t\tif (!tree.isLeaf) {\n\t\t\ttree.children[tree.numKeys] = rightSib.children[0];\n\t\t\ttree.children[tree.numKeys].parent = tree;\n\t\t\tthis.cmd(act.disconnect, rightSib.graphicID, rightSib.children[0].graphicID);\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\ttree.graphicID,\n\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\ttree.numKeys,\n\t\t\t);\n\n\t\t\tfor (let i = 1; i < rightSib.numKeys + 1; i++) {\n\t\t\t\tthis.cmd(act.disconnect, rightSib.graphicID, rightSib.children[i].graphicID);\n\t\t\t\trightSib.children[i - 1] = rightSib.children[i];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\trightSib.graphicID,\n\t\t\t\t\trightSib.children[i - 1].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti - 1,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tfor (let i = 1; i < rightSib.numKeys; i++) {\n\t\t\trightSib.keys[i - 1] = rightSib.keys[i];\n\t\t\tthis.cmd(act.setText, rightSib.graphicID, rightSib.keys[i - 1], i - 1);\n\t\t}\n\t\tthis.cmd(act.setText, rightSib.graphicID, '', rightSib.numKeys - 1);\n\t\trightSib.numKeys--;\n\t\tthis.cmd(act.setNumElements, rightSib.graphicID, rightSib.numKeys);\n\t\tthis.resizeTree();\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn tree;\n\t}\n\n\tstealFromLeft(tree, parentIndex) {\n\t\tconst parentNode = tree.parent;\n\t\t// Steal from left sibling\n\t\ttree.numKeys++;\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.messageID,\n\t\t\t'Node has too few keys.  Stealing from left sibling.',\n\t\t);\n\n\t\tfor (let i = tree.numKeys - 1; i > 0; i--) {\n\t\t\ttree.keys[i] = tree.keys[i - 1];\n\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t}\n\t\tconst leftSib = parentNode.children[parentIndex - 1];\n\n\t\tthis.cmd(act.setText, tree.graphicID, '', 0);\n\t\tthis.cmd(act.setText, parentNode.graphicID, '', parentIndex - 1);\n\t\tthis.cmd(act.setText, leftSib.graphicID, '', leftSib.numKeys - 1);\n\n\t\tconst tmpLabel1 = this.nextIndex++;\n\t\tconst tmpLabel2 = this.nextIndex++;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel1,\n\t\t\tleftSib.keys[leftSib.numKeys - 1],\n\t\t\tthis.getLabelX(leftSib, leftSib.numKeys - 1),\n\t\t\tleftSib.y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel2,\n\t\t\tparentNode.keys[parentIndex - 1],\n\t\t\tthis.getLabelX(parentNode, parentIndex - 1),\n\t\t\tparentNode.y,\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel1, FOREGROUND_COLOR);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel2, FOREGROUND_COLOR);\n\n\t\tthis.cmd(act.move, tmpLabel1, this.getLabelX(parentNode, parentIndex - 1), parentNode.y);\n\t\tthis.cmd(act.move, tmpLabel2, this.getLabelX(tree, 0), tree.y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, tmpLabel1);\n\t\tthis.cmd(act.delete, tmpLabel2);\n\n\t\tif (!tree.isLeaf) {\n\t\t\tfor (let i = tree.numKeys; i > 0; i--) {\n\t\t\t\tthis.cmd(act.disconnect, tree.graphicID, tree.children[i - 1].graphicID);\n\t\t\t\ttree.children[i] = tree.children[i - 1];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\ttree.graphicID,\n\t\t\t\t\ttree.children[i].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti,\n\t\t\t\t);\n\t\t\t}\n\t\t\ttree.children[0] = leftSib.children[leftSib.numKeys];\n\t\t\tthis.cmd(\n\t\t\t\tact.disconnect,\n\t\t\t\tleftSib.graphicID,\n\t\t\t\tleftSib.children[leftSib.numKeys].graphicID,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\ttree.graphicID,\n\t\t\t\ttree.children[0].graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\t0,\n\t\t\t);\n\t\t\tleftSib.children[leftSib.numKeys] = null;\n\t\t\ttree.children[0].parent = tree;\n\t\t}\n\n\t\ttree.keys[0] = parentNode.keys[parentIndex - 1];\n\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[0], 0);\n\t\tparentNode.keys[parentIndex - 1] = leftSib.keys[leftSib.numKeys - 1];\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tparentNode.graphicID,\n\t\t\tparentNode.keys[parentIndex - 1],\n\t\t\tparentIndex - 1,\n\t\t);\n\t\tthis.cmd(act.setText, leftSib.graphicID, '', leftSib.numKeys - 1);\n\n\t\tleftSib.numKeys--;\n\t\tthis.cmd(act.setNumElements, leftSib.graphicID, leftSib.numKeys);\n\t\tthis.resizeTree();\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn tree;\n\t}\n\n\trepairAfterDelete(tree) {\n\t\tif (tree.numKeys < this.min_keys) {\n\t\t\tif (tree.parent == null) {\n\t\t\t\tif (tree.numKeys === 0) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, tree.graphicID);\n\t\t\t\t\tthis.treeRoot = tree.children[0];\n\t\t\t\t\tif (this.treeRoot != null) this.treeRoot.parent = null;\n\t\t\t\t\tthis.resizeTree();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst parentNode = tree.parent;\n\t\t\t\tlet parentIndex;\n\t\t\t\tlet nextNode;\n\t\t\t\tfor (parentIndex = 0; parentNode.children[parentIndex] !== tree; parentIndex++);\n\t\t\t\tif (\n\t\t\t\t\tparentIndex > 0 &&\n\t\t\t\t\tparentNode.children[parentIndex - 1].numKeys > this.min_keys\n\t\t\t\t) {\n\t\t\t\t\tthis.stealFromLeft(tree, parentIndex);\n\t\t\t\t} else if (\n\t\t\t\t\tparentIndex < parentNode.numKeys &&\n\t\t\t\t\tparentNode.children[parentIndex + 1].numKeys > this.min_keys\n\t\t\t\t) {\n\t\t\t\t\tthis.stealFromRight(tree, parentIndex);\n\t\t\t\t} else if (parentIndex === 0) {\n\t\t\t\t\t// Merge with right sibling\n\t\t\t\t\tnextNode = this.mergeRight(tree);\n\t\t\t\t\tthis.repairAfterDelete(nextNode.parent);\n\t\t\t\t} else {\n\t\t\t\t\t// Merge with left sibling\n\t\t\t\t\tnextNode = this.mergeRight(parentNode.children[parentIndex - 1]);\n\t\t\t\t\tthis.repairAfterDelete(nextNode.parent);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLabelX(tree, index) {\n\t\treturn (\n\t\t\ttree.x -\n\t\t\t(WIDTH_PER_ELEM * tree.numKeys) / 2 +\n\t\t\tWIDTH_PER_ELEM / 2 +\n\t\t\tindex * WIDTH_PER_ELEM\n\t\t);\n\t}\n\n\tresizeTree() {\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tthis.setNewPositions(this.treeRoot, this.starting_x, STARTING_Y);\n\t\tthis.animateNewPositions(this.treeRoot);\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\ttree.x = xPosition;\n\t\t\tif (!tree.isLeaf) {\n\t\t\t\tconst leftEdge = xPosition - tree.width / 2;\n\t\t\t\tlet priorWidth = 0;\n\t\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\n\t\t\t\t\tthis.setNewPositions(\n\t\t\t\t\t\ttree.children[i],\n\t\t\t\t\t\tleftEdge + priorWidth + tree.widths[i] / 2,\n\t\t\t\t\t\tyPosition + HEIGHT_DELTA,\n\t\t\t\t\t);\n\t\t\t\t\tpriorWidth += tree.widths[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet i;\n\t\tfor (i = 0; i < tree.numKeys + 1; i++) {\n\t\t\tthis.animateNewPositions(tree.children[i]);\n\t\t}\n\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (tree.isLeaf) {\n\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\n\t\t\t\ttree.widths[i] = 0;\n\t\t\t}\n\t\t\ttree.width = tree.numKeys * WIDTH_PER_ELEM + NODE_SPACING;\n\t\t\treturn tree.width;\n\t\t} else {\n\t\t\tlet treeWidth = 0;\n\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\n\t\t\t\ttree.widths[i] = this.resizeWidths(tree.children[i]);\n\t\t\t\ttreeWidth = treeWidth + tree.widths[i];\n\t\t\t}\n\t\t\ttreeWidth = Math.max(treeWidth, tree.numKeys * WIDTH_PER_ELEM + NODE_SPACING);\n\t\t\ttree.width = treeWidth;\n\t\t\treturn treeWidth;\n\t\t}\n\t}\n}\n\nfunction BTreeNode(id, initialX, initialY) {\n\tthis.widths = [];\n\tthis.keys = [];\n\tthis.children = [];\n\tthis.x = initialX;\n\tthis.y = initialY;\n\tthis.graphicID = id;\n\tthis.numKeys = 1;\n\tthis.isLeaf = true;\n\tthis.parent = null;\n\n\tthis.leftWidth = 0;\n\tthis.rightWidth = 0;\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 130;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst WARN_START_X = 200;\nconst WARN_START_Y = 200;\n\nexport default class BogoSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). No more than 5 elements, unless you have time to spare...',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.warningID = this.nextIndex++;\n\t\tthis.iterations = 0;\n\n\t\tthis.colors = [\n\t\t\t'#f0928e',\n\t\t\t'#f8b896',\n\t\t\t'#a9fd99',\n\t\t\t'#a8fdff',\n\t\t\t'#94b3f9',\n\t\t\t'#ca8ff9',\n\t\t\t'#f092f9',\n\t\t\t'#ed74f0',\n\t\t\t'#ec74b3',\n\t\t\t'#ed7370'\n\t\t]\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Iterations: ' + this.iterations,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.warningID, '', WARN_START_X, WARN_START_Y);\n\n\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.warningID = this.nextIndex++;\n\t\tthis.iterations = 0;\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iterations = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Iterations: ' + this.iterations);\n\t\tthis.cmd(act.setText, this.warningID, '');\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], this.colors[i % this.colors.length]);\n    }\n\n\t\tthis.cmd(act.step);\n\n\t\tif (this.arrayData.length >= 10) {\n\t\t\tfor (let i= 0; i < this.arrayData.length / 2; i++) {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\twhile (this.arrayID.length > 0) {\n\t\t\t\tconst cell = this.arrayID.splice(Math.floor(Math.random()*(this.arrayID.length - 1)), 1);\n\t\t\t\tthis.cmd(act.delete, cell);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.arrayID = [];\n\t\t\tthis.arrayData = [];\n\t\t\tthis.displayData = [];\n\t\t\tthis.iterations = 0;\n\t\t\tthis.cmd(act.setText, this.comparisonCountID, 'Iterations: ' + this.iterations);\n\t\t\tthis.cmd(act.setText, this.warningID, 'Yeah so that array was too long...try something smaller');\n\t\t\treturn this.commands;\n\t\t}\n\n    let sorted = false;\n\t\twhile (!sorted) {\n      this.cmd(act.setText, this.comparisonCountID, \"Iterations: \" + this.iterations++);\n      sorted = true;\n\n      for (let i = 0; i < length - 1; i++) {\n        if (this.arrayData[i] > this.arrayData[i + 1]) {\n          sorted = false;\n          break;\n        }\n      }\n      if (!sorted) {\n        this.shuffle();\n      } else {\n        for (let i = 0; i < length; i++) {\n          this.cmd(act.setBackgroundColor, this.arrayID[i], this.colors[i % this.colors.length]);\n        }\n      }\n      this.cmd(act.step);\n    }\n\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n  shuffle() {\n    for (let i = 0; i < this.arrayData.length; i++) {\n      this.swap(i, Math.floor(Math.random() * (this.arrayData.length - 1)));\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], this.colors[Math.abs((this.iterations - i)) % this.colors.length]);\n    }\n  }\n\n\tswap(i, j) {\n\n\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\n\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\nconst PATTERN_START_Y = 100;\n\nconst FAILURE_TABLE_START_Y = 300;\nconst LAST_TABLE_START_Y = 200;\n\nconst COMP_COUNT_X = 575;\nconst COMP_COUNT_Y = 30;\n\nconst PERIOD_Y = 60;\n\nlet galilRuleEnabled = false;\n\nexport default class BoyerMoore extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Build Last Occurrence Table button\n\t\tthis.blotButton = addControlToAlgorithmBar('Button', 'Build Last Occurrence Table');\n\t\tthis.blotButton.onclick = this.buildLastOccurrenceTableCallback.bind(this);\n\t\tthis.controls.push(this.blotButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Galil Rule button\n\t\tthis.galilButton = addCheckboxToAlgorithmBar('Galil Rule Optimization', false);\n\t\tthis.galilButton.onclick = this.toggleGalilRule.bind(this);\n\t\tthis.controls.push(this.galilButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.patternTableLabelID = this.nextIndex++;\n\t\tthis.patternTableCharacterID = [];\n\t\tthis.patternTableIndexID = [];\n\t\tthis.lastTableLabelID = this.nextIndex++;\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\t// this.failureTableLabelID = this.nextIndex++;\n\t\t// this.failureTableCharacterID = [];\n\t\t// this.failureTableValueID = [];\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.periodLabelID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.createLabel, this.comparisonCountID, '', COMP_COUNT_X, COMP_COUNT_Y, 0);\n\n\t\tthis.period = 1;\n\t\tthis.cmd(act.createLabel, this.periodLabelID, '', COMP_COUNT_X, PERIOD_Y, 0);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.patternTableLabelID = this.nextIndex++;\n\t\tthis.patternTableCharacterID = [];\n\t\tthis.patternTableIndexID = [];\n\t\tthis.lastTableLabelID = this.nextIndex++;\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\t// this.failureTableLabelID = this.nextIndex++;\n\t\t// this.failureTableCharacterID = [];\n\t\t// this.failureTableValueID = [];\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.periodLabelID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.period = 1;\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tbuildLastOccurrenceTableCallback() {\n\t\tif (this.patternField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.onlyBuildLastOccurrenceTable.bind(this), 0, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\ttoggleGalilRule() {\n\t\tgalilRuleEnabled = !galilRuleEnabled;\n\t\t//this.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\tconst maxRows = this.getMaxRows(text, pattern);\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tconst xpos = i * this.cellSize + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tlet xpos;\n\t\tlet ypos;\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst lastTable = this.buildLastTable(text.length, pattern);\n\t\tif (galilRuleEnabled) {\n\t\t\tthis.buildFailureTable(text.length, pattern);\n\t\t}\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + (pattern.length - 1) * this.cellSize,\n\t\t\tARRAY_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + (pattern.length - 1) * this.cellSize,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\n\t\tlet i = 0;\n\t\tlet j = pattern.length - 1;\n\t\tlet row = 0;\n\t\tlet l = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t\tif (k - i < l) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][k], '#FFFF4D');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (j >= l && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\tj--;\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (j >= 0) {\n\t\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (j < l) {\n\t\t\t\tif (galilRuleEnabled) {\n\t\t\t\t\ti += this.period;\n\t\t\t\t\tl = pattern.length - this.period;\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tif (l !== 0) {\n\t\t\t\t\tl = 0;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#E74C3C');\n\t\t\t\tlet shift;\n\t\t\t\tif (text.charAt(i + j) in lastTable) {\n\t\t\t\t\tshift = lastTable[text.charAt(i + j)];\n\t\t\t\t} else {\n\t\t\t\t\tshift = -1;\n\t\t\t\t}\n\t\t\t\tif (shift < j) {\n\t\t\t\t\ti += j - shift;\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tj = pattern.length - 1;\n\t\t\trow++;\n\t\t\tif (i <= text.length - pattern.length) {\n\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\treturn this.commands;\n\t}\n\n\tgetMaxRows(text, pattern) {\n\t\tconst lastTable = {};\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tlastTable[pattern.charAt(i)] = i;\n\t\t}\n\t\tlet i = 0;\n\t\tlet j = pattern.length - 1;\n\t\tlet maxRows = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\twhile (j >= 0 && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tj--;\n\t\t\t}\n\t\t\tif (j === -1) {\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tlet shift;\n\t\t\t\tif (text.charAt(i + j) in lastTable) {\n\t\t\t\t\tshift = lastTable[text.charAt(i + j)];\n\t\t\t\t} else {\n\t\t\t\t\tshift = -1;\n\t\t\t\t}\n\t\t\t\tif (shift < j) {\n\t\t\t\t\ti += j - shift;\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tj = pattern.length - 1;\n\t\t\tmaxRows++;\n\t\t}\n\t\treturn maxRows;\n\t}\n\n\tonlyBuildLastOccurrenceTable(textLength, pattern) {\n\t\tthis.commands = [];\n\t\tthis.cellSize = 30;\n\t\tthis.buildLastTable(textLength, pattern);\n\t\treturn this.commands;\n\t}\n\n\tbuildLastTable(textLength, pattern) {\n\t\t// Display labels\n\t\tconst labelsX = ARRAY_START_X + textLength * this.cellSize + 10;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.patternTableLabelID,\n\t\t\t'Pattern:',\n\t\t\tlabelsX,\n\t\t\tPATTERN_START_Y - 5,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.lastTableLabelID,\n\t\t\t'Last occurence table:',\n\t\t\tlabelsX,\n\t\t\tLAST_TABLE_START_Y + 10,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.move, this.comparisonCountID, labelsX, COMP_COUNT_Y);\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\n\t\t// Display pattern table\n\t\tconst patternTableStartX = ARRAY_START_X + textLength * this.cellSize + 80;\n\t\tthis.patternTableCharacterID = new Array(pattern.length);\n\t\tthis.patternTableIndexID = new Array(pattern.length);\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tconst xpos = patternTableStartX + i * this.cellSize;\n\t\t\tthis.patternTableCharacterID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tpattern.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tPATTERN_START_Y,\n\t\t\t);\n\t\t\tthis.patternTableIndexID[i] = this.nextIndex;\n\t\t\tthis.cmd(act.createLabel, this.nextIndex++, i, xpos, PATTERN_START_Y + this.cellSize);\n\t\t}\n\n\t\t// Create and display last occurrence table\n\t\tconst lastTable = {};\n\t\tconst lotStartX = ARRAY_START_X + textLength * this.cellSize + 155;\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\tlet j = 0;\n\n\t\tconst lotPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tlotPointerID,\n\t\t\t'#0000FF',\n\t\t\tpatternTableStartX,\n\t\t\tPATTERN_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.setHighlight, lotPointerID, 1);\n\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tlet xpos = patternTableStartX + i * this.cellSize;\n\t\t\tthis.cmd(act.move, lotPointerID, xpos, PATTERN_START_Y);\n\t\t\tif (lastTable[pattern.charAt(i)]) {\n\t\t\t\tthis.cmd(act.setText, lastTable[pattern.charAt(i)][1], i);\n\t\t\t\tthis.cmd(act.setHighlight, lastTable[pattern.charAt(i)][1], 1);\n\t\t\t\tlastTable[pattern.charAt(i)][0] = i;\n\t\t\t} else {\n\t\t\t\txpos = lotStartX + j * this.cellSize;\n\t\t\t\tthis.lastTableCharacterID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\tpattern.charAt(i),\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\tLAST_TABLE_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t\t\tthis.lastTableValueID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\ti,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\tLAST_TABLE_START_Y + this.cellSize,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setHighlight, this.nextIndex, 1);\n\t\t\t\tj++;\n\t\t\t\tlastTable[pattern.charAt(i)] = [i, this.nextIndex++];\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, lastTable[pattern.charAt(i)][1], 0);\n\t\t}\n\n\t\t// Display '*' entry\n\t\tthis.cmd(act.delete, lotPointerID);\n\t\tconst xpos = lotStartX + j * this.cellSize;\n\t\tthis.lastTableCharacterID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.nextIndex,\n\t\t\t'*',\n\t\t\tthis.cellSize,\n\t\t\tthis.cellSize,\n\t\t\txpos,\n\t\t\tLAST_TABLE_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\tthis.lastTableValueID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.nextIndex++,\n\t\t\t'-1',\n\t\t\tthis.cellSize,\n\t\t\tthis.cellSize,\n\t\t\txpos,\n\t\t\tLAST_TABLE_START_Y + this.cellSize,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tObject.keys(lastTable).map(char => (lastTable[char] = lastTable[char][0])); // Return only indices\n\t\treturn lastTable;\n\t}\n\n\tbuildFailureTable(textLength, pattern) {\n\t\tconst startIndex = this.nextIndex;\n\t\tthis.failureTableLabelID = this.nextIndex++;\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\t// Display label\n\t\tconst labelX = ARRAY_START_X + textLength * this.cellSize + 10;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.failureTableLabelID,\n\t\t\t'Failure table:',\n\t\t\tlabelX,\n\t\t\tFAILURE_TABLE_START_Y + 10,\n\t\t\t0,\n\t\t);\n\n\t\tthis.cmd(act.move, this.periodLabelID, labelX, PERIOD_Y);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.periodLabelID,\n\t\t\t'Period = pattern.length - FT[pattern.length - 1]',\n\t\t);\n\n\t\t// Display empty failure table\n\t\tconst tableStartX = ARRAY_START_X + textLength * this.cellSize + 110;\n\t\tthis.failureTableCharacterID = new Array(pattern.length);\n\t\tthis.failureTableValueID = new Array(pattern.length);\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tconst xpos = tableStartX + i * this.cellSize;\n\t\t\tthis.failureTableCharacterID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableCharacterID[i],\n\t\t\t\tpattern.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.failureTableCharacterID[i], '#D3D3D3');\n\t\t\tthis.failureTableValueID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableValueID[i],\n\t\t\t\t'',\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Display pointers and set first value to 0\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\ttableStartX,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#FF0000',\n\t\t\ttableStartX + this.cellSize,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.setText, this.failureTableValueID[0], 0);\n\t\tthis.cmd(act.step);\n\n\t\tconst failureTable = [];\n\t\tfailureTable[0] = 0;\n\t\tlet i = 0;\n\t\tlet j = 1;\n\t\twhile (j < pattern.length) {\n\t\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + ++this.compCount);\n\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\n\t\t\t\ti++;\n\t\t\t\tfailureTable[j] = i;\n\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\tj++;\n\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t} else {\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\t\tj++;\n\t\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\ti = failureTable[i - 1];\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.periodLabelID,\n\t\t\t'Period = ' + pattern.length + ' - ' + failureTable[pattern.length - 1],\n\t\t);\n\t\tconst ftPeriodLabel = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tftPeriodLabel,\n\t\t\t'#FF0000',\n\t\t\ttableStartX + this.cellSize * (pattern.length - 1),\n\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tthis.period = pattern.length - failureTable[pattern.length - 1];\n\t\tthis.cmd(act.setText, this.periodLabelID, 'Period = ' + this.period);\n\t\tthis.cmd(act.delete, ftPeriodLabel);\n\n\t\tif (this.failureTableValueID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.failureTableLabelID);\n\t\t}\n\n\t\tfor (let i = 0; i < this.failureTableCharacterID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.failureTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.failureTableValueID[i]);\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\n\t\tthis.nextIndex = startIndex;\n\n\t\treturn failureTable;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tconsole.log('Text row ' + this.textRowID[i]);\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tconsole.log('Comp matrix: ' + this.comparisonMatrixID[i][j]);\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\n\t\tthis.comparisonMatrixID = [];\n\t\tif (this.patternTableCharacterID.length !== 0) {\n\t\t\tconsole.log('pat table label: ' + this.patternTableLabelID);\n\t\t\tthis.cmd(act.delete, this.patternTableLabelID);\n\t\t}\n\n\t\tfor (let i = 0; i < this.patternTableCharacterID.length; i++) {\n\t\t\tconsole.log('pat table char: ' + this.patternTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.patternTableCharacterID[i]);\n\t\t\tconsole.log('pat table idx: ' + this.patternTableIndexID[i]);\n\t\t\tthis.cmd(act.delete, this.patternTableIndexID[i]);\n\t\t}\n\n\t\tthis.patternTableCharacterID = [];\n\t\tthis.patternTableIndexID = [];\n\t\tif (this.lastTableCharacterID.length !== 0) {\n\t\t\tconsole.log('table label: ' + this.lastTableLabelID);\n\t\t\tthis.cmd(act.delete, this.lastTableLabelID);\n\t\t}\n\n\t\tfor (let i = 0; i < this.lastTableCharacterID.length; i++) {\n\t\t\tconsole.log(this.lastTableCharacterID.length);\n\t\t\tconsole.log('table char: ' + this.lastTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.lastTableCharacterID[i]);\n\t\t\tconsole.log('table val: ' + this.lastTableValueID[i]);\n\t\t\tthis.cmd(act.delete, this.lastTableValueID[i]);\n\t\t}\n\t\tconsole.log();\n\n\t\t// if (this.failureTableValueID.length !== 0) {\n\t\t// \tthis.cmd(act.delete, this.failureTableLabelID);\n\t\t// }\n\n\t\t// for (let i = 0; i < this.failureTableCharacterID.length; i++) {\n\t\t// \tthis.cmd(act.delete, this.failureTableCharacterID[i]);\n\t\t// \tthis.cmd(act.delete, this.failureTableValueID[i]);\n\t\t// }\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, '');\n\t\tthis.cmd(act.setText, this.periodLabelID, '');\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\tthis.period = 1;\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\nconst COMP_COUNT_X = 575;\nconst COMP_COUNT_Y = 30;\n\nexport default class BruteForce extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.createLabel, this.comparisonCountID, '', COMP_COUNT_X, COMP_COUNT_Y, 0);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\tconst maxRows = text.length - pattern.length + 1;\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tconst labelsX = ARRAY_START_X + text.length * this.cellSize + 10;\n\t\tthis.cmd(act.move, this.comparisonCountID, labelsX, COMP_COUNT_Y);\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tlet xpos, ypos;\n\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\typos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\n\t\tlet i = 0;\n\t\tlet j = 0;\n\t\tlet row = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\tj++;\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (j < pattern.length) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (j !== pattern.length) {\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#E74C3C');\n\t\t\t}\n\t\t\ti++;\n\t\t\tj = 0;\n\t\t\trow++;\n\t\t\tif (i <= text.length - pattern.length) {\n\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, '');\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 130;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 200;\n\nlet lastSwapEnabled = true;\n\nexport default class BubbleSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Last swap optimization toggle\n\t\tthis.lastSwapCheckbox = addCheckboxToAlgorithmBar('Enable last swap optimization', true);\n\t\tthis.lastSwapCheckbox.onclick = this.toggleLastSwap.bind(this);\n\t\tthis.controls.push(this.lastSwapCheckbox);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure BubbleSort(array):'],\n\t\t\t['     end <- length of array'],\n\t\t\t['     start <- 0'],\n\t\t\t['     swapped <- start'],\n\t\t\t['     while start < end'],\n\t\t\t['          swapped <- start'],\n\t\t\t['          for j <- 0, end do'],\n\t\t\t['               if arr[j] > arr[j + 1]'],\n\t\t\t['                    swap arr[j], arr[j + 1]'],\n\t\t\t['                    swapped <- j'],\n\t\t\t['               end if'],\n\t\t\t['          end for'],\n\t\t\t['          end <- swapped'],\n\t\t\t['     end while'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t\tif (!lastSwapEnabled) {\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '     while start < end and sorted is false');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '          sorted <- true');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[12][0], '          end <- end - 1');\n\t\t}\n\t\tthis.compCount = 0;\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tconsole.log(list);\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\ttoggleLastSwap() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t\tif (lastSwapEnabled) {\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '     while start < end and sorted is false');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '          sorted <- true');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[12][0], '          end <- end - 1');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     swapped <- start');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '     while start < end');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '          swapped <- start');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '                    swapped <- j');\n\t\t\tthis.cmd(act.setText, this.codeID[12][0], '          end <- swapped');\n\t\t}\n\t\tlastSwapEnabled = !lastSwapEnabled;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.compCount = 0;\n\t\tthis.displayData = [];\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\t\tthis.highlight(0, 0);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\n\t\tlet sorted = true;\n\t\tlet end = this.arrayData.length - 1;\n\t\tlet lastSwapped = 0;\n\t\tthis.highlight(4, 0);\n\t\tthis.cmd(act.step);\n\t\tdo {\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tsorted = true;\n\t\t\tthis.highlight(6, 0);\n\t\t\tfor (let i = 0; i < end; i++) {\n\t\t\t\tthis.movePointers(i, i + 1);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tif (this.arrayData[i] > this.arrayData[i + 1]) {\n\t\t\t\t\tthis.swap(i, i + 1);\n\t\t\t\t\tsorted = false;\n\t\t\t\t\tlastSwapped = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tthis.highlight(12, 0);\n\t\t\tif (lastSwapEnabled) {\n\t\t\t\tend = lastSwapped;\n\t\t\t} else {\n\t\t\t\tend--;\n\t\t\t}\n\t\t\tif (!sorted) {\n\t\t\t\tfor (let i = end + 1; i < this.arrayData.length; i++) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(12, 0);\n\t\t} while (!sorted);\n\t\tthis.highlight(4, 0);\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(4, 0);\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, ARRAY_START_Y);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.highlight(8, 0);\n\t\tthis.highlight(9, 0);\n\t\t// Change pointer colors to red\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\t// Create temporary labels and remove text in array\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\t// Move labels\n\t\tthis.cmd(act.move, iLabelID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, jLabelID, iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array and delete temporary labels\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\t// Reset pointer colors back to blue\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.unhighlight(8, 0);\n\t\tthis.unhighlight(9, 0);\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 9;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 9;\n\nexport default class CircularlyLinkedList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Front',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Back',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add at Index',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Index',\n\t\t\tremoveTopHorizontalGroup,\n\t\t);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Front',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Back',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddIndexCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\tthis.addIndexField.value !== '' &&\n\t\t\tthis.size < SIZE\n\t\t) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// CircularlySinglyLinkedList.prototype.getCallback = function()\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\t// Order of data should behave as normal\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\n\t\t// Adding to the front or back using O(1) trick, so new node will be added to index 1\n\t\tif (this.size !== 0 && (index === 0 || index === this.size)) {\n\t\t\t// Move over all node IDs but the first\n\t\t\tfor (let i = this.size - 1; i >= 1; i--) {\n\t\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t\t}\n\t\t\t// Place new node's ID at index 1\n\t\t\tthis.linkedListElemID[1] = this.nextIndex++;\n\t\t}\n\t\t// Adding first node or to the middle, so new node will be placed normally\n\t\telse {\n\t\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t\t}\n\t\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tif (this.size !== 0 && (index === 0 || index === this.size)) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircularlyLinkedListNode,\n\t\t\t\tthis.linkedListElemID[1],\n\t\t\t\t'',\n\t\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\t\tLINKED_LIST_INSERT_X,\n\t\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircularlyLinkedListNode,\n\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t'',\n\t\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\t\tLINKED_LIST_INSERT_X,\n\t\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size === 0) {\n\t\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.cmd(act.setText, this.linkedListElemID[0], elemToAdd);\n\t\t\tthis.cmd(act.delete, labPushValID);\n\t\t\tthis.cmd(act.connectCurve, this.linkedListElemID[0], this.linkedListElemID[0], -0.5);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.size = this.size + 1;\n\t\t\tthis.resetNodePositions();\n\t\t} else {\n\t\t\tif (index === 0 || index === this.size) {\n\t\t\t\t// Move label from first node to new node\n\t\t\t\tconst labCopiedValID = this.nextIndex++;\n\t\t\t\tconst copiedData = index === 0 ? this.arrayData[1] : this.arrayData[0];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tlabCopiedValID,\n\t\t\t\t\tcopiedData,\n\t\t\t\t\tLINKED_LIST_START_X,\n\t\t\t\t\tLINKED_LIST_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, labCopiedValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[1], copiedData);\n\t\t\t\tthis.cmd(act.delete, labCopiedValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t// Move label for new data to the first node\n\t\t\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_START_X, LINKED_LIST_START_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[0], elemToAdd);\n\t\t\t\tthis.cmd(act.delete, labPushValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t// Change pointers\n\t\t\t\tif (this.size === 1) {\n\t\t\t\t\t// Case where we're adding the second node\n\t\t\t\t\tthis.cmd(act.disconnect, this.linkedListElemID[0], this.linkedListElemID[0]); // Disconnect head node from itself\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[0], this.linkedListElemID[1]); // Connect head node to new node\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t); // Connect new node to head node\n\t\t\t\t} else {\n\t\t\t\t\t// Other cases\n\t\t\t\t\tthis.cmd(act.disconnect, this.linkedListElemID[0], this.linkedListElemID[2]); // Disconnect head from old second node\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[0], this.linkedListElemID[1]); // Connect head node to new node\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[1], this.linkedListElemID[2]); // Connect new node to old second node\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.size = this.size + 1;\n\t\t\t\tthis.resetNodePositions();\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t// If adding to the back, \"move head over\" (rotate elements backwards)\n\t\t\t\tif (index === this.size - 1) {\n\t\t\t\t\t// We increment size above, so subtract one to check if adding to back\n\t\t\t\t\tlet i;\n\t\t\t\t\tconst firstNodeID = this.linkedListElemID[0];\n\t\t\t\t\tfor (i = 0; i < this.size - 1; i++) {\n\t\t\t\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t\t\t\t}\n\t\t\t\t\tthis.linkedListElemID[this.size - 1] = firstNodeID;\n\n\t\t\t\t\tconst lastX =\n\t\t\t\t\t\t((this.size - 1) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\t\tconst lastY =\n\t\t\t\t\t\tMath.floor((this.size - 1) / LINKED_LIST_ELEMS_PER_LINE) *\n\t\t\t\t\t\t\tLINKED_LIST_LINE_SPACING +\n\t\t\t\t\t\tLINKED_LIST_START_Y;\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tthis.linkedListElemID[i],\n\t\t\t\t\t\t(LINKED_LIST_START_X + lastX) / 2,\n\t\t\t\t\t\tlastY + LINKED_LIST_ELEM_HEIGHT * 3,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tfor (let i = 0; i < this.size - 1; i++) {\n\t\t\t\t\t\tconst nextX =\n\t\t\t\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\t\t\tconst nextY =\n\t\t\t\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\t\t\t\tLINKED_LIST_START_Y;\n\t\t\t\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.disconnect,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 2],\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t); // Disconnect curved pointer\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 2],\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t); // Connect with normal pointer\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.disconnect,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t); // Disconnect normal pointer\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t); // Connect with curved pointer\n\t\t\t\t\tthis.cmd(act.move, this.linkedListElemID[i], lastX, lastY);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\t\t\tthis.cmd(act.delete, labPushValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\n\t\t\t\tthis.size = this.size + 1;\n\t\t\t\tthis.resetNodePositions();\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\t// O(1) remove from front trick\n\t\t\t\tconst labCopiedValID = this.nextIndex++;\n\t\t\t\tconst secondNodeX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING;\n\t\t\t\tconst secondNodeY = LINKED_LIST_START_Y;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tlabCopiedValID,\n\t\t\t\t\tthis.arrayData[1],\n\t\t\t\t\tsecondNodeX,\n\t\t\t\t\tsecondNodeY,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, labCopiedValID, LINKED_LIST_START_X, LINKED_LIST_START_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[0], this.arrayData[1]);\n\t\t\t\tthis.cmd(act.delete, labCopiedValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.linkedListElemID[1],\n\t\t\t\t\tsecondNodeX,\n\t\t\t\t\tsecondNodeY - LINKED_LIST_ELEM_HEIGHT * 2,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.disconnect, this.linkedListElemID[0], this.linkedListElemID[1]);\n\t\t\t\tif (this.size === 2) {\n\t\t\t\t\t// Only one node will remain, connect it to itself\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// Normal remove\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[0], this.linkedListElemID[2]);\n\t\t\t\t}\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tif (this.size === 2) {\n\t\t\t\t\t// Only one node will remain, connect it to itself\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// Normal remove\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tconst removedNodeIndex = index === 0 ? 1 : index; // If deleting from front, we need to remove the second node\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[removedNodeIndex]);\n\t\t\tfor (let i = removedNodeIndex; i < this.size; i++) {\n\t\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[0]);\n\t\t}\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_HASH_LENGTH = 10;\nconst MAX_LOAD_LENGTH = 5;\n\nconst HASH_NUMBER_START_X = 200;\nconst HASH_X_DIFF = 7;\nconst HASH_NUMBER_START_Y = 10;\nconst HASH_ADD_START_Y = 30;\nconst HASH_INPUT_START_X = 60;\nconst HASH_INPUT_X_DIFF = 7;\nconst HASH_INPUT_START_Y = 55;\nconst HASH_ADD_LINE_Y = 42;\nconst HASH_RESULT_Y = 50;\nconst ELF_HASH_SHIFT = 10;\n\nconst HASH_LABEL_X = 200;\nconst HASH_LABEL_Y = 45;\nconst HASH_LABEL_DELTA_X = 50;\n\nconst HIGHLIGHT_COLOR = '#0000FF';\n\nexport default class Hash extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.hashingIntegers = true;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Key: ');\n\t\tthis.keyField = addControlToAlgorithmBar('Text', '');\n\t\tthis.keyField.size = MAX_HASH_LENGTH;\n\t\tthis.keyField.onkeydown = this.returnSubmit(\n\t\t\tthis.keyField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.keyField);\n\n\t\t//I'm allowing any type of data be inserted for the value, should it be restricted?\n\t\taddLabelToAlgorithmBar('Value: ');\n\t\tthis.valueField = addControlToAlgorithmBar('Text', '');\n\t\tthis.valueField.size = MAX_HASH_LENGTH;\n\t\tthis.valueField.onkeydown = this.returnSubmit(\n\t\t\tthis.valueField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.valueField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.size = MAX_HASH_LENGTH;\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.keyField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.size = MAX_HASH_LENGTH;\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.keyField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.loadField = addControlToAlgorithmBar('Text', '');\n\t\tthis.loadField.setAttribute('placeholder', 'LF/100');\n\t\tthis.loadField.size = MAX_LOAD_LENGTH;\n\t\tthis.loadField.onkeydown = this.returnSubmit(\n\t\t\tthis.loadField,\n\t\t\tthis.changeLoadFactor.bind(this),\n\t\t\tMAX_LOAD_LENGTH,\n\t\t\ttrue,\n\t\t);\n\n\t\tthis.controls.push(this.loadField);\n\n\t\tthis.loadButton = addControlToAlgorithmBar('Button', 'Load Factor');\n\t\tthis.loadButton.onclick = this.loadFactorCallBack.bind(this);\n\t\tthis.controls.push(this.loadButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Hash Integer', 'Hash Strings'],\n\t\t\t'HashType',\n\t\t);\n\t\tthis.hashIntegerButton = radioButtonList[0];\n\t\tthis.hashIntegerButton.onclick = this.changeHashTypeCallback.bind(this, true);\n\t\tthis.controls.push(this.hashIntegerButton);\n\t\tthis.hashStringButton = radioButtonList[1];\n\t\tthis.hashStringButton.onclick = this.changeHashTypeCallback.bind(this, false);\n\t\tthis.hashIntegerButton.checked = true;\n\t\tthis.controls.push(this.hashStringButton);\n\t}\n\n\t// Do this extra level of wrapping to get undo to work properly.\n\t// (also, so that we only implement the action if we are changing the\n\t// radio button)\n\tchangeHashTypeCallback(newHashingIntegers) {\n\t\tif (this.hashingIntegers !== newHashingIntegers) {\n\t\t\tthis.implementAction(this.changeHashType.bind(this), newHashingIntegers);\n\t\t}\n\t}\n\n\tchangeHashType(newHashingIntegerValue) {\n\t\tthis.hashingIntegers = newHashingIntegerValue;\n\t\tif (this.hashingIntegers) {\n\t\t\tthis.hashIntegerButton.checked = true;\n\t\t\tthis.keyField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.insertCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.deleteCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.findCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.hashStringButton.checked = true;\n\t\t\tthis.keyField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.insertCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.deleteCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.keyField,\n\t\t\t\tthis.findCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t}\n\t\treturn this.resetAll();\n\t}\n\n\tdoHash(input) {\n\t\tif (this.hashingIntegers) {\n\t\t\tconst labelID1 = this.nextIndex++;\n\t\t\tconst labelID2 = this.nextIndex++;\n\t\t\tconst highlightID = this.nextIndex++;\n\t\t\tconst index = parseInt(input) % this.table_size;\n\t\t\tthis.currHash = parseInt(input);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabelID1,\n\t\t\t\tinput + ' % ' + String(this.table_size) + ' = ',\n\t\t\t\tHASH_LABEL_X,\n\t\t\t\tHASH_LABEL_Y,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabelID2,\n\t\t\t\tindex,\n\t\t\t\tHASH_LABEL_X + HASH_LABEL_DELTA_X,\n\t\t\t\tHASH_LABEL_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightID,\n\t\t\t\tHIGHLIGHT_COLOR,\n\t\t\t\tHASH_LABEL_X + HASH_LABEL_DELTA_X,\n\t\t\t\tHASH_LABEL_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.move, highlightID, this.indexXPos[index], this.indexYPos[index]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, labelID1);\n\t\t\tthis.cmd(act.delete, labelID2);\n\t\t\tthis.cmd(act.delete, highlightID);\n\t\t\tthis.nextIndex -= 3;\n\n\t\t\treturn index;\n\t\t} else {\n\t\t\tconst label1 = this.nextIndex++;\n\t\t\tthis.cmd(act.createLabel, label1, 'Hashing:', 10, 55, 0);\n\t\t\tconst wordToHashID = new Array(input.length);\n\t\t\tconst wordToHash = new Array(input.length);\n\t\t\tfor (let i = 0; i < input.length; i++) {\n\t\t\t\twordToHashID[i] = this.nextIndex++;\n\t\t\t\twordToHash[i] = input.charAt(i);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\twordToHashID[i],\n\t\t\t\t\twordToHash[i],\n\t\t\t\t\tHASH_INPUT_START_X + i * HASH_INPUT_X_DIFF,\n\t\t\t\t\tHASH_INPUT_START_Y,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t}\n\t\t\tconst digits = new Array(32);\n\t\t\tconst hashValue = new Array(32);\n\t\t\tconst nextByte = new Array(8);\n\t\t\tconst nextByteID = new Array(8);\n\t\t\tconst resultDigits = new Array(32);\n\t\t\tconst floatingDigits = new Array(4);\n\t\t\tconst floatingVals = new Array(4);\n\n\t\t\tconst operatorID = this.nextIndex++;\n\t\t\tconst barID = this.nextIndex++;\n\t\t\tfor (let i = 0; i < 32; i++) {\n\t\t\t\thashValue[i] = 0;\n\t\t\t\tdigits[i] = this.nextIndex++;\n\t\t\t\tresultDigits[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tfor (let i = 0; i < 8; i++) {\n\t\t\t\tnextByteID[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\tfloatingDigits[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = wordToHash.length - 1; i >= 0; i--) {\n\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tdigits[j],\n\t\t\t\t\t\thashValue[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, wordToHashID[i]);\n\t\t\t\tlet nextChar = wordToHash[i].charCodeAt(0);\n\t\t\t\tfor (let j = 7; j >= 0; j--) {\n\t\t\t\t\tnextByte[j] = nextChar % 2;\n\t\t\t\t\tnextChar = Math.floor(nextChar / 2);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tnextByteID[j],\n\t\t\t\t\t\tnextByte[j],\n\t\t\t\t\t\tHASH_INPUT_START_X + i * HASH_INPUT_X_DIFF,\n\t\t\t\t\t\tHASH_INPUT_START_Y,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tnextByteID[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + (j + 24) * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_ADD_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tbarID,\n\t\t\t\t\t'',\n\t\t\t\t\t32 * HASH_X_DIFF,\n\t\t\t\t\t0,\n\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\tHASH_ADD_LINE_Y,\n\t\t\t\t\t'left',\n\t\t\t\t\t'bottom',\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\toperatorID,\n\t\t\t\t\t'+',\n\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\tHASH_ADD_START_Y,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tlet carry = 0;\n\t\t\t\tfor (let j = 7; j >= 0; j--) {\n\t\t\t\t\thashValue[j + 24] = hashValue[j + 24] + nextByte[j] + carry;\n\t\t\t\t\tif (hashValue[j + 24] > 1) {\n\t\t\t\t\t\thashValue[j + 24] = hashValue[j + 24] - 2;\n\t\t\t\t\t\tcarry = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcarry = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (let j = 23; j >= 0; j--) {\n\t\t\t\t\thashValue[j] = hashValue[j] + carry;\n\t\t\t\t\tif (hashValue[j] > 1) {\n\t\t\t\t\t\thashValue[j] = hashValue[j] - 2;\n\t\t\t\t\t\tcarry = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcarry = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\thashValue[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_RESULT_Y,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tfor (let j = 0; j < 8; j++) {\n\t\t\t\t\tthis.cmd(act.delete, nextByteID[j]);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, barID);\n\t\t\t\tthis.cmd(act.delete, operatorID);\n\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\tthis.cmd(act.delete, digits[j]);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j - 4) * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tfor (let j = 0; j < 28; j++) {\n\t\t\t\t\t\tfloatingVals[j] = hashValue[j];\n\t\t\t\t\t\thashValue[j] = hashValue[j + 4];\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j + ELF_HASH_SHIFT) * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_ADD_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\thashValue[j + 28] = 0;\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tfloatingDigits[j],\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j + 28) * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (floatingVals[j]) {\n\t\t\t\t\t\t\thashValue[j + ELF_HASH_SHIFT] = 1 - hashValue[j + ELF_HASH_SHIFT];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createRectangle,\n\t\t\t\t\t\tbarID,\n\t\t\t\t\t\t'',\n\t\t\t\t\t\t32 * HASH_X_DIFF,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\t\tHASH_ADD_LINE_Y,\n\t\t\t\t\t\t'left',\n\t\t\t\t\t\t'bottom',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\toperatorID,\n\t\t\t\t\t\t'XOR',\n\t\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\t\tHASH_ADD_START_Y,\n\t\t\t\t\t\t0,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tdigits[j],\n\t\t\t\t\t\t\thashValue[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_RESULT_Y,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tthis.cmd(act.delete, operatorID);\n\t\t\t\t\tthis.cmd(act.delete, barID);\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, resultDigits[j]);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tdigits[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, floatingDigits[j]);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, digits[j]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, resultDigits[j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.delete, label1);\n\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tdigits[j],\n\t\t\t\t\thashValue[j],\n\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.currHash = 0;\n\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\tthis.currHash = this.currHash * 2 + hashValue[j];\n\t\t\t}\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabel1,\n\t\t\t\t' = ' + String(this.currHash),\n\t\t\t\tHASH_NUMBER_START_X + 32 * HASH_X_DIFF,\n\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t0,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\tthis.cmd(act.delete, digits[j]);\n\t\t\t}\n\n\t\t\tconst label2 = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tlabel1,\n\t\t\t\tString(this.currHash) + ' % ' + String(this.table_size) + ' = ',\n\t\t\t);\n\t\t\tconst index = this.currHash % this.table_size;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabel2,\n\t\t\t\tindex,\n\t\t\t\tHASH_NUMBER_START_X + 32 * HASH_X_DIFF + 105,\n\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t0,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tconst highlightID = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightID,\n\t\t\t\tHIGHLIGHT_COLOR,\n\t\t\t\tHASH_NUMBER_START_X + 30 * HASH_X_DIFF + 120,\n\t\t\t\tHASH_NUMBER_START_Y + 15,\n\t\t\t);\n\t\t\tthis.cmd(act.move, highlightID, this.indexXPos[index], this.indexYPos[index]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, highlightID);\n\t\t\tthis.cmd(act.delete, label1);\n\t\t\tthis.cmd(act.delete, label2);\n\n\t\t\treturn index;\n\t\t}\n\t}\n\n\tresetAll() {\n\t\tthis.keyField.value = '';\n\t\tthis.valueField.value = '';\n\t\tthis.deleteField.value = '';\n\t\tthis.findField.value = '';\n\t\treturn [];\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedKey = this.keyField.value;\n\t\tconst insertedValue = this.valueField.value;\n\t\tif (insertedKey !== '' && insertedValue !== '') {\n\t\t\tthis.keyField.value = '';\n\t\t\tthis.valueField.value = '';\n\t\t\tthis.commands = [];\n\t\t\tthis.implementAction(this.insertElement.bind(this), insertedKey, insertedValue);\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tconst deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.deleteElement.bind(this), deletedValue);\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), findValue);\n\t\t}\n\t}\n\n\tloadFactorCallBack() {\n\t\tif (this.loadField.value !== '') {\n\t\t\tconst newLF = this.loadField.value / 100;\n\t\t\tthis.loadField.value = '';\n\t\t\tthis.implementAction(this.changeLoadFactor.bind(this), newLF);\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.hashIntegerButton.checked = true;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport { addDivisorToAlgorithmBar, addRadioButtonGroupToAlgorithmBar } from './Algorithm.js';\nimport Hash from './Hash.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_ELEM_WIDTH = 60;\nconst ARRAY_ELEM_HEIGHT = 30;\nconst ARRAY_ELEM_START_Y = 110;\nconst ARRAY_VERTICAL_SEPARATION = 70;\n\nconst CLOSED_HASH_TABLE_SIZE = 13;\n\nconst ARRAY_ELEM_START_X = 100;\n// If you want to center the array:\n// const ARRAY_ELEM_START_X = (window.screen.width - CLOSED_HASH_TABLE_SIZE * ARRAY_ELEM_WIDTH + ARRAY_ELEM_WIDTH) / 2;\nconst ARRAY_RESIZE_ELEM_START_Y = 240;\nconst ELEMS_PER_ROW = 14;\n\nconst LOAD_LABEL_X = 60;\nconst LOAD_LABEL_Y = 20;\n\nconst HASH2_LABEL_X = 270;\nconst HASH2_LABEL_Y = 70;\n\nconst RESIZE_LABEL_X = 400;\nconst RESIZE_LABEL_Y = 20;\n\nconst DEFAULT_LOAD_FACTOR = 0.67;\n\nconst MAX_SIZE = 70;\n\nconst INDEX_COLOR = '#0000FF';\n\nexport default class ClosedHash extends Hash {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.elements_per_row = ELEMS_PER_ROW;\n\t\t//this.elements_per_row = Math.floor(w / ARRAY_ELEM_WIDTH) - 1;\n\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tsuper.addControls();\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t[\n\t\t\t\t'Linear Probing: f(i) = i',\n\t\t\t\t'Quadratic Probing: f(i) = i * i',\n\t\t\t\t'Double Hashing: f(i) = i * hash2(elem)',\n\t\t\t],\n\t\t\t'Collision Strategy: h(elem) + f(i)',\n\t\t);\n\t\tthis.linearProblingButton = radioButtonList[0];\n\t\tthis.linearProblingButton.onclick = this.linearProbeCallback.bind(this);\n\t\tthis.quadraticProbingButton = radioButtonList[1];\n\t\tthis.quadraticProbingButton.onclick = this.quadraticProbeCallback.bind(this);\n\t\tthis.doubleHashingButton = radioButtonList[2];\n\t\tthis.doubleHashingButton.onclick = this.doubleHashingCallback.bind(this);\n\n\t\tthis.linearProblingButton.checked = true;\n\t\tthis.currentHashingTypeButtonState = this.linearProblingButton;\n\n\t\t// Add new controls\n\t}\n\n\tchangeProbeType(newProbingType) {\n\t\tif (newProbingType === this.linearProblingButton) {\n\t\t\tthis.linearProblingButton.checked = true;\n\t\t\tthis.currentHashingTypeButtonState = this.linearProblingButton;\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = i + 1;\n\t\t\t}\n\t\t} else if (newProbingType === this.quadraticProbingButton) {\n\t\t\tthis.quadraticProbingButton.checked = true;\n\t\t\tthis.currentHashingTypeButtonState = this.quadraticProbingButton;\n\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = (i + 1) * (i + 1);\n\t\t\t}\n\t\t} else if (newProbingType === this.doubleHashingButton) {\n\t\t\tthis.doubleHashingButton.checked = true;\n\t\t\tthis.currentHashingTypeButtonState = this.doubleHashingButton;\n\t\t}\n\t\tthis.commands = this.resetAll();\n\t\treturn this.commands;\n\t}\n\n\tquadraticProbeCallback() {\n\t\tif (this.currentHashingTypeButtonState !== this.quadraticProbingButton) {\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.quadraticProbingButton);\n\t\t}\n\t}\n\n\tdoubleHashingCallback() {\n\t\tif (this.currentHashingTypeButtonState !== this.doubleHashingButton) {\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.doubleHashingButton);\n\t\t}\n\t}\n\n\tlinearProbeCallback() {\n\t\tif (this.currentHashingTypeButtonState !== this.linearProblingButton) {\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.linearProblingButton);\n\t\t}\n\t}\n\n\tinsertElement(key, value) {\n\t\tconst entry = new MapEntry(key, value);\n\t\tconst elem = entry.elem;\n\t\tthis.commands = [];\n\n\t\tif (\n\t\t\t(this.size + 1) / this.table_size > this.load_factor &&\n\t\t\tthis.table_size * 2 + 1 < MAX_SIZE\n\t\t) {\n\t\t\tthis.resize(false);\n\t\t}\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting element: ' + elem);\n\t\tthis.cmd(act.step);\n\n\t\tlet index = this.doHash(key);\n\n\t\tindex = this.getEmptyIndex(index, key);\n\n\t\tif (index === -2 && this.table_size * 2 < MAX_SIZE) {\n\t\t\tthis.resize(true);\n\t\t} else if (index === -2) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t`Array would normally resize after length number of probes,\n\t\t\t\thowever there just isn't enough space on the screen to resize. \n\t\t\t\tSo here's a cute emoji of jack instead: VV`,\n\t\t\t);\n\t\t\treturn this.commands;\n\t\t}\n\n\t\tif (\n\t\t\tthis.hashTableValues[index] &&\n\t\t\tthis.hashTableValues[index].key === key &&\n\t\t\t!this.deleted[index]\n\t\t) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Key ' + key + ' is already in HashMap, updating value.',\n\t\t\t\t``,\n\t\t\t);\n\t\t\tthis.size--;\n\t\t}\n\n\t\tconst labID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, labID, elem, 20, 25);\n\t\tthis.cmd(act.move, labID, this.indexXPos[index], this.indexYPos[index] - ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, labID);\n\t\tthis.cmd(act.setText, this.hashTableVisual[index], elem);\n\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\tthis.hashTableValues[index] = entry;\n\t\tthis.empty[index] = false;\n\t\tthis.deleted[index] = false;\n\t\tthis.size++;\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\t\tthis.cmd(act.setText, this.DelIndexLabel, '');\n\t\treturn this.commands;\n\t}\n\n\tresetSkipDist(key, labelID) {\n\t\tconst skipVal = this.nextLowestPrime - (this.currHash % this.nextLowestPrime);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabelID,\n\t\t\t`hash2(${String(key)}) = ` +\n\t\t\t\t`${this.nextLowestPrime} - ${String(this.currHash)} % ${\n\t\t\t\t\tthis.nextLowestPrime\n\t\t\t\t} = ${String(skipVal)}`,\n\t\t\tHASH2_LABEL_X,\n\t\t\tHASH2_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.skipDist[0] = skipVal;\n\t\tfor (let i = 1; i < this.table_size; i++) {\n\t\t\tthis.skipDist[i] = this.skipDist[i - 1] + skipVal;\n\t\t}\n\t\treturn skipVal;\n\t}\n\n\tgetEmptyIndex(index, key) {\n\t\tlet HashID = -1;\n\t\tlet skipVal = 1;\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\n\t\t\tHashID = this.nextIndex++;\n\t\t\tskipVal = this.resetSkipDist(key, HashID);\n\t\t}\n\n\t\tlet probes = 0;\n\t\tlet removedIndex = -1;\n\t\tconst start = index;\n\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 1);\n\t\twhile (\n\t\t\tprobes < this.table_size &&\n\t\t\t!this.empty[index] &&\n\t\t\t!(this.hashTableValues[index].key === key)\n\t\t) {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, `Entry occupied, so probe forward`);\n\t\t\tthis.cmd(act.step);\n\t\t\t// storing removed index\n\t\t\tif (removedIndex === -1 && this.deleted[index]) {\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Storing index of first deleted element');\n\t\t\t\tthis.cmd(act.setText, this.DelIndexLabel, 'First Deleted Index: ' + index);\n\t\t\t\tremovedIndex = index;\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\n\t\t\t// increment index and clear labels\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\n\t\t\tindex = (start + this.skipDist[probes]) % this.table_size;\n\n\t\t\tif (this.currentHashingTypeButtonState === this.quadraticProbingButton) {\n\t\t\t\tskipVal = probes + 1;\n\t\t\t}\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.HashIndexID,\n\t\t\t\t`Index to probe: (${start} + ${probes + 1}*${skipVal}) % ${this.table_size} =` +\n\t\t\t\t\t` ${(start + this.skipDist[probes]) % this.table_size}`,\n\t\t\t);\n\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 1);\n\t\t\tif (this.empty[index]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.ExplainLabel,\n\t\t\t\t\t'Encountered null spot, so terminate loop',\n\t\t\t\t);\n\t\t\t} else if (this.hashTableValues[index].key === key) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.ExplainLabel,\n\t\t\t\t\t`Encountered matching key, so terminate loop`,\n\t\t\t\t);\n\t\t\t}\n\t\t\tprobes++;\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tthis.cmd(act.setText, this.HashIndexID, '');\n\n\t\tif (HashID !== -1) {\n\t\t\tthis.cmd(act.delete, HashID);\n\t\t\tthis.nextIndex--;\n\t\t}\n\n\t\tif (!this.empty[index] && this.hashTableValues[index].key === key && !this.deleted[index]) {\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\treturn index;\n\t\t} else if (probes === this.table_size && removedIndex === -1) {\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\treturn -2;\n\t\t} else {\n\t\t\tif (removedIndex !== -1) {\n\t\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting at earlier DEL spot');\n\t\t\t\tindex = removedIndex;\n\t\t\t} else if (this.hashTableValues[index] == null) {\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting at null spot');\n\t\t\t} else if (this.hashTableValues[index].key === key) {\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting at DEL spot with same key');\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\treturn removedIndex !== -1 ? removedIndex : index;\n\t\t}\n\t}\n\n\tgetElemIndex(index, key) {\n\t\tlet HashID = -1;\n\t\tlet skipVal = 1;\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\n\t\t\tHashID = this.nextIndex++;\n\t\t\tskipVal = this.resetSkipDist(key, HashID);\n\t\t}\n\n\t\tconst start = index;\n\t\tlet foundIndex = -1;\n\t\tlet candidateIndex = index;\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 0);\n\t\t\tif (\n\t\t\t\t!this.empty[candidateIndex] &&\n\t\t\t\t!this.deleted[candidateIndex] &&\n\t\t\t\tthis.hashTableValues[candidateIndex].key === key\n\t\t\t) {\n\t\t\t\tfoundIndex = candidateIndex;\n\t\t\t\tbreak;\n\t\t\t} else if (\n\t\t\t\tthis.empty[candidateIndex] ||\n\t\t\t\t(this.deleted[candidateIndex] && this.hashTableValues[candidateIndex].key === key)\n\t\t\t) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (this.currentHashingTypeButtonState === this.quadraticProbingButton) {\n\t\t\t\tskipVal = i + 1;\n\t\t\t}\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.HashIndexID,\n\t\t\t\t`Index to probe: (${start} + ${i + 1}*${skipVal}) % ${this.table_size} =` +\n\t\t\t\t\t` ${(start + this.skipDist[i]) % this.table_size}`,\n\t\t\t);\n\t\t\tcandidateIndex = (index + this.skipDist[i]) % this.table_size;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.HashIndexID, '');\n\t\tif (HashID !== -1) {\n\t\t\tthis.cmd(act.delete, HashID);\n\t\t\tthis.nextIndex--;\n\t\t}\n\n\t\treturn foundIndex;\n\t}\n\n\tdeleteElement(key) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Deleting element with key: ' + key);\n\t\tlet index = this.doHash(key);\n\n\t\tindex = this.getElemIndex(index, key);\n\n\t\tif (index >= 0) {\n\t\t\tconst elem = this.hashTableValues[index].elem;\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting element: ' + elem + '  Element deleted',\n\t\t\t);\n\t\t\t// this.empty[index] = true;\n\t\t\tthis.deleted[index] = true;\n\t\t\tthis.cmd(act.setText, this.hashTableVisual[index], 'DEL');\n\t\t\tthis.size--;\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting element with key: ' + key + '  Key not in table',\n\t\t\t);\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tfindElement(key) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Key: ' + key);\n\t\tconst index = this.doHash(key);\n\n\t\tconst found = this.getElemIndex(index, key) !== -1;\n\t\tif (found) {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Found Key: ' + key + '  Value: ' + this.hashTableValues[index].val);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Key: ' + key + '  Not Found!');\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tresize(fromCycle) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\t\tthis.cmd(act.setText, this.DelIndexLabel, '');\n\n\t\tconst resizeLabel = this.nextIndex++;\n\t\tif (!fromCycle) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tresizeLabel,\n\t\t\t\t`(Resize Required): (Size + 1 / length) > Load Factor --> (${this.size} + 1 / ${\n\t\t\t\t\tthis.table_size\n\t\t\t\t}) > ${this.load_factor}`,\n\t\t\t\tRESIZE_LABEL_X,\n\t\t\t\tRESIZE_LABEL_Y,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tresizeLabel,\n\t\t\t\t`(Resize Required): ${this.table_size} elements probed`,\n\t\t\t\tRESIZE_LABEL_X,\n\t\t\t\tRESIZE_LABEL_Y,\n\t\t\t);\n\t\t}\n\n\t\tthis.table_size = this.table_size * 2 + 1;\n\n\t\tif (this.table_size * 2 + 1 > MAX_SIZE) {\n\t\t\tthis.load_factor = 0.99;\n\t\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\t\t}\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.oldHashTableVisual = this.hashTableVisual;\n\t\tthis.oldHashTableValues = this.hashTableValues;\n\t\tthis.oldskipDist = this.skipDist;\n\t\tthis.oldempty = this.empty;\n\t\tthis.olddeleted = this.deleted;\n\t\tthis.oldIndexXPos = this.indexXPos;\n\t\tthis.oldIndexYPos = this.indexYPos;\n\t\tthis.oldindexLabelID = this.indexLabelID;\n\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.skipDist = new Array(this.table_size);\n\t\tthis.empty = new Array(this.table_size);\n\t\tthis.deleted = new Array(this.table_size);\n\t\tthis.indexXPos = new Array(this.table_size);\n\t\tthis.indexYPos = new Array(this.table_size);\n\t\tthis.indexLabelID = new Array(this.table_size);\n\n\t\tif (this.currentHashingTypeButtonState === this.linearProblingButton) {\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = i + 1;\n\t\t\t}\n\t\t} else if (this.currentHashingTypeButtonState === this.quadraticProbingButton) {\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = (i + 1) * (i + 1);\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\n\t\t\tconst nextYPos =\n\t\t\t\tARRAY_RESIZE_ELEM_START_Y +\n\t\t\t\tMath.floor(i / this.elements_per_row) * ARRAY_VERTICAL_SEPARATION;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.hashTableVisual[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\tnextXPos,\n\t\t\t\tnextYPos,\n\t\t\t);\n\t\t\tthis.indexLabelID[i] = this.nextIndex++;\n\t\t\tthis.indexXPos[i] = nextXPos;\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.indexLabelID[i],\n\t\t\t\ti,\n\t\t\t\tthis.indexXPos[i],\n\t\t\t\tthis.indexYPos[i],\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.indexLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tlet elementsMoved = 0;\n\n\t\tfor (let i = 0; i < this.table_size / 2 && elementsMoved < this.size; i++) {\n\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 1);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (!this.oldempty[i] && !this.olddeleted[i]) {\n\t\t\t\tconst oldElement = this.oldHashTableValues[i];\n\n\t\t\t\tlet index = this.doHash(oldElement.key);\n\n\t\t\t\tindex = this.getEmptyIndex(index, oldElement.key);\n\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tconst labID = this.nextIndex++;\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tlabID,\n\t\t\t\t\t\toldElement.elem,\n\t\t\t\t\t\tthis.oldIndexXPos[i],\n\t\t\t\t\t\tthis.oldIndexYPos[i] - ARRAY_ELEM_HEIGHT,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tlabID,\n\t\t\t\t\t\tthis.indexXPos[index],\n\t\t\t\t\t\tthis.indexYPos[index] - ARRAY_ELEM_HEIGHT,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, labID);\n\t\t\t\t\tthis.cmd(act.setText, this.hashTableVisual[index], oldElement.elem);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\n\t\t\t\t\tthis.hashTableValues[index] = oldElement;\n\t\t\t\t\tthis.empty[index] = false;\n\t\t\t\t\tthis.deleted[index] = false;\n\t\t\t\t\telementsMoved++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 0);\n\t\t}\n\n\t\tthis.cmd(act.delete, resizeLabel);\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\n\t\t\tconst nextYPos =\n\t\t\t\tARRAY_ELEM_START_Y +\n\t\t\t\tMath.floor(i / this.elements_per_row) * ARRAY_VERTICAL_SEPARATION;\n\t\t\tif (i < (this.table_size - 1) / 2) {\n\t\t\t\tthis.cmd(act.delete, this.oldHashTableVisual[i]);\n\t\t\t\tthis.cmd(act.delete, this.oldindexLabelID[i]);\n\t\t\t}\n\t\t\tthis.cmd(act.move, this.hashTableVisual[i], nextXPos, nextYPos);\n\t\t\tthis.cmd(act.move, this.indexLabelID[i], nextXPos, nextYPos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tchangeLoadFactor(LF) {\n\t\tthis.commands = [];\n\n\t\tif (this.table_size * 2 + 1 <= MAX_SIZE) {\n\t\t\tthis.load_factor = LF;\n\t\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.loadFactorID,\n\t\t\t\t`Load Factor: ${this.load_factor}\n\t\t\t(Max Array Length)`,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tsetup() {\n\t\tthis.resetIndex = this.nextIndex;\n\t\tthis.table_size = CLOSED_HASH_TABLE_SIZE;\n\t\tthis.nextLowestPrime = 11;\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\n\t\tthis.skipDist = new Array(this.table_size);\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.size = 0;\n\n\t\tthis.indexLabelID = new Array(this.table_size);\n\t\tthis.indexXPos = new Array(this.table_size);\n\t\tthis.indexYPos = new Array(this.table_size);\n\n\t\tthis.empty = new Array(this.table_size);\n\t\tthis.deleted = new Array(this.table_size);\n\n\t\tthis.ExplainLabel = this.nextIndex++;\n\n\t\tthis.HashIndexID = this.nextIndex++;\n\n\t\t// stores deleted index\n\t\tthis.DelIndexLabel = this.nextIndex++;\n\n\t\t// stores the load factor\n\t\tthis.loadFactorID = this.nextIndex++;\n\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.skipDist[i] = i + 1; // Start with linear probing\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\n\t\t\tconst nextYPos =\n\t\t\t\tARRAY_ELEM_START_Y +\n\t\t\t\tMath.floor(i / this.elements_per_row) * ARRAY_VERTICAL_SEPARATION;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.hashTableVisual[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\tnextXPos,\n\t\t\t\tnextYPos,\n\t\t\t);\n\t\t\tthis.indexLabelID[i] = this.nextIndex++;\n\t\t\tthis.indexXPos[i] = nextXPos;\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.indexLabelID[i],\n\t\t\t\ti,\n\t\t\t\tthis.indexXPos[i],\n\t\t\t\tthis.indexYPos[i],\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.indexLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, this.ExplainLabel, '', 10, 40, 0);\n\t\tthis.cmd(act.createLabel, this.HashIndexID, '', HASH2_LABEL_X + 300, HASH2_LABEL_Y + 5);\n\t\tthis.cmd(act.createLabel, this.DelIndexLabel, '', 10, 60, 0);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.loadFactorID,\n\t\t\t`Load Factor: ${this.load_factor}`,\n\t\t\tLOAD_LABEL_X,\n\t\t\tLOAD_LABEL_Y,\n\t\t);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tresetAll() {\n\t\tthis.commands = super.resetAll();\n\n\t\tthis.size = 0;\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\t\t\tthis.hashTableValues[i] = undefined;\n\t\t\tthis.cmd(act.setText, this.hashTableVisual[i], '');\n\t\t}\n\n\t\treturn this.commands;\n\t\t// Clear array, etc\n\t}\n\n\t// NEED TO OVERRIDE IN PARENT\n\treset() {\n\t\tthis.nextIndex = this.resetIndex;\n\t\tthis.table_size = CLOSED_HASH_TABLE_SIZE;\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\n\t\tthis.size = 0;\n\n\t\tthis.empty = new Array(this.table_size);\n\t\tthis.deleted = new Array(this.table_size);\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.indexLabelID = new Array(this.table_size);\n\n\t\tthis.ExplainLabel = this.nextIndex++;\n\n\t\tthis.HashIndexID = this.nextIndex++;\n\n\t\t// stores deleted index\n\t\tthis.DelIndexLabel = this.nextIndex++;\n\n\t\t// stores the load factor\n\t\tthis.loadFactorID = this.nextIndex++;\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\n\t\t\tthis.indexLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tsuper.reset();\n\t}\n\n\tresetCallback() {}\n\n\tdisableUI() {\n\t\tsuper.disableUI();\n\t\tthis.linearProblingButton.disabled = true;\n\t\tthis.quadraticProbingButton.disabled = true;\n\t\tthis.doubleHashingButton.disabled = true;\n\t}\n\n\tenableUI() {\n\t\tsuper.enableUI();\n\t\tthis.linearProblingButton.disabled = false;\n\t\tthis.quadraticProbingButton.disabled = false;\n\t\tthis.doubleHashingButton.disabled = false;\n\t}\n}\n\nclass MapEntry {\n\tconstructor(key, val) {\n\t\tthis.key = key;\n\t\tthis.val = val;\n\t\tthis.elem = `<${key}, ${val}>`;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 120;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 180;\n\nlet lastSwapEnabled = true;\n\nexport default class CocktailSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Last swap optimization toggle\n\t\tthis.lastSwapCheckbox = addCheckboxToAlgorithmBar('Enable last swap optimization', true);\n\t\tthis.lastSwapCheckbox.onclick = this.toggleLastSwap.bind(this);\n\t\tthis.controls.push(this.lastSwapCheckbox);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure CocktailSort(array):'],\n\t\t\t['     start <- 0, end <- length of array - 1'],\n\t\t\t['     swapped <- start'],\n\t\t\t['     while end > start'],\n\t\t\t['          swapped <- start'],\n\t\t\t['          for i <- start, end do'],\n\t\t\t['               if array[i] > array[i + 1]'],\n\t\t\t['                    swap array[i], array[i + 1]'],\n\t\t\t['                    swapped <- i'],\n\t\t\t['               end if'],\n\t\t\t['          end for'],\n\t\t\t['          end <- swapped'],\n\t\t\t['          for i <- end, start do'],\n\t\t\t['               if array[i] < array[i - 1]'],\n\t\t\t['                    swap array[i], array[i - 1]'],\n\t\t\t['                    swapped <- i'],\n\t\t\t['               end if'],\n\t\t\t['          end for'],\n\t\t\t['          start <- swapped'],\n\t\t\t['     end while'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tconsole.log(this.nextIndex);\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.compCount = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t\tif (!lastSwapEnabled) {\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     while start < end and sorted is false');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          sorted <- true');\n\t\t\tthis.cmd(act.setText, this.codeID[8][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[11][0], '          end <- end - 1');\n\t\t\tthis.cmd(act.setText, this.codeID[15][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[18][0], '          start <- start + 1');\n\t\t}\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\ttoggleLastSwap() {\n\t\tif (lastSwapEnabled) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     while start < end and sorted is false');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          sorted <- true');\n\t\t\tthis.cmd(act.setText, this.codeID[8][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[11][0], '          end <- end - 1');\n\t\t\tthis.cmd(act.setText, this.codeID[15][0], '                    sorted <- false');\n\t\t\tthis.cmd(act.setText, this.codeID[18][0], '          start <- start + 1');\n\t\t} else {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     swapped <- start');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '     while start < end');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          swapped <- start');\n\t\t\tthis.cmd(act.setText, this.codeID[8][0], '                    swapped <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[11][0], '          end <- swapped');\n\t\t\tthis.cmd(act.setText, this.codeID[15][0], '                    swapped <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[18][0], '          start <- swapped');\n\t\t}\n\t\tlastSwapEnabled = !lastSwapEnabled;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.compCount = 0;\n\t\tthis.displayData = [];\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\t\tthis.highlight(0, 0);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\t\tconst length = this.arrayData.length;\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\n\t\tlet sorted = true;\n\t\tlet start = 0;\n\t\tlet end = this.arrayData.length - 1;\n\t\tlet lastSwapped = 0;\n\t\tthis.highlight(3, 0);\n\t\tthis.cmd(act.step);\n\t\tdo {\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tsorted = true;\n\t\t\tfor (let i = start; i < end; i++) {\n\t\t\t\tthis.movePointers(i, i + 1);\n\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\tthis.highlight(6, 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tif (this.arrayData[i] > this.arrayData[i + 1]) {\n\t\t\t\t\tthis.highlight(7, 0);\n\t\t\t\t\tthis.highlight(8, 0);\n\t\t\t\t\tthis.swap(i, i + 1);\n\t\t\t\t\tsorted = false;\n\t\t\t\t\tlastSwapped = i;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.unhighlight(8, 0);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.highlight(11, 0);\n\t\t\tif (lastSwapEnabled) {\n\t\t\t\tend = lastSwapped;\n\t\t\t} else {\n\t\t\t\tend--;\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(11, 0);\n\t\t\tif (!sorted) {\n\t\t\t\tfor (let i = end + 1; i < this.arrayData.length; i++) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.highlight(12, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (!sorted) {\n\t\t\t\tsorted = true;\n\t\t\t\tfor (let i = end; i > start; i--) {\n\t\t\t\t\tthis.movePointers(i - 1, i);\n\t\t\t\t\tthis.unhighlight(12, 0);\n\t\t\t\t\tthis.highlight(13, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\t\tif (+this.arrayData[i] < +this.arrayData[i - 1]) {\n\t\t\t\t\t\tthis.highlight(14, 0);\n\t\t\t\t\t\tthis.highlight(15, 0);\n\t\t\t\t\t\tthis.swap(i, i - 1);\n\t\t\t\t\t\tsorted = false;\n\t\t\t\t\t\tlastSwapped = i;\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(14, 0);\n\t\t\t\t\tthis.unhighlight(15, 0);\n\t\t\t\t}\n\t\t\t\tthis.highlight(18, 0);\n\t\t\t\tif (lastSwapEnabled) {\n\t\t\t\t\tstart = lastSwapped;\n\t\t\t\t} else {\n\t\t\t\t\tstart++;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(18, 0);\n\t\t\t\tif (!sorted) {\n\t\t\t\t\tfor (let i = start - 1; i >= 0; i--) {\n\t\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.unhighlight(12, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t} while (!sorted);\n\t\tthis.unhighlight(3, 0);\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\n\t\t// Swap actual data\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\n\t\t// Swap displayed data\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { BFS_DFS_ADJ_LIST } from './util/GraphValues';\nimport Graph from './Graph.js';\nimport { act } from '../anim/AnimationMain';\n\nconst DFS_STACK_TOP_COLOR = '#0000FF';\nconst VISITED_COLOR = '#99CCFF';\n\nconst INFO_MSG_X = 25;\nconst INFO_MSG_Y = 15;\n\nconst LIST_START_X = 30;\nconst LIST_START_Y = 70;\nconst LIST_SPACING = 20;\n\nconst VISITED_START_X = 30;\nconst VISITED_START_Y = 120;\n\nconst CURRENT_VERTEX_LABEL_X = 25;\nconst CURRENT_VERTEX_LABEL_Y = 145;\nconst CURRENT_VERTEX_X = 115;\nconst CURRENT_VERTEX_Y = 151;\n\nconst STACK_LABEL_X = 25;\nconst STACK_LABEL_Y = 170;\n\nconst STACK_START_X = 40;\nconst SMALL_STACK_START_Y = 335;\nconst LARGE_STACK_START_Y = 465;\nconst SMALL_STACK_SPACING = 20;\nconst LARGE_STACK_SPACING = 16;\n\nconst RECURSION_START_X = 125;\nconst RECURSION_START_Y = 185;\nconst SMALL_RECURSION_SPACING_X = 20;\nconst LARGE_RECURSION_SPACING_X = 10;\nconst SMALL_RECURSION_SPACING_Y = 20;\nconst LARGE_RECURSION_SPACING_Y = 15;\n\nexport default class DFS extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, BFS_DFS_ADJ_LIST);\n\t\tthis.addControls();\n\t\tthis.physicalStack = false;\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start vertex: ');\n\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.startField);\n\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Recursion', 'Stack'],\n\t\t\t'StackType',\n\t\t);\n\n\t\tthis.recursiveStackButton = radioButtonList[0];\n\t\tthis.recursiveStackButton.onclick = this.stackCallback.bind(this, false);\n\t\tthis.recursiveStackButton.checked = true;\n\t\tthis.controls.push(this.recursiveStackButton);\n\n\t\tthis.physicalStackButton = radioButtonList[1];\n\t\tthis.physicalStackButton.onclick = this.stackCallback.bind(this, true);\n\t\tthis.controls.push(this.physicalStackButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\t\tthis.commands = [];\n\t\tthis.messageID = [];\n\n\t\tthis.visited = [];\n\n\t\tthis.stackID = [];\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited Set:',\n\t\t\tVISITED_START_X - 5,\n\t\t\tVISITED_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'List:',\n\t\t\tLIST_START_X - 5,\n\t\t\tLIST_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current vertex:',\n\t\t\tCURRENT_VERTEX_LABEL_X,\n\t\t\tCURRENT_VERTEX_LABEL_Y,\n\t\t\t0,\n\t\t);\n\n\t\tthis.stackLabelID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.stackLabelID,\n\t\t\tthis.physicalStack ? 'Stack:' : 'Recursive stack:   Recursive calls:',\n\t\t\tSTACK_LABEL_X,\n\t\t\tSTACK_LABEL_Y,\n\t\t\t0,\n\t\t);\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\t\tthis.messageID = [];\n\t}\n\n\tstackCallback(physical) {\n\t\tif (this.physicalStack !== physical) {\n\t\t\tthis.physicalStack = physical;\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup(this.adj_matrix);\n\t\t}\n\t}\n\n\tstartCallback() {\n\t\tif (this.startField.value !== '') {\n\t\t\tlet startvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size) {\n\t\t\t\tif (this.physicalStack) {\n\t\t\t\t\tthis.implementAction(this.doDFSStack.bind(this), startvalue);\n\t\t\t\t} else {\n\t\t\t\t\tthis.implementAction(this.doDFSRecursive.bind(this), startvalue);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdoDFSStack(startVertex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.visited = new Array(this.size);\n\t\tthis.stack = [];\n\t\tthis.stackID = [];\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\t\tthis.stackStartY = this.isLarge ? LARGE_STACK_START_Y : SMALL_STACK_START_Y;\n\t\tthis.stackSpacing = this.isLarge ? LARGE_STACK_SPACING : SMALL_STACK_SPACING;\n\n\t\tthis.rebuildEdges();\n\n\t\tlet vertex = startVertex;\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Pushing ' + this.toStr(vertex) + ' and adding to visited set',\n\t\t);\n\t\tlet vertexID = this.nextIndex++;\n\t\tthis.visited[vertex] = true;\n\t\tthis.visitedID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(vertex),\n\t\t\tVISITED_START_X,\n\t\t\tVISITED_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[vertex], VISITED_COLOR);\n\t\tthis.stack.push(vertex);\n\t\tthis.stackID.push(vertexID);\n\t\tthis.cmd(act.createLabel, vertexID, this.toStr(vertex), STACK_START_X, this.stackStartY);\n\t\tthis.cmd(act.step);\n\n\t\twhile (this.stack.length > 0 && this.listID.length < this.size) {\n\t\t\tvertex = this.stack.pop();\n\t\t\tvertexID = this.stackID.pop();\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.infoLabelID,\n\t\t\t\t'Popping ' + this.toStr(vertex) + ' and adding to list',\n\t\t\t);\n\n\t\t\tthis.cmd(act.setTextColor, vertexID, DFS_STACK_TOP_COLOR);\n\t\t\tthis.cmd(act.move, vertexID, CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\n\t\t\tthis.listID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tthis.toStr(vertex),\n\t\t\t\tLIST_START_X + (this.listID.length - 1) * LIST_SPACING,\n\t\t\t\tLIST_START_Y,\n\t\t\t);\n\n\t\t\tthis.visitVertex(vertex);\n\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\tif (this.adj_matrix[vertex][neighbor] > 0) {\n\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 1);\n\t\t\t\t\tif (!this.visited[neighbor]) {\n\t\t\t\t\t\tthis.visited[neighbor] = true;\n\t\t\t\t\t\tthis.visitedID.push(this.nextIndex);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\tthis.toStr(neighbor) +\n\t\t\t\t\t\t\t\t' has not yet been visited, pushing and adding to visited set',\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\tthis.toStr(neighbor),\n\t\t\t\t\t\t\tVISITED_START_X + (this.visitedID.length - 1) * LIST_SPACING,\n\t\t\t\t\t\t\tVISITED_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[neighbor], VISITED_COLOR);\n\t\t\t\t\t\tthis.stack.push(neighbor);\n\t\t\t\t\t\tthis.stackID.push(this.nextIndex);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\tthis.toStr(neighbor),\n\t\t\t\t\t\t\tSTACK_START_X,\n\t\t\t\t\t\t\tthis.stackStartY - (this.stack.length - 1) * this.stackSpacing,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\tthis.toStr(neighbor) + ' has already been visited, skipping',\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t// this.highlightEdge(vertex, neighbor, 0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.cmd(act.delete, vertexID);\n\n\t\t\tthis.leaveVertex();\n\t\t}\n\n\t\tif (this.stack.length > 0) {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'All vertices have been visited, done');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Stack is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tdoDFSRecursive(startVertex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.visited = new Array(this.size);\n\t\tthis.listID = [];\n\t\tthis.visitedID = [];\n\t\tthis.stackStartY = this.isLarge ? LARGE_STACK_START_Y : SMALL_STACK_START_Y;\n\t\tthis.stackSpacing = this.isLarge ? LARGE_STACK_SPACING : SMALL_STACK_SPACING;\n\t\tthis.recursionSpacingX = this.isLarge\n\t\t\t? LARGE_RECURSION_SPACING_X\n\t\t\t: SMALL_RECURSION_SPACING_X;\n\t\tthis.recursionSpacingY = this.isLarge\n\t\t\t? LARGE_RECURSION_SPACING_Y\n\t\t\t: SMALL_RECURSION_SPACING_Y;\n\t\tthis.currentID = this.nextIndex++;\n\n\t\tthis.rebuildEdges();\n\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\n\n\t\tconst vertex = startVertex;\n\n\t\tthis.cmd(act.createLabel, this.currentID, '', CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\t\tthis.cmd(act.setTextColor, this.currentID, DFS_STACK_TOP_COLOR);\n\n\t\tthis.cmd(act.setText, this.infoLabelID, 'About to recurse to ' + this.toStr(startVertex));\n\t\tthis.cmd(act.step);\n\n\t\tthis.visitVertex(vertex);\n\n\t\tthis.dfsVisit(vertex, RECURSION_START_X);\n\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Returned from ' + this.toStr(vertex) + ', done');\n\t\tthis.cmd(act.delete, this.currentID);\n\t\tthis.leaveVertex();\n\n\t\treturn this.commands;\n\t}\n\n\tdfsVisit(currVertex, messageX) {\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Visiting ' + this.toStr(currVertex) + ' and adding to list',\n\t\t);\n\t\tthis.cmd(act.setText, this.currentID, this.toStr(currVertex));\n\n\t\tthis.stackID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(currVertex),\n\t\t\tSTACK_START_X,\n\t\t\tthis.stackStartY - (this.stackID.length - 1) * this.stackSpacing,\n\t\t);\n\n\t\tconst nextMessage = this.nextIndex++;\n\t\tthis.messageID.push(nextMessage);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tnextMessage,\n\t\t\t'DFS(' + this.toStr(currVertex) + ')',\n\t\t\tmessageX,\n\t\t\tRECURSION_START_Y + (this.messageID.length - 1) * this.recursionSpacingY,\n\t\t\t0,\n\t\t);\n\n\t\tthis.listID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(currVertex),\n\t\t\tLIST_START_X + (this.listID.length - 1) * LIST_SPACING,\n\t\t\tLIST_START_Y,\n\t\t);\n\n\t\tthis.visited[currVertex] = true;\n\t\tthis.visitedID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(currVertex),\n\t\t\tVISITED_START_X + (this.visitedID.length - 1) * LIST_SPACING,\n\t\t\tVISITED_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[currVertex], VISITED_COLOR);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\tif (this.adj_matrix[currVertex][neighbor] > 0) {\n\t\t\t\tif (this.visited[neighbor]) {\n\t\t\t\t\t// this.highlightEdge(currVertex, neighbor, 1, 'blue');\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t'Vertex ' + this.toStr(neighbor) + ' already visited, skipping',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t// this.highlightEdge(currVertex, neighbor, 0);\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlightEdge(currVertex, neighbor, 1, 'red');\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t'About to recurse to ' + this.toStr(neighbor),\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tthis.leaveVertex();\n\t\t\t\t\tthis.visitVertex(neighbor);\n\t\t\t\t\t// this.highlightEdge(currVertex, neighbor, 0);\n\n\t\t\t\t\tthis.dfsVisit(neighbor, messageX + this.recursionSpacingX);\n\n\t\t\t\t\tthis.leaveVertex();\n\t\t\t\t\tthis.visitVertex(currVertex);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t'Returned from ' + this.toStr(neighbor) + ' to ' + this.toStr(currVertex),\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, this.stackID.pop());\n\t}\n\n\tclear() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], '#FFFFFF');\n\t\t\tthis.visited[i] = false;\n\t\t}\n\t\tfor (let i = 0; i < this.listID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.listID[i]);\n\t\t}\n\t\tthis.listID = [];\n\t\tfor (let i = 0; i < this.visitedID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.visitedID[i]);\n\t\t}\n\t\tthis.visitedID = [];\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.messageID = [];\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst INFO_MSG_X = 20;\nconst INFO_MSG_Y = 400;\n\nconst TABLE_ELEM_WIDTH = 40;\nconst TABLE_ELEM_HEIGHT = 30;\n\nconst TABLE_START_X = 500;\nconst TABLE_START_Y = 80;\n\nconst CODE_START_X = 20;\nconst CODE_START_Y = 20;\nconst CODE_LINE_HEIGHT = 14;\n\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\nconst CODE_STANDARD_COLOR = '#000000';\nconst LCS_CELL_COLOR = '#99CCFF';\nconst MAX_SEQUENCE_LENGTH = 13;\n\nconst SEQUENCE_START_X = 20;\nconst SEQUENCE_START_Y = 450;\nconst SEQUENCE_DELTA_X = 10;\n\nexport default class LCS extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\taddLabelToAlgorithmBar('S1:');\n\t\tthis.S1Field = addControlToAlgorithmBar('Text', '');\n\t\tthis.S1Field.onkeydown = this.returnSubmit(\n\t\t\tthis.S1Field,\n\t\t\tthis.runCallback.bind(this),\n\t\t\tMAX_SEQUENCE_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.S1Field);\n\n\t\taddLabelToAlgorithmBar('S2:');\n\t\tthis.S2Field = addControlToAlgorithmBar('Text', '');\n\t\tthis.S2Field.onkeydown = this.returnSubmit(\n\t\t\tthis.S2Field,\n\t\t\tthis.runCallback.bind(this),\n\t\t\tMAX_SEQUENCE_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.S2Field);\n\n\t\tthis.tableButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.tableButton.onclick = this.runCallback.bind(this);\n\t\tthis.controls.push(this.tableButton);\n\t}\n\n\tsetup() {\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.code = [\n\t\t\t['procedure ', 'LCS(S1, S2, matrix)'],\n\t\t\t['     matrix <- create new 2D array of length S1.length by S2.length'],\n\t\t\t['     for y <- 1, to S1.length, loop'],\n\t\t\t['          for x <- 1 to S2.length, loop'],\n\t\t\t['               if ', '(S1[y] == S2[x])'],\n\t\t\t['                    matrix[y][x] = 1 + ', 'matrix[y - 1][x - 1]'],\n\t\t\t['               else'],\n\t\t\t[\n\t\t\t\t'                    matrix[y][x] = max(',\n\t\t\t\t'matrix[y - 1][x]',\n\t\t\t\t',',\n\t\t\t\t' matrix[y][x - 1]',\n\t\t\t\t')',\n\t\t\t],\n\t\t\t['          end for'],\n\t\t\t['     end for'],\n\t\t\t['     currY <- S1.length'],\n\t\t\t['     currX <- S2.length'],\n\t\t\t['     list <- create new List()'],\n\t\t\t['     while currY > 0 and currX > 0, loop:'],\n\t\t\t[['          if '], ['matrix[currY - 1][currX] == matrix[currY][currX - 1] ']],\n\t\t\t[['           and '], ['matrix[currY][currX] != matrix [currY - 1][currX - 1]']],\n\t\t\t['               list.addFront(S1[currY])'],\n\t\t\t['               currX--'],\n\t\t\t['               currY--'],\n\t\t\t['          else'],\n\t\t\t[['               if '], ['matrix[currY - 1][currX] > matrix[currY][currX - 1]']],\n\t\t\t['                    currX--'],\n\t\t\t['               else'],\n\t\t\t['                    currY--'],\n\t\t\t['     end while'],\n\t\t\t['end procedure']\n\t\t];\n\n\t\tthis.codeID = Array(this.code.length);\n\t\tlet i, j;\n\t\tfor (i = 0; i < this.code.length; i++) {\n\t\t\tthis.codeID[i] = new Array(this.code[i].length);\n\t\t\tfor (j = 0; j < this.code[i].length; j++) {\n\t\t\t\tthis.codeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.codeID[i][j],\n\t\t\t\t\tthis.code[i][j],\n\t\t\t\t\tCODE_START_X,\n\t\t\t\t\tCODE_START_Y + i * CODE_LINE_HEIGHT,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[i][j], CODE_STANDARD_COLOR);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, this.codeID[i][j], this.codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.initialIndex = this.nextIndex;\n\t\tthis.oldIDs = [];\n\t\tthis.commands = [];\n\t}\n\n\treset() {\n\t\tthis.oldIDs = [];\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\trunCallback() {\n\t\tconst string1 = this.S1Field.value;\n\t\tconst string2 = this.S2Field.value;\n\t\tif (string1 !== '' && string2 !== '') {\n\t\t\tthis.S1Field.value = '';\n\t\t\tthis.S2Field.value = '';\n\t\t\tthis.implementAction(this.run.bind(this), string1, string2);\n\t\t}\n\t}\n\n\trun(str1, str2) {\n\t\tthis.commands = [];\n\t\tthis.clearOldIDs();\n\n\t\tthis.buildTable(str1, str2);\n\n\t\tconst moveID = this.nextIndex++;\n\t\tconst x = str1.length;\n\t\tconst y = str2.length;\n\t\tlet i, j;\n\n\t\tfor (i = 0; i <= x; i++) {\n\t\t\tthis.cmd(act.setText, this.tableID[i][0], '0');\n\t\t\tthis.tableVals[i][0] = 0;\n\t\t}\n\t\tfor (i = 0; i <= y; i++) {\n\t\t\tthis.cmd(act.setText, this.tableID[0][i], '0');\n\t\t\tthis.tableVals[0][i] = 0;\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tfor (j = 0; j < y; j++) {\n\t\t\tfor (i = 0; i < x; i++) {\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j + 1], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[i], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[j], 1);\n\t\t\t\tthis.highlight(4, 1);\n\t\t\t\t// this.cmd(act.setForegroundColor, this.codeID[4][1], CODE_HIGHLIGHT_COLOR);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Comparing ' + str1.charAt(i) + ' and ' + str2.charAt(j),\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[i], 0);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[j], 0);\n\t\t\t\tthis.unhighlight(4, 1);\n\t\t\t\t// this.cmd(act.setForegroundColor, this.codeID[4][1], CODE_STANDARD_COLOR);\n\t\t\t\tif (str1.charAt(i) === str2.charAt(j)) {\n\t\t\t\t\t// this.cmd(act.setForegroundColor, this.codeID[5][0], CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\t// this.cmd(act.setForegroundColor, this.codeID[5][1], CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\tthis.highlight(5, 0);\n\t\t\t\t\tthis.highlight(5, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1 - 1][j + 1 - 1], 1);\n\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Match, increment from the diagonal');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\tthis.tableVals[i][j] + 1,\n\t\t\t\t\t\tthis.tableXPos[i][j],\n\t\t\t\t\t\tthis.tableYPos[i][j],\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.bringToTop, moveID, 1);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\tthis.tableXPos[i + 1][j + 1],\n\t\t\t\t\t\tthis.tableYPos[i + 1][j + 1],\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, moveID);\n\t\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\t\tthis.unhighlight(5, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1 - 1][j + 1 - 1], 0);\n\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i][j] + 1;\n\t\t\t\t\tthis.cmd(act.setText, this.tableID[i + 1][j + 1], this.tableVals[i + 1][j + 1]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlight(7, 0);\n\t\t\t\t\tthis.highlight(7, 1);\n\t\t\t\t\tthis.highlight(7, 2);\n\t\t\t\t\tthis.highlight(7, 3);\n\t\t\t\t\tthis.highlight(7, 4);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i][j + 1], 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j], 1);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t'Mismatch, copy greatest value from left or above',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\t\tthis.unhighlight(7, 2);\n\t\t\t\t\tthis.unhighlight(7, 4);\n\t\t\t\t\n\t\t\t\t\tif (this.tableVals[i][j + 1] > this.tableVals[i + 1][j]) {\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j], 0);\n\t\t\t\t\t\tthis.unhighlight(7, 1);\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i][j + 1];\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\t\tthis.tableVals[i][j + 1],\n\t\t\t\t\t\t\tthis.tableXPos[i][j + 1],\n\t\t\t\t\t\t\tthis.tableYPos[i][j + 1],\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.unhighlight(7, 3);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i][j + 1], 0);\n\t\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i + 1][j];\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\t\tthis.tableVals[i + 1][j],\n\t\t\t\t\t\t\tthis.tableXPos[i + 1][j],\n\t\t\t\t\t\t\tthis.tableYPos[i + 1][j],\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.bringToTop, moveID, 1);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\tthis.tableXPos[i + 1][j + 1],\n\t\t\t\t\t\tthis.tableYPos[i + 1][j + 1],\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setText, this.tableID[i + 1][j + 1], this.tableVals[i + 1][j + 1]);\n\t\t\t\t\tthis.cmd(act.delete, moveID);\n\t\t\t\t\tif (this.tableVals[i][j + 1] > this.tableVals[i + 1][j]) {\n\t\t\t\t\t\tthis.unhighlight(7, 3);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i][j + 1], 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.unhighlight(7, 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j], 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j + 1], 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.highlight(9, 0);\n\t\tthis.highlight(10, 0);\n\t\tthis.highlight(11, 0);\n\t\tthis.highlight(12, 0);\n\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Finished building table, can now find LCS');\n\t\tthis.cmd(act.step);\n\n\t\tthis.buildLCSFromTable(str1, str2);\n\n\t\tthis.unhighlight(24, 0);\n\t\tthis.highlight(25, 0);\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Done');\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(25, 0);\n\n\t\treturn this.commands;\n\t}\n\n\tbuildTable(str1, str2) {\n\t\tconst x = str1.length;\n\t\tconst y = str2.length;\n\t\tthis.tableID = new Array(x + 1);\n\t\tthis.tableVals = new Array(x + 1);\n\t\tthis.tableXPos = new Array(x + 1);\n\t\tthis.tableYPos = new Array(x + 1);\n\n\t\tlet i, j;\n\n\t\tthis.S1TableID = new Array(x);\n\t\tfor (i = 0; i <= x; i++) {\n\t\t\tif (i > 0) {\n\t\t\t\tthis.S1TableID[i - 1] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.S1TableID[i - 1],\n\t\t\t\t\tstr1.charAt(i - 1),\n\t\t\t\t\tTABLE_START_X + i * TABLE_ELEM_WIDTH,\n\t\t\t\t\tTABLE_START_Y - 2 * TABLE_ELEM_HEIGHT,\n\t\t\t\t);\n\t\t\t\tthis.oldIDs.push(this.S1TableID[i - 1]);\n\t\t\t}\n\t\t\tconst index = this.nextIndex++;\n\t\t\tthis.oldIDs.push(index);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tindex,\n\t\t\t\ti - 1 === -1 ? '\\u2205' : i - 1,\n\t\t\t\tTABLE_START_X + i * TABLE_ELEM_WIDTH,\n\t\t\t\tTABLE_START_Y - 1 * TABLE_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, index, '#0000FF');\n\t\t}\n\n\t\tthis.S2TableID = new Array(y);\n\t\tfor (i = 0; i <= y; i++) {\n\t\t\tif (i > 0) {\n\t\t\t\tthis.S2TableID[i - 1] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.S2TableID[i - 1],\n\t\t\t\t\tstr2.charAt(i - 1),\n\t\t\t\t\tTABLE_START_X - 2 * TABLE_ELEM_WIDTH,\n\t\t\t\t\tTABLE_START_Y + i * TABLE_ELEM_HEIGHT,\n\t\t\t\t);\n\t\t\t\tthis.oldIDs.push(this.S2TableID[i - 1]);\n\t\t\t}\n\t\t\tconst index = this.nextIndex++;\n\t\t\tthis.oldIDs.push(index);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tindex,\n\t\t\t\ti - 1 === -1 ? '\\u2205' : i - 1,\n\t\t\t\tTABLE_START_X - 1 * TABLE_ELEM_WIDTH,\n\t\t\t\tTABLE_START_Y + i * TABLE_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, index, '#0000FF');\n\t\t}\n\n\t\tfor (i = 0; i <= x; i++) {\n\t\t\tthis.tableID[i] = new Array(y + 1);\n\t\t\tthis.tableVals[i] = new Array(y + 1);\n\t\t\tthis.tableXPos[i] = new Array(y + 1);\n\t\t\tthis.tableYPos[i] = new Array(y + 1);\n\n\t\t\tfor (j = 0; j <= y; j++) {\n\t\t\t\tthis.tableID[i][j] = this.nextIndex++;\n\t\t\t\tthis.tableVals[i][j] = -1;\n\t\t\t\tthis.oldIDs.push(this.tableID[i][j]);\n\n\t\t\t\tthis.tableXPos[i][j] = TABLE_START_X + i * TABLE_ELEM_WIDTH;\n\t\t\t\tthis.tableYPos[i][j] = TABLE_START_Y + j * TABLE_ELEM_HEIGHT;\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.tableID[i][j],\n\t\t\t\t\t'',\n\t\t\t\t\tTABLE_ELEM_WIDTH,\n\t\t\t\t\tTABLE_ELEM_HEIGHT,\n\t\t\t\t\tthis.tableXPos[i][j],\n\t\t\t\t\tthis.tableYPos[i][j],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tclearOldIDs() {\n\t\tfor (let i = 0; i < this.oldIDs.length; i++) {\n\t\t\tthis.cmd(act.delete, this.oldIDs[i]);\n\t\t}\n\t\tthis.oldIDs = [];\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tbuildLCSFromTable(str1, str2) {\n\t\tlet currX = this.tableVals.length - 1;\n\t\tlet currY = this.tableVals[0].length - 1;\n\n\t\tconst sequence = [];\n\n\t\tconst header = this.nextIndex++;\n\t\tthis.oldIDs.push(header);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\theader,\n\t\t\t'Longest Common Subsequence:',\n\t\t\tSEQUENCE_START_X,\n\t\t\tSEQUENCE_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, header, '#003300');\n\n\t\tfor (let i = 1; i <= str1.length; i++) {\n\t\t\tfor (let j = 1; j <= str2.length; j++) {\n\t\t\t\tconst topThick = this.tableVals[i][j] !== this.tableVals[i][j - 1];\n\t\t\t\tconst leftThick = this.tableVals[i][j] !== this.tableVals[i - 1][j];\n\t\t\t\tif (topThick || leftThick) {\n\t\t\t\t\tthis.cmd(act.setRectangleEdgeThickness, this.tableID[i][j], [\n\t\t\t\t\t\ttopThick,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tleftThick,\n\t\t\t\t\t]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(9, 0);\n\t\tthis.unhighlight(10, 0);\n\t\tthis.unhighlight(11, 0);\n\t\tthis.unhighlight(12, 0);\n\n\t\twhile (currX > 0 && currY > 0) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.tableID[currX][currY], LCS_CELL_COLOR);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.unhighlight(14, 1);\n\t\t\tthis.unhighlight(15, 1);\n\t\t\tfor (let i = 16; i < 24; i++) {\n\t\t\t\tthis.unhighlight(i, 0);\n\t\t\t}\n\n\t\t\tthis.highlight(14, 1);\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 1);\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\t\n\t\t\tthis.unhighlight(14, 1);\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 0);\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 0);\n\n\t\t\tif (this.tableVals[currX - 1][currY] === this.tableVals[currX][currY - 1]) {\n\t\t\t\tthis.highlight(15, 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY - 1], 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\n\t\t\t\tthis.unhighlight(15, 1);\n\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY], 0);\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY - 1], 0);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.tableVals[currX - 1][currY] === this.tableVals[currX][currY - 1] &&\n\t\t\t\tthis.tableVals[currX - 1][currY] !== this.tableVals[currX][currY]\n\t\t\t) {\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[currX - 1], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[currY - 1], 1);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Hit a corner, move diagonally and add current character to LCS',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[currX - 1], 0);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[currY - 1], 0);\n\t\t\t} else {\n\t\t\t\tif (this.tableVals[currX - 1][currY] > this.tableVals[currX][currY - 1]) {\n\t\t\t\t\tthis.highlight(20, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 1);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tthis.unhighlight(20, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 0);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 0);\n\t\t\t\t\tthis.highlight(21, 0);\n\n\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Move left');\n\t\t\t\t} else {\n\t\t\t\t\tthis.highlight(23, 0);\n\n\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Move up');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.tableVals[currX - 1][currY] === this.tableVals[currX][currY - 1] &&\n\t\t\t\tthis.tableVals[currX - 1][currY] !== this.tableVals[currX][currY]\n\t\t\t) {\n\t\t\t\tconst nextSequenceID = this.nextIndex++;\n\t\t\t\tthis.oldIDs.push(nextSequenceID);\n\t\t\t\tsequence.push(nextSequenceID);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tnextSequenceID,\n\t\t\t\t\tstr1.charAt(currX - 1),\n\t\t\t\t\tSEQUENCE_START_X + (sequence.length - 1) * SEQUENCE_DELTA_X + 4,\n\t\t\t\t\tSEQUENCE_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, nextSequenceID, '#0000FF');\n\n\t\t\t\tfor (let i = sequence.length - 1; i >= 0; i--) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tsequence[i],\n\t\t\t\t\t\tSEQUENCE_START_X + (sequence.length - 1 - i) * SEQUENCE_DELTA_X + 4,\n\t\t\t\t\t\tSEQUENCE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis.highlight(16, 0);\n\t\t\t\tthis.highlight(17, 0);\n\t\t\t\tthis.highlight(18, 0);\n\n\t\t\t\tcurrX = currX - 1;\n\t\t\t\tcurrY = currY - 1;\n\t\t\t} else {\n\t\t\t\tif (this.tableVals[currX - 1][currY] > this.tableVals[currX][currY - 1]) {\n\t\t\t\t\tcurrX = currX - 1;\n\t\t\t\t\tthis.highlight(21, 0);\n\t\t\t\t} else {\n\t\t\t\t\tcurrY = currY - 1;\n\t\t\t\t\tthis.highlight(23, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let i = 16; i < 24; i++) {\n\t\t\tthis.unhighlight(i, 0);\n\t\t}\n\t\tthis.highlight(24, 0);\n\t\tthis.cmd(act.step);\n\t}\n\n\thighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\n\t}\n\n\tunhighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRAY_ELEMS_PER_LINE = 14;\nconst ARRAY_LINE_SPACING = 130;\n\nconst FRONT_POS_X = 180;\nconst FRONT_POS_Y = 100;\nconst FRONT_LABEL_X = 130;\nconst FRONT_LABEL_Y = 100;\n\nconst SIZE_POS_X = 280;\nconst SIZE_POS_Y = 100;\nconst SIZE_LABEL_X = 230;\nconst SIZE_LABEL_Y = 100;\n\nconst QUEUE_LABEL_X = 50;\nconst QUEUE_LABEL_Y = 30;\nconst QUEUE_ELEMENT_X = 120;\nconst QUEUE_ELEMENT_Y = 30;\n\nconst RESIZE_ARRAY_START_X = 100;\nconst RESIZE_ARRAY_START_Y = 300;\nconst QUEUE_RESIZE_LABEL_X = 60;\nconst QUEUE_RESIZE_LABEL_Y = 60;\n\nconst FRONT_LABEL_OFFSET = -40;\n\n\nconst INDEX_COLOR = '#0000FF';\n\nconst SIZE = 7;\nconst MAX_SIZE = 30;\n\nexport default class DequeArray extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\t// Add's value text field\n\t\tthis.addField = addControlToAlgorithmBar('Text', '');\n\t\tthis.addField.onkeydown = this.returnSubmit(this.addField, null, 4);\n\t\tthis.controls.push(this.addField);\n\n\t\t// Add first button\n\t\tthis.addFirstButton = addControlToAlgorithmBar('Button', 'Add First');\n\t\tthis.addFirstButton.onclick = this.addFirstCallBack.bind(this);\n\t\tthis.controls.push(this.addFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Add last button\n\t\tthis.addLastButton = addControlToAlgorithmBar('Button', 'Add Last');\n\t\tthis.addLastButton.onclick = this.addLastCallback.bind(this);\n\t\tthis.controls.push(this.addLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Remove first button\n\t\tthis.removeFirstButton = addControlToAlgorithmBar('Button', 'Remove First');\n\t\tthis.removeFirstButton.onclick = this.removeFirstCallback.bind(this);\n\t\tthis.controls.push(this.removeFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Remove last button\n\t\tthis.removeLastButton = addControlToAlgorithmBar('Button', 'Remove Last');\n\t\tthis.removeLastButton.onclick = this.removeLastCallback.bind(this);\n\t\tthis.controls.push(this.removeLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.frontID = this.nextIndex++;\n\t\tconst frontLabelID = this.nextIndex++;\n\t\tthis.frontPointerID = this.nextIndex++;\n\t\tthis.sizeID = this.nextIndex++;\n\t\tconst sizeLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, frontLabelID, 'Front', FRONT_LABEL_X, FRONT_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.frontID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, sizeLabelID, 'Size', SIZE_LABEL_X, SIZE_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.sizeID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tSIZE_POS_X,\n\t\t\tSIZE_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel,\n\t\t\tthis.frontPointerID,\n\t\t\t'Front',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + FRONT_LABEL_OFFSET);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', QUEUE_LABEL_X, QUEUE_LABEL_Y, false);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.arrayID = new Array(SIZE); \n\t\tthis.arrayLabelID = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.nextIndex = this.nextIndex + 7;\n\t}\n\n\taddLastCallback() {\n\t\tif (this.size < this.arrayData.length && this.addField.value !== '') {\n\t\t\tconst pushVal = this.addField.value;\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.addLast.bind(this), pushVal);\n\t\t} else if (this.size === this.arrayData.length \n\t\t\t&& this.addField.value !== ''\n\t\t\t&& this.size * 2 < MAX_SIZE) {\n\t\t\t\tconst pushVal = this.addField.value;\n\t\t\t\tthis.addField.value = '';\n\t\t\t\tthis.implementAction(this.resize.bind(this), pushVal, false);\n\t\t\t}\n\t}\n\n\tremoveFirstCallback() {\n\t\tif (this.size !== 0) {\n\t\t\tthis.implementAction(this.removeFirst.bind(this));\n\t\t}\n\t}\n\n\tremoveLastCallback() {\n\t\tif (this.size !== 0) {\n\t\t\tthis.implementAction(this.removeLast.bind(this));\n\t\t}\n\t}\n\n\taddFirstCallBack() {\n\t\tif (this.size < this.arrayData.length && this.addField.value !== '') {\n\t\t\tconst pushVal = this.addField.value;\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.addFirst.bind(this), pushVal);\n\t\t} else if (this.size === this.arrayData.length\n\t\t\t&& this.addField.value !== ''\n\t\t\t&& this.size * 2 < MAX_SIZE) {\n\t\t\t\tconst pushVal = this.addField.value;\n\t\t\t\tthis.addField.value = '';\n\t\t\t\tthis.implementAction(this.resize.bind(this), pushVal, true);\n\t\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\taddLast(elemToAddLast) {\n\t\tthis.commands = [];\n\n\t\tconst labAddLastID = this.nextIndex++;\n\t\tconst labAddLastValID = this.nextIndex++;\n\t\tconst addIndex = (this.front + this.size) % this.arrayData.length;\n\n\t\tthis.arrayData[addIndex] = elemToAddLast;\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X + 100, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labAddLastID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labAddLastValID, elemToAddLast, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.leftoverLabelID,\n\t\t\t`Adding ${elemToAddLast} to back at index (${this.front} + ${this.size}) % ${this.arrayData.length}`,\n\t\t);\n\n\t\tconst xpos = (addIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(addIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labAddLastValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[addIndex], elemToAddLast);\n\t\tthis.cmd(act.delete, labAddLastValID);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.delete, labAddLastID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\taddFirst(elemToAdd) {\n\t\tthis.commands = [];\n\n\t\tconst labelAddID = this.nextIndex++;\n\t\tconst labelAddIDVal = this.nextIndex++;\n\n\t\tconst addIndex = (this.front - 1 + this.arrayData.length) % this.arrayData.length;\n\n\t\tconst xpos = (addIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(addIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.arrayData[addIndex] = elemToAdd;\n\n\t\tthis.cmd(act.createLabel, labelAddID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labelAddIDVal, elemToAdd, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X + 100, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\tINDEX_COLOR,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.leftoverLabelID,\n\t\t\t`Adding ${elemToAdd} to front at index (${this.front} - 1) % ${this.arrayData.length}`,\n\t\t);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(\n\t\t\tact.move,\n\t\t\tthis.highlight1ID,\n\t\t\tthis.front * ARRAY_ELEM_WIDTH + ARRAY_START_X,\n\t\t\typos + ARRAY_ELEM_HEIGHT,\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, labelAddIDVal, xpos, ypos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, labelAddIDVal);\n\n\t\tthis.front = addIndex;\n\n\t\tconst frontxpos = (addIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst frontypos =\n\t\t\tMath.floor(addIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING \n\t\t\t+ ARRAY_START_Y + FRONT_LABEL_OFFSET;\n\t\t\n\n\t\tthis.cmd(act.setText, this.arrayID[addIndex], elemToAdd);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, this.frontPointerID, frontxpos, frontypos);\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.sizeID, this.size + 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.delete, labelAddID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.size++;\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tremoveFirst() {\n\t\tthis.commands = [];\n\n\t\tconst labremoveFirstID = this.nextIndex++;\n\t\tconst labremoveFirstValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabremoveFirstID,\n\t\t\t'removeFirst Value: ',\n\t\t\tQUEUE_LABEL_X,\n\t\t\tQUEUE_LABEL_Y,\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\tINDEX_COLOR,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.front % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.front / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tconst removeFirstdVal = this.arrayData[this.front];\n\t\tthis.cmd(act.createLabel, labremoveFirstValID, removeFirstdVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[this.front], '');\n\t\tthis.cmd(act.move, labremoveFirstValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.front = (this.front + 1) % this.arrayData.length;\n\t\tconst frontxpos = (this.front % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst frontypos =\n\t\t\tMath.floor(this.front / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING \n\t\t\t+ ARRAY_START_Y + FRONT_LABEL_OFFSET;\n\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.move, this.frontPointerID, frontxpos, frontypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'removeFirst Value: ' + removeFirstdVal);\n\n\t\tthis.cmd(act.delete, labremoveFirstID);\n\t\tthis.cmd(act.delete, labremoveFirstValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size--;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tremoveLast() {\n\t\tthis.commands = [];\n\t\tconst remLabelID = this.nextIndex++;\n\t\tconst remLabelValID = this.nextIndex++;\n\n\t\tconst remIndex = (this.front + this.size - 1 + this.arrayData.length) % this.arrayData.length;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(act.createLabel, remLabelID, 'Removed Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\tINDEX_COLOR,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight2ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (remIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(remIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, this.highlight2ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.delete, this.highlight2ID);\n\n\t\tconst removedVal = this.arrayData[remIndex];\n\t\tthis.cmd(act.createLabel, remLabelValID, removedVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[remIndex], '');\n\t\tthis.cmd(act.move, remLabelValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Removed Value: ' + removedVal);\n\n\t\tthis.cmd(act.delete, remLabelID);\n\t\tthis.cmd(act.delete, remLabelValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.sizeID, this.size - 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.size--;\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tresize(elemToEnqueue, isFront) {\n\t\tthis.commands = [];\n\n\t\tconst labEnqueueID = this.nextIndex++;\n\t\tconst labEnqueueValID = this.nextIndex++;\n\t\tconst labEnqueueResizeID = this.nextIndex++;\n\n\t\tthis.arrayIDNew = new Array(this.size * 2);\n\t\tthis.arrayLabelIDNew = new Array(this.size * 2);\n\t\tthis.arrayDataNew = new Array(this.size * 2);\n\n\t\tconst frontOffset = (isFront) ? 1 : 0;\n\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tthis.arrayIDNew[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelIDNew[i] = this.nextIndex++;\n\t\t\tif (i < this.size) {\n\t\t\t\tthis.arrayDataNew[i + frontOffset] = this.arrayData[(this.front + i) % this.arrayData.length];\n\t\t\t}\n\t\t}\n\n\t\tconst extra = (isFront) ? \": elements shifted by 1\" : '';\n\n\t\tthis.cmd(act.createLabel, labEnqueueID, 'Enqueuing Value:', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labEnqueueValID, elemToEnqueue, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel, \n\t\t\tlabEnqueueResizeID, \n\t\t\t`(Resize Required${extra})`, \n\t\t\t(isFront) ? QUEUE_RESIZE_LABEL_X + 100 : QUEUE_RESIZE_LABEL_X, \n\t\t\tQUEUE_RESIZE_LABEL_Y\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\t//Create new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING \n\t\t\t+ (RESIZE_ARRAY_START_Y);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayIDNew[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelIDNew[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelIDNew[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\t//Move old elements to new array\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst xposinit = (((this.front + i) % this.arrayData.length) % ARRAY_ELEMS_PER_LINE) \n\t\t\t* ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yposinit = Math.floor(((this.front + i) % this.arrayData.length) / ARRAY_ELEMS_PER_LINE) \n\t\t\t* ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tconst xpos = (((i + frontOffset) % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X);\n\t\t\tconst ypos = Math.floor((i + frontOffset) / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i],\n\t\t\t\tthis.arrayData[(this.front + i) % this.arrayData.length],\n\t\t\t\txposinit,\n\t\t\t\typosinit\n\t\t\t);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos, ypos);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\t//Delete movement objects and set text\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\tthis.cmd(act.setText, this.arrayIDNew[i + frontOffset], this.arrayDataNew[i + frontOffset]);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//Delete old array\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t\tthis.cmd(act.delete, this.arrayLabelID[i]);\n\t\t}\n\n\t\t//Move new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = ((i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X);\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tthis.cmd(act.move, this.arrayIDNew[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.arrayLabelIDNew[i], xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.front = 0;\n\t\tthis.arrayID = this.arrayIDNew;\n\t\tthis.arrayLabelID = this.arrayLabelIDNew;\n\t\tthis.arrayData = this.arrayDataNew;\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.move, this.frontPointerID, ARRAY_START_X, ARRAY_START_Y + FRONT_LABEL_OFFSET);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\t//Delete '(resize required)' text, create circle at the \"size\" object, add enqueue text\n\t\t\n\t\tconst addIndex = (!isFront) ? (this.front + this.size) % this.arrayDataNew.length : this.front;\n\n\t\tthis.cmd(act.delete, labEnqueueResizeID);\n\n\t\t//Just so the element travels over the array instead of underneath it\n\t\tthis.cmd(act.delete, labEnqueueValID);\n\t\tconst labEnqueueValIDNew = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, labEnqueueValIDNew, elemToEnqueue, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (isFront) {\n\t\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, FRONT_POS_X, FRONT_POS_Y);\n\t\t} else {\n\t\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (addIndex % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(addIndex / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\n\n\t\tthis.cmd(\n\t\t\tact.move,\n\t\t\tthis.highlight1ID,\n\t\t\tthis.front * ARRAY_ELEM_WIDTH + ARRAY_START_X,\n\t\t\typos + ARRAY_ELEM_HEIGHT,\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, labEnqueueValIDNew, xpos, ypos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, labEnqueueValIDNew);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.arrayData[addIndex] = elemToEnqueue;\n\t\tthis.cmd(act.setText, this.arrayID[addIndex], elemToEnqueue);\n\t\tthis.cmd(act.step);\n\n\t\t\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.sizeID, this.size + 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\n\t\tthis.cmd(act.delete, labEnqueueID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.size++;\n\n\t\tthis.nextIndex = this.nextIndex - this.size;\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.cmd(act.setText, this.frontID, '0');\n\t\tthis.cmd(act.setText, this.sizeID, '0');\n\t\tthis.cmd(\n\t\t\tact.setPosition, \n\t\t\tthis.frontPointerID, \n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + FRONT_LABEL_OFFSET);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 100;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 150;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 32;\n\nexport default class DequeLL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\t// Add's value text field\n\t\tthis.addField = addControlToAlgorithmBar('Text', '');\n\t\tthis.addField.onkeydown = this.returnSubmit(this.addField, null, 4);\n\t\tthis.controls.push(this.addField);\n\n\t\t// Add first button\n\t\tthis.addFirstButton = addControlToAlgorithmBar('Button', 'Add First');\n\t\tthis.addFirstButton.onclick = this.addFirstCallback.bind(this);\n\t\tthis.controls.push(this.addFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Add last button\n\t\tthis.addLastButton = addControlToAlgorithmBar('Button', 'Add Last');\n\t\tthis.addLastButton.onclick = this.addLastCallback.bind(this);\n\t\tthis.controls.push(this.addLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Remove first button\n\t\tthis.removeFirstButton = addControlToAlgorithmBar('Button', 'Remove First');\n\t\tthis.removeFirstButton.onclick = this.removeFirstCallback.bind(this);\n\t\tthis.controls.push(this.removeFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Remove last button\n\t\tthis.removeLastButton = addControlToAlgorithmBar('Button', 'Remove Last');\n\t\tthis.removeLastButton.onclick = this.removeLastCallback.bind(this);\n\t\tthis.controls.push(this.removeLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddFirstCallback() {\n\t\tif (this.addField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addField.value);\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddLastCallback() {\n\t\tif (this.addField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addField.value);\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveFirstCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveLastCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// getCallback(event)\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createDoublyLinkedListNode,\n\t\t\tthis.linkedListElemID[index],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (index === 0) {\n\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (index === this.size) {\n\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (this.size !== 0) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t} else if (index === this.size) {\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.resetNodePositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 1);\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 1);\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[index]);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n}\n","class PriorityQueue {\n\tconstructor() {\n\t\tthis.backingArray = [];\n\t}\n\n\tenqueue(data, id, priority) {\n\t\tthis.backingArray.push([data, id, priority]);\n\t\tthis.backingArray.sort((a, b) => {\n\t\t\tif (a[2] !== b[2]) {\n\t\t\t\treturn a[2] - b[2];\n\t\t\t} else {\n\t\t\t\tif (Array.isArray(a[0])) {\n\t\t\t\t\tif (a[0][0] !== b[0][0]) {\n\t\t\t\t\t\treturn a[0][0] - b[0][0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn a[0][1] - b[0][1];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn a[0] - b[0];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tdequeue() {\n\t\tconst x = this.backingArray.shift();\n\t\treturn [x[0], x[1]];\n\t}\n\n\tsize() {\n\t\treturn this.backingArray.length;\n\t}\n\n\tgetIDs() {\n\t\treturn this.backingArray.map(x => x[1]);\n\t}\n}\n\nexport default PriorityQueue;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { VERTEX_INDEX_COLOR } from './Graph.js';\nimport {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { DIJKSTRAS_ADJ_LIST } from './util/GraphValues';\nimport PriorityQueue from './util/PriorityQueue';\nimport { act } from '../anim/AnimationMain';\n\nconst PQ_DEQUEUED_COLOR = '#0000FF';\nconst VISITED_COLOR = '#99CCFF';\n\nconst INFO_MSG_X = 25;\nconst INFO_MSG_Y = 15;\n\nconst VISITED_START_X = 30;\nconst VISITED_START_Y = 65;\nconst VISITED_SPACING = 20;\n\nconst CURRENT_VERTEX_LABEL_X = 25;\nconst CURRENT_VERTEX_LABEL_Y = 85;\nconst CURRENT_VERTEX_X = 110;\nconst CURRENT_VERTEX_Y = 85;\n\nconst PQ_LABEL_X = 25;\nconst PQ_LABEL_Y = 110;\n\nconst PQ_X = 110;\nconst PQ_Y = 110;\nconst PQ_SPACING = 42;\nconst PQ_LINE_SPACING = 25;\nconst PQ_MAX_PER_LINE = 9;\n\nconst TABLE_ENTRY_WIDTH = 50;\nconst SMALL_TABLE_ENTRY_HEIGHT = 20;\nconst LARGE_TABLE_ENTRY_HEIGHT = 17;\nconst TABLE_START_X = 50;\nconst TABLE_START_Y = 180;\n\nexport default class Dijkstras extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, DIJKSTRAS_ADJ_LIST, false, false, true);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start vertex: ');\n\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse,\n\t\t);\n\t\tthis.startField.size = 2;\n\t\tthis.controls.push(this.startField);\n\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\n\t\tthis.commands = [];\n\n\t\tthis.vertexID = new Array(this.size);\n\n\t\tthis.distance = new Array(this.size);\n\t\tthis.distanceID = new Array(this.size);\n\n\t\tthis.visited = [];\n\t\tthis.visitedID = [];\n\n\t\tthis.pq = new PriorityQueue();\n\n\t\tthis.tableEntryHeight = this.isLarge ? LARGE_TABLE_ENTRY_HEIGHT : SMALL_TABLE_ENTRY_HEIGHT;\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.vertexID[i] = this.nextIndex++;\n\t\t\tthis.distanceID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.vertexID[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tTABLE_ENTRY_WIDTH,\n\t\t\t\tthis.tableEntryHeight,\n\t\t\t\tTABLE_START_X,\n\t\t\t\tTABLE_START_Y + i * this.tableEntryHeight,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.distanceID[i],\n\t\t\t\t'',\n\t\t\t\tTABLE_ENTRY_WIDTH,\n\t\t\t\tthis.tableEntryHeight,\n\t\t\t\tTABLE_START_X + TABLE_ENTRY_WIDTH,\n\t\t\t\tTABLE_START_Y + i * this.tableEntryHeight,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.vertexID[i], VERTEX_INDEX_COLOR);\n\t\t}\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited Set:',\n\t\t\tVISITED_START_X - 5,\n\t\t\tVISITED_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current vertex:',\n\t\t\tCURRENT_VERTEX_LABEL_X,\n\t\t\tCURRENT_VERTEX_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.createLabel, this.nextIndex++, 'Priority Queue:', PQ_LABEL_X, PQ_LABEL_Y, 0);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Distance Map:',\n\t\t\tTABLE_START_X + 0.5 * TABLE_ENTRY_WIDTH,\n\t\t\tTABLE_START_Y - SMALL_TABLE_ENTRY_HEIGHT,\n\t\t);\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.comparisonMessageID = this.nextIndex++;\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.messageID = [];\n\t\tthis.visitedID = [];\n\t\tthis.pq = new PriorityQueue();\n\t}\n\n\tstartCallback() {\n\t\tlet startvalue;\n\n\t\tif (this.startField.value !== '') {\n\t\t\tstartvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size)\n\t\t\t\tthis.implementAction(this.doDijkstra.bind(this), startvalue);\n\t\t}\n\t}\n\n\tdoDijkstra(startVertex) {\n\t\tthis.commands = [];\n\n\t\tlet current = startVertex;\n\t\tlet currentID = this.nextIndex++;\n\n\t\tthis.clear();\n\n\t\tthis.visitedID = [];\n\n\t\tthis.distance[current] = 0;\n\t\tthis.cmd(act.setText, this.distanceID[current], 0);\n\n\t\tthis.pq = new PriorityQueue();\n\t\tthis.pq.enqueue(current, currentID, 0);\n\t\tthis.cmd(act.createLabel, currentID, '(' + this.toStr(current) + ', 0)', PQ_X, PQ_Y, 0);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Enqueueing ' + this.toStr(current) + ' with distance 0 and updating distance map',\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\twhile (this.visited.includes(false) && this.pq.size() !== 0) {\n\t\t\t[current, currentID] = this.pq.dequeue();\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Dequeueing ' + this.toStr(current));\n\t\t\tthis.cmd(act.move, currentID, CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\t\t\tthis.cmd(act.setText, currentID, this.toStr(current));\n\t\t\tthis.cmd(act.setTextColor, currentID, PQ_DEQUEUED_COLOR);\n\t\t\tlet pqIDs = this.pq.getIDs();\n\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tpqIDs[i],\n\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\tPQ_Y + Math.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.visitVertex(current);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (!this.visited[current]) {\n\t\t\t\tthis.visited[current] = true;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Adding ' + this.toStr(current) + ' to visited set',\n\t\t\t\t);\n\t\t\t\tthis.visitedID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\tthis.toStr(current),\n\t\t\t\t\tVISITED_START_X + (this.visitedID.length - 1) * VISITED_SPACING,\n\t\t\t\t\tVISITED_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[current], VISITED_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Updating neighbors of vertex ' + this.toStr(current),\n\t\t\t\t);\n\t\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\t\tif (this.adj_matrix[current][neighbor] >= 0) {\n\t\t\t\t\t\tthis.highlightEdge(current, neighbor, 1);\n\t\t\t\t\t\tif (this.visited[neighbor]) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\tthis.toStr(neighbor) + ' has already been visited, skipping',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Comparing distances');\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 1);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[neighbor], 1);\n\t\t\t\t\t\t\tconst curDist = this.distance[current];\n\t\t\t\t\t\t\tconst edgDist = this.adj_matrix[current][neighbor];\n\t\t\t\t\t\t\tconst newDist = curDist + edgDist;\n\t\t\t\t\t\t\tconst oldDist = this.distance[neighbor];\n\t\t\t\t\t\t\tconst oldDistStr =\n\t\t\t\t\t\t\t\toldDist >= 0 ? String(this.distance[neighbor]) : 'INF';\n\n\t\t\t\t\t\t\tif (oldDist < 0 || newDist < oldDist) {\n\t\t\t\t\t\t\t\tthis.distance[neighbor] = newDist;\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\n\t\t\t\t\t\t\t\t\t'New distance (' +\n\t\t\t\t\t\t\t\t\t\tcurDist +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tedgDist +\n\t\t\t\t\t\t\t\t\t\t' = ' +\n\t\t\t\t\t\t\t\t\t\tnewDist +\n\t\t\t\t\t\t\t\t\t\t') is less than old distance (' +\n\t\t\t\t\t\t\t\t\t\toldDistStr +\n\t\t\t\t\t\t\t\t\t\t'), updating',\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 2 * TABLE_ENTRY_WIDTH - 15,\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * this.tableEntryHeight - 5,\n\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Updating distance');\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tthis.distanceID[neighbor],\n\t\t\t\t\t\t\t\t\tthis.distance[neighbor],\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[neighbor], 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, this.comparisonMessageID);\n\t\t\t\t\t\t\t\tthis.pq.enqueue(neighbor, this.nextIndex, newDist);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\t\t'Enqueueing ' +\n\t\t\t\t\t\t\t\t\t\tthis.toStr(neighbor) +\n\t\t\t\t\t\t\t\t\t\t' with distance ' +\n\t\t\t\t\t\t\t\t\t\tnewDist,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\t\t\t'(' + this.toStr(neighbor) + ', ' + newDist + ')',\n\t\t\t\t\t\t\t\t\tPQ_X + ((this.pq.size() - 1) % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\t\t\tPQ_Y +\n\t\t\t\t\t\t\t\t\t\tMath.floor((this.pq.size() - 1) / PQ_MAX_PER_LINE) *\n\t\t\t\t\t\t\t\t\t\t\tPQ_LINE_SPACING,\n\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\t\tconst newPqIDs = this.pq.getIDs();\n\t\t\t\t\t\t\t\tif (String(pqIDs) !== String(newPqIDs.slice(0, -1))) {\n\t\t\t\t\t\t\t\t\t// Check if newly enqueued element shifted things\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\t\t\tnewPqIDs[i],\n\t\t\t\t\t\t\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\t\t\t\t\tPQ_Y +\n\t\t\t\t\t\t\t\t\t\t\t\tMath.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpqIDs = newPqIDs;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\n\t\t\t\t\t\t\t\t\t'New distance (' +\n\t\t\t\t\t\t\t\t\t\tcurDist +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tedgDist +\n\t\t\t\t\t\t\t\t\t\t' = ' +\n\t\t\t\t\t\t\t\t\t\tnewDist +\n\t\t\t\t\t\t\t\t\t\t') is greater than or equal to old distance (' +\n\t\t\t\t\t\t\t\t\t\toldDistStr +\n\t\t\t\t\t\t\t\t\t\t'), skipping',\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 2 * TABLE_ENTRY_WIDTH - 15,\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * this.tableEntryHeight - 5,\n\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, this.comparisonMessageID);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 0);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[neighbor], 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.highlightEdge(current, neighbor, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\tthis.toStr(current) + ' has already been visited, skipping',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.leaveVertex();\n\t\t\tthis.cmd(act.delete, currentID);\n\t\t}\n\n\t\tif (this.pq.size() > 0) {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'All vertices have been visited, done');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Priority queue is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], '#FFFFFF');\n\t\t\tthis.cmd(act.setText, this.distanceID[i], 'INF');\n\t\t\tthis.visited[i] = false;\n\t\t\tthis.distance[i] = -1;\n\t\t}\n\t\tfor (let i = 0; i < this.visitedID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.visitedID[i]);\n\t\t}\n\t\tconst pqIDs = this.pq.getIDs();\n\t\tfor (const id of pqIDs) {\n\t\t\tthis.cmd(act.delete, id);\n\t\t}\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.messageID = [];\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 100;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 150;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 32;\n\nexport default class DoublyLinkedList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Front',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Back',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add at Index',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Index',\n\t\t\tremoveTopHorizontalGroup,\n\t\t);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Front',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Back',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddIndexCallback() {\n\t\tif (this.addValueField.value !== '' && this.addIndexField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// DoublyLinkedList.prototype.getCallback = function(event)\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createDoublyLinkedListNode,\n\t\t\tthis.linkedListElemID[index],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (index === 0) {\n\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (index === this.size) {\n\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (this.size !== 0) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t} else if (index === this.size) {\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.resetNodePositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 1);\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 1);\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[index]);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { LARGE_SIZE, SMALL_SIZE } from './Graph.js';\nimport { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst SMALL_COST_TABLE_WIDTH = 30;\nconst SMALL_COST_TABLE_HEIGHT = 30;\nconst SMALL_COST_TABLE_START_X = 40;\nconst SMALL_COST_TABLE_START_Y = 70;\n\nconst SMALL_PATH_TABLE_WIDTH = 30;\nconst SMALL_PATH_TABLE_HEIGHT = 30;\nconst SMALL_PATH_TABLE_START_X = 330;\nconst SMALL_PATH_TABLE_START_Y = 70;\n\nconst SMALL_NODE_1_X_POS = 50;\nconst SMALL_NODE_1_Y_POS = 400;\nconst SMALL_NODE_2_X_POS = 150;\nconst SMALL_NODE_2_Y_POS = 350;\nconst SMALL_NODE_3_X_POS = 250;\nconst SMALL_NODE_3_Y_POS = 400;\n\nconst SMALL_MESSAGE_X = 400;\nconst SMALL_MESSAGE_Y = 350;\n\nconst LARGE_COST_TABLE_WIDTH = 20;\nconst LARGE_COST_TABLE_HEIGHT = 20;\nconst LARGE_COST_TABLE_START_X = 40;\nconst LARGE_COST_TABLE_START_Y = 50;\n\nconst LARGE_PATH_TABLE_WIDTH = 20;\nconst LARGE_PATH_TABLE_HEIGHT = 20;\nconst LARGE_PATH_TABLE_START_X = 500;\nconst LARGE_PATH_TABLE_START_Y = 50;\n\nconst LARGE_NODE_1_X_POS = 50;\nconst LARGE_NODE_1_Y_POS = 500;\nconst LARGE_NODE_2_X_POS = 150;\nconst LARGE_NODE_2_Y_POS = 450;\nconst LARGE_NODE_3_X_POS = 250;\nconst LARGE_NODE_3_Y_POS = 500;\n\nconst LARGE_MESSAGE_X = 300;\nconst LARGE_MESSAGE_Y = 450;\n\nexport default class Floyd extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, [], false, false, true);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t\tthis.smallGraphButton.onclick = this.smallGraphCallback.bind(this);\n\t\tthis.largeGraphButton.onclick = this.largeGraphCallback.bind(this);\n\t}\n\n\treset() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tthis.costTable[i][j] = this.adj_matrix[i][j];\n\t\t\t\tif (this.costTable[i][j] >= 0) {\n\t\t\t\t\tthis.pathTable[i][j] = i;\n\t\t\t\t} else {\n\t\t\t\t\tthis.pathTable[i][j] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsmallGraphCallback() {\n\t\tif (this.size !== SMALL_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\t\tthis.logicalButton.disabled = false;\n\t\t\tthis.adjacencyListButton.disabled = false;\n\t\t\tthis.adjacencyMatrixButton.disabled = false;\n\t\t\tthis.setup_small();\n\t\t}\n\t}\n\n\tlargeGraphCallback() {\n\t\tif (this.size !== LARGE_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\t//this.animationManager.setAllLayers([0]);\n\t\t\tthis.logicalButton.disabled = true;\n\t\t\tthis.adjacencyListButton.disabled = true;\n\t\t\tthis.adjacencyMatrixButton.disabled = true;\n\t\t\tthis.setup_large();\n\t\t}\n\t}\n\n\tgetCostLabel(value, alwaysUseINF) {\n\t\talwaysUseINF = alwaysUseINF === undefined ? false : alwaysUseINF;\n\t\tif (value >= 0) {\n\t\t\treturn String(value);\n\t\t} else if (this.size === SMALL_SIZE || alwaysUseINF) {\n\t\t\treturn 'INF';\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tsetup_small() {\n\t\tthis.cost_table_width = SMALL_COST_TABLE_WIDTH;\n\t\tthis.cost_table_height = SMALL_COST_TABLE_HEIGHT;\n\t\tthis.cost_table_start_x = SMALL_COST_TABLE_START_X;\n\t\tthis.cost_table_start_y = SMALL_COST_TABLE_START_Y;\n\n\t\tthis.path_table_width = SMALL_PATH_TABLE_WIDTH;\n\t\tthis.path_table_height = SMALL_PATH_TABLE_HEIGHT;\n\t\tthis.path_table_start_x = SMALL_PATH_TABLE_START_X;\n\t\tthis.path_table_start_y = SMALL_PATH_TABLE_START_Y;\n\n\t\tthis.node_1_x_pos = SMALL_NODE_1_X_POS;\n\t\tthis.node_1_y_pos = SMALL_NODE_1_Y_POS;\n\t\tthis.node_2_x_pos = SMALL_NODE_2_X_POS;\n\t\tthis.node_2_y_pos = SMALL_NODE_2_Y_POS;\n\t\tthis.node_3_x_pos = SMALL_NODE_3_X_POS;\n\t\tthis.node_3_y_pos = SMALL_NODE_3_Y_POS;\n\n\t\tthis.message_x = SMALL_MESSAGE_X;\n\t\tthis.message_y = SMALL_MESSAGE_Y;\n\t\tsuper.setup_small();\n\t}\n\n\tsetup_large() {\n\t\tthis.cost_table_width = LARGE_COST_TABLE_WIDTH;\n\t\tthis.cost_table_height = LARGE_COST_TABLE_HEIGHT;\n\t\tthis.cost_table_start_x = LARGE_COST_TABLE_START_X;\n\t\tthis.cost_table_start_y = LARGE_COST_TABLE_START_Y;\n\n\t\tthis.path_table_width = LARGE_PATH_TABLE_WIDTH;\n\t\tthis.path_table_height = LARGE_PATH_TABLE_HEIGHT;\n\t\tthis.path_table_start_x = LARGE_PATH_TABLE_START_X;\n\t\tthis.path_table_start_y = LARGE_PATH_TABLE_START_Y;\n\n\t\tthis.node_1_x_pos = LARGE_NODE_1_X_POS;\n\t\tthis.node_1_y_pos = LARGE_NODE_1_Y_POS;\n\t\tthis.node_2_x_pos = LARGE_NODE_2_X_POS;\n\t\tthis.node_2_y_pos = LARGE_NODE_2_Y_POS;\n\t\tthis.node_3_x_pos = LARGE_NODE_3_X_POS;\n\t\tthis.node_3_y_pos = LARGE_NODE_3_Y_POS;\n\n\t\tthis.message_x = LARGE_MESSAGE_X;\n\t\tthis.message_y = LARGE_MESSAGE_Y;\n\n\t\tsuper.setup_large();\n\t}\n\n\tsetup() {\n\t\tsuper.setup();\n\t\tthis.commands = [];\n\n\t\tthis.costTable = new Array(this.size);\n\t\tthis.pathTable = new Array(this.size);\n\t\tthis.costTableID = new Array(this.size);\n\t\tthis.pathTableID = new Array(this.size);\n\t\tthis.pathIndexXID = new Array(this.size);\n\t\tthis.pathIndexYID = new Array(this.size);\n\t\tthis.costIndexXID = new Array(this.size);\n\t\tthis.costIndexYID = new Array(this.size);\n\n\t\tthis.node1ID = this.nextIndex++;\n\t\tthis.node2ID = this.nextIndex++;\n\t\tthis.node3ID = this.nextIndex++;\n\n\t\tlet i;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.costTable[i] = new Array(this.size);\n\t\t\tthis.pathTable[i] = new Array(this.size);\n\t\t\tthis.costTableID[i] = new Array(this.size);\n\t\t\tthis.pathTableID[i] = new Array(this.size);\n\t\t}\n\n\t\tconst costTableHeader = this.nextIndex++;\n\t\tconst pathTableHeader = this.nextIndex++;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tcostTableHeader,\n\t\t\t'Cost Table',\n\t\t\tthis.cost_table_start_x,\n\t\t\tthis.cost_table_start_y - 2 * this.cost_table_height,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tpathTableHeader,\n\t\t\t'Path Table',\n\t\t\tthis.path_table_start_x,\n\t\t\tthis.path_table_start_y - 2 * this.path_table_height,\n\t\t\t0,\n\t\t);\n\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.pathIndexXID[i] = this.nextIndex++;\n\t\t\tthis.pathIndexYID[i] = this.nextIndex++;\n\t\t\tthis.costIndexXID[i] = this.nextIndex++;\n\t\t\tthis.costIndexYID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.pathIndexXID[i],\n\t\t\t\ti,\n\t\t\t\tthis.path_table_start_x + i * this.path_table_width,\n\t\t\t\tthis.path_table_start_y - this.path_table_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.pathIndexXID[i], '#0000FF');\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.pathIndexYID[i],\n\t\t\t\ti,\n\t\t\t\tthis.path_table_start_x - this.path_table_width,\n\t\t\t\tthis.path_table_start_y + i * this.path_table_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.pathIndexYID[i], '#0000FF');\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.costIndexXID[i],\n\t\t\t\ti,\n\t\t\t\tthis.cost_table_start_x + i * this.cost_table_width,\n\t\t\t\tthis.cost_table_start_y - this.cost_table_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.costIndexXID[i], '#0000FF');\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.costIndexYID[i],\n\t\t\t\ti,\n\t\t\t\tthis.cost_table_start_x - this.cost_table_width,\n\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.costIndexYID[i], '#0000FF');\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tthis.costTable[i][j] = this.adj_matrix[i][j];\n\t\t\t\tif (this.costTable[i][j] >= 0) {\n\t\t\t\t\tthis.pathTable[i][j] = i;\n\t\t\t\t} else {\n\t\t\t\t\tthis.pathTable[i][j] = -1;\n\t\t\t\t}\n\t\t\t\tthis.costTableID[i][j] = this.nextIndex++;\n\t\t\t\tthis.pathTableID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.costTableID[i][j],\n\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true),\n\t\t\t\t\tthis.cost_table_width,\n\t\t\t\t\tthis.cost_table_height,\n\t\t\t\t\tthis.cost_table_start_x + j * this.cost_table_width,\n\t\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.pathTableID[i][j],\n\t\t\t\t\tthis.pathTable[i][j],\n\t\t\t\t\tthis.path_table_width,\n\t\t\t\t\tthis.path_table_height,\n\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\n\t\t\t\t\tthis.path_table_start_y + i * this.path_table_height,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tif (this.size === LARGE_SIZE) {\n\t\t\tthis.animationManager.setAllLayers([0]);\n\t\t}\n\t}\n\n\tstartCallback() {\n\t\tthis.implementAction(this.doFloydWarshall.bind(this));\n\t}\n\n\tdoFloydWarshall() {\n\t\tthis.commands = [];\n\n\t\tconst oldIndex = this.nextIndex;\n\t\tconst messageID = this.nextIndex++;\n\t\tconst moveLabel1ID = this.nextIndex++;\n\t\tconst moveLabel2ID = this.nextIndex++;\n\n\t\tthis.cmd(act.createCircle, this.node1ID, '', this.node_1_x_pos, this.node_1_y_pos);\n\t\tthis.cmd(act.createCircle, this.node2ID, '', this.node_2_x_pos, this.node_2_y_pos);\n\t\tthis.cmd(act.createCircle, this.node3ID, '', this.node_3_x_pos, this.node_3_y_pos);\n\t\tthis.cmd(act.createLabel, messageID, '', this.message_x, this.message_y, 0);\n\n\t\tfor (let k = 0; k < this.size; k++) {\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\t\tif (i !== j && j !== k && i !== k) {\n\t\t\t\t\t\tthis.cmd(act.setText, this.node1ID, i);\n\t\t\t\t\t\tthis.cmd(act.setText, this.node2ID, k);\n\t\t\t\t\t\tthis.cmd(act.setText, this.node3ID, j);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.node1ID,\n\t\t\t\t\t\t\tthis.node2ID,\n\t\t\t\t\t\t\t'#009999',\n\t\t\t\t\t\t\t-0.1,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.node2ID,\n\t\t\t\t\t\t\tthis.node3ID,\n\t\t\t\t\t\t\t'#9900CC',\n\t\t\t\t\t\t\t-0.1,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.node1ID,\n\t\t\t\t\t\t\tthis.node3ID,\n\t\t\t\t\t\t\t'#CC0000',\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][k], 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[k][j], 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][j], 1);\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][k], '#009999');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[k][j], '#9900CC');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][j], '#CC0000');\n\t\t\t\t\t\tif (this.costTable[i][k] >= 0 && this.costTable[k][j] >= 0) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.costTable[i][j] < 0 ||\n\t\t\t\t\t\t\t\tthis.costTable[i][k] + this.costTable[k][j] < this.costTable[i][j]\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tmessageID,\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\n\t\t\t\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.costTable[i][j] = this.costTable[i][k] + this.costTable[k][j];\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.pathTableID[i][j], '');\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.costTableID[i][j], '');\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tmoveLabel1ID,\n\t\t\t\t\t\t\t\t\tthis.pathTable[k][j],\n\t\t\t\t\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\n\t\t\t\t\t\t\t\t\tthis.path_table_start_y + k * this.path_table_height,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\tmoveLabel1ID,\n\t\t\t\t\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\n\t\t\t\t\t\t\t\t\tthis.path_table_start_y + i * this.path_table_height,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tmoveLabel2ID,\n\t\t\t\t\t\t\t\t\tthis.costTable[i][j],\n\t\t\t\t\t\t\t\t\tthis.message_x,\n\t\t\t\t\t\t\t\t\tthis.message_y,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, moveLabel2ID, 1);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\tmoveLabel2ID,\n\t\t\t\t\t\t\t\t\tthis.cost_table_start_x + j * this.cost_table_width,\n\t\t\t\t\t\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.pathTable[i][j] = this.pathTable[k][j];\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.costTableID[i][j], this.costTable[i][j]);\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.pathTableID[i][j], this.pathTable[i][j]);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, moveLabel1ID);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, moveLabel2ID);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tmessageID,\n\t\t\t\t\t\t\t\t\t'!(' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\n\t\t\t\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true) +\n\t\t\t\t\t\t\t\t\t\t')',\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tmessageID,\n\t\t\t\t\t\t\t\t'!(' +\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\n\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\n\t\t\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true) +\n\t\t\t\t\t\t\t\t\t')',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][k], '#000000');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[k][j], '#000000');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][j], '#000000');\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.node1ID, this.node2ID);\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.node2ID, this.node3ID);\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.node1ID, this.node3ID);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][k], 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[k][j], 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][j], 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.delete, this.node1ID);\n\t\tthis.cmd(act.delete, this.node2ID);\n\t\tthis.cmd(act.delete, this.node3ID);\n\t\tthis.cmd(act.delete, messageID);\n\t\tthis.nextIndex = oldIndex;\n\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_SIZE = 32;\nconst LENGTH = 8;\n\nconst MAX_ARRAY_SIZE = 31;\nconst ARRAY_ELEM_WIDTH = 40;\nconst ARRAY_ELEM_HEIGHT = 25;\nconst ARRAY_INITIAL_X = 30;\n\nconst ARRAY_Y_POS = 50;\nconst ARRAY_LABEL_Y_POS = 75;\n\nconst ARRAY_RESIZE_Y_POS = 100;\nconst ARRAY_RESIZE_LABEL_Y_POS = 125;\n\nconst HEAP_X_POSITIONS = [\n\t0, 450, 250, 650, 150, 350, 550, 750, 100, 200, 300, 400, 500, 600, 700, 800, 75, 125, 175, 225,\n\t275, 325, 375, 425, 475, 525, 575, 625, 675, 725, 775, 825,\n];\n\nconst HEAP_Y_POSITIONS = [\n\t0, 180, 250, 250, 320, 320, 320, 320, 390, 390, 390, 390, 390, 390, 390, 390, 460, 460, 460,\n\t460, 460, 460, 460, 460, 460, 460, 460, 460, 460, 460, 460, 460,\n];\n\nexport default class Heap extends Algorithm {\n\tconstructor(am) {\n\t\tsuper(am);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.array_size = LENGTH;\n\t\tthis.order = 'smaller';\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Enqueue');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.removeButton = addControlToAlgorithmBar('Button', 'Dequeue');\n\t\tthis.removeButton.onclick = this.removeCallback.bind(this);\n\t\tthis.controls.push(this.removeButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma separated list (e.g. \"3,1,2\"). Max 31 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\tthis.buildHeapField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.buildHeapField.onkeydown = this.returnSubmit(\n\t\t\tthis.buildHeapField,\n\t\t\tthis.buildHeapCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.buildHeapField);\n\n\t\tthis.buildHeapButton = addControlToAlgorithmBar('Button', 'BuildHeap', horizontalGroup);\n\t\tthis.buildHeapButton.onclick = this.buildHeapCallback.bind(this);\n\t\tthis.controls.push(this.buildHeapButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst minMaxButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['MinHeap', 'MaxHeap'],\n\t\t\t'MinHeap/MaxHeap',\n\t\t);\n\n\t\tthis.minHeapButton = minMaxButtonList[0];\n\t\tthis.minHeapButton.onclick = this.minHeapCallback.bind(this);\n\t\tthis.minHeapButton.checked = true;\n\t\tthis.maxHeapButton = minMaxButtonList[1];\n\t\tthis.maxHeapButton.onclick = this.maxHeapCallback.bind(this);\n\t\tthis.isMinHeap = true;\n\t\tthis.controls.push(this.minHeapButton);\n\t\tthis.controls.push(this.maxHeapButton);\n\t}\n\n\tcreateArray() {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = new Array(this.array_size);\n\t\tthis.arrayLabels = new Array(this.array_size);\n\t\tthis.arrayRects = new Array(this.array_size);\n\t\tthis.circleObjs = new Array(this.array_size);\n\t\tthis.arrayXPositions = new Array(this.array_size);\n\t\tthis.currentHeapSize = 0;\n\n\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\tthis.arrayXPositions[i] = ARRAY_INITIAL_X + i * ARRAY_ELEM_WIDTH;\n\t\t\tthis.arrayLabels[i] = this.nextIndex++;\n\t\t\tthis.arrayRects[i] = this.nextIndex++;\n\t\t\tthis.circleObjs[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayRects[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\tARRAY_Y_POS,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.arrayLabels[i],\n\t\t\t\ti,\n\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\tARRAY_LABEL_Y_POS,\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabels[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.setText, this.arrayRects[0], 'null');\n\t\treturn this.commands;\n\t}\n\n\tsetup() {\n\t\tthis.swapLabel1 = this.nextIndex++;\n\t\tthis.swapLabel2 = this.nextIndex++;\n\t\tthis.swapLabel3 = this.nextIndex++;\n\t\tthis.swapLabel4 = this.nextIndex++;\n\t\tthis.descriptLabel1 = this.nextIndex++;\n\t\tthis.descriptLabel2 = this.nextIndex++;\n\t\tthis.descriptLabel3 = this.nextIndex++;\n\t\tthis.resetIndex = this.nextIndex;\n\t\tthis.createArray();\n\t\tthis.cmd(act.createLabel, this.descriptLabel1, '', 20, 10, 0);\n\t\tthis.cmd(act.createLabel, this.descriptLabel3, '', 300, 10, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.normalizeNumber(this.insertField.value, 4);\n\t\tif (insertedValue !== '') {\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tremoveCallback() {\n\t\tthis.implementAction(this.remove.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t\tthis.implementAction(this.resize.bind(this), LENGTH, false);\n\t}\n\n\tbuildHeapCallback() {\n\t\tconst list = this.buildHeapField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.buildHeapField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.buildHeapField.value = '';\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.implementAction(this.buildHeap.bind(this), list);\n\t\t}\n\t}\n\n\tminHeapCallback() {\n\t\tif (!this.isMinHeap) {\n\t\t\tthis.clearCallback();\n\t\t\tthis.isMinHeap = true;\n\t\t\tthis.order = 'smaller';\n\t\t}\n\t}\n\n\tmaxHeapCallback() {\n\t\tif (this.isMinHeap) {\n\t\t\tthis.clearCallback();\n\t\t\tthis.isMinHeap = false;\n\t\t\tthis.order = 'larger';\n\t\t}\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\twhile (this.currentHeapSize > 0) {\n\t\t\tthis.cmd(act.delete, this.circleObjs[this.currentHeapSize]);\n\t\t\tthis.cmd(act.setText, this.arrayRects[this.currentHeapSize], '');\n\t\t\tthis.currentHeapSize--;\n\t\t}\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\t\treturn this.commands;\n\t}\n\n\treset() {\n\t\tthis.currentHeapSize = 0;\n\t\tthis.array_size = LENGTH;\n\n\t\tthis.nextIndex = this.resetIndex;\n\n\t\tthis.arrayData = new Array(this.array_size);\n\t\tthis.arrayLabels = new Array(this.array_size);\n\t\tthis.arrayRects = new Array(this.array_size);\n\t\tthis.circleObjs = new Array(this.array_size);\n\t\tthis.arrayXPositions = new Array(this.array_size);\n\n\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\tthis.arrayXPositions[i] = ARRAY_INITIAL_X + i * ARRAY_ELEM_WIDTH;\n\t\t\tthis.arrayLabels[i] = this.nextIndex++;\n\t\t\tthis.arrayRects[i] = this.nextIndex++;\n\t\t\tthis.circleObjs[i] = this.nextIndex++;\n\t\t}\n\t}\n\n\tswap(index1, index2) {\n\t\tthis.cmd(act.setText, this.arrayRects[index1], '');\n\t\tthis.cmd(act.setText, this.arrayRects[index2], '');\n\t\tthis.cmd(act.setText, this.circleObjs[index1], '');\n\t\tthis.cmd(act.setText, this.circleObjs[index2], '');\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel1,\n\t\t\tthis.arrayData[index1],\n\t\t\tthis.arrayXPositions[index1],\n\t\t\tARRAY_Y_POS,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel2,\n\t\t\tthis.arrayData[index2],\n\t\t\tthis.arrayXPositions[index2],\n\t\t\tARRAY_Y_POS,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel3,\n\t\t\tthis.arrayData[index1],\n\t\t\tHEAP_X_POSITIONS[index1],\n\t\t\tHEAP_Y_POSITIONS[index1],\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel4,\n\t\t\tthis.arrayData[index2],\n\t\t\tHEAP_X_POSITIONS[index2],\n\t\t\tHEAP_Y_POSITIONS[index2],\n\t\t);\n\t\tthis.cmd(act.move, this.swapLabel1, this.arrayXPositions[index2], ARRAY_Y_POS);\n\t\tthis.cmd(act.move, this.swapLabel2, this.arrayXPositions[index1], ARRAY_Y_POS);\n\t\tthis.cmd(act.move, this.swapLabel3, HEAP_X_POSITIONS[index2], HEAP_Y_POSITIONS[index2]);\n\t\tthis.cmd(act.move, this.swapLabel4, HEAP_X_POSITIONS[index1], HEAP_Y_POSITIONS[index1]);\n\t\tconst tmp = this.arrayData[index1];\n\t\tthis.arrayData[index1] = this.arrayData[index2];\n\t\tthis.arrayData[index2] = tmp;\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayRects[index1], this.arrayData[index1]);\n\t\tthis.cmd(act.setText, this.arrayRects[index2], this.arrayData[index2]);\n\t\tthis.cmd(act.setText, this.circleObjs[index1], this.arrayData[index1]);\n\t\tthis.cmd(act.setText, this.circleObjs[index2], this.arrayData[index2]);\n\t\tthis.cmd(act.delete, this.swapLabel1);\n\t\tthis.cmd(act.delete, this.swapLabel2);\n\t\tthis.cmd(act.delete, this.swapLabel3);\n\t\tthis.cmd(act.delete, this.swapLabel4);\n\t}\n\n\tsetIndexHighlight(index, highlightVal) {\n\t\tthis.cmd(act.setHighlight, this.circleObjs[index], highlightVal);\n\t\tthis.cmd(act.setHighlight, this.arrayRects[index], highlightVal);\n\t}\n\n\tpushDown(index) {\n\t\tlet childIndex; // Used to keep track of smallest (in MinHeap) or largest (in MaxHeap) child\n\n\t\twhile (index * 2 <= this.currentHeapSize) {\n\t\t\tchildIndex = 2 * index;\n\n\t\t\tif (index * 2 + 1 <= this.currentHeapSize) {\n\t\t\t\tthis.cmd(act.setText, this.descriptLabel3, `Finding ${this.order} of two children`);\n\t\t\t\tthis.setIndexHighlight(2 * index, 1);\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.setIndexHighlight(2 * index, 0);\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 0);\n\t\t\t\tif (this.downheapCheckRightChild(index)) {\n\t\t\t\t\tchildIndex = 2 * index + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.setText, this.descriptLabel3, `Comparing child to parent`);\n\t\t\tthis.setIndexHighlight(index, 1);\n\t\t\tthis.setIndexHighlight(childIndex, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.setIndexHighlight(index, 0);\n\t\t\tthis.setIndexHighlight(childIndex, 0);\n\t\t\tthis.cmd(act.setText, this.descriptLabel3, ``);\n\n\t\t\tif (this.downheapCompare(childIndex, index)) {\n\t\t\t\tthis.swap(childIndex, index);\n\t\t\t\tindex = childIndex;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdownheapCheckRightChild(index) {\n\t\t// Checks if the right child is smaller (in MinHeap) or greater (in MaxHeap) than left child\n\t\tif (this.isMinHeap) {\n\t\t\tif (this.arrayData[2 * index + 1] < this.arrayData[2 * index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.arrayData[2 * index + 1] > this.arrayData[2 * index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdownheapCompare(childIndex, index) {\n\t\t// Checks if smallest child is smaller than parent (in MinHeap)\n\t\t// or greatest child is greater than parent (in MaxHeap)\n\t\tif (this.isMinHeap) {\n\t\t\tif (this.arrayData[childIndex] < this.arrayData[index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.arrayData[childIndex] > this.arrayData[index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tremove() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\n\t\tif (this.currentHeapSize === 0) {\n\t\t\tthis.cmd(act.setText, this.descriptLabel1, 'Heap is empty, cannot dequeue');\n\t\t\treturn this.commands;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Removing element:');\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.descriptLabel2,\n\t\t\tthis.arrayData[1],\n\t\t\tHEAP_X_POSITIONS[1],\n\t\t\tHEAP_Y_POSITIONS[1],\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.setText, this.circleObjs[1], '');\n\t\tthis.cmd(act.move, this.descriptLabel2, 120, 40);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.descriptLabel2);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Removing element: ' + this.arrayData[1]);\n\t\tthis.arrayData[1] = '';\n\t\tif (this.currentHeapSize > 1) {\n\t\t\tthis.cmd(act.setText, this.arrayRects[1], '');\n\t\t\tthis.cmd(act.setText, this.arrayRects[this.currentHeapSize], '');\n\t\t\tthis.swap(1, this.currentHeapSize);\n\t\t\tthis.cmd(act.delete, this.circleObjs[this.currentHeapSize]);\n\t\t\tthis.currentHeapSize--;\n\t\t\tthis.pushDown(1);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.arrayRects[1], '');\n\t\t\tthis.cmd(act.delete, this.circleObjs[this.currentHeapSize]);\n\t\t\tthis.currentHeapSize--;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tbuildHeap(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = params\n\t\t\t.map(Number) // Map to numbers (to remove invalid characters)\n\t\t\t.filter(x => !Number.isNaN(x)) // Remove stuff that was invalid\n\t\t\t.slice(0, MAX_ARRAY_SIZE); // Get first 31 numbers\n\t\tthis.arrayData.unshift(0); // Add a 0 to start of array\n\n\t\tthis.currentHeapSize = this.arrayData.length - 1;\n\t\tconst size = Math.min(MAX_SIZE, this.currentHeapSize * 2 + 1);\n\t\tif (this.array_size !== size) {\n\t\t\tthis.commands = this.resize(size, false);\n\t\t}\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Adding data to array');\n\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 1; i <= this.currentHeapSize; i++) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircle,\n\t\t\t\tthis.circleObjs[i],\n\t\t\t\tthis.arrayData[i],\n\t\t\t\tHEAP_X_POSITIONS[i],\n\t\t\t\tHEAP_Y_POSITIONS[i],\n\t\t\t);\n\t\t\tthis.cmd(act.setText, this.arrayRects[i], this.arrayData[i]);\n\t\t\tif (i > 1) {\n\t\t\t\tthis.cmd(act.connect, this.circleObjs[Math.floor(i / 2)], this.circleObjs[i]);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Enforcing order property using downheap');\n\t\tlet nextElem = this.currentHeapSize;\n\t\twhile (nextElem > 0) {\n\t\t\tthis.pushDown(nextElem);\n\t\t\tnextElem = nextElem - 1;\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Buildheap complete!');\n\t\treturn this.commands;\n\t}\n\n\tinsertElement(insertedValue) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\n\t\tif (this.currentHeapSize === this.array_size - 1) {\n\t\t\tif (this.currentHeapSize >= MAX_SIZE - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.descriptLabel1,\n\t\t\t\t\t'Array would normally resize here, ' +\n\t\t\t\t\t\t\"but there's not enough space on the screen for a larger heap. So here's a cute emoji of jack instead: VV\",\n\t\t\t\t);\n\t\t\t\treturn this.commands;\n\t\t\t} else {\n\t\t\t\tconst size = Math.min(MAX_SIZE, this.array_size * 2);\n\t\t\t\tthis.commands = this.resize(size, true);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Enqueueing Element: ' + insertedValue);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Enqueueing Element: ');\n\t\tthis.currentHeapSize++;\n\t\tthis.arrayData[this.currentHeapSize] = insertedValue;\n\t\tthis.cmd(\n\t\t\tact.createCircle,\n\t\t\tthis.circleObjs[this.currentHeapSize],\n\t\t\t'',\n\t\t\tHEAP_X_POSITIONS[this.currentHeapSize],\n\t\t\tHEAP_Y_POSITIONS[this.currentHeapSize],\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.descriptLabel2, insertedValue, 120, 45, 1);\n\t\tif (this.currentHeapSize > 1) {\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.circleObjs[Math.floor(this.currentHeapSize / 2)],\n\t\t\t\tthis.circleObjs[this.currentHeapSize],\n\t\t\t);\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.move,\n\t\t\tthis.descriptLabel2,\n\t\t\tHEAP_X_POSITIONS[this.currentHeapSize],\n\t\t\tHEAP_Y_POSITIONS[this.currentHeapSize],\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.circleObjs[this.currentHeapSize], insertedValue);\n\t\tthis.cmd(act.delete, this.descriptLabel2);\n\t\tthis.cmd(act.setText, this.arrayRects[this.currentHeapSize], insertedValue);\n\n\t\tlet currentIndex = this.currentHeapSize;\n\t\tlet parentIndex = Math.floor(currentIndex / 2);\n\n\t\tif (currentIndex > 1) {\n\t\t\tthis.setIndexHighlight(currentIndex, 1);\n\t\t\tthis.setIndexHighlight(parentIndex, 1);\n\t\t\tthis.cmd(act.setText, this.descriptLabel3, `Comparing child to parent`);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.setIndexHighlight(currentIndex, 0);\n\t\t\tthis.setIndexHighlight(parentIndex, 0);\n\t\t}\n\n\t\twhile (currentIndex > 1 && this.upheapCompare(currentIndex, parentIndex)) {\n\t\t\tthis.swap(currentIndex, parentIndex);\n\t\t\tcurrentIndex = parentIndex;\n\t\t\tparentIndex = Math.floor(parentIndex / 2);\n\t\t\tif (currentIndex > 1) {\n\t\t\t\tthis.setIndexHighlight(currentIndex, 1);\n\t\t\t\tthis.setIndexHighlight(parentIndex, 1);\n\t\t\t\tthis.cmd(act.setText, this.descriptLabel3, `Comparing child to parent`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.setIndexHighlight(currentIndex, 0);\n\t\t\t\tthis.setIndexHighlight(parentIndex, 0);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\t\tthis.cmd(act.setText, this.descriptLabel3, '');\n\t\treturn this.commands;\n\t}\n\n\tresize(size, add) {\n\t\tthis.commands = [];\n\t\tconst resizeLabelID = this.nextIndex++;\n\n\t\tif (add) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tresizeLabelID,\n\t\t\t\t'Resize Required: size == array.length - 1',\n\t\t\t\t400,\n\t\t\t\t20,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (size === MAX_SIZE) {\n\t\t\t\tthis.cmd(act.setText, resizeLabelID, 'Resizing to 32 (Max array size)');\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setText, resizeLabelID, 'Resizing to 2 * array.length');\n\t\t\t}\n\t\t}\n\n\t\tconst oldSize = this.array_size;\n\n\t\tthis.array_size = size;\n\n\t\tthis.newArrayData = new Array(this.array_size);\n\t\tthis.newArrayLabels = new Array(this.array_size);\n\t\tthis.newArrayRects = new Array(this.array_size);\n\t\tthis.newCircleObjs = new Array(this.array_size);\n\t\tthis.newArrayXPositions = new Array(this.array_size);\n\n\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\tthis.newArrayLabels[i] = this.nextIndex++;\n\t\t\tthis.newArrayRects[i] = this.nextIndex++;\n\t\t\tthis.newArrayXPositions[i] = ARRAY_INITIAL_X + i * ARRAY_ELEM_WIDTH;\n\t\t\tif (i < oldSize) {\n\t\t\t\tthis.newCircleObjs[i] = this.circleObjs[i];\n\t\t\t} else {\n\t\t\t\tthis.newCircleObjs[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tthis.newArrayData[i] = this.arrayData[i];\n\t\t}\n\n\t\tif (add) {\n\t\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.newArrayRects[i],\n\t\t\t\t\t'',\n\t\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\t\tthis.newArrayXPositions[i],\n\t\t\t\t\tARRAY_RESIZE_Y_POS,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.newArrayLabels[i],\n\t\t\t\t\ti,\n\t\t\t\t\tthis.newArrayXPositions[i],\n\t\t\t\t\tARRAY_RESIZE_LABEL_Y_POS,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.newArrayLabels[i], '#0000FF');\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.arrayMoveID = new Array(this.oldSize);\n\n\t\t\tfor (let i = 0; i <= this.currentHeapSize; i++) {\n\t\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.arrayMoveID[i],\n\t\t\t\t\t\t'null',\n\t\t\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\t\t\tARRAY_Y_POS,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.arrayMoveID[i],\n\t\t\t\t\t\tthis.arrayData[i],\n\t\t\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\t\t\tARRAY_Y_POS,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.arrayMoveID[i],\n\t\t\t\t\tthis.newArrayXPositions[i],\n\t\t\t\t\tARRAY_RESIZE_Y_POS,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let i = 0; i < oldSize; i++) {\n\t\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\t\tthis.cmd(act.setText, this.newArrayRects[i], this.newArrayData[i]);\n\t\t\t}\n\n\t\t\tthis.cmd(act.setText, this.newArrayRects[0], 'null');\n\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tfor (let i = 0; i < oldSize; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayLabels[i]);\n\t\t\tthis.cmd(act.delete, this.arrayRects[i]);\n\t\t}\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayData = this.newArrayData;\n\t\tthis.arrayLabels = this.newArrayLabels;\n\t\tthis.arrayXPositions = this.newArrayXPositions;\n\t\tthis.arrayRects = this.newArrayRects;\n\t\tthis.circleObjs = this.newCircleObjs;\n\n\t\tif (add) {\n\t\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\t\tthis.cmd(act.move, this.arrayRects[i], this.arrayXPositions[i], ARRAY_Y_POS);\n\t\t\t\tthis.cmd(act.move, this.arrayLabels[i], this.arrayXPositions[i], ARRAY_LABEL_Y_POS);\n\t\t\t}\n\n\t\t\tthis.cmd(act.delete, resizeLabelID);\n\t\t} else {\n\t\t\tfor (let i = 0; i < this.array_size; i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.arrayRects[i],\n\t\t\t\t\t'',\n\t\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\t\tARRAY_Y_POS,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.arrayLabels[i],\n\t\t\t\t\ti,\n\t\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\t\tARRAY_LABEL_Y_POS,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.newArrayLabels[i], '#0000FF');\n\t\t\t}\n\t\t\tthis.cmd(act.setText, this.arrayRects[0], 'null');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tupheapCompare(currentIndex, parentIndex) {\n\t\tif (this.isMinHeap) {\n\t\t\tif (this.arrayData[currentIndex] < this.arrayData[parentIndex]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.arrayData[currentIndex] > this.arrayData[parentIndex]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tthis.controls.forEach(button => (button.disabled = true));\n\t}\n\n\tenableUI() {\n\t\tthis.controls.forEach(button => (button.disabled = false));\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 130;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 200;\n\nexport default class InsertionSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure InsertionSort(array):'],\n\t\t\t['     length <- length of array'],\n\t\t\t['     for i <- 1, length - 1 do'],\n\t\t\t['          j <- i'],\n\t\t\t['          while ', 'j > 0, ', 'array[j - 1] > array[j]', ' do'],\n\t\t\t['               swap array[j-1], array[j] '],\n\t\t\t['               j <- j - 1'],\n\t\t\t['          end while'],\n\t\t\t['     end for'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.highlight(0, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\t\tthis.highlight(2, 0);\n\n\t\tfor (let i = 1; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(4, 0);\n\t\t\tfor (let j = i; j >= 1; j--) {\n\t\t\t\tthis.movePointers(j - 1, j);\n\t\t\t\tthis.unhighlight(3, 0);\n\t\t\t\tthis.unhighlight(4, 0);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tthis.highlight(4, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(4, 1);\n\t\t\t\tthis.highlight(4, 2);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(4, 2);\n\t\t\t\tif (this.arrayData[j] < this.arrayData[j - 1]) {\n\t\t\t\t\tthis.highlight(5, 0);\n\t\t\t\t\tthis.swap(j, j - 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\t\tthis.highlight(6, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tif (i === 1) this.cmd(act.setBackgroundColor, this.arrayID[0], '#2ECC71');\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.unhighlight(2, 0);\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\nconst FAILURE_TABLE_START_Y = 100;\n\nconst COMP_COUNT_X = 575;\nconst COMP_COUNT_Y = 30;\n\nexport default class KMP extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Build Failure Table button\n\t\tthis.bftButton = addControlToAlgorithmBar('Button', 'Build Failure Table');\n\t\tthis.bftButton.onclick = this.buildFailureTableCallback.bind(this);\n\t\tthis.controls.push(this.bftButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.failureTableLabelID = this.nextIndex++;\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.createLabel, this.comparisonCountID, '', COMP_COUNT_X, COMP_COUNT_Y, 0);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.failureTableLabelID = this.nextIndex++;\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tbuildFailureTableCallback() {\n\t\tif (this.patternField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.onlyBuildFailureTable.bind(this), 0, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\tconst maxRows = this.getMaxRows(text, pattern);\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tlet xpos, ypos;\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\typos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst failureTable = this.buildFailureTable(text.length, pattern);\n\t\tconst tableStartX = ARRAY_START_X + text.length * this.cellSize + 110;\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tconst fjPointerID = this.nextIndex++;\n\t\tconst f0PointerID = this.nextIndex++;\n\t\tconst f1PointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tfjPointerID,\n\t\t\t'#FF0000',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tf0PointerID,\n\t\t\t'#FF0000',\n\t\t\ttableStartX,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tf1PointerID,\n\t\t\t'#FF0000',\n\t\t\ttableStartX,\n\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.setAlpha, fjPointerID, 0);\n\t\tthis.cmd(act.setAlpha, f0PointerID, 0);\n\t\tthis.cmd(act.setAlpha, f1PointerID, 0);\n\n\t\tlet i = 0;\n\t\tlet j = 0;\n\t\tlet row = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t\tif (k - i < j) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][k], '#FFFF4D');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setAlpha, fjPointerID, 0);\n\t\t\tthis.cmd(act.setAlpha, f0PointerID, 0);\n\t\t\tthis.cmd(act.setAlpha, f1PointerID, 0);\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\tj++;\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (j < pattern.length) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (j === 0) {\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i], '#E74C3C');\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setBackgroundColor,\n\t\t\t\t\t\tthis.comparisonMatrixID[row][i + j],\n\t\t\t\t\t\t'#E74C3C',\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tconst nextAlignment = failureTable[j - 1];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setPosition,\n\t\t\t\t\tfjPointerID,\n\t\t\t\t\t(i + j - 1) * this.cellSize + ARRAY_START_X,\n\t\t\t\t\t(row + 1) * this.cellSize + ARRAY_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setPosition,\n\t\t\t\t\tf0PointerID,\n\t\t\t\t\ttableStartX + (j - 1) * this.cellSize,\n\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setPosition,\n\t\t\t\t\tf1PointerID,\n\t\t\t\t\ttableStartX + (j - 1) * this.cellSize,\n\t\t\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setAlpha, fjPointerID, 1);\n\t\t\t\tthis.cmd(act.setAlpha, f0PointerID, 1);\n\t\t\t\tthis.cmd(act.setAlpha, f1PointerID, 1);\n\t\t\t\ti += j - nextAlignment;\n\t\t\t\tj = nextAlignment;\n\t\t\t}\n\t\t\trow++;\n\t\t\tif (i <= text.length - pattern.length) {\n\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\tthis.cmd(act.delete, fjPointerID);\n\t\tthis.cmd(act.delete, f0PointerID);\n\t\tthis.cmd(act.delete, f1PointerID);\n\t\treturn this.commands;\n\t}\n\n\tgetMaxRows(text, pattern) {\n\t\tconst failureTable = [];\n\t\tfailureTable[0] = 0;\n\t\tlet i = 0;\n\t\tlet j = 1;\n\t\twhile (j < pattern.length) {\n\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\n\t\t\t\ti++;\n\t\t\t\tfailureTable[j] = i;\n\t\t\t\tj++;\n\t\t\t} else {\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\tj++;\n\t\t\t\t} else {\n\t\t\t\t\ti = failureTable[i - 1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ti = 0;\n\t\tj = 0;\n\t\tlet maxRows = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tif (j === 0) {\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tconst nextAlignment = failureTable[j - 1];\n\t\t\t\ti += j - nextAlignment;\n\t\t\t\tj = nextAlignment;\n\t\t\t}\n\t\t\tmaxRows++;\n\t\t}\n\t\treturn maxRows;\n\t}\n\n\tonlyBuildFailureTable(textLength, pattern) {\n\t\tthis.commands = [];\n\t\tthis.cellSize = 30;\n\t\tthis.buildFailureTable(textLength, pattern);\n\t\treturn this.commands;\n\t}\n\n\tbuildFailureTable(textLength, pattern) {\n\t\t// Display label\n\t\tconst labelX = ARRAY_START_X + textLength * this.cellSize + 10;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.failureTableLabelID,\n\t\t\t'Failure table:',\n\t\t\tlabelX,\n\t\t\tFAILURE_TABLE_START_Y + 10,\n\t\t\t0,\n\t\t);\n\n\t\tthis.cmd(act.move, this.comparisonCountID, labelX, COMP_COUNT_Y);\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\n\t\t// Display empty failure table\n\t\tconst tableStartX = ARRAY_START_X + textLength * this.cellSize + 110;\n\t\tthis.failureTableCharacterID = new Array(pattern.length);\n\t\tthis.failureTableValueID = new Array(pattern.length);\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tconst xpos = tableStartX + i * this.cellSize;\n\t\t\tthis.failureTableCharacterID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableCharacterID[i],\n\t\t\t\tpattern.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.failureTableCharacterID[i], '#D3D3D3');\n\t\t\tthis.failureTableValueID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableValueID[i],\n\t\t\t\t'',\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y + this.cellSize,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Display pointers and set first value to 0\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\ttableStartX,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#FF0000',\n\t\t\ttableStartX + this.cellSize,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2,\n\t\t);\n\t\tthis.cmd(act.setText, this.failureTableValueID[0], 0);\n\t\tthis.cmd(act.step);\n\n\t\tconst failureTable = [];\n\t\tfailureTable[0] = 0;\n\t\tlet i = 0;\n\t\tlet j = 1;\n\t\twhile (j < pattern.length) {\n\t\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + ++this.compCount);\n\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\n\t\t\t\ti++;\n\t\t\t\tfailureTable[j] = i;\n\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\tj++;\n\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t} else {\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\t\tj++;\n\t\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\ti = failureTable[i - 1];\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\n\t\treturn failureTable;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\t\tif (this.failureTableValueID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.failureTableLabelID);\n\t\t}\n\t\tfor (let i = 0; i < this.failureTableCharacterID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.failureTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.failureTableValueID[i]);\n\t\t}\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, '');\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { EDGE_COLOR, VERTEX_INDEX_COLOR } from './Graph.js';\nimport { KRUSKALS_DS_COLORS, PRIMS_KRUSKALS_ADJ_LIST } from './util/GraphValues';\nimport { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MESSAGE_LABEL_X = 30;\nconst MESSAGE_LABEL_Y = 15;\n\nconst FIND_LABEL_1_X = 30;\nconst FIND_LABEL_2_X = 100;\nconst FIND_LABEL_1_Y = 40;\nconst FIND_LABEL_2_Y = FIND_LABEL_1_Y;\n\nconst CURRENT_LABEL_X = 145;\nconst CURRENT_LABEL_Y = 67;\n\nconst PQ_LABEL_X = 145;\nconst PQ_LABEL_Y = 92;\n\nconst SET_ARRAY_ELEM_WIDTH = 50;\nconst SET_ARRAY_ELEM_HEIGHT = 20;\nconst SET_ARRAY_START_X = 52;\nconst SET_ARRAY_START_Y = 110;\n\nconst EDGE_LIST_ELEM_WIDTH = 40;\nconst EDGE_LIST_ELEM_HEIGHT = 40;\nconst EDGE_LIST_COLUMN_WIDTH = 100;\nconst EDGE_LIST_MAX_PER_COLUMN = 9;\n\nconst EDGE_LIST_START_X = 150;\nconst EDGE_LIST_START_Y = 135;\n\nconst HIGHLIGHT_CIRCLE_COLOR_1 = '#FF9999';\nconst HIGHLIGHT_CIRCLE_COLOR_2 = '#FF0000';\nconst HIGHLIGHT_CIRCLE_COLOR_3 = '#0000FF';\nconst HIGHLIGHT_CIRCLE_RADIUS = 12;\n\nconst MST_EDGE_COLOR = '#3399FF';\nconst MST_EDGE_THICKNESS = 4;\n\nexport default class Kruskals extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, PRIMS_KRUSKALS_ADJ_LIST, false, false, true);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls(false);\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\t\tthis.messageID = [];\n\t\tthis.commands = [];\n\t\tthis.setID = new Array(this.size);\n\t\tthis.setIndexID = new Array(this.size);\n\t\tthis.setData = new Array(this.size);\n\t\tthis.edgesListLeftID = [];\n\t\tthis.edgesListRightID = [];\n\n\t\tlet i;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.setID[i] = this.nextIndex++;\n\t\t\tthis.setIndexID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.setIndexID[i],\n\t\t\t\tthis.toStr(i),\n\t\t\t\tSET_ARRAY_ELEM_WIDTH,\n\t\t\t\tSET_ARRAY_ELEM_HEIGHT,\n\t\t\t\tSET_ARRAY_START_X,\n\t\t\t\tSET_ARRAY_START_Y + i * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.setID[i],\n\t\t\t\t'',\n\t\t\t\tSET_ARRAY_ELEM_WIDTH,\n\t\t\t\tSET_ARRAY_ELEM_HEIGHT,\n\t\t\t\tSET_ARRAY_START_X + SET_ARRAY_ELEM_WIDTH,\n\t\t\t\tSET_ARRAY_START_Y + i * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.setIndexID[i], VERTEX_INDEX_COLOR);\n\t\t}\n\n\t\tthis.messageLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.messageLabelID, '', MESSAGE_LABEL_X, MESSAGE_LABEL_Y, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Disjoint Set:',\n\t\t\tSET_ARRAY_START_X + 0.5 * SET_ARRAY_ELEM_WIDTH,\n\t\t\tSET_ARRAY_START_Y - 37,\n\t\t\t1,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Vertex',\n\t\t\tSET_ARRAY_START_X,\n\t\t\tSET_ARRAY_START_Y - 22,\n\t\t\t1,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Set ID',\n\t\t\tSET_ARRAY_START_X + SET_ARRAY_ELEM_WIDTH,\n\t\t\tSET_ARRAY_START_Y - 22,\n\t\t\t1,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current edge:',\n\t\t\tCURRENT_LABEL_X,\n\t\t\tCURRENT_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.createLabel, this.nextIndex++, 'Priority Queue:', PQ_LABEL_X, PQ_LABEL_Y, 0);\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.messageID = [];\n\t\tthis.edgesListLeft = [];\n\t\tthis.edgesListRight = [];\n\t\tthis.edgesListLeftID = [];\n\t\tthis.edgesListRightID = [];\n\t}\n\n\tstartCallback() {\n\t\tthis.implementAction(this.doKruskal.bind(this));\n\t}\n\n\tdoKruskal() {\n\t\tthis.commands = [];\n\n\t\tfor (let k = 0; k < this.edgesListLeftID.length; k++) {\n\t\t\tthis.cmd(act.delete, this.edgesListLeftID[k]);\n\t\t\tthis.cmd(act.delete, this.edgesListRightID[k]);\n\t\t}\n\n\t\tthis.edgesListLeftID = [];\n\t\tthis.edgesListRightID = [];\n\t\tthis.edgesListLeft = [];\n\t\tthis.edgesListRight = [];\n\n\t\tlet i;\n\t\tlet j;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.setData[i] = i + 1;\n\t\t\tthis.cmd(act.setText, this.setID[i], i + 1);\n\t\t\t!this.isLarge && this.cmd(act.setBackgroundColor, this.setID[i], KRUSKALS_DS_COLORS[i]);\n\t\t}\n\n\t\tthis.recolorGraph();\n\n\t\t// Create edge list\n\t\tthis.cmd(act.setText, this.messageLabelID, 'Enqueueing all edges into Priority Queue');\n\t\tlet top;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tfor (j = i + 1; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tthis.edgesListLeftID.push(this.nextIndex++);\n\t\t\t\t\tthis.edgesListRightID.push(this.nextIndex++);\n\t\t\t\t\ttop = this.edgesListLeftID.length - 1;\n\t\t\t\t\tthis.edgesListLeft.push(i);\n\t\t\t\t\tthis.edgesListRight.push(j);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.edgesListLeftID[top],\n\t\t\t\t\t\tthis.toStr(i) + ' ',\n\t\t\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\t\t\tMath.floor(top / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\t\tEDGE_LIST_START_Y +\n\t\t\t\t\t\t\t(top % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.edgesListRightID[top],\n\t\t\t\t\t\t' ' + this.toStr(j),\n\t\t\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\t\t\tEDGE_LIST_ELEM_WIDTH +\n\t\t\t\t\t\t\tMath.floor(top / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\t\tEDGE_LIST_START_Y +\n\t\t\t\t\t\t\t(top % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\tthis.edgesListLeftID[top],\n\t\t\t\t\t\tthis.edgesListRightID[top],\n\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tthis.adj_matrix[i][j],\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Sort edge list based on edge cost\n\t\tconst edgeCount = this.edgesListLeftID.length;\n\t\tlet tmpLeftID;\n\t\tlet tmpRightID;\n\t\tlet tmpLeft;\n\t\tlet tmpRight;\n\t\tfor (i = 1; i < edgeCount; i++) {\n\t\t\ttmpLeftID = this.edgesListLeftID[i];\n\t\t\ttmpRightID = this.edgesListRightID[i];\n\t\t\ttmpLeft = this.edgesListLeft[i];\n\t\t\ttmpRight = this.edgesListRight[i];\n\t\t\tj = i;\n\t\t\twhile (\n\t\t\t\tj > 0 &&\n\t\t\t\tthis.adj_matrix[this.edgesListLeft[j - 1]][this.edgesListRight[j - 1]] >\n\t\t\t\t\tthis.adj_matrix[tmpLeft][tmpRight]\n\t\t\t) {\n\t\t\t\tthis.edgesListLeft[j] = this.edgesListLeft[j - 1];\n\t\t\t\tthis.edgesListRight[j] = this.edgesListRight[j - 1];\n\t\t\t\tthis.edgesListLeftID[j] = this.edgesListLeftID[j - 1];\n\t\t\t\tthis.edgesListRightID[j] = this.edgesListRightID[j - 1];\n\t\t\t\tj = j - 1;\n\t\t\t}\n\t\t\tthis.edgesListLeft[j] = tmpLeft;\n\t\t\tthis.edgesListRight[j] = tmpRight;\n\t\t\tthis.edgesListLeftID[j] = tmpLeftID;\n\t\t\tthis.edgesListRightID[j] = tmpRightID;\n\t\t}\n\t\tfor (i = 0; i < edgeCount; i++) {\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListLeftID[i],\n\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\tMath.floor(i / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\tEDGE_LIST_START_Y + (i % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListRightID[i],\n\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\tEDGE_LIST_ELEM_WIDTH +\n\t\t\t\t\tMath.floor(i / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\tEDGE_LIST_START_Y + (i % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tconst findLabelLeft = this.nextIndex++;\n\t\tconst findLabelRight = this.nextIndex++;\n\t\tconst highlightCircle1 = this.nextIndex++;\n\t\tconst highlightCircle2 = this.nextIndex++;\n\t\tconst highlightCircle3 = this.nextIndex++;\n\n\t\tlet edgesAdded = 0;\n\t\tlet nextListIndex = 0;\n\t\tthis.cmd(act.createLabel, findLabelLeft, '', FIND_LABEL_1_X, FIND_LABEL_1_Y, 0);\n\t\tthis.cmd(act.createLabel, findLabelRight, '', FIND_LABEL_2_X, FIND_LABEL_2_Y, 0);\n\n\t\t// Run algorithm\n\t\twhile (edgesAdded < this.size - 1 && nextListIndex < edgeCount) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.messageLabelID,\n\t\t\t\t'Dequeueing ' +\n\t\t\t\t\tthis.toStr(this.edgesListLeft[nextListIndex]) +\n\t\t\t\t\tthis.toStr(this.edgesListRight[nextListIndex]),\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListLeftID[nextListIndex],\n\t\t\t\tCURRENT_LABEL_X + 90,\n\t\t\t\tCURRENT_LABEL_Y + 6,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListRightID[nextListIndex],\n\t\t\t\tCURRENT_LABEL_X + EDGE_LIST_ELEM_WIDTH + 90,\n\t\t\t\tCURRENT_LABEL_Y + 6,\n\t\t\t);\n\n\t\t\tfor (i = nextListIndex + 1; i < edgeCount; i++) {\n\t\t\t\tconst newPos = i - nextListIndex - 1;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.edgesListLeftID[i],\n\t\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\t\tMath.floor(newPos / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\tEDGE_LIST_START_Y + (newPos % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.edgesListRightID[i],\n\t\t\t\t\tEDGE_LIST_START_X +\n\t\t\t\t\t\tEDGE_LIST_ELEM_WIDTH +\n\t\t\t\t\t\tMath.floor(newPos / EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\tEDGE_LIST_START_Y + (newPos % EDGE_LIST_MAX_PER_COLUMN) * EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.highlightEdge(\n\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t1,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.cmd(act.setText, this.messageLabelID, 'Looking at disjoint set');\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelLeft,\n\t\t\t\t'find(' + this.toStr(this.edgesListLeft[nextListIndex]) + ') = ',\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightCircle1,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR_1,\n\t\t\t\tCURRENT_LABEL_X + 88,\n\t\t\t\tCURRENT_LABEL_Y + 6,\n\t\t\t\tHIGHLIGHT_CIRCLE_RADIUS,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tconst left = this.edgesListLeft[nextListIndex];\n\t\t\tconst leftRoot = this.setData[left];\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightCircle1,\n\t\t\t\tSET_ARRAY_START_X,\n\t\t\t\tSET_ARRAY_START_Y + this.edgesListLeft[nextListIndex] * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelLeft,\n\t\t\t\t'find(' + this.toStr(this.edgesListLeft[nextListIndex]) + ') = ' + leftRoot,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelRight,\n\t\t\t\t'find(' + this.toStr(this.edgesListRight[nextListIndex]) + ') = ',\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightCircle2,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR_2,\n\t\t\t\tCURRENT_LABEL_X + EDGE_LIST_ELEM_WIDTH + 91,\n\t\t\t\tCURRENT_LABEL_Y + 6,\n\t\t\t\tHIGHLIGHT_CIRCLE_RADIUS,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tconst right = this.edgesListRight[nextListIndex];\n\t\t\tconst rightRoot = this.setData[right];\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightCircle2,\n\t\t\t\tSET_ARRAY_START_X,\n\t\t\t\tSET_ARRAY_START_Y + this.edgesListRight[nextListIndex] * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelRight,\n\t\t\t\t'find(' + this.toStr(this.edgesListRight[nextListIndex]) + ') = ' + rightRoot,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (leftRoot !== rightRoot) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.messageLabelID,\n\t\t\t\t\t'Vertices in different sets.  Add edge to MST.',\n\t\t\t\t);\n\t\t\t\tthis.highlightEdge(\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tedgesAdded++;\n\t\t\t\tthis.setEdgeColor(\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\tMST_EDGE_COLOR,\n\t\t\t\t);\n\t\t\t\tthis.setEdgeThickness(\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\tMST_EDGE_THICKNESS,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.messageLabelID,\n\t\t\t\t\t'Union sets ' + leftRoot + ' and ' + rightRoot,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tfindLabelLeft, // reusing find label\n\t\t\t\t\t'union(' + this.toStr(left) + ', ' + this.toStr(right) + ')',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setText, findLabelRight, '');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tconst minRoot = Math.min(leftRoot, rightRoot);\n\t\t\t\tconst maxRoot = Math.max(leftRoot, rightRoot);\n\t\t\t\tlet firstMatch = true;\n\t\t\t\tfor (let k = 0; k < this.size; k++) {\n\t\t\t\t\tif (this.setData[k] === maxRoot) {\n\t\t\t\t\t\tif (firstMatch) {\n\t\t\t\t\t\t\tfirstMatch = false;\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\t\thighlightCircle3,\n\t\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR_3,\n\t\t\t\t\t\t\t\tSET_ARRAY_START_X + SET_ARRAY_ELEM_WIDTH,\n\t\t\t\t\t\t\t\tSET_ARRAY_START_Y + k * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_RADIUS,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, highlightCircle3, 1);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\thighlightCircle3,\n\t\t\t\t\t\t\t\tSET_ARRAY_START_X + SET_ARRAY_ELEM_WIDTH,\n\t\t\t\t\t\t\t\tSET_ARRAY_START_Y + k * SET_ARRAY_ELEM_HEIGHT,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.setData[k] = minRoot;\n\t\t\t\t\t\tthis.cmd(act.setText, this.setID[k], minRoot);\n\t\t\t\t\t\t!this.isLarge &&\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setBackgroundColor,\n\t\t\t\t\t\t\t\tthis.setID[k],\n\t\t\t\t\t\t\t\tKRUSKALS_DS_COLORS[minRoot - 1],\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, highlightCircle3);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setText, this.messageLabelID, 'Vertices in the same set, skip edge');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\n\t\t\tthis.highlightEdge(\n\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t0,\n\t\t\t);\n\n\t\t\tthis.cmd(act.delete, highlightCircle1);\n\t\t\tthis.cmd(act.delete, highlightCircle2);\n\n\t\t\tthis.cmd(act.delete, this.edgesListLeftID[nextListIndex]);\n\t\t\tthis.cmd(act.delete, this.edgesListRightID[nextListIndex]);\n\t\t\tthis.cmd(act.setText, findLabelLeft, '');\n\t\t\tthis.cmd(act.setText, findLabelRight, '');\n\t\t\tnextListIndex++;\n\t\t}\n\t\tthis.cmd(act.delete, findLabelLeft);\n\t\tthis.cmd(act.delete, findLabelRight);\n\n\t\tthis.edgesListLeftID = this.edgesListLeftID.slice(nextListIndex);\n\t\tthis.edgesListRightID = this.edgesListRightID.slice(nextListIndex);\n\n\t\tif (edgesAdded === this.size - 1) {\n\t\t\tthis.cmd(act.setText, this.messageLabelID, 'MST has correct amount of edges, done');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.messageLabelID, 'Priority queue is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst INFO_LABEL_X = 75;\nconst INFO_LABEL_Y = 20;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 70;\n\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst BUCKETS_START_X = 100;\nconst BUCKETS_START_Y = 140;\n\nconst BUCKET_ELEM_WIDTH = 50;\nconst BUCKET_ELEM_HEIGHT = 20;\nconst BUCKET_ELEM_SPACING = 15;\n\nconst CODE_START_X = 650;\nconst CODE_START_Y = 140;\n\nexport default class LSDRadix extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements < 0',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.arrayDisplay = [];\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\t\tthis.bucketsDisplay = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.infoLabelID = this.nextIndex++;\n\n\t\tthis.code = [\n\t\t\t['procedure LSDRadixSort(array):'],\n\t\t\t['     buckets <- list of 10 lists'],\n\t\t\t['     iterations <- length of longest number'],\n\t\t\t['     length <- length of array'],\n\t\t\t['     for i <- 1, iterations do'],\n\t\t\t['          for j <- 0, length - 1 do'],\n\t\t\t['               bucket <- ith digit of array[j]'],\n\t\t\t['               add array[j] to buckets[bucket]'],\n\t\t\t['          end for'],\n\t\t\t['          index <- 0'],\n\t\t\t['          for bucket <- 0, 9 do'],\n\t\t\t[\"               while buckets[bucket] isn't empty\"],\n\t\t\t['                    array[index] <- remove first from buckets[bucket]'],\n\t\t\t['                    index <- index + 1'],\n\t\t\t['               end while'],\n\t\t\t['          end for'],\n\t\t\t['     end for'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.arrayDisplay = [];\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\t\tthis.bucketsDisplay = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tfor (let i = 0; i < this.bucketsID.length; i++) {\n\t\t\tfor (let j = 0; j < this.bucketsID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.bucketsID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.arrayDisplay = [];\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\t\tthis.bucketsDisplay = [];\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.highlight(0, 0);\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\t// Create data array\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet arrayDisplay = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tarrayDisplay += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.arrayDisplay[i] = arrayDisplay;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tarrayDisplay,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\t\tthis.highlight(1, 0);\n\n\t\t// Create buckets\n\t\tfor (let i = 0; i < 10; i++) {\n\t\t\tthis.bucketsData[i] = [];\n\t\t\tthis.bucketsID[i] = [];\n\t\t\tthis.bucketsDisplay[i] = [];\n\t\t\tthis.bucketsID[i].push(this.nextIndex++);\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + BUCKETS_START_X;\n\t\t\tconst ypos = BUCKETS_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.bucketsID[i][0],\n\t\t\t\ti,\n\t\t\t\tBUCKET_ELEM_WIDTH,\n\t\t\t\tBUCKET_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.bucketsID[i], '#D3D3D3');\n\t\t}\n\n\t\t// Find number of digits\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.infoLabelID,\n\t\t\t'Searching for number with greatest magnitude',\n\t\t\tINFO_LABEL_X,\n\t\t\tINFO_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#FF0000',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\t\tthis.highlight(2, 0);\n\t\tlet greatest = 0;\n\t\tfor (let i = 1; i < this.arrayData.length; i++) {\n\t\t\tthis.movePointers(greatest, i);\n\t\t\tif (this.arrayData[i] > this.arrayData[greatest]) {\n\t\t\t\tgreatest = i;\n\t\t\t\tthis.movePointers(greatest, i);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[greatest], '#FFFF00');\n\n\t\tlet digits = Math.floor(Math.log10(this.arrayData[greatest])) + 1;\n\t\tdigits = digits || 1; // If greatest is 0, above returns NaN, so set to 1 if that happens\n\n\t\tconst longData = this.arrayData[greatest];\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\tlongData + ' has greatest magnitude, number of digits is ' + digits,\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[greatest], '#FFFFFF');\n\t\tthis.highlight(4, 0);\n\n\t\t// Run algorithm\n\t\tfor (let i = 0; i < digits; i++) {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Getting digits at position ' + (i + 1));\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.iPointerID,\n\t\t\t\t'#0000FF',\n\t\t\t\tARRAY_START_X,\n\t\t\t\tARRAY_START_Y,\n\t\t\t);\n\t\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tfor (let j = 0; j < this.arrayData.length; j++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.iPointerID,\n\t\t\t\t\tARRAY_START_X + j * ARRAY_ELEM_WIDTH,\n\t\t\t\t\tARRAY_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(5, 0);\n\t\t\t\tthis.highlight(6, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\tconst id = this.nextIndex++;\n\t\t\t\tconst data = this.arrayData[j];\n\t\t\t\tconst display = this.arrayDisplay[j];\n\t\t\t\tconst digit = this.nthDigit(data, i);\n\t\t\t\tthis.bucketsID[digit].push(id);\n\t\t\t\tthis.bucketsData[digit].push(data);\n\t\t\t\tthis.bucketsDisplay[digit].push(display);\n\t\t\t\tconst len = this.bucketsData[digit].length;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tid,\n\t\t\t\t\tdisplay,\n\t\t\t\t\tBUCKET_ELEM_WIDTH,\n\t\t\t\t\tBUCKET_ELEM_HEIGHT,\n\t\t\t\t\tBUCKETS_START_X + digit * BUCKET_ELEM_WIDTH,\n\t\t\t\t\tBUCKETS_START_Y + len * BUCKET_ELEM_HEIGHT + len * BUCKET_ELEM_SPACING,\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.bucketsID[digit][this.bucketsID[digit].length - 2],\n\t\t\t\t\tid,\n\t\t\t\t\t0,\n\t\t\t\t\t0,\n\t\t\t\t\t1,\n\t\t\t\t\t'',\n\t\t\t\t\t2,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t}\n\t\t\tthis.cmd(act.delete, this.iPointerID);\n\t\t\tthis.highlight(9, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(9, 0);\n\t\t\tthis.highlight(10, 0);\n\t\t\tlet index = 0;\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let j = 0; j < 10; j++) {\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tconst idBucket = this.bucketsID[j];\n\t\t\t\tconst dataBucket = this.bucketsData[j];\n\t\t\t\tconst displayBucket = this.bucketsDisplay[j];\n\t\t\t\tthis.highlight(11, 0);\n\t\t\t\twhile (dataBucket.length) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\t\tthis.highlight(12, 0);\n\t\t\t\t\tconst labelID = this.nextIndex++;\n\t\t\t\t\tconst nodeID = idBucket.splice(1, 1)[0];\n\t\t\t\t\tconst data = dataBucket.shift();\n\t\t\t\t\tconst display = displayBucket.shift();\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tlabelID,\n\t\t\t\t\t\tdisplay,\n\t\t\t\t\t\tBUCKETS_START_X + j * BUCKET_ELEM_WIDTH,\n\t\t\t\t\t\tBUCKETS_START_Y + BUCKET_ELEM_HEIGHT + BUCKET_ELEM_SPACING,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tlabelID,\n\t\t\t\t\t\tARRAY_START_X + index * ARRAY_ELEM_WIDTH,\n\t\t\t\t\t\tARRAY_START_Y,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setText, this.arrayID[index], display);\n\t\t\t\t\tthis.cmd(act.delete, labelID);\n\t\t\t\t\tthis.cmd(act.delete, nodeID);\n\t\t\t\t\tthis.unhighlight(12, 0);\n\t\t\t\t\tthis.highlight(13, 0);\n\t\t\t\t\tif (dataBucket.length) {\n\t\t\t\t\t\tthis.cmd(act.connect, idBucket[0], idBucket[1]);\n\t\t\t\t\t\tfor (let k = 1; k < idBucket.length; k++) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\tidBucket[k],\n\t\t\t\t\t\t\t\tBUCKETS_START_X + j * BUCKET_ELEM_WIDTH,\n\t\t\t\t\t\t\t\tBUCKETS_START_Y + k * BUCKET_ELEM_HEIGHT + k * BUCKET_ELEM_SPACING,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.arrayData[index] = data;\n\t\t\t\t\tthis.arrayDisplay[index] = display;\n\t\t\t\t\tindex++;\n\t\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\t}\n\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, this.infoLabelID);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t}\n\n\tnthDigit(data, digit) {\n\t\tdata = Math.floor(data / Math.pow(10, digit));\n\t\tdata %= 10;\n\t\treturn data;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst TOP_ELEM_WIDTH = 30;\nconst TOP_ELEM_HEIGHT = 30;\n\nconst SIZE = 32;\n\nexport default class LinkedList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Front',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add to Back',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add at Index',\n\t\t\taddBottomHorizontalGroup,\n\t\t);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Index',\n\t\t\tremoveTopHorizontalGroup,\n\t\t);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Front',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Remove from Back',\n\t\t\tremoveBottomHorizontalGroup,\n\t\t);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.topID = this.nextIndex++;\n\t\tthis.topLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\t// this.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.cmd(act.createLabel, this.topLabelID, 'Head', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.topID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y,\n\t\t);\n\t\tthis.cmd(act.setNull, this.topID, 1);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddIndexCallback() {\n\t\tif (this.addValueField.value !== '' && this.addIndexField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// getCallback()\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tthis.linkedListElemID[index],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (index === this.size) { // adding to back , dont need to do anything to head\n\t\t\tthis.cmd(act.setNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (this.size !== 0) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[index + 1]);\n\t\t\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[index]);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t} else if (index === this.size) {\n\t\t\t\tthis.cmd(act.setNull, this.linkedListElemID[index - 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[0]);\n\t\t}\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.resetNodePositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[index]);\n\t\t\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[index + 1]);\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setNull, this.linkedListElemID[index - 1], 1);\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[index]);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 15;\n\nconst ARRAY_START_X = 450;\nconst ARRAY_START_Y = 50;\nconst ARRAY_LINE_SPACING = 75;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 80;\n\n// const ARRRAY_ELEMS_PER_LINE = 15;\n\n// const TOP_POS_X = 180;\n// const TOP_POS_Y = 100;\n// const TOP_LABEL_X = 130;\n// const TOP_LABEL_Y = 100;\n\n// const PUSH_LABEL_X = 50;\n// const PUSH_LABEL_Y = 30;\n// const PUSH_ELEMENT_X = 120;\n// const PUSH_ELEMENT_Y = 30;\n\n// const SIZE = 10;\n\nconst LARGE_OFFSET = 15;\nconst SMALL_OFFSET = 7;\n\nexport default class MergeSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\n\t\t// Useful for memory management\n\t\tthis.nextIndex = 0;\n\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\n\t\t// structures, etc.\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 15 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.kPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure MergeSort(array)'],\n\t\t\t['     length <- length of array, midIdx <- length / 2'],\n\t\t\t['     leftArray <- array[0...midIdx - 1]'],\n\t\t\t['     rightArray <- array[midIdx...length - 1]'],\n\t\t\t['     MergeSort(leftArray)'],\n\t\t\t['     MergeSort(rightArray)'],\n\t\t\t['     leftIdx, rightIdx, currIdx <- 0'],\n\t\t\t['     while leftIdx < midIdx and rightIdx < length - midIdx do'],\n\t\t\t['          if leftArray[leftIdx] <= rightArray[rightIdx] then'],\n\t\t\t['               array[currIdx] <- leftArray[leftIdx]'],\n\t\t\t['               leftIdx <- leftIdx + 1'],\n\t\t\t['          else'],\n\t\t\t['               array[currIdx] <- rightArray[rightIdx]'],\n\t\t\t['               rightIdx <- rightIdx + 1'],\n\t\t\t['          end if'],\n\t\t\t['          currIdx <- currIdx + 1'],\n\t\t\t['     end while'],\n\t\t\t['     while leftIdx < midIdx do'],\n\t\t\t['          array[currIdx] <- leftArray[leftIdx]'],\n\t\t\t['          currIdx <- currIdx + 1'],\n\t\t\t['          leftIdx <- leftIdx + 1'],\n\t\t\t['     end while'],\n\t\t\t['     while rightIdx < length - midIdx do'],\n\t\t\t['          array[currIdx] <- rightArray[rightIdx]'],\n\t\t\t['          currIdx <- currIdx + 1'],\n\t\t\t['          rightIdx <- rightIdx + 1'],\n\t\t\t['     end while'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.kPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\t\tthis.highlight(0, 0);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst xPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yPos = ARRAY_START_Y;\n\t\t\tthis.arrayID.push(this.nextIndex);\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txPos,\n\t\t\t\tyPos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\n\t\tif (this.arrayData.length !== 1) {\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tconst mid = Math.ceil((this.arrayData.length - 1) / 2);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.leftHelper(0, mid - 1, -LARGE_OFFSET, 0, 1);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.rightHelper(mid, this.arrayData.length - 1, LARGE_OFFSET, 0, 1);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.merge(\n\t\t\t\t0,\n\t\t\t\tthis.arrayData.length - 1,\n\t\t\t\tmid,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\t-LARGE_OFFSET,\n\t\t\t\tLARGE_OFFSET,\n\t\t\t\tthis.arrayID,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[0], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tleftHelper(left, right, offset, prevOffset, row) {\n\t\tthis.cmd(act.step);\n\t\tif (left > right) return;\n\t\tthis.unhighlight(4, 0);\n\t\tthis.unhighlight(5, 0);\n\t\tthis.highlight(0, 0);\n\n\t\tconst tempArrayID = this.drawArrayAndCopy(left, right, offset, prevOffset, row);\n\t\tthis.unhighlight(0, 0);\n\n\t\tif (left !== right) {\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tconst mid = Math.ceil((left + right) / 2);\n\t\t\tconst extraOffset = row < 2 ? 2 * LARGE_OFFSET : 2 * SMALL_OFFSET;\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.leftHelper(left, mid - 1, offset - extraOffset, offset, row + 1);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.leftHelper(mid, right, offset, offset, row + 1);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.merge(left, right, mid, row, offset, offset - extraOffset, offset, tempArrayID);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, tempArrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\trightHelper(left, right, offset, prevOffset, row) {\n\t\tthis.cmd(act.step);\n\t\tif (left > right) return;\n\t\tthis.unhighlight(4, 0);\n\t\tthis.unhighlight(5, 0);\n\t\tthis.highlight(0, 0);\n\n\t\tconst tempArrayID = this.drawArrayAndCopy(left, right, offset, prevOffset, row);\n\t\tthis.unhighlight(0, 0);\n\n\t\tif (left !== right) {\n\t\t\tthis.highlight(2, 0);\n\t\t\tthis.highlight(3, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(2, 0);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tconst mid = Math.ceil((left + right) / 2);\n\t\t\tconst extraOffset = row < 2 ? 2 * LARGE_OFFSET : 2 * SMALL_OFFSET;\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.rightHelper(left, mid - 1, offset, offset, row + 1);\n\t\t\tthis.unhighlight(4, 0);\n\t\t\tthis.highlight(5, 0);\n\t\t\tthis.rightHelper(mid, right, offset + extraOffset, offset, row + 1);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.merge(left, right, mid, row, offset, offset, offset + extraOffset, tempArrayID);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, tempArrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tdrawArrayAndCopy(left, right, offset, prevOffset, row) {\n\t\tconst tempArrayID = [];\n\n\t\t// Display subarray\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tconst xPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X + offset;\n\t\t\tconst yPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\n\t\t\ttempArrayID[i] = this.nextIndex;\n\t\t\tthis.arrayID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txPos,\n\t\t\t\tyPos,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Copy elements from big array to current subarray\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.copyData(\n\t\t\t\ti,\n\t\t\t\ti,\n\t\t\t\tprevOffset,\n\t\t\t\toffset,\n\t\t\t\trow - 1,\n\t\t\t\trow,\n\t\t\t\tthis.displayData[i],\n\t\t\t\ttempArrayID[i],\n\t\t\t\t-1,\n\t\t\t);\n\t\t}\n\n\t\treturn tempArrayID;\n\t}\n\n\tmerge(left, right, mid, row, currOffset, leftOffset, rightOffset, currArrayID) {\n\t\tconst tempArray = new Array(this.arrayData.length); // Temporary array to store data for sorting\n\t\tconst tempDisplay = new Array(this.arrayData.length);\n\n\t\t// Copy data to temporary array\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\ttempArray[i] = this.arrayData[i];\n\t\t\ttempDisplay[i] = this.displayData[i];\n\t\t}\n\n\t\tthis.highlight(6, 0);\n\n\t\t// Create pointers\n\t\tconst bottomYPos = ARRAY_START_Y + (row + 1) * ARRAY_LINE_SPACING;\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst iXPos = left * ARRAY_ELEM_WIDTH + ARRAY_START_X + leftOffset;\n\t\tthis.cmd(act.createHighlightCircle, iPointerID, '#0000FF', iXPos, bottomYPos);\n\t\tconst jPointerID = this.nextIndex++;\n\t\tconst jXPos = mid * ARRAY_ELEM_WIDTH + ARRAY_START_X + rightOffset;\n\t\tthis.cmd(act.createHighlightCircle, jPointerID, '#0000FF', jXPos, bottomYPos);\n\t\tconst kPointerID = this.nextIndex++;\n\t\tconst kXPos = left * ARRAY_ELEM_WIDTH + ARRAY_START_X + currOffset;\n\t\tconst topYPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\n\t\tthis.cmd(act.createHighlightCircle, kPointerID, '#0000FF', kXPos, topYPos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.unhighlight(6, 0);\n\t\tthis.highlight(7, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(7, 0);\n\t\t// Merge data and animate\n\t\tlet i = left;\n\t\tlet j = mid;\n\t\tlet k = left;\n\t\twhile (i < mid && j <= right) {\n\t\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + ++this.compCount);\n\t\t\tthis.highlight(8, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(8, 0);\n\t\t\tif (tempArray[i] <= tempArray[j]) {\n\t\t\t\tthis.highlight(9, 0);\n\t\t\t\tthis.copyData(\n\t\t\t\t\ti,\n\t\t\t\t\tk,\n\t\t\t\t\tleftOffset,\n\t\t\t\t\tcurrOffset,\n\t\t\t\t\trow + 1,\n\t\t\t\t\trow,\n\t\t\t\t\ttempDisplay[i],\n\t\t\t\t\tcurrArrayID[k],\n\t\t\t\t\tiPointerID,\n\t\t\t\t);\n\t\t\t\tthis.unhighlight(9, 0);\n\t\t\t\tthis.arrayData[k] = tempArray[i];\n\t\t\t\tthis.displayData[k] = tempDisplay[i];\n\t\t\t\ti++;\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tif (i < mid) {\n\t\t\t\t\tthis.movePointer(i, row + 1, leftOffset, iPointerID);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t} else {\n\t\t\t\tthis.highlight(11, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(11, 0);\n\t\t\t\tthis.highlight(12, 0);\n\t\t\t\tthis.copyData(\n\t\t\t\t\tj,\n\t\t\t\t\tk,\n\t\t\t\t\trightOffset,\n\t\t\t\t\tcurrOffset,\n\t\t\t\t\trow + 1,\n\t\t\t\t\trow,\n\t\t\t\t\ttempDisplay[j],\n\t\t\t\t\tcurrArrayID[k],\n\t\t\t\t\tjPointerID,\n\t\t\t\t);\n\t\t\t\tthis.unhighlight(12, 0);\n\t\t\t\tthis.arrayData[k] = tempArray[j];\n\t\t\t\tthis.displayData[k] = tempDisplay[j];\n\t\t\t\tj++;\n\t\t\t\tthis.highlight(13, 0);\n\t\t\t\tif (j <= right) {\n\t\t\t\t\tthis.movePointer(j, row + 1, rightOffset, jPointerID);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t}\n\t\t\tk++;\n\t\t\tthis.highlight(15, 0);\n\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(15, 0);\n\t\t}\n\t\tthis.highlight(17, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(17, 0);\n\t\twhile (i < mid) {\n\t\t\tthis.highlight(18, 0);\n\t\t\tthis.copyData(\n\t\t\t\ti,\n\t\t\t\tk,\n\t\t\t\tleftOffset,\n\t\t\t\tcurrOffset,\n\t\t\t\trow + 1,\n\t\t\t\trow,\n\t\t\t\ttempDisplay[i],\n\t\t\t\tcurrArrayID[k],\n\t\t\t\tiPointerID,\n\t\t\t);\n\t\t\tthis.unhighlight(18, 0);\n\t\t\tthis.highlight(19, 0);\n\t\t\tthis.highlight(20, 0);\n\t\t\tthis.arrayData[k] = tempArray[i];\n\t\t\tthis.displayData[k] = tempDisplay[i];\n\t\t\tk++;\n\t\t\ti++;\n\t\t\tif (k <= right) {\n\t\t\t\tthis.movePointer(i, row + 1, leftOffset, iPointerID);\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(19, 0);\n\t\t\tthis.unhighlight(20, 0);\n\t\t}\n\t\tthis.highlight(22, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(22, 0);\n\t\twhile (j <= right) {\n\t\t\tthis.highlight(23, 0);\n\t\t\tthis.copyData(\n\t\t\t\tj,\n\t\t\t\tk,\n\t\t\t\trightOffset,\n\t\t\t\tcurrOffset,\n\t\t\t\trow + 1,\n\t\t\t\trow,\n\t\t\t\ttempDisplay[j],\n\t\t\t\tcurrArrayID[k],\n\t\t\t\tjPointerID,\n\t\t\t);\n\t\t\tthis.unhighlight(23, 0);\n\t\t\tthis.highlight(24, 0);\n\t\t\tthis.highlight(25, 0);\n\t\t\tthis.arrayData[k] = tempArray[j];\n\t\t\tthis.displayData[k] = tempDisplay[j];\n\t\t\tj++;\n\t\t\tk++;\n\t\t\tif (k <= right) {\n\t\t\t\tthis.movePointer(j, row + 1, rightOffset, jPointerID);\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.unhighlight(24, 0);\n\t\t\tthis.unhighlight(25, 0);\n\t\t}\n\n\t\t// Delete pointers\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\tthis.cmd(act.delete, kPointerID);\n\t\tthis.cmd(act.step);\n\t}\n\n\tcopyData(fromIndex, toIndex, fromOffset, toOffset, fromRow, toRow, value, cellID, pointerID) {\n\t\tif (pointerID !== -1) {\n\t\t\tthis.cmd(act.setForegroundColor, pointerID, '#FF0000');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst fromXPos = fromIndex * ARRAY_ELEM_WIDTH + ARRAY_START_X + fromOffset;\n\t\tconst fromYPos = ARRAY_START_Y + fromRow * ARRAY_LINE_SPACING;\n\t\tconst labelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, labelID, value, fromXPos, fromYPos);\n\t\tconst toXPos = toIndex * ARRAY_ELEM_WIDTH + ARRAY_START_X + toOffset;\n\t\tconst toYPos = ARRAY_START_Y + toRow * ARRAY_LINE_SPACING;\n\t\tthis.cmd(act.move, labelID, toXPos, toYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, cellID, value);\n\t\tthis.cmd(act.delete, labelID);\n\t\tif (pointerID !== -1) {\n\t\t\tthis.cmd(act.setBackgroundColor, cellID, '#2ECC71');\n\t\t\tthis.cmd(act.setForegroundColor, pointerID, '#0000FF');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tmovePointer(index, row, offset, pointerID) {\n\t\tconst xPos = index * ARRAY_ELEM_WIDTH + ARRAY_START_X + offset;\n\t\tconst yPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\n\t\tthis.cmd(act.move, pointerID, xPos, yPos);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Hash from './Hash.js';\nimport { act } from '../anim/AnimationMain';\n\nconst POINTER_ARRAY_ELEM_WIDTH = 50;\nconst POINTER_ARRAY_ELEM_HEIGHT = 25;\nconst POINTER_ARRAY_ELEM_START_X = 70;\nconst POINTER_ARRAY_ELEM_START_Y = 100;\n\nconst RESIZE_POINTER_ARRAY_ELEM_START_X = 670;\nconst RESIZE_POINTER_ARRAY_ELEM_START_Y = 50;\nconst RESIZE_LABEL_X = 800;\nconst RESIZE_LABEL_Y = 20;\n\nconst LINKED_ITEM_WIDTH = 70;\nconst LINKED_ITEM_HEIGHT = 20;\n\nconst LINKED_ITEM_INITIAL_X = 60;\nconst LINKED_ITEM_INITIAL_Y = 40;\nconst LINKED_ITEM_X_DELTA_INIT = 70;\nconst LINKED_ITEM_X_DELTA = 90;\n\nconst EXPLAIN_LABEL_X = 550;\nconst EXPLAIN_LABEL_Y = 15;\n\nconst HASH_TABLE_SIZE = 7;\n\nconst DEFAULT_LOAD_FACTOR = 0.67;\n\nconst LOAD_LABEL_X = 60;\nconst LOAD_LABEL_Y = 20;\n\nconst MAX_SIZE = 30;\n\nconst INDEX_COLOR = '#0000FF';\n\nexport default class OpenHash extends Hash {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.nextIndex = 0;\n\t\tthis.POINTER_ARRAY_ELEM_Y = h - POINTER_ARRAY_ELEM_WIDTH;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tsuper.addControls();\n\t}\n\n\tsetup() {\n\t\tthis.hashTableVisual = new Array(HASH_TABLE_SIZE);\n\t\tthis.hashTableIndices = new Array(HASH_TABLE_SIZE);\n\t\tthis.hashTableValues = new Array(HASH_TABLE_SIZE);\n\t\tthis.indexXPos = new Array(HASH_TABLE_SIZE);\n\t\tthis.indexYPos = new Array(HASH_TABLE_SIZE);\n\n\t\tthis.ExplainLabel = this.nextIndex++;\n\n\t\tthis.loadFactorID = this.nextIndex++;\n\n\t\tthis.size = 0;\n\n\t\tthis.table_size = HASH_TABLE_SIZE;\n\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\n\n\t\tthis.resetIndex = this.nextIndex;\n\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < HASH_TABLE_SIZE; i++) {\n\t\t\tlet nextID = this.nextIndex++;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tnextID,\n\t\t\t\t'',\n\t\t\t\tPOINTER_ARRAY_ELEM_WIDTH,\n\t\t\t\tPOINTER_ARRAY_ELEM_HEIGHT,\n\t\t\t\tPOINTER_ARRAY_ELEM_START_X,\n\t\t\t\tPOINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.hashTableVisual[i] = nextID;\n\t\t\tthis.cmd(act.setNull, this.hashTableVisual[i], 1);\n\n\t\t\tnextID = this.nextIndex++;\n\t\t\tthis.hashTableIndices[i] = nextID;\n\t\t\tthis.hashTableValues[i] = null;\n\n\t\t\tthis.indexXPos[i] = POINTER_ARRAY_ELEM_START_X - POINTER_ARRAY_ELEM_WIDTH;\n\t\t\tthis.indexYPos[i] = POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(act.createLabel, nextID, i, this.indexXPos[i], this.indexYPos[i]);\n\t\t\tthis.cmd(act.setForegroundColor, nextID, INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.loadFactorID,\n\t\t\t`Load Factor: ${this.load_factor}`,\n\t\t\tLOAD_LABEL_X,\n\t\t\tLOAD_LABEL_Y,\n\t\t);\n\t\tthis.cmd(act.createLabel, this.ExplainLabel, '', EXPLAIN_LABEL_X, EXPLAIN_LABEL_Y, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tinsertElement(key, value) {\n\t\tconst elem = `<${key}, ${value}>`;\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\n\t\tif (\n\t\t\t(this.size + 1) / this.table_size > this.load_factor &&\n\t\t\tthis.table_size * 2 + 1 < MAX_SIZE\n\t\t) {\n\t\t\tthis.resize();\n\t\t}\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting element ' + elem);\n\t\tconst node = new LinkedListNode(key, value, this.nextIndex++, LINKED_ITEM_INITIAL_X, LINKED_ITEM_INITIAL_Y);\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tnode.graphicID,\n\t\t\telem,\n\t\t\tLINKED_ITEM_WIDTH,\n\t\t\tLINKED_ITEM_HEIGHT,\n\t\t\tLINKED_ITEM_INITIAL_X,\n\t\t\tLINKED_ITEM_INITIAL_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1\n\t\t);\n\n\t\tconst index = this.doHash(key);\n\n\t\tlet found = false;\n\t\tlet prev = null;\n\t\tlet old;\n\t\tif (this.hashTableValues[index] != null) {\n\t\t\t// Search for duplicates\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Searching for duplicates of ' + key);\n\n\t\t\tconst compareIndex = this.nextIndex++;\n\t\t\tlet tmp = this.hashTableValues[index];\n\t\t\tthis.cmd(act.createLabel, compareIndex, '', EXPLAIN_LABEL_X, EXPLAIN_LABEL_Y + 30, 0);\n\t\t\twhile (tmp != null && !found) {\n\t\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 1);\n\t\t\t\tif (tmp.key === key) {\n\t\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.key + '==' + key);\n\t\t\t\t\told = tmp;\n\t\t\t\t\tfound = true;\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.key + '!=' + key);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\t\tprev = tmp;\n\t\t\t\ttmp = tmp.next;\n\t\t\t}\n\n\t\t\tthis.cmd(act.delete, compareIndex);\n\t\t\tthis.nextIndex--;\n\t\t} else {\n\t\t\tthis.cmd(act.setNull, node.graphicID, 1);\n\t\t\tthis.cmd(act.setNull, this.hashTableVisual[index], 0);\n\t\t}\n\n\t\tif (found) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Key ' + key + ' is already in HashMap, updating value.',\n\t\t\t);\n\t\t\tthis.cmd(act.delete, old.graphicID);\n\t\t\tnode.next = old.next;\n\n\t\t\tif (prev != null) {\n\t\t\t\tprev.next = node;\n\t\t\t\tthis.cmd(act.connect, prev.graphicID, node.graphicID);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.hashTableVisual[index],\n\t\t\t\t\tthis.hashTableValues[index].graphicID,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.connect, this.hashTableVisual[index], node.graphicID);\n\t\t\t\tthis.hashTableValues[index] = node;\n\t\t\t}\n\t\t\tif (node.next != null) {\n\t\t\t\tthis.cmd(act.connect, node.graphicID, node.next.graphicID);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setNull, node.graphicID, 1);\n\t\t\t}\n\n\t\t\tthis.repositionList(index, this.hashTableValues[index]);\n\t\t\tthis.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Duplicate of  ' + key + '  not found!');\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (this.hashTableValues[index] != null) {\n\t\t\t\tthis.cmd(act.connect, node.graphicID, this.hashTableValues[index].graphicID);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.hashTableVisual[index],\n\t\t\t\t\tthis.hashTableValues[index].graphicID,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.cmd(act.connect, this.hashTableVisual[index], node.graphicID);\n\t\t\tnode.next = this.hashTableValues[index];\n\t\t\tthis.hashTableValues[index] = node;\n\t\t\tthis.repositionList(index, this.hashTableValues[index]);\n\t\t\tthis.size++;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\n\t\treturn this.commands;\n\t}\n\n\trepositionList(index, tmp) {\n\t\tlet startX = POINTER_ARRAY_ELEM_START_X + LINKED_ITEM_X_DELTA_INIT;\n\t\tconst startY = POINTER_ARRAY_ELEM_START_Y + index * POINTER_ARRAY_ELEM_HEIGHT;\n\t\t// let tmp = this.hashTableValues[index];\n\t\twhile (tmp != null) {\n\t\t\ttmp.x = startX;\n\t\t\ttmp.y = startY;\n\t\t\tthis.cmd(act.move, tmp.graphicID, tmp.x, tmp.y);\n\t\t\tstartX = startX + LINKED_ITEM_X_DELTA;\n\t\t\ttmp = tmp.next;\n\t\t}\n\t}\n\n\trepositionResizeList(index) {\n\t\tlet startX = RESIZE_POINTER_ARRAY_ELEM_START_X + LINKED_ITEM_X_DELTA_INIT;\n\t\tconst startY = RESIZE_POINTER_ARRAY_ELEM_START_Y + index * POINTER_ARRAY_ELEM_HEIGHT;\n\t\tlet tmp = this.hashTableValues[index];\n\t\twhile (tmp != null) {\n\t\t\ttmp.x = startX;\n\t\t\ttmp.y = startY;\n\t\t\tthis.cmd(act.move, tmp.graphicID, tmp.x, tmp.y);\n\t\t\tstartX = startX + LINKED_ITEM_X_DELTA;\n\t\t\ttmp = tmp.next;\n\t\t}\n\t}\n\n\tdeleteElement(key) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Deleting entry with key: ' + key);\n\t\tconst index = this.doHash(key);\n\t\tif (this.hashTableValues[index] == null) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting entry with key: ' + key + '  Key not in table',\n\t\t\t);\n\t\t\treturn this.commands;\n\t\t}\n\t\tthis.cmd(act.setHighlight, this.hashTableValues[index].graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.hashTableValues[index].graphicID, 0);\n\t\tif (this.hashTableValues[index].key === key) {\n\t\t\tif (this.hashTableValues[index].next != null) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.hashTableVisual[index],\n\t\t\t\t\tthis.hashTableValues[index].next.graphicID,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setNull, this.hashTableVisual[index], 1);\n\t\t\t}\n\t\t\tthis.cmd(act.delete, this.hashTableValues[index].graphicID);\n\t\t\tthis.hashTableValues[index] = this.hashTableValues[index].next;\n\t\t\tthis.repositionList(index, this.hashTableValues[index]);\n\t\t\tthis.size--;\n\t\t\treturn this.commands;\n\t\t}\n\t\tlet tmpPrev = this.hashTableValues[index];\n\t\tlet tmp = this.hashTableValues[index].next;\n\t\tlet found = false;\n\t\twhile (tmp != null && !found) {\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\tif (tmp.key === key) {\n\t\t\t\tfound = true;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.ExplainLabel,\n\t\t\t\t\t'Deleting entry with key: ' + key + '  Entry deleted',\n\t\t\t\t);\n\t\t\t\tif (tmp.next != null) {\n\t\t\t\t\tthis.cmd(act.connect, tmpPrev.graphicID, tmp.next.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setNull, tmpPrev.graphicID, 1);\n\t\t\t\t}\n\t\t\t\ttmpPrev.next = tmpPrev.next.next;\n\t\t\t\tthis.cmd(act.delete, tmp.graphicID);\n\t\t\t\tthis.repositionList(index, this.hashTableValues[index]);\n\t\t\t\tthis.size--;\n\t\t\t} else {\n\t\t\t\ttmpPrev = tmp;\n\t\t\t\ttmp = tmp.next;\n\t\t\t}\n\t\t}\n\t\tif (!found) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting entry with key: ' + key + '  Key not in table',\n\t\t\t);\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tfindElement(key) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding entry with key: ' + key);\n\n\t\tconst index = this.doHash(key);\n\t\tconst compareIndex = this.nextIndex++;\n\t\tlet found = false;\n\t\tlet tmp = this.hashTableValues[index];\n\t\tlet value = null;\n\t\tthis.cmd(act.createLabel, compareIndex, '', 10, 40, 0);\n\t\twhile (tmp != null && !found) {\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 1);\n\t\t\tif (tmp.key === key) {\n\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.key + '==' + key);\n\t\t\t\tfound = true;\n\t\t\t\tvalue = tmp.val;\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.key + '!=' + key);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\ttmp = tmp.next;\n\t\t}\n\t\tif (found) {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Found entry with key: ' + key + '  Value: ' + value);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Finding entry with key: ' + key + '  Not Found!',\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.delete, compareIndex);\n\t\tthis.nextIndex--;\n\t\treturn this.commands;\n\t}\n\n\tresize() {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\n\t\tconst resizeLabel = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tresizeLabel,\n\t\t\t`(Resize Required): (Size + 1 / length) > Load Factor --> (${this.size} + 1 / ${\n\t\t\t\tthis.table_size\n\t\t\t}) > ${this.load_factor}`,\n\t\t\tRESIZE_LABEL_X,\n\t\t\tRESIZE_LABEL_Y,\n\t\t);\n\n\t\tthis.table_size = this.table_size * 2 + 1;\n\n\t\tif (this.table_size * 2 + 1 > MAX_SIZE) {\n\t\t\tthis.load_factor = 0.99;\n\t\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\t\t}\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.oldHashTableVisual = this.hashTableVisual;\n\t\tthis.oldHashTableValues = this.hashTableValues;\n\t\tthis.oldHashTableIndices = this.hashTableIndices;\n\t\tthis.oldIndexXPos = this.indexXPos;\n\t\tthis.oldIndexYPos = this.indexYPos;\n\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.hashTableIndices = new Array(this.table_size);\n\t\tthis.indexXPos = new Array(this.table_size);\n\t\tthis.indexYPos = new Array(this.table_size);\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tlet nextID = this.nextIndex++;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tnextID,\n\t\t\t\t'',\n\t\t\t\tPOINTER_ARRAY_ELEM_WIDTH,\n\t\t\t\tPOINTER_ARRAY_ELEM_HEIGHT,\n\t\t\t\tRESIZE_POINTER_ARRAY_ELEM_START_X,\n\t\t\t\tRESIZE_POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT,\n\t\t\t);\n\t\t\tthis.hashTableVisual[i] = nextID;\n\t\t\tthis.cmd(act.setNull, this.hashTableVisual[i], 1);\n\n\t\t\tnextID = this.nextIndex++;\n\t\t\tthis.hashTableIndices[i] = nextID;\n\t\t\tthis.hashTableValues[i] = null;\n\n\t\t\tthis.indexXPos[i] = RESIZE_POINTER_ARRAY_ELEM_START_X - POINTER_ARRAY_ELEM_WIDTH;\n\t\t\tthis.indexYPos[i] = RESIZE_POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(act.createLabel, nextID, i, this.indexXPos[i], this.indexYPos[i]);\n\t\t\tthis.cmd(act.setForegroundColor, nextID, INDEX_COLOR);\n\t\t}\n\n\t\tfor (let i = 0; i < (this.table_size - 1) / 2; i++) {\n\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 1);\n\t\t\tthis.cmd(act.step);\n\n\t\t\twhile (this.oldHashTableValues[i] != null) {\n\t\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 0);\n\n\t\t\t\tconst node = this.oldHashTableValues[i];\n\t\t\t\tthis.cmd(act.setHighlight, node.graphicID, 1);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.move, node.graphicID, LINKED_ITEM_INITIAL_X, LINKED_ITEM_INITIAL_Y);\n\n\t\t\t\tthis.oldHashTableValues[i] = this.oldHashTableValues[i].next;\n\n\t\t\t\tthis.cmd(act.disconnect, this.oldHashTableVisual[i], node.graphicID);\n\t\t\t\tif (this.oldHashTableValues[i] != null) {\n\t\t\t\t\tthis.cmd(act.connect, this.oldHashTableVisual[i], this.oldHashTableValues[i].graphicID);\n\t\t\t\t\tthis.cmd(act.disconnect, node.graphicID, this.oldHashTableValues[i].graphicID);\n\t\t\t\t\tthis.repositionList(i, this.oldHashTableValues[i]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setNull, this.oldHashTableVisual[i], 1);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tconst index = this.doHash(node.key);\n\n\t\t\t\tnode.next = this.hashTableValues[index];\n\t\t\t\tthis.cmd(act.setNull, node.graphicID, 1);\n\t\t\t\tthis.cmd(act.setNull, this.hashTableVisual[index], 0);\n\n\t\t\t\tif (node.next != null) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.disconnect,\n\t\t\t\t\t\tthis.hashTableVisual[index],\n\t\t\t\t\t\tnode.next.graphicID,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.connect, node.graphicID, node.next.graphicID);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.connect, this.hashTableVisual[index], node.graphicID);\n\t\t\t\tthis.hashTableValues[index] = node;\n\t\t\t\tthis.repositionResizeList(index);\n\t\t\t\t\n\t\t\t\tthis.cmd(act.setHighlight, node.graphicID, 0);\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, this.oldHashTableVisual[i], 0);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < (this.table_size - 1) / 2; i++) {\n\t\t\tthis.cmd(act.setNull, this.oldHashTableVisual[i], 1);\n\t\t\tthis.cmd(act.delete, this.oldHashTableVisual[i]);\n\t\t\tthis.cmd(act.delete, this.oldHashTableIndices[i]);\n\t\t}\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tconst xpos = POINTER_ARRAY_ELEM_START_X;\n\t\t\tconst ypos = POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.indexXPos[i] = POINTER_ARRAY_ELEM_START_X - POINTER_ARRAY_ELEM_WIDTH;\n\t\t\tthis.indexYPos[i] = POINTER_ARRAY_ELEM_START_Y + i * POINTER_ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(act.move, this.hashTableVisual[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.hashTableIndices[i], xpos - POINTER_ARRAY_ELEM_WIDTH, ypos);\n\n\t\t\tlet index = 0;\n\t\t\tlet tmp = this.hashTableValues[i];\n\t\t\twhile (tmp != null) {\n\t\t\t\tthis.cmd(act.move, tmp.graphicID, xpos + LINKED_ITEM_X_DELTA_INIT + (LINKED_ITEM_X_DELTA * index), ypos);\n\t\t\t\tindex++;\n\t\t\t\ttmp = tmp.next;\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, resizeLabel);\n\t\tthis.cmd(act.step);\n\t}\n\n\tchangeLoadFactor(LF) {\n\t\tthis.commands = [];\n\n\t\tif (this.table_size * 2 + 1 <= MAX_SIZE) {\n\t\t\tthis.load_factor = LF;\n\t\t\tthis.cmd(act.setText, this.loadFactorID, `Load Factor: ${this.load_factor}`);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.loadFactorID,\n\t\t\t\t`Load Factor: ${this.load_factor}\n\t\t\t(Max Array Length)`,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tresetAll() {\n\t\tlet tmp;\n\t\tthis.commands = super.resetAll();\n\n\t\tthis.size = 0;\n\n\t\tfor (let i = 0; i < this.hashTableValues.length; i++) {\n\t\t\ttmp = this.hashTableValues[i];\n\t\t\tif (tmp != null) {\n\t\t\t\twhile (tmp != null) {\n\t\t\t\t\tthis.cmd(act.delete, tmp.graphicID);\n\t\t\t\t\ttmp = tmp.next;\n\t\t\t\t}\n\t\t\t\tthis.hashTableValues[i] = null;\n\t\t\t\tthis.cmd(act.setNull, this.hashTableVisual[i], 1);\n\t\t\t}\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\t// NEED TO OVERRIDE IN PARENT\n\treset() {\n\t\tthis.nextIndex = this.resetIndex;\n\t\tthis.table_size = HASH_TABLE_SIZE;\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\n\t\tthis.size = 0;\n\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.hashTableValues = new Array(this.table_size);\n\t\tthis.hashTableIndices = new Array(HASH_TABLE_SIZE);\n\n\t\tthis.indexXPos = new Array(HASH_TABLE_SIZE);\n\t\tthis.indexYPos = new Array(HASH_TABLE_SIZE);\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.hashTableValues[i] = null;\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\n\t\t\tthis.hashTableIndices[i] = this.nextIndex++;\n\t\t}\n\t\t\n\t\tsuper.reset();\n\t}\n\n\t/*this.nextIndex = 0;\n this.commands = [];\n this.cmd(act.createLabel, 0, \"\", 20, 50, 0);\n this.animationManager.startNewAnimation(this.commands);\n this.animationManager.skipForward();\n this.animationManager.clearHistory(); */\n\n\tdisableUI() {\n\t\tsuper.disableUI();\n\t}\n\n\tenableUI() {\n\t\tsuper.enableUI();\n\t}\n}\n\nclass LinkedListNode {\n\tconstructor(key, val, id, initialX, initialY) {\n\t\tthis.key = key;\n\t\tthis.val = val;\n\t\tthis.graphicID = id;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.next = null;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport Graph from './Graph.js';\nimport { PRIMS_KRUSKALS_ADJ_LIST } from './util/GraphValues';\nimport PriorityQueue from './util/PriorityQueue';\nimport { act } from '../anim/AnimationMain';\n\nconst PQ_DEQUEUED_COLOR = '#0000FF';\nconst VISITED_COLOR = '#99CCFF';\nconst MST_EDGE_COLOR = '#3399FF';\nconst MST_EDGE_THICKNESS = 4;\n\nconst INFO_MSG_X = 25;\nconst INFO_MSG_Y = 15;\n\nconst VISITED_START_X = 30;\nconst VISITED_START_Y = 65;\nconst VISITED_SPACING = 20;\n\nconst CURRENT_EDGE_LABEL_X = 25;\nconst CURRENT_EDGE_LABEL_Y = 90;\nconst CURRENT_VERTEX_X = 110;\nconst CURRENT_VERTEX_Y = 96;\n\nconst PQ_LABEL_X = 25;\nconst PQ_LABEL_Y = 115;\n\nconst PQ_X = 45;\nconst PQ_Y = 143;\nconst PQ_SPACING = 50;\nconst PQ_LINE_SPACING = 25;\nconst PQ_MAX_PER_LINE = 8;\n\nexport default class Prims extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, PRIMS_KRUSKALS_ADJ_LIST, false, false, true);\n\t\tthis.addControls();\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start vertex: ');\n\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse,\n\t\t);\n\t\tthis.startField.size = 2;\n\t\tthis.controls.push(this.startField);\n\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\t\tthis.controls.push(this.startButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls(false);\n\t}\n\n\tsetup(adjMatrix) {\n\t\tsuper.setup(adjMatrix);\n\t\tthis.commands = [];\n\t\tthis.messageID = null;\n\n\t\tthis.visited = [];\n\t\tthis.visitedID = [];\n\t\tthis.pq = new PriorityQueue();\n\n\t\tthis.infoLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited Set:',\n\t\t\tVISITED_START_X - 5,\n\t\t\tVISITED_START_Y - 25,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current edge:',\n\t\t\tCURRENT_EDGE_LABEL_X,\n\t\t\tCURRENT_EDGE_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.createLabel, this.nextIndex++, 'Priority Queue:', PQ_LABEL_X, PQ_LABEL_Y, 0);\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.highlightCircleL = this.nextIndex++;\n\t\tthis.highlightCircleAL = this.nextIndex++;\n\t\tthis.highlightCircleAM = this.nextIndex++;\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.messageID = [];\n\t\tthis.visitedID = [];\n\t\tthis.pq = new PriorityQueue();\n\t}\n\n\tstartCallback() {\n\t\tif (this.startField.value !== '') {\n\t\t\tlet startvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size)\n\t\t\t\tthis.implementAction(this.doPrim.bind(this), startvalue);\n\t\t}\n\t}\n\n\tdoPrim(startVertex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.visitedID = [];\n\n\t\tthis.visitVertex(startVertex);\n\n\t\tthis.visited[startVertex] = true;\n\t\tthis.visitedID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\tthis.toStr(startVertex),\n\t\t\tVISITED_START_X,\n\t\t\tVISITED_START_Y,\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[startVertex], VISITED_COLOR);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\t'Adding ' + this.toStr(startVertex) + ' to visited set',\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tthis.pq = new PriorityQueue();\n\t\tlet pqIDs = [];\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Enqueuing edges of ' + this.toStr(startVertex));\n\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\tconst weight = this.adj_matrix[startVertex][neighbor];\n\t\t\tif (weight > 0) {\n\t\t\t\tthis.highlightEdge(startVertex, neighbor, 1);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\t'(' + this.toStr(startVertex) + this.toStr(neighbor) + ', ' + weight + ')',\n\t\t\t\t\tPQ_X + (this.pq.size() % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\tPQ_Y + Math.floor(this.pq.size() / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t);\n\t\t\t\tthis.pq.enqueue([startVertex, neighbor], this.nextIndex++, weight);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tconst newPqIDs = this.pq.getIDs();\n\t\t\t\tif (String(pqIDs) !== String(newPqIDs.slice(0, -1))) {\n\t\t\t\t\t// Check if newly enqueued element shifted things\n\t\t\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tnewPqIDs[i],\n\t\t\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\tPQ_Y + Math.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tpqIDs = newPqIDs;\n\t\t\t\tthis.highlightEdge(startVertex, neighbor, 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.leaveVertex();\n\n\t\twhile (this.visited.includes(false) && this.pq.size() !== 0) {\n\t\t\tconst [edge, edgeID] = this.pq.dequeue();\n\t\t\tlet edgeStr = this.toStr(edge[0]) + this.toStr(edge[1]);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.infoLabelID,\n\t\t\t\t'Dequeued ' + edgeStr + ', with destination ' + this.toStr(edge[1]),\n\t\t\t);\n\t\t\tthis.cmd(act.move, edgeID, CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\t\t\tthis.cmd(act.setText, edgeID, this.toStr(edge[0]) + this.toStr(edge[1]));\n\t\t\tthis.cmd(act.setTextColor, edgeID, PQ_DEQUEUED_COLOR);\n\t\t\tpqIDs = this.pq.getIDs();\n\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tpqIDs[i],\n\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\tPQ_Y + Math.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.highlightEdge(edge[0], edge[1], 1);\n\t\t\tthis.visitVertex(edge[1]);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (!this.visited[edge[1]]) {\n\t\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Adding ' + edgeStr + ' to MST');\n\t\t\t\tthis.highlightEdge(edge[0], edge[1], 0);\n\t\t\t\tthis.setEdgeColor(edge[0], edge[1], MST_EDGE_COLOR);\n\t\t\t\tthis.setEdgeThickness(edge[0], edge[1], MST_EDGE_THICKNESS);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.visited[edge[1]] = true;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Adding ' + this.toStr(edge[1]) + ' to visited set',\n\t\t\t\t);\n\t\t\t\tthis.visitedID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\tthis.toStr(edge[1]),\n\t\t\t\t\tVISITED_START_X + (this.visitedID.length - 1) * VISITED_SPACING,\n\t\t\t\t\tVISITED_START_Y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[edge[1]], VISITED_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t'Enqueuing edges of ' + this.toStr(edge[1]),\n\t\t\t\t);\n\t\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\t\tif (this.adj_matrix[edge[1]][neighbor] >= 0) {\n\t\t\t\t\t\tthis.highlightEdge(edge[1], neighbor, 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.circleID[neighbor], 1);\n\t\t\t\t\t\tif (this.visited[neighbor]) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\t'Vertex ' +\n\t\t\t\t\t\t\t\t\tthis.toStr(neighbor) +\n\t\t\t\t\t\t\t\t\t' has already been visited, skipping',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.circleID[neighbor], 0);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\t'Vertex ' + this.toStr(neighbor) + ' has not yet been visited',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, this.circleID[neighbor], 0);\n\t\t\t\t\t\t\tedgeStr = this.toStr(edge[1]) + this.toStr(neighbor);\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\t\t\t\t'Enqueueing edge ' +\n\t\t\t\t\t\t\t\t\tedgeStr +\n\t\t\t\t\t\t\t\t\t' with weight ' +\n\t\t\t\t\t\t\t\t\tthis.adj_matrix[edge[1]][neighbor],\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\t\t\t\t'(' + edgeStr + ', ' + this.adj_matrix[edge[1]][neighbor] + ')',\n\t\t\t\t\t\t\t\tPQ_X + (this.pq.size() % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\t\tPQ_Y +\n\t\t\t\t\t\t\t\t\tMath.floor(this.pq.size() / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.pq.enqueue(\n\t\t\t\t\t\t\t\t[edge[1], neighbor],\n\t\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\t\tthis.adj_matrix[edge[1]][neighbor],\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\tconst newPqIDs = this.pq.getIDs();\n\t\t\t\t\t\t\tif (String(pqIDs) !== String(newPqIDs.slice(0, -1))) {\n\t\t\t\t\t\t\t\t// Check if newly enqueued element shifted things\n\t\t\t\t\t\t\t\tfor (let i = 0; i < this.pq.size(); i++) {\n\t\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\t\tnewPqIDs[i],\n\t\t\t\t\t\t\t\t\t\tPQ_X + (i % PQ_MAX_PER_LINE) * PQ_SPACING,\n\t\t\t\t\t\t\t\t\t\tPQ_Y + Math.floor(i / PQ_MAX_PER_LINE) * PQ_LINE_SPACING,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpqIDs = newPqIDs;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.highlightEdge(edge[1], neighbor, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.highlightEdge(edge[0], edge[1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.infoLabelID,\n\t\t\t\t\tthis.toStr(edge[1]) + ' has already been visited, skipping',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.leaveVertex();\n\t\t\tthis.cmd(act.delete, edgeID);\n\t\t}\n\n\t\tif (this.pq.size() > 0) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.infoLabelID,\n\t\t\t\t'MST has correct amount of edges / all vertices have been visited, done',\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Priority queue is empty, done');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tthis.recolorGraph();\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], '#FFFFFF');\n\t\t\tthis.visited[i] = false;\n\t\t}\n\t\tfor (let i = 0; i < this.visitedID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.visitedID[i]);\n\t\t}\n\t\tconst pqIDs = this.pq.getIDs();\n\t\tfor (const id of pqIDs) {\n\t\t\tthis.cmd(act.delete, id);\n\t\t}\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.messageID = [];\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRAY_ELEMS_PER_LINE = 14;\nconst ARRAY_LINE_SPACING = 130;\n\nconst FRONT_POS_X = 180;\nconst FRONT_POS_Y = 100;\nconst FRONT_LABEL_X = 130;\nconst FRONT_LABEL_Y = 100;\n\nconst SIZE_POS_X = 280;\nconst SIZE_POS_Y = 100;\nconst SIZE_LABEL_X = 230;\nconst SIZE_LABEL_Y = 100;\n\nconst QUEUE_LABEL_X = 60;\nconst QUEUE_LABEL_Y = 30;\nconst QUEUE_ELEMENT_X = 130;\nconst QUEUE_ELEMENT_Y = 30;\n\nconst QUEUE_INDEX_X = 129;\nconst QUEUE_INDEX_Y = 50;\nconst QUEUE_INDEXVAL_X = 260;\nconst QUEUE_INDEXVAL_Y = 50;\n\nconst RESIZE_ARRAY_START_X = 100;\nconst RESIZE_ARRAY_START_Y = 300;\nconst QUEUE_RESIZE_LABEL_X = 60;\nconst QUEUE_RESIZE_LABEL_Y = 60;\n\nconst INDEX_COLOR = '#0000FF';\n\nconst FRONT_LABEL_OFFSET = -40;\n\nconst SIZE = 7;\nconst MAX_SIZE = 30;\n\nexport default class QueueArray extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.enqueueField = addControlToAlgorithmBar('Text', '');\n\t\tthis.enqueueField.onkeydown = this.returnSubmit(\n\t\t\tthis.enqueueField,\n\t\t\tthis.enqueueCallback.bind(this),\n\t\t\t4,\n\t\t);\n\n\t\tthis.enqueueButton = addControlToAlgorithmBar('Button', 'Enqueue');\n\t\tthis.enqueueButton.onclick = this.enqueueCallback.bind(this);\n\t\tthis.controls.push(this.enqueueField);\n\t\tthis.controls.push(this.enqueueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.dequeueButton = addControlToAlgorithmBar('Button', 'Dequeue');\n\t\tthis.dequeueButton.onclick = this.dequeueCallback.bind(this);\n\t\tthis.controls.push(this.dequeueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.frontID = this.nextIndex++;\n\t\tconst frontLabelID = this.nextIndex++;\n\t\tthis.sizeID = this.nextIndex++;\n\t\tconst sizeLabelID = this.nextIndex++;\n\t\tthis.frontPointerID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, frontLabelID, 'Front', FRONT_LABEL_X, FRONT_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.frontID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, sizeLabelID, 'Size', SIZE_LABEL_X, SIZE_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.sizeID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tSIZE_POS_X,\n\t\t\tSIZE_POS_Y,\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.frontPointerID,\n\t\t\t'Front',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + FRONT_LABEL_OFFSET,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.top = 0;\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.nextIndex = this.nextIndex + 7;\n\t}\n\n\tenqueueCallback() {\n\t\tif (this.size < this.arrayData.length && this.enqueueField.value !== '') {\n\t\t\tconst pushVal = this.enqueueField.value;\n\t\t\tthis.enqueueField.value = '';\n\t\t\tthis.implementAction(this.enqueue.bind(this), pushVal);\n\t\t} else if (\n\t\t\tthis.size === this.arrayData.length &&\n\t\t\tthis.enqueueField !== '' &&\n\t\t\tthis.size * 2 < MAX_SIZE\n\t\t) {\n\t\t\tconst pushVal = this.enqueueField.value;\n\t\t\tthis.enqueueField.value = '';\n\t\t\tthis.implementAction(this.resize.bind(this), pushVal);\n\t\t}\n\t}\n\n\tdequeueCallback() {\n\t\tif (this.size !== 0) {\n\t\t\tthis.implementAction(this.dequeue.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tenqueue(elemToEnqueue) {\n\t\tthis.commands = [];\n\n\t\tconst labEnqueueID = this.nextIndex++;\n\t\tconst labEnqueueValID = this.nextIndex++;\n\t\tconst labIndexID = this.nextIndex++;\n\t\tconst labIndexValID = this.nextIndex++;\n\n\t\tconst newTail = (this.front + this.size) % this.arrayData.length;\n\t\tthis.arrayData[newTail] = elemToEnqueue;\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labEnqueueID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labEnqueueValID, elemToEnqueue, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabIndexID,\n\t\t\t'Enqueueing at (front + size) % array.length: ',\n\t\t\tQUEUE_INDEX_X,\n\t\t\tQUEUE_INDEX_Y,\n\t\t);\n\t\tthis.cmd(act.createLabel, labIndexValID, newTail, QUEUE_INDEXVAL_X, QUEUE_INDEXVAL_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (newTail % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(newTail / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, QUEUE_INDEXVAL_X, QUEUE_INDEXVAL_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, labIndexValID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labEnqueueValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[newTail], elemToEnqueue);\n\t\tthis.cmd(act.delete, labEnqueueValID);\n\t\tthis.cmd(act.delete, labIndexValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.delete, labEnqueueID);\n\t\tthis.cmd(act.delete, labIndexID);\n\n\t\tthis.nextIndex = this.nextIndex - 4;\n\n\t\treturn this.commands;\n\t}\n\n\tdequeue() {\n\t\tthis.commands = [];\n\n\t\tconst labDequeueID = this.nextIndex++;\n\t\tconst labDequeueValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labDequeueID, 'Dequeued Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\tINDEX_COLOR,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.front % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.front / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tconst dequeuedVal = this.arrayData[this.front];\n\t\tthis.cmd(act.createLabel, labDequeueValID, dequeuedVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[this.front], '');\n\t\tthis.cmd(act.move, labDequeueValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.front = (this.front + 1) % this.arrayData.length;\n\t\tconst frontxpos = (this.front % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst frontypos =\n\t\t\tMath.floor(this.front / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\tARRAY_START_Y +\n\t\t\tFRONT_LABEL_OFFSET;\n\t\tthis.cmd(act.move, this.frontPointerID, frontxpos, frontypos);\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Dequeued Value: ' + dequeuedVal);\n\n\t\tthis.cmd(act.delete, labDequeueID);\n\t\tthis.cmd(act.delete, labDequeueValID);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size - 1;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tresize(elemToEnqueue) {\n\t\tthis.commands = [];\n\n\t\tconst labEnqueueID = this.nextIndex++;\n\t\tconst labEnqueueValID = this.nextIndex++;\n\t\tconst labEnqueueResizeID = this.nextIndex++;\n\n\t\tthis.arrayIDNew = new Array(this.size * 2);\n\t\tthis.arrayLabelIDNew = new Array(this.size * 2);\n\t\tthis.arrayDataNew = new Array(this.size * 2);\n\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tthis.arrayIDNew[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelIDNew[i] = this.nextIndex++;\n\t\t\tif (i < this.size) {\n\t\t\t\tthis.arrayDataNew[i] = this.arrayData[(this.front + i) % this.arrayData.length];\n\t\t\t}\n\t\t}\n\n\t\tthis.arrayDataNew[this.size] = elemToEnqueue;\n\n\t\tthis.cmd(act.createLabel, labEnqueueID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labEnqueueValID, elemToEnqueue, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabEnqueueResizeID,\n\t\t\t'(Resize Required)',\n\t\t\tQUEUE_RESIZE_LABEL_X,\n\t\t\tQUEUE_RESIZE_LABEL_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\t//Create new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayIDNew[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelIDNew[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelIDNew[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.arrayMoveID = new Array(this.size);\n\n\t\t//Move old elements to new array\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst xposinit =\n\t\t\t\t(((this.front + i) % this.arrayData.length) % ARRAY_ELEMS_PER_LINE) *\n\t\t\t\t\tARRAY_ELEM_WIDTH +\n\t\t\t\tARRAY_START_X;\n\t\t\tconst yposinit =\n\t\t\t\tMath.floor(((this.front + i) % this.arrayData.length) / ARRAY_ELEMS_PER_LINE) *\n\t\t\t\t\tARRAY_LINE_SPACING +\n\t\t\t\tARRAY_START_Y;\n\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.arrayMoveID[i],\n\t\t\t\tthis.arrayData[(this.front + i) % this.arrayData.length],\n\t\t\t\txposinit,\n\t\t\t\typosinit,\n\t\t\t);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos, ypos);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//Delete movement objects and set text\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t\tthis.cmd(act.setText, this.arrayIDNew[i], this.arrayDataNew[i]);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//Delete old array\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t\tthis.cmd(act.delete, this.arrayLabelID[i]);\n\t\t}\n\n\t\t//Move new array\n\t\tfor (let i = 0; i < this.size * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tthis.cmd(act.move, this.arrayIDNew[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.arrayLabelIDNew[i], xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.front = 0;\n\t\tthis.arrayID = this.arrayIDNew;\n\t\tthis.arrayLabelID = this.arrayLabelIDNew;\n\t\tthis.arrayData = this.arrayDataNew;\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.move, this.frontPointerID, ARRAY_START_X, ARRAY_START_Y + FRONT_LABEL_OFFSET);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\tthis.cmd(act.setHighlight, this.frontPointerID, 0);\n\n\t\t//Delete '(resize required)' text, create circle at the \"size\" object, add enqueue text\n\n\t\tconst newTail = (this.front + this.size) % this.arrayData.length;\n\t\tconst labIndexID = this.nextIndex++;\n\t\tconst labIndexValID = this.nextIndex++;\n\n\t\tthis.cmd(act.delete, labEnqueueResizeID);\n\n\t\t//Just so the element travels over the array instead of underneath it\n\t\tthis.cmd(act.delete, labEnqueueValID);\n\t\tconst labEnqueueValIDNew = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabEnqueueValIDNew,\n\t\t\telemToEnqueue,\n\t\t\tQUEUE_ELEMENT_X,\n\t\t\tQUEUE_ELEMENT_Y,\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabIndexID,\n\t\t\t'Enqueueing at (front + size) % array.length: ',\n\t\t\tQUEUE_INDEX_X,\n\t\t\tQUEUE_INDEX_Y,\n\t\t);\n\t\tthis.cmd(act.createLabel, labIndexValID, newTail, QUEUE_INDEXVAL_X, QUEUE_INDEXVAL_Y);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\t//Enqueue 'elemToEnqueue'\n\t\tconst xpos = (newTail % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(newTail / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, QUEUE_INDEXVAL_X, QUEUE_INDEXVAL_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, labIndexValID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labEnqueueValIDNew, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[newTail], elemToEnqueue);\n\t\tthis.cmd(act.delete, labEnqueueValIDNew);\n\t\tthis.cmd(act.delete, labIndexValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.delete, labEnqueueID);\n\t\tthis.cmd(act.delete, labIndexID);\n\n\t\tthis.nextIndex = this.nextIndex - this.size;\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.cmd(act.setText, this.frontID, '0');\n\t\tthis.cmd(act.setText, this.sizeID, '0');\n\t\tthis.cmd(\n\t\t\tact.setPosition,\n\t\t\tthis.frontPointerID,\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + FRONT_LABEL_OFFSET,\n\t\t);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 250;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst TOP_ELEM_WIDTH = 30;\nconst TOP_ELEM_HEIGHT = 30;\n\nconst TAIL_POS_X = 180;\nconst TAIL_LABEL_X = 130;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 32;\n\nexport default class QueueLL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.tail_pos_y = h - LINKED_LIST_ELEM_HEIGHT;\n\t\tthis.tail_label_y = this.tail_pos_y;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.enqueueField = addControlToAlgorithmBar('Text', '');\n\t\tthis.enqueueField.onkeydown = this.returnSubmit(\n\t\t\tthis.enqueueField,\n\t\t\tthis.enqueueCallback.bind(this),\n\t\t\t4,\n\t\t);\n\n\t\tthis.enqueueButton = addControlToAlgorithmBar('Button', 'Enqueue');\n\t\tthis.enqueueButton.onclick = this.enqueueCallback.bind(this);\n\t\tthis.controls.push(this.enqueueField);\n\t\tthis.controls.push(this.enqueueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.dequeueButton = addControlToAlgorithmBar('Button', 'Dequeue');\n\t\tthis.dequeueButton.onclick = this.dequeueCallback.bind(this);\n\t\tthis.controls.push(this.dequeueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.linkedListElemID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.headID = this.nextIndex++;\n\t\tthis.headLabelID = this.nextIndex++;\n\n\t\tthis.tailID = this.nextIndex++;\n\t\tthis.tailLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.headLabelID, 'Head', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.headID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y,\n\t\t);\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\n\t\tthis.cmd(act.createLabel, this.tailLabelID, 'Tail', TAIL_LABEL_X, this.tail_label_y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.tailID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTAIL_POS_X,\n\t\t\tthis.tail_pos_y,\n\t\t);\n\t\tthis.cmd(act.setNull, this.tailID, 1);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', 5, PUSH_LABEL_Y, 0);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tresetLinkedListPositions() {\n\t\tfor (let i = this.top - 1; i >= 0; i--) {\n\t\t\tconst nextX =\n\t\t\t\t((this.top - 1 - i) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\tLINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor((this.top - 1 - i) / LINKED_LIST_ELEMS_PER_LINE) *\n\t\t\t\t\tLINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tenqueueCallback() {\n\t\tif (this.top < SIZE && this.enqueueField.value !== '') {\n\t\t\tconst pushVal = this.enqueueField.value;\n\t\t\tthis.enqueueField.value = '';\n\t\t\tthis.implementAction(this.enqueue.bind(this), pushVal);\n\t\t}\n\t}\n\n\tdequeueCallback() {\n\t\tif (this.top > 0) {\n\t\t\tthis.implementAction(this.dequeue.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tenqueue(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData[this.top] = elemToPush;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tfor (let i = this.top; i > 0; i--) {\n\t\t\tthis.arrayData[i] = this.arrayData[i - 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i - 1];\n\t\t}\n\t\tthis.arrayData[0] = elemToPush;\n\t\tthis.linkedListElemID[0] = this.nextIndex++;\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tthis.linkedListElemID[0],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1,\n\t\t);\n\n\t\tthis.cmd(act.setNull, this.linkedListElemID[0], 1);\n\t\tthis.cmd(act.createLabel, labPushID, 'Enqueuing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[0], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (this.top === 0) {\n\t\t\tthis.cmd(act.setNull, this.headID, 0);\n\t\t\tthis.cmd(act.setNull, this.tailID, 0);\n\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[this.top]);\n\t\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[this.top]);\n\t\t} else {\n\t\t\tthis.cmd(act.setNull, this.linkedListElemID[1], 0);\n\t\t\tthis.cmd(act.connect, this.linkedListElemID[1], this.linkedListElemID[0]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[1]);\n\t\t}\n\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[0]);\n\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top + 1;\n\t\tthis.resetLinkedListPositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tdequeue() {\n\t\tthis.commands = [];\n\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPopID, 'Dequeued Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPopValID,\n\t\t\tthis.arrayData[this.top - 1],\n\t\t\tLINKED_LIST_START_X,\n\t\t\tLINKED_LIST_START_Y,\n\t\t);\n\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[this.top - 1]);\n\n\t\tif (this.top === 1) {\n\t\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\t\tthis.cmd(act.setNull, this.tailID, 1);\n\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[this.top - 1]);\n\t\t} else {\n\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[this.top - 2]);\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[this.top - 1]);\n\t\tthis.top = this.top - 1;\n\t\tthis.resetLinkedListPositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Dequeued Value: ' + this.arrayData[this.top]);\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.top = 0;\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\tthis.cmd(act.setNull, this.tailID, 1);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 350;\nconst ARRAY_START_Y = 120;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 100;\n\nexport default class QuickSelect extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t`Comma seperated list (e.g. \"3,1,2\"). Max ${MAX_ARRAY_SIZE} elements & no elements > 999`,\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.runCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\taddLabelToAlgorithmBar('k element (1 indexed)', horizontalGroup);\n\n\t\t// k text field\n\t\tthis.kField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.kField.onkeydown = this.returnSubmit(\n\t\t\tthis.kField,\n\t\t\tthis.runCallback.bind(this),\n\t\t\t2,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.kField);\n\n\t\t// Run button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Run', horizontalGroup);\n\t\tthis.findButton.onclick = this.runCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\t\t// Toggles\n\t\tconst pivotButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Random pivot', 'Min element', 'First element', 'Perfect pivot'],\n\t\t\t'Traversals',\n\t\t);\n\n\t\tthis.randomPivotSelect = pivotButtonList[0];\n\t\tthis.minPivotSelect = pivotButtonList[1];\n\t\tthis.firstPivotSelect = pivotButtonList[2];\n\t\tthis.perfectPivotSelect = pivotButtonList[3];\n\t\tthis.randomPivotSelect.onclick = () => (this.pivotType = 'random');\n\t\tthis.minPivotSelect.onclick = () => (this.pivotType = 'min');\n\t\tthis.firstPivotSelect.onclick = () => (this.pivotType = 'first');\n\t\tthis.perfectPivotSelect.onclick = () => (this.pivotType = 'perfect');\n\t\tthis.randomPivotSelect.checked = true;\n\t\tthis.pivotType = 'random';\n\n\t\tthis.controls.push(this.randomPivotSelect);\n\t\tthis.controls.push(this.perfectPivotSelect);\n\t\tthis.controls.push(this.firstPivotSelect);\n\t\tthis.controls.push(this.minPivotSelect);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure QuickSelect(array, left, right, k):'],\n\t\t\t['     pivotIdx <- random index within [left, right]'],\n\t\t\t['     pivot <- array[pivotIdx]'],\n\t\t\t['     swap array[left] and array[pivotIdx]'],\n\t\t\t['     i <- left + 1, j <- right - 1'],\n\t\t\t['     while i <= j do'],\n\t\t\t['          while ', 'i <= j', ' and ', 'array[i] <= pivot'],\n\t\t\t['               i <- i + 1'],\n\t\t\t['          end while'],\n\t\t\t['          while ', 'i <= j', ' and ', 'array[j] >= pivot'],\n\t\t\t['               j <- j - 1'],\n\t\t\t['          end while'],\n\t\t\t['          if i <= j then'],\n\t\t\t['               swap array[i] and array[j]'],\n\t\t\t['               i <- i + 1, j <- j - 1'],\n\t\t\t['          end if'],\n\t\t\t['     end while'],\n\t\t\t['     swap pivot and array[j]'],\n\t\t\t['     if j equals k - 1 then'],\n\t\t\t['          return array[j]'],\n\t\t\t['     if j > k - 1 then'],\n\t\t\t['          QuickSelect on array, left, j - 1, k'],\n\t\t\t['     else'],\n\t\t\t['          QuickSelect on array, j + 1, right, k'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t}\n\n\trunCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tthis.kField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tconst k = this.kField.value;\n\t\t\tif (k > 0 && k <= list.length) {\n\t\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\t\tthis.listField.value = '';\n\t\t\t\tthis.kField.value = '';\n\t\t\t\tthis.implementAction(this.run.bind(this), list, k);\n\t\t\t}\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\trun(list, k) {\n\t\tthis.commands = [];\n\n\t\tthis.k = Number(k);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = list\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, 18);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.arrayData[i] = parseInt(this.arrayData[i]);\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.pPointerID = this.nextIndex++;\n\t\tthis.helper(0, this.arrayData.length - 1);\n\n\t\treturn this.commands;\n\t}\n\n\thelper(left, right) {\n\t\tif (left > right) return;\n\n\t\tthis.highlight(0, 0);\n\n\t\t// Hightlight cells in the current sub-array\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#99CCFF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tif (left === right) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(0, 0);\n\t\t\treturn;\n\t\t}\n\t\tthis.unhighlight(0, 0);\n\n\t\t// Create pivot pointer and swap with left-most element\n\t\t// To make things more interesting (and clearer), we don't pick the left-most element as pivot\n\t\tlet pivot;\n\t\tthis.highlight(1, 0);\n\t\tthis.highlight(2, 0);\n\t\tif (this.pivotType === 'min') {\n\t\t\tlet min = left;\n\t\t\tfor (let i = left + 1; i <= right; i++) {\n\t\t\t\tif (this.arrayData[i] < this.arrayData[min]) {\n\t\t\t\t\tmin = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpivot = min;\n\t\t} else if (this.pivotType === 'first') {\n\t\t\tpivot = left;\n\t\t} else if (this.pivotType === 'perfect') {\n\t\t\tconst sorted = this.arrayData.slice(left, right + 1);\n\t\t\tsorted.sort((a, b) => a - b);\n\t\t\tconst midIndex = Math.floor(sorted.length / 2);\n\t\t\tpivot = this.arrayData.indexOf(sorted[midIndex]);\n\t\t} else if (this.pivotType === 'random') {\n\t\t\tpivot = Math.floor(Math.random() * (right - left)) + left + 1;\n\t\t}\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.pPointerID, '#FFFF00', pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.highlight(3, 0);\n\t\tthis.swapPivot(pivot, left);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(3, 0);\n\t\tthis.highlight(4, 0);\n\t\t// Partition\n\t\tlet i = left + 1;\n\t\tlet j = right;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.iPointerID, '#0000FF', iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.createHighlightCircle, this.jPointerID, '#0000FF', jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(4, 0);\n\t\tthis.highlight(5, 0);\n\t\twhile (i <= j) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.highlight(6, 0);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.highlight(6, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tthis.unhighlight(6, 1);\n\t\t\tthis.highlight(6, 3);\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (i <= j && this.arrayData[left] >= this.arrayData[i]) {\n\t\t\t\tthis.unhighlight(6, 3);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\ti++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.highlight(6, 1);\n\t\t\t\tif (i <= j) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(6, 1);\n\t\t\t\t\tthis.highlight(6, 3);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.unhighlight(6, 1);\n\t\t\tthis.unhighlight(6, 3);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\n\t\t\tthis.highlight(9, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(9, 0);\n\t\t\tthis.highlight(9, 1);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(9, 1);\n\t\t\t\tthis.highlight(9, 3);\n\t\t\t}\n\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (i <= j && this.arrayData[left] <= this.arrayData[j]) {\n\t\t\t\tthis.unhighlight(9, 3);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tj--;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tthis.highlight(9, 1);\n\t\t\t\tif (i <= j) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(9, 1);\n\t\t\t\t\tthis.highlight(9, 3);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.unhighlight(9, 1);\n\t\t\tthis.unhighlight(9, 3);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.highlight(13, 0);\n\t\t\t\tthis.swap(i, j);\n\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\tthis.highlight(14, 0);\n\t\t\t\ti++;\n\t\t\t\tj--;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(14, 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.highlight(17, 0);\n\t\t// Move pivot back and delete pivot pointer\n\t\tthis.swapPivot(left, j, true);\n\t\tthis.unhighlight(17, 0);\n\n\t\t// Delete i and j pointers\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.delete, this.pPointerID);\n\t\tthis.cmd(act.step);\n\n\t\t// Un-hightlight cells in sub-array and set pivot cell to green\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#FFFFFF');\n\t\t}\n\t\tthis.highlight(18, 0);\n\t\tthis.cmd(act.step);\n\t\tif (this.k - 1 === j) {\n\t\t\tthis.unhighlight(18, 0);\n\t\t\tthis.highlight(19, 0);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[j], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(19, 0);\n\t\t} else {\n\t\t\tthis.unhighlight(18, 0);\n\t\t\tthis.highlight(20, 0);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[j], '#4DA6ff');\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (this.k - 1 < j) {\n\t\t\t\tthis.unhighlight(20, 0);\n\t\t\t\tthis.highlight(21, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(21, 0);\n\t\t\t\tthis.helper(left, j - 1);\n\t\t\t} else {\n\t\t\t\tthis.unhighlight(20, 0);\n\t\t\t\tthis.highlight(23, 0);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(23, 0);\n\t\t\t\tthis.helper(j + 1, right);\n\t\t\t}\n\t\t}\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, ARRAY_START_Y);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswapPivot(pivot, other, moveJ) {\n\t\tif (pivot === other) return;\n\t\t// Create temporary labels and remove text in array\n\t\tconst lLabelID = this.nextIndex++;\n\t\tconst lXPos = other * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, lLabelID, this.displayData[other], lXPos, ARRAY_START_Y);\n\t\tconst pLabelID = this.nextIndex++;\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, pLabelID, this.displayData[pivot], pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[other], '');\n\t\tthis.cmd(act.setText, this.arrayID[pivot], '');\n\t\t// Move labels and pivot pointer\n\t\tthis.cmd(act.move, pLabelID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, this.pPointerID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, lLabelID, pXPos, ARRAY_START_Y);\n\t\tmoveJ && this.cmd(act.move, this.jPointerID, pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array, and delete temporary labels and pointer\n\t\tthis.cmd(act.setText, this.arrayID[other], this.displayData[pivot]);\n\t\tthis.cmd(act.setText, this.arrayID[pivot], this.displayData[other]);\n\t\tthis.cmd(act.delete, pLabelID);\n\t\tthis.cmd(act.delete, lLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[pivot];\n\t\tthis.arrayData[pivot] = this.arrayData[other];\n\t\tthis.arrayData[other] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[pivot];\n\t\tthis.displayData[pivot] = this.displayData[other];\n\t\tthis.displayData[other] = temp;\n\t}\n\n\tswap(i, j) {\n\t\t// Create temporary labels and remove text in array\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\t// Move labels\n\t\tthis.cmd(act.move, iLabelID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, jLabelID, iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array and delete temporary labels\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\t// Reset pointer colors back to blue\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 120;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 180;\n\nexport default class QuickSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Toggles\n\t\tconst pivotButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Random pivot', 'Min element', 'First element', 'Perfect pivot'],\n\t\t\t'Traversals',\n\t\t);\n\n\t\tthis.randomPivotSelect = pivotButtonList[0];\n\t\tthis.minPivotSelect = pivotButtonList[1];\n\t\tthis.firstPivotSelect = pivotButtonList[2];\n\t\tthis.perfectPivotSelect = pivotButtonList[3];\n\t\tthis.randomPivotSelect.onclick = () => (this.pivotType = 'random');\n\t\tthis.minPivotSelect.onclick = () => (this.pivotType = 'min');\n\t\tthis.firstPivotSelect.onclick = () => (this.pivotType = 'first');\n\t\tthis.perfectPivotSelect.onclick = () => (this.pivotType = 'perfect');\n\t\tthis.randomPivotSelect.checked = true;\n\t\tthis.pivotType = 'random';\n\n\t\tthis.controls.push(this.randomPivotSelect);\n\t\tthis.controls.push(this.perfectPivotSelect);\n\t\tthis.controls.push(this.firstPivotSelect);\n\t\tthis.controls.push(this.minPivotSelect);\n\n\t\taddDivisorToAlgorithmBar();\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure QuickSort(array, left, right):'],\n\t\t\t['     pivotIdx <- random index within region being sorted'],\n\t\t\t['     pivot <- array[pivotIdx]'],\n\t\t\t['     swap array[left] and array[pivotIdx]'],\n\t\t\t['     i <- left + 1, j <- right - 1'],\n\t\t\t['     while i <= j do'],\n\t\t\t['          while ', 'i <= j', ' and ', 'array[i] <= pivot'],\n\t\t\t['               i <- i + 1'],\n\t\t\t['          end while'],\n\t\t\t['          while ', 'i <= j', ' and ', 'array[j] >= pivot'],\n\t\t\t['               j <- j - 1'],\n\t\t\t['          end while'],\n\t\t\t['          if i <= j then'],\n\t\t\t['               swap array[i] and array[j]'],\n\t\t\t['               i <- i + 1, j <- j - 1'],\n\t\t\t['          end if'],\n\t\t\t['     end while'],\n\t\t\t['     swap pivot and array[j]'],\n\t\t\t['     QuickSort on array, left, j'],\n\t\t\t['     QuickSort on array, j + 1, right'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.arrayData[i] = parseInt(this.arrayData[i]);\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.pPointerID = this.nextIndex++;\n\t\tthis.helper(0, this.arrayData.length - 1);\n\n\t\treturn this.commands;\n\t}\n\n\thelper(left, right) {\n\t\tif (left > right) return;\n\n\t\tthis.highlight(0, 0);\n\n\t\t// Hightlight cells in the current sub-array\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#99CCFF');\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\n\t\tif (left === right) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(0, 0);\n\t\t\treturn;\n\t\t}\n\n\t\t// Create pivot pointer and swap with left-most element\n\t\t// To make things more interesting (and clearer), we don't pick the left-most element as pivot\n\t\tlet pivot;\n\t\tthis.highlight(1, 0);\n\t\tthis.highlight(2, 0);\n\t\tif (this.pivotType === 'min') {\n\t\t\tlet min = left;\n\t\t\tfor (let i = left + 1; i <= right; i++) {\n\t\t\t\tif (this.arrayData[i] < this.arrayData[min]) {\n\t\t\t\t\tmin = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpivot = min;\n\t\t} else if (this.pivotType === 'first') {\n\t\t\tpivot = left;\n\t\t} else if (this.pivotType === 'perfect') {\n\t\t\tconst sorted = this.arrayData.slice(left, right + 1);\n\t\t\tsorted.sort((a, b) => a - b);\n\t\t\tconst midIndex = Math.floor(sorted.length / 2);\n\t\t\tpivot = this.arrayData.indexOf(sorted[midIndex]);\n\t\t} else if (this.pivotType === 'random') {\n\t\t\tpivot = Math.floor(Math.random() * (right - left)) + left + 1;\n\t\t}\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.pPointerID, '#FFFF00', pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\t\tthis.unhighlight(2, 0);\n\t\tthis.highlight(3, 0);\n\t\tthis.swapPivot(pivot, left);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(3, 0);\n\t\tthis.highlight(4, 0);\n\t\t// Partition\n\t\tlet i = left + 1;\n\t\tlet j = right;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.iPointerID, '#0000FF', iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.createHighlightCircle, this.jPointerID, '#0000FF', jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(4, 0);\n\t\tthis.highlight(5, 0);\n\t\twhile (i <= j) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.highlight(6, 0);\n\t\t\tthis.unhighlight(5, 0);\n\t\t\tthis.highlight(6, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(6, 0);\n\t\t\tthis.unhighlight(6, 1);\n\t\t\tthis.highlight(6, 3);\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (i <= j && this.arrayData[left] >= this.arrayData[i]) {\n\t\t\t\tthis.unhighlight(6, 3);\n\t\t\t\tthis.highlight(7, 0);\n\t\t\t\ti++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(7, 0);\n\t\t\t\tthis.highlight(6, 1);\n\t\t\t\tif (i <= j) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(6, 1);\n\t\t\t\t\tthis.highlight(6, 3);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.unhighlight(6, 1);\n\t\t\tthis.unhighlight(6, 3);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\t\t\t// One additional comparison will be made in the above loop if i <= j\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.highlight(9, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(9, 0);\n\t\t\tthis.highlight(9, 1);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.unhighlight(9, 1);\n\t\t\t\tthis.highlight(9, 3);\n\t\t\t}\n\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (i <= j && this.arrayData[left] <= this.arrayData[j]) {\n\t\t\t\tthis.unhighlight(9, 3);\n\t\t\t\tthis.highlight(10, 0);\n\t\t\t\tj--;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(10, 0);\n\t\t\t\tthis.highlight(9, 1);\n\t\t\t\tif (i <= j) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(9, 1);\n\t\t\t\t\tthis.highlight(9, 3);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.unhighlight(9, 1);\n\t\t\tthis.unhighlight(9, 3);\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.highlight(13, 0);\n\t\t\t\tthis.swap(i, j);\n\t\t\t\tthis.unhighlight(13, 0);\n\t\t\t\tthis.highlight(14, 0);\n\t\t\t\ti++;\n\t\t\t\tj--;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t\tthis.unhighlight(14, 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.highlight(17, 0);\n\t\t// Move pivot back and delete pivot pointer\n\t\tthis.swapPivot(left, j, true);\n\t\tthis.unhighlight(17, 0);\n\n\t\t// Delete i and j pointers\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.delete, this.pPointerID);\n\t\tthis.cmd(act.step);\n\n\t\t// Un-hightlight cells in sub-array and set pivot cell to green\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#FFFFFF');\n\t\t}\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[j], '#2ECC71');\n\t\tthis.cmd(act.step);\n\n\t\tthis.highlight(18, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(18, 0);\n\n\t\tthis.helper(left, j - 1);\n\n\t\tthis.highlight(19, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(19, 0);\n\n\t\tthis.helper(j + 1, right);\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, ARRAY_START_Y);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswapPivot(pivot, other, moveJ) {\n\t\tif (pivot === other) return;\n\t\t// Create temporary labels and remove text in array\n\t\tconst lLabelID = this.nextIndex++;\n\t\tconst lXPos = other * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, lLabelID, this.displayData[other], lXPos, ARRAY_START_Y);\n\t\tconst pLabelID = this.nextIndex++;\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, pLabelID, this.displayData[pivot], pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[other], '');\n\t\tthis.cmd(act.setText, this.arrayID[pivot], '');\n\t\t// Move labels and pivot pointer\n\t\tthis.cmd(act.move, pLabelID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, this.pPointerID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, lLabelID, pXPos, ARRAY_START_Y);\n\t\tmoveJ && this.cmd(act.move, this.jPointerID, pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array, and delete temporary labels and pointer\n\t\tthis.cmd(act.setText, this.arrayID[other], this.displayData[pivot]);\n\t\tthis.cmd(act.setText, this.arrayID[pivot], this.displayData[other]);\n\t\tthis.cmd(act.delete, pLabelID);\n\t\tthis.cmd(act.delete, lLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[pivot];\n\t\tthis.arrayData[pivot] = this.arrayData[other];\n\t\tthis.arrayData[other] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[pivot];\n\t\tthis.displayData[pivot] = this.displayData[other];\n\t\tthis.displayData[other] = temp;\n\t}\n\n\tswap(i, j) {\n\t\t// Create temporary labels and remove text in array\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\t// Move labels\n\t\tthis.cmd(act.move, iLabelID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, jLabelID, iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array and delete temporary labels\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\t// Reset pointer colors back to blue\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\t// toggleWorstPivot() {\n\t// \tworstPivotEnabled = !worstPivotEnabled;\n\t// \tif (firstPivotEnabled) {\n\t// \t\tfirstPivotEnabled = false;\n\t// \t\tthis.firstPivotToggle.checked = false;\n\t// \t}\n\t// }\n\n\t// toggleFirstPivot() {\n\t// \tfirstPivotEnabled = !firstPivotEnabled;\n\t// \tif (worstPivotEnabled) {\n\t// \t\tworstPivotEnabled = false;\n\t// \t\tthis.worstPivotToggle.checked = false;\n\t// \t}\n\t// }\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\n// const LOWER_A_CHAR_CODE = 97;\n\nconst BASE_LABEL_Y = 45;\nconst CHARACTER_VALUES_LABEL_Y = 60;\nconst TEXT_HASH_LABEL_START_Y = 100;\nconst PATTERN_HASH_LABEL_START_Y = 115;\n\nconst COMP_COUNT_X = 575;\nconst COMP_COUNT_Y = 30;\n\nexport default class RabinKarp extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t//Base value text field\n\t\tthis.baseField = addControlToAlgorithmBar('Base', '');\n\t\tthis.baseField.onkeydown = this.returnSubmit(\n\t\t\tthis.baseField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.baseField);\n\n\t\t// Base button\n\t\tthis.baseButton = addControlToAlgorithmBar('Button', 'Change Base');\n\t\tthis.baseButton.onclick = this.baseCallback.bind(this);\n\t\tthis.controls.push(this.baseButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.baseLabelID = this.nextIndex++;\n\t\tthis.characterValuesLabelID = this.nextIndex++;\n\t\tthis.textHashLabelID = this.nextIndex++;\n\t\tthis.textHashCalculationID = this.nextIndex++;\n\t\tthis.patternHashLabelID = this.nextIndex++;\n\t\tthis.patternHashCalculationID = this.nextIndex++;\n\n\t\tthis.baseValue = 1;\n\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.createLabel, this.comparisonCountID, '', COMP_COUNT_X, COMP_COUNT_Y, 0);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.baseLabelID = this.nextIndex++;\n\t\tthis.characterValuesLabelID = this.nextIndex++;\n\t\tthis.textHashLabelID = this.nextIndex++;\n\t\tthis.textHashCalculationID = this.nextIndex++;\n\t\tthis.patternHashLabelID = this.nextIndex++;\n\t\tthis.patternHashCalculationID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tbaseCallback() {\n\t\tconst val = parseInt(this.baseField.value);\n\t\tif (this.baseField.value !== '' && val !== 0) {\n\t\t\tthis.baseField.value = '';\n\t\t\tthis.baseValue = val;\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\t// Filter non-letters from string and make lower case\n\t\ttext = text.replace(/[^a-zA-Z]/g, '').toLowerCase();\n\t\tpattern = pattern.replace(/[^a-zA-Z]/g, '').toLowerCase();\n\n\t\tconst maxRows = text.length - pattern.length + 1;\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tlet xpos, ypos;\n\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\typos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst labelsX = ARRAY_START_X + text.length * this.cellSize + 10;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.baseLabelID,\n\t\t\t`Base constant = ${this.baseValue}`,\n\t\t\tlabelsX,\n\t\t\tBASE_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.characterValuesLabelID,\n\t\t\t'Character values: a = 0, b = 1, ..., z = 25',\n\t\t\tlabelsX,\n\t\t\tCHARACTER_VALUES_LABEL_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.textHashLabelID,\n\t\t\t'Text hash:',\n\t\t\tlabelsX,\n\t\t\tTEXT_HASH_LABEL_START_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.patternHashLabelID,\n\t\t\t'Pattern hash:',\n\t\t\tlabelsX,\n\t\t\tPATTERN_HASH_LABEL_START_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(act.move, this.comparisonCountID, labelsX, COMP_COUNT_Y);\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\n\t\tlet textCalculation = '';\n\t\tlet textHash = 0;\n\t\tlet patternCalculation = '';\n\t\tlet patternHash = 0;\n\t\tconst base = Math.pow(this.baseValue, pattern.length - 1);\n\t\tlet runningBase = base;\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\ttextHash += (text.charCodeAt(i) - 97) * runningBase;\n\t\t\ttextCalculation += `(${text.charAt(i)} * ${runningBase}) + `;\n\t\t\tpatternHash += (pattern.charCodeAt(i) - 97) * runningBase;\n\t\t\tpatternCalculation += `(${pattern.charAt(i)} * ${runningBase}) + `;\n\t\t\trunningBase /= this.baseValue;\n\t\t}\n\t\ttextCalculation =\n\t\t\ttextCalculation.substring(0, textCalculation.length - 2) + ' = ' + textHash;\n\t\tpatternCalculation =\n\t\t\tpatternCalculation.substring(0, patternCalculation.length - 2) + ' = ' + patternHash;\n\t\tconst calculationsX = ARRAY_START_X + text.length * this.cellSize + 100;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.textHashCalculationID,\n\t\t\ttextCalculation,\n\t\t\tcalculationsX,\n\t\t\tTEXT_HASH_LABEL_START_Y,\n\t\t\t0,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.patternHashCalculationID,\n\t\t\tpatternCalculation,\n\t\t\tcalculationsX,\n\t\t\tPATTERN_HASH_LABEL_START_Y,\n\t\t\t0,\n\t\t);\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\n\t\tlet row = 0;\n\t\tfor (let i = 0; i <= text.length - pattern.length; i++) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tif (patternHash === textHash) {\n\t\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.createHighlightCircle, iPointerID, '#0000FF', xpos, ARRAY_START_Y);\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.createHighlightCircle, jPointerID, '#0000FF', xpos, ypos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tlet j = 0;\n\t\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setBackgroundColor,\n\t\t\t\t\t\tthis.comparisonMatrixID[row][i + j],\n\t\t\t\t\t\t'#2ECC71',\n\t\t\t\t\t);\n\t\t\t\t\tj++;\n\t\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.comparisonCountID,\n\t\t\t\t\t\t'Comparison Count: ' + ++this.compCount,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setBackgroundColor,\n\t\t\t\t\t\tthis.comparisonMatrixID[row][i + j],\n\t\t\t\t\t\t'#E74C3C',\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, iPointerID);\n\t\t\t\tthis.cmd(act.delete, jPointerID);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t} else {\n\t\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][k], '#FFFF4D');\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tif (i < text.length - pattern.length) {\n\t\t\t\ttextHash =\n\t\t\t\t\tthis.baseValue * (textHash - base * (text.charCodeAt(i) - 97)) +\n\t\t\t\t\t(text.charCodeAt(i + pattern.length) - 97);\n\t\t\t\ttextCalculation = '';\n\t\t\t\trunningBase = base;\n\t\t\t\tfor (let k = 0; k < pattern.length; k++) {\n\t\t\t\t\ttextCalculation += `(${text.charAt(k + i + 1)} * ${runningBase}) + `; //text.charAt(k + i + 1) + ' + ';\n\t\t\t\t\trunningBase /= this.baseValue;\n\t\t\t\t}\n\t\t\t\ttextCalculation =\n\t\t\t\t\ttextCalculation.substring(0, textCalculation.length - 2) + ' = ' + textHash;\n\t\t\t\tthis.cmd(act.setText, this.textHashCalculationID, textCalculation);\n\t\t\t}\n\t\t\trow++;\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tif (this.textRowID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.baseLabelID);\n\t\t\tthis.cmd(act.delete, this.characterValuesLabelID);\n\t\t\tthis.cmd(act.delete, this.textHashLabelID);\n\t\t\tthis.cmd(act.delete, this.textHashCalculationID);\n\t\t\tthis.cmd(act.delete, this.patternHashLabelID);\n\t\t\tthis.cmd(act.delete, this.patternHashCalculationID);\n\t\t}\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.compCount = 0;\n\t\tthis.cmd(act.setText, this.comparisonCountID, '');\n\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_ARRAY_SIZE = 18;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 130;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst COMP_COUNT_X = 100;\nconst COMP_COUNT_Y = 50;\n\nconst CODE_START_X = 50;\nconst CODE_START_Y = 200;\n\n// const ARRRAY_ELEMS_PER_LINE = 15;\n// const ARRAY_LINE_SPACING = 130;\n\n// const TOP_POS_X = 180;\n// const TOP_POS_Y = 100;\n// const TOP_LABEL_X = 130;\n// const TOP_LABEL_Y = 100;\n\n// const PUSH_LABEL_X = 50;\n// const PUSH_LABEL_Y = 30;\n// const PUSH_ELEMENT_X = 120;\n// const PUSH_ELEMENT_Y = 30;\n\n// const SIZE = 10;\n\nexport default class SelectionSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 18 elements & no elements > 999',\n\t\t\tverticalGroup,\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse,\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.sortButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\t//Min & Max selection button\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst minMaxButtonList = addRadioButtonGroupToAlgorithmBar(['Min', 'Max'], 'Min/Max');\n\n\t\tthis.minButton = minMaxButtonList[0];\n\t\tthis.minButton.onclick = this.minCallback.bind(this);\n\t\tthis.controls.push(this.minButton);\n\t\tthis.minButton.checked = true;\n\t\tthis.maxButton = minMaxButtonList[1];\n\t\tthis.maxButton.onclick = this.maxCallback.bind(this);\n\t\tthis.controls.push(this.maxButton);\n\t\tthis.isMin = true;\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\n\t\tthis.compCount = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.comparisonCountID,\n\t\t\t'Comparison Count: ' + this.compCount,\n\t\t\tCOMP_COUNT_X,\n\t\t\tCOMP_COUNT_Y,\n\t\t);\n\n\t\tthis.code = [\n\t\t\t['procedure SelectionSort(array):'],\n\t\t\t['     length <- length of array'],\n\t\t\t['     for i <- 0, length do'],\n\t\t\t['          min <- i'],\n\t\t\t['          for j <- i + 1, length do'],\n\t\t\t['               if array[j] < array[min]'],\n\t\t\t['                    min <- j'],\n\t\t\t['               end if'],\n\t\t\t['          end for'],\n\t\t\t['          swap array[min], array[i]'],\n\t\t\t['     end for'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.removeCode(this.codeID);\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.comparisonCountID = this.nextIndex++;\n\t\tthis.compCount = 0;\n\t\tthis.codeID = this.addCodeToCanvasBase(this.code, CODE_START_X, CODE_START_Y);\n\t\tif (!this.isMin) {\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     for i <- length - 1, 0 do');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '          max <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          for j <- i - 1, 0 do');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '               if array[j] > array[max]');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '                    max <- j');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '          swap array[max], array[i]');\n\t\t}\n\t}\n\n\tminCallback() {\n\t\tif (!this.isMin) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     for i <- 0, length do');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '          min <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          for j <- i + 1, length do');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '               if array[j] < array[min]');\n\t\t\tthis.cmd(act.setText, this.codeID[6][0], '                    min <- j');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '          swap array[min], array[i]');\n\t\t\tthis.isMin = true;\n\t\t}\n\t}\n\n\tmaxCallback() {\n\t\tif (this.isMin) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.cmd(act.setText, this.codeID[2][0], '     for i <- length - 1, 0 do');\n\t\t\tthis.cmd(act.setText, this.codeID[3][0], '          max <- i');\n\t\t\tthis.cmd(act.setText, this.codeID[4][0], '          for j <- i - 1, 0 do');\n\t\t\tthis.cmd(act.setText, this.codeID[5][0], '               if array[j] > array[max]');\n\t\t\tthis.cmd(act.setText, this.codeID[6][0], '                    max <- j');\n\t\t\tthis.cmd(act.setText, this.codeID[9][0], '          swap array[max], array[i]');\n\t\t\tthis.isMin = false;\n\t\t}\n\t}\n\n\tsortCallback() {\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\n\t\tif (\n\t\t\tthis.listField.value !== '' &&\n\t\t\tlist.length <= MAX_ARRAY_SIZE &&\n\t\t\tlist.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.compCount = 0;\n\t\tthis.displayData = [];\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + this.compCount);\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\t\tthis.highlight(0, 0);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\n\t\tconst length = this.arrayData.length;\n\t\tthis.displayData = new Array(length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t}\n\t\tlet circleShift = 0;\n\t\tif (!this.isMin) {\n\t\t\tcircleShift = ARRAY_ELEM_WIDTH * (this.arrayData.length - 1);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#FF0000',\n\t\t\tARRAY_START_X + circleShift,\n\t\t\tARRAY_START_Y,\n\t\t);\n\n\t\tcircleShift = ARRAY_ELEM_WIDTH;\n\t\tif (!this.isMin) {\n\t\t\tcircleShift = ARRAY_ELEM_WIDTH * (this.arrayData.length - 2);\n\t\t}\n\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + circleShift,\n\t\t\tARRAY_START_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(0, 0);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.highlight(2, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(2, 0);\n\t\tfor (let i = 0; i < this.arrayData.length - 1; i++) {\n\t\t\tthis.highlight(3, 0);\n\t\t\tlet k = i;\n\t\t\tif (!this.isMin) {\n\t\t\t\tk = this.arrayData.length - 1 - i;\n\t\t\t}\n\n\t\t\tlet toSwap = k;\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[toSwap], '#FFFF00');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.unhighlight(3, 0);\n\t\t\tthis.highlight(4, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let j = i + 1; j < this.arrayData.length; j++) {\n\t\t\t\tthis.unhighlight(4, 0);\n\t\t\t\tlet w = j;\n\t\t\t\tif (!this.isMin) {\n\t\t\t\t\tw = this.arrayData.length - 1 - j;\n\t\t\t\t}\n\n\t\t\t\tthis.movePointers(toSwap, w);\n\t\t\t\tif (this.compare(this.arrayData[w], this.arrayData[toSwap])) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[toSwap], '#FFFFFF');\n\t\t\t\t\tthis.highlight(6, 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\ttoSwap = w;\n\t\t\t\t\tthis.movePointers(toSwap, w);\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[toSwap], '#FFFF00');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.unhighlight(6, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.swap(k, toSwap);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[toSwap], '#FFFFFF');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[k], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\tlet lastIndex = this.arrayID.length - 1;\n\t\tif (!this.isMin) {\n\t\t\tlastIndex = 0;\n\t\t}\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[lastIndex], '#2ECC71');\n\n\t\treturn this.commands;\n\t}\n\n\tcompare(i, j) {\n\t\tthis.highlight(5, 0);\n\t\tthis.cmd(act.setText, this.comparisonCountID, 'Comparison Count: ' + ++this.compCount);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(5, 0);\n\t\tif (this.isMin) {\n\t\t\treturn i < j;\n\t\t} else {\n\t\t\treturn i > j;\n\t\t}\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.highlight(9, 0);\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\tthis.unhighlight(9, 0);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst SKIP_LIST_START_X = 100;\nconst SKIP_LIST_START_Y = 400;\nconst SKIP_LIST_ELEM_SIZE = 40;\n\nconst SKIP_LIST_SPACING = 80;\n\nconst VALUE_LABEL_X = 50;\nconst VALUE_LABEL_Y = 23;\nconst VALUE_STRING_X = 120;\nconst VALUE_STRING_Y = 23;\n\nconst CF_LABEL_X = 50;\nconst CF_LABEL_Y = 37;\nconst CF_STRING_X = 120;\nconst CF_STRING_Y = 37;\n\nconst EXP_LABEL_X = 250;\nconst EXP_LABEL_Y = 30;\n\nconst NINF = '\\u2212\\u221E'; // Negative infinity\nconst PINF = '\\u221E'; // Positive infinity\n\nexport default class SkipList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\t// add w/ heads groups\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst topHorizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\t\tconst bottomHorizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// add w/ random heads groups\n\t\tconst verticalGroupRandom = addGroupToAlgorithmBar(false);\n\t\tconst topHorizontalGroupRandom = addGroupToAlgorithmBar(true, verticalGroupRandom);\n\t\tconst bottomHorizontalGroupRandom = addGroupToAlgorithmBar(true, verticalGroupRandom);\n\n\t\t// Add w/ heads section\n\t\taddLabelToAlgorithmBar('Add', topHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', topHorizontalGroup);\n\t\tthis.addValueField.setAttribute('placeholder', 'Value');\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\tthis.addWithHeadsCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('with', topHorizontalGroup);\n\n\t\t// Heads' text field\n\t\tthis.headsField = addControlToAlgorithmBar('Text', '', topHorizontalGroup);\n\t\tthis.headsField.setAttribute('placeholder', '#');\n\t\tthis.headsField.onkeydown = this.returnSubmit(\n\t\t\tthis.headsField,\n\t\t\tthis.addWithHeadsCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.headsField);\n\n\t\taddLabelToAlgorithmBar('heads (Max 4)', topHorizontalGroup);\n\n\t\t// Add with heads button\n\t\tthis.addWithHeadsButton = addControlToAlgorithmBar('Button', 'Add', bottomHorizontalGroup);\n\t\tthis.addWithHeadsButton.onclick = this.addWithHeadsCallback.bind(this);\n\t\tthis.controls.push(this.addWithHeadsButton);\n\n\t\t// Add w/ random heads section\n\t\taddLabelToAlgorithmBar('Add', topHorizontalGroupRandom);\n\n\t\t// Add's value text field\n\t\tthis.addValueFieldRandom = addControlToAlgorithmBar('Text', '', topHorizontalGroupRandom);\n\t\tthis.addValueFieldRandom.setAttribute('placeholder', 'Value');\n\t\tthis.addValueFieldRandom.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueFieldRandom,\n\t\t\tthis.addRandomlyCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.addValueFieldRandom);\n\n\t\taddLabelToAlgorithmBar('with random coin flip', topHorizontalGroupRandom);\n\n\t\t// Add randomly button\n\t\tthis.addRandomlyButton = addControlToAlgorithmBar(\n\t\t\t'Button',\n\t\t\t'Add',\n\t\t\tbottomHorizontalGroupRandom,\n\t\t);\n\t\tthis.addRandomlyButton.onclick = this.addRandomlyCallback.bind(this);\n\t\tthis.controls.push(this.addRandomlyButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Remove's text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '');\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\tthis.removeCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove button\n\t\tthis.removeButton = addControlToAlgorithmBar('Button', 'Remove');\n\t\tthis.removeButton.onclick = this.removeCallback.bind(this);\n\t\tthis.controls.push(this.removeButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Get's index text field\n\t\tthis.getField = addControlToAlgorithmBar('Text', '');\n\t\tthis.getField.onkeydown = this.returnSubmit(\n\t\t\tthis.getField,\n\t\t\tthis.getCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.getField);\n\n\t\t// Get button\n\t\tthis.getButton = addControlToAlgorithmBar('Button', 'Get');\n\t\tthis.getButton.onclick = this.getCallback.bind(this);\n\t\tthis.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\n\t\tthis.size = 0;\n\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[0][0],\n\t\t\tNINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[1][0],\n\t\t\tPINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING,\n\t\t\tSKIP_LIST_START_Y,\n\t\t);\n\t\tthis.cmd(act.connectSkipList, this.nodeID[0][0], this.nodeID[1][0], 3);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\n\t\tthis.size = 0;\n\t}\n\n\taddRandomlyCallback() {\n\t\tif (this.addValueFieldRandom.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueFieldRandom.value);\n\t\t\tthis.addValueFieldRandom.value = '';\n\t\t\tthis.headsField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal);\n\t\t}\n\t}\n\n\taddWithHeadsCallback() {\n\t\tif (this.addValueField.value !== '' && this.headsField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tconst heads = parseInt(this.headsField.value);\n\t\t\tthis.headsField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, heads);\n\t\t}\n\t}\n\n\tremoveCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst value = parseInt(this.removeField.value);\n\t\t\tthis.removeField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), value);\n\t\t}\n\t}\n\n\tgetCallback() {\n\t\tif (this.getField.value !== '') {\n\t\t\tconst value = parseInt(this.getField.value);\n\t\t\tthis.getField.value = '';\n\t\t\tthis.implementAction(this.get.bind(this), value);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(value, heads) {\n\t\tthis.commands = [];\n\n\t\tif (heads === undefined) {\n\t\t\theads = Math.floor(Math.random() * (this.size + 1));\n\t\t}\n\t\theads = Math.min(heads, 4);\n\n\t\tconst valueLabelId = this.nextIndex++;\n\t\tconst valueStringId = this.nextIndex++;\n\n\t\tconst cfLabelId = this.nextIndex++;\n\t\tconst cfStringId = this.nextIndex++;\n\t\tconst expLabelID = this.nextIndex++;\n\n\t\tlet headsString = '';\n\t\tfor (let i = 0; i < heads; i++) {\n\t\t\theadsString += 'H';\n\t\t}\n\t\theadsString += 'T';\n\n\t\tthis.cmd(act.createLabel, valueLabelId, 'Value to add:', VALUE_LABEL_X, VALUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, valueStringId, value, VALUE_STRING_X, VALUE_STRING_Y);\n\t\tthis.cmd(act.createLabel, cfLabelId, 'Coin Flipper:', CF_LABEL_X, CF_LABEL_Y);\n\t\tthis.cmd(act.createLabel, cfStringId, headsString, CF_STRING_X, CF_STRING_Y);\n\t\tthis.cmd(act.createLabel, expLabelID, '', EXP_LABEL_X, EXP_LABEL_Y);\n\t\tthis.cmd(act.step);\n\n\t\t// Add levels\n\t\tfor (let row = this.nodeID[0].length; row <= heads; row++) {\n\t\t\tconst rightPhantomsCol = this.nodeID.length - 1;\n\t\t\tthis.data[0][row] = Number.NEGATIVE_INFINITY;\n\t\t\tthis.nodeID[0][row] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createSkipListNode,\n\t\t\t\tthis.nodeID[0][row],\n\t\t\t\tNINF,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_START_X,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tthis.data[rightPhantomsCol][row] = Number.POSITIVE_INFINITY;\n\t\t\tthis.nodeID[rightPhantomsCol][row] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createSkipListNode,\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\n\t\t\t\tPINF,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * rightPhantomsCol,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.connectSkipList,\n\t\t\t\tthis.nodeID[0][row],\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\n\t\t\t\t3,\n\t\t\t);\n\t\t\tthis.cmd(act.connectSkipList, this.nodeID[0][row - 1], this.nodeID[0][row], 0);\n\t\t\tthis.cmd(\n\t\t\t\tact.connectSkipList,\n\t\t\t\tthis.nodeID[rightPhantomsCol][row - 1],\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\n\t\t\t\t0,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\t// Find column where new element will be inserted\n\t\tlet newCol = 1;\n\t\twhile (value > this.data[newCol][0]) {\n\t\t\tnewCol++;\n\t\t}\n\n\t\t//this step should be skipped in the case of a duplicate\n\t\tif (value !== this.data[newCol][0]) {\n\t\t\t// Move IDs and data in next columns to the right\n\t\t\tfor (let col = this.nodeID.length - 1; col >= newCol; col--) {\n\t\t\t\tthis.nodeID[col + 1] = this.nodeID[col];\n\t\t\t\tthis.data[col + 1] = this.data[col];\n\t\t\t}\n\t\t\tthis.nodeID[newCol] = [];\n\t\t\tthis.data[newCol] = [];\n\t\t}\n\n\t\t// Traverse and add\n\t\tlet col = 0;\n\t\tlet row = this.nodeID[0].length - 1;\n\n\t\tconst highlightID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\thighlightID,\n\t\t\t'#FF0000',\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t);\n\t\tthis.cmd(act.setHighlight, highlightID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tlet foundDuplicate = false;\n\t\twhile (row >= 0) {\n\t\t\t// Move right until next element is greater or equal\n\t\t\tlet nextCol = this.getNextCol(col, row);\n\t\t\tif (value === this.data[nextCol][row]) {\n\t\t\t\tcol = nextCol;\n\t\t\t\tfoundDuplicate = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\twhile (value > this.data[nextCol][row]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tcol = nextCol;\n\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t}\n\n\t\t\tif (value === this.data[nextCol][row]) {\n\t\t\t\tcol = nextCol;\n\t\t\t\tfoundDuplicate = true;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Move highlight circle downward\n\t\t\trow--;\n\t\t\tif (row >= 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\t// Add nodes bottom-up to the new column if no duplicate has been found\n\t\tif (!foundDuplicate) {\n\t\t\tthis.shiftColumns(newCol);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightID,\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, expLabelID, 'Duplicate found!');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\trow++;\n\t\t// Having a highlight circle in the previous ID causes an object to look weird (this\n\t\t// seems to be an already existing bug) Creating a random object before it is a workaround\n\t\tthis.cmd(act.createCircle, this.nextIndex++, '', -100, -100, 0);\n\n\t\twhile (row <= heads) {\n\t\t\tthis.cmd(act.setText, expLabelID, 'Adding data');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.data[newCol][row] = value;\n\t\t\tthis.nodeID[newCol][row] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createSkipListNode,\n\t\t\t\tthis.nodeID[newCol][row],\n\t\t\t\tvalue,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * newCol,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tconst prevCol = this.getPrevCol(newCol, row);\n\t\t\tconst nextCol = this.getNextCol(newCol, row);\n\t\t\tthis.cmd(act.disconnect, this.nodeID[prevCol][row], this.nodeID[nextCol][row]);\n\t\t\tthis.cmd(act.connectSkipList, this.nodeID[prevCol][row], this.nodeID[newCol][row], 3);\n\t\t\tthis.cmd(act.connectSkipList, this.nodeID[newCol][row], this.nodeID[nextCol][row], 3);\n\t\t\tif (row !== 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectSkipList,\n\t\t\t\t\tthis.nodeID[newCol][row - 1],\n\t\t\t\t\tthis.nodeID[newCol][row],\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightID,\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * newCol,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\trow++;\n\t\t}\n\n\t\tthis.cmd(act.delete, valueLabelId);\n\t\tthis.cmd(act.delete, valueStringId);\n\t\tthis.cmd(act.delete, cfLabelId);\n\t\tthis.cmd(act.delete, cfStringId);\n\t\tthis.cmd(act.delete, highlightID);\n\t\tthis.cmd(act.delete, expLabelID);\n\n\t\tthis.size++;\n\n\t\treturn this.commands;\n\t}\n\n\tremove(params) {\n\t\tthis.commands = [];\n\n\t\tconst value = parseInt(params);\n\n\t\tconst valueLabelId = this.nextIndex++;\n\t\tconst valueStringId = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, valueLabelId, 'Value to remove:', VALUE_LABEL_X, VALUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, valueStringId, value, VALUE_STRING_X, VALUE_STRING_Y);\n\t\tthis.cmd(act.step);\n\n\t\t// Traverse and remove\n\t\tlet col = 0;\n\t\tlet row = this.nodeID[0].length - 1;\n\t\tlet removedCol = -1;\n\n\t\tconst highlightID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\thighlightID,\n\t\t\t'#FF0000',\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\twhile (row >= 0) {\n\t\t\t// Move right until next element is greater or equal\n\t\t\tlet nextCol = this.getNextCol(col, row);\n\t\t\twhile (value > this.data[nextCol][row]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tcol = nextCol;\n\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t}\n\n\t\t\tif (value === this.data[nextCol][row]) {\n\t\t\t\tremovedCol = nextCol;\n\t\t\t\tcol = nextCol;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\twhile (row >= 0) {\n\t\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t\t\tconst prevCol = this.getPrevCol(col, row);\n\t\t\t\t\tthis.cmd(act.disconnect, this.nodeID[prevCol][row], this.nodeID[col][row]);\n\t\t\t\t\tthis.cmd(act.disconnect, this.nodeID[col][row], this.nodeID[nextCol][row]);\n\t\t\t\t\tif (this.nodeID[col][row + 1] != null) {\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.nodeID[col][row + 1], this.nodeID[col][row]);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectSkipList,\n\t\t\t\t\t\tthis.nodeID[prevCol][row],\n\t\t\t\t\t\tthis.nodeID[nextCol][row],\n\t\t\t\t\t\t3,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.delete, this.nodeID[col][row]);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\trow--;\n\t\t\t\t\tif (row !== -1) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\thighlightID,\n\t\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trow--;\n\t\t\t\tif (row !== -1) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\thighlightID,\n\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, valueLabelId);\n\t\tthis.cmd(act.delete, valueStringId);\n\t\tthis.cmd(act.delete, highlightID);\n\n\t\tif (removedCol !== -1) {\n\t\t\t// Shift ID and data columns to the left (already erases last column)\n\t\t\tfor (let col = removedCol; col < this.nodeID.length - 1; col++) {\n\t\t\t\tthis.nodeID[col] = this.nodeID[col + 1];\n\t\t\t\tthis.data[col] = this.data[col + 1];\n\t\t\t}\n\t\t\tthis.nodeID.pop();\n\t\t\tthis.data.pop();\n\n\t\t\tthis.shiftColumns(removedCol);\n\t\t}\n\n\t\t// Remove empty rows\n\t\t// Find tallest column of actual values (not phantoms)\n\t\tlet maxHeight = 1;\n\t\tfor (let col = 1; col < this.nodeID.length - 1; col++) {\n\t\t\tmaxHeight = Math.max(maxHeight, this.nodeID[col].length);\n\t\t}\n\t\t// Remove rows above tallest column (so empty rows)\n\t\tfor (let row = this.nodeID[0].length - 1; row >= maxHeight; row--) {\n\t\t\tthis.data[0].pop();\n\t\t\tconst leftPhantomID = this.nodeID[0].pop();\n\t\t\tthis.cmd(act.delete, leftPhantomID);\n\t\t\tconst rightPhantomsCol = this.nodeID.length - 1;\n\t\t\tthis.data[rightPhantomsCol].pop();\n\t\t\tconst rightPhantomID = this.nodeID[rightPhantomsCol].pop();\n\t\t\tthis.cmd(act.delete, rightPhantomID);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.size--;\n\n\t\treturn this.commands;\n\t}\n\n\tget(params) {\n\t\tthis.commands = [];\n\n\t\tconst value = parseInt(params);\n\n\t\tlet col = 0;\n\t\tlet row = this.nodeID[0].length - 1;\n\t\t// let nextCol = this.getNextCol(col, row);\n\n\t\tconst highlightID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\thighlightID,\n\t\t\t'#FF0000',\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t);\n\t\tthis.cmd(act.setHighlight, highlightID, 1);\n\t\tthis.cmd(act.step);\n\n\t\twhile (row >= 0 && value !== this.data[col][row]) {\n\t\t\t// Move right until next element is greater or equal\n\t\t\tlet nextCol = this.getNextCol(col, row);\n\t\t\twhile (value >= this.data[nextCol][row]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tcol = nextCol;\n\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t}\n\n\t\t\t// Move highlight circle downward if data has not been found\n\t\t\tif (value !== this.data[col][row]) {\n\t\t\t\trow--;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, highlightID);\n\n\t\treturn this.commands;\n\t}\n\n\t// Shifts columns on screen\n\tshiftColumns(col) {\n\t\tfor (; col < this.nodeID.length; col++) {\n\t\t\tfor (let row = 0; row < this.nodeID[col].length; row++) {\n\t\t\t\tif (this.nodeID[col][row] != null) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tthis.nodeID[col][row],\n\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t}\n\n\t// Gets the column of the next node (\"right pointer\")\n\tgetNextCol(col, row) {\n\t\tcol++;\n\t\twhile (this.data[col][row] == null) {\n\t\t\tcol++;\n\t\t}\n\t\treturn col;\n\t}\n\n\t// Gets the column of the previous node (\"left pointer\")\n\tgetPrevCol(col, row) {\n\t\tcol--;\n\t\twhile (this.data[col][row] == null) {\n\t\t\tcol--;\n\t\t}\n\t\treturn col;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\n\t\tfor (let col = 0; col < this.nodeID.length; col++) {\n\t\t\tfor (let row = 0; row < this.nodeID[col].length; row++) {\n\t\t\t\tthis.cmd(act.delete, this.nodeID[col][row]);\n\t\t\t}\n\t\t}\n\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\n\t\tthis.size = 0;\n\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[0][0],\n\t\t\tNINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y,\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[1][0],\n\t\t\tPINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING,\n\t\t\tSKIP_LIST_START_Y,\n\t\t);\n\t\tthis.cmd(act.connectSkipList, this.nodeID[0][0], this.nodeID[1][0], 3);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINK_COLOR = '#007700';\nconst HIGHLIGHT_CIRCLE_COLOR = '#007700';\nconst FOREGROUND_COLOR = '#007700';\nconst BACKGROUND_COLOR = '#EEFFEE';\nconst PRINT_COLOR = FOREGROUND_COLOR;\n\nconst WIDTH_DELTA = 50;\nconst HEIGHT_DELTA = 50;\nconst STARTING_Y = 50;\n\nconst FIRST_PRINT_POS_X = 50;\nconst PRINT_VERTICAL_GAP = 20;\nconst PRINT_HORIZONTAL_GAP = 50;\n\nexport default class SplayTree extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.startingX = w / 2;\n\t\tthis.first_print_pos_y = h - 2 * PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.cmd(act.createLabel, 0, '', 20, 10, 0);\n\t\tthis.nextIndex = 1;\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue,\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t}\n\n\tinsertCallback() {\n\t\tlet insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.deleteElement.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\t//  TODO:  This top-down version is broken.  Don't use\n\tsplay(value) {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this.treeRoot.data === value) {\n\t\t\treturn true;\n\t\t}\n\t\tif (value < this.treeRoot.data) {\n\t\t\tif (this.treeRoot.left == null) {\n\t\t\t\treturn false;\n\t\t\t} else if (this.treeRoot.left.data === value) {\n\t\t\t\tthis.singleRotateRight(this.treeRoot);\n\t\t\t\treturn true;\n\t\t\t} else if (value < this.treeRoot.left.data) {\n\t\t\t\tif (this.treeRoot.left.left == null) {\n\t\t\t\t\tthis.singleRotateRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.zigZigRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.treeRoot.left.right == null) {\n\t\t\t\t\tthis.singleRotateRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.doubleRotateRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.treeRoot.right == null) {\n\t\t\t\treturn false;\n\t\t\t} else if (this.treeRoot.right.data === value) {\n\t\t\t\tthis.singleRotateLeft(this.treeRoot);\n\t\t\t\treturn true;\n\t\t\t} else if (value > this.treeRoot.right.data) {\n\t\t\t\tif (this.treeRoot.right.right == null) {\n\t\t\t\t\tthis.singleRotateLeft(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.zigZigLeft(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.treeRoot.right.left == null) {\n\t\t\t\t\tthis.singleRotateLeft(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.doubleRotateLeft(this.treeRot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y,\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) {\n\t\t\t\tthis.cmd(act.delete, i);\n\t\t\t}\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\n\t\t}\n\t\tif (tree.right != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\treturn;\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.normalizeNumber(this.findField.value, 4);\n\t\tthis.findField.value = '';\n\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tconst found = this.doFind(this.treeRoot, findValue);\n\n\t\tif (found) {\n\t\t\tthis.cmd(act.setText, 0, 'Element ' + findValue + ' found.');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, 'Element ' + findValue + ' not found.');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searching for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Splaying found node to root of tree');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\tthis.splayUp(tree);\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t\treturn this.doFind(tree.left, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.splayUp(tree);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)',\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t\treturn this.doFind(tree.right, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.splayUp(tree);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t'Searching for ' + value + ' : < Empty Tree > (Element not found)',\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, 'Searching for ' + value + ' :  (Element not found)');\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tinsertElement(insertedValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Inserting ' + insertedValue);\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tif (this.treeRoot == null) {\n\t\t\tthis.cmd(act.createCircle, this.nextIndex, insertedValue, this.startingX, STARTING_Y);\n\t\t\tthis.cmd(act.setForegroundColor, this.nextIndex, FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex, BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.treeRoot = new BSTNode(insertedValue, this.nextIndex, this.startingX, STARTING_Y);\n\t\t\tthis.nextIndex += 1;\n\t\t} else {\n\t\t\tthis.cmd(act.createCircle, this.nextIndex, insertedValue, 100, 100);\n\t\t\tthis.cmd(act.setForegroundColor, this.nextIndex, FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex, BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tconst insertElem = new BSTNode(insertedValue, this.nextIndex, 100, 100);\n\n\t\t\tthis.nextIndex += 1;\n\t\t\tthis.cmd(act.setHighlight, insertElem.graphicID, 1);\n\t\t\tthis.insert(insertElem, this.treeRoot);\n\t\t\tthis.resizeTree();\n\t\t\tthis.cmd(act.setText, 0, 'Splay inserted element to root of tree');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.splayUp(insertElem);\n\t\t}\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn this.commands;\n\t}\n\n\tinsert(elem, tree) {\n\t\tlet foundDuplicate = false;\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.setHighlight, elem.graphicID, 1);\n\n\t\tif (elem.data < tree.data) {\n\t\t\tthis.cmd(act.setText, 0, elem.data + ' < ' + tree.data + '.  Looking at left subtree');\n\t\t} else if (elem.data > tree.data) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\telem.data + ' >= ' + tree.data + '.  Looking at right subtree',\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, elem.data + ' = ' + tree.data + '. Ignoring duplicate');\n\t\t\tfoundDuplicate = true;\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, elem.graphicID, 0);\n\n\t\tif (foundDuplicate) {\n\t\t\tthis.cmd(act.delete, elem.graphicID, 0);\n\t\t\treturn;\n\t\t}\n\n\t\tif (elem.data < tree.data) {\n\t\t\tif (tree.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Found null tree, inserting element');\n\n\t\t\t\tthis.cmd(act.setHighlight, elem.graphicID, 0);\n\t\t\t\ttree.left = elem;\n\t\t\t\telem.parent = tree;\n\t\t\t\tthis.cmd(act.connect, tree.graphicID, elem.graphicID, LINK_COLOR);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\tthis.highlightID,\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\ttree.x,\n\t\t\t\t\ttree.y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\tthis.insert(elem, tree.left);\n\t\t\t}\n\t\t} else {\n\t\t\tif (tree.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Found null tree, inserting element');\n\t\t\t\tthis.cmd(act.setHighlight, elem.graphicID, 0);\n\t\t\t\ttree.right = elem;\n\t\t\t\telem.parent = tree;\n\t\t\t\tthis.cmd(act.connect, tree.graphicID, elem.graphicID, LINK_COLOR);\n\t\t\t\telem.x = tree.x + WIDTH_DELTA / 2;\n\t\t\t\telem.y = tree.y + HEIGHT_DELTA;\n\t\t\t\tthis.cmd(act.move, elem.graphicID, elem.x, elem.y);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\tthis.highlightID,\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\ttree.x,\n\t\t\t\t\ttree.y,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\tthis.insert(elem, tree.right);\n\t\t\t}\n\t\t}\n\t}\n\n\tdeleteElement(deletedValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Deleting ' + deletedValue);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeDelete(this.treeRoot, deletedValue);\n\t\tthis.cmd(act.setText, 0, '');\n\t\t// Do delete\n\t\treturn this.commands;\n\t}\n\n\ttreeDelete(tree, valueToDelete) {\n\t\tthis.cmd(act.setText, 0, 'Finding ' + valueToDelete + ' and splaying to rooot');\n\t\tthis.cmd(act.step);\n\n\t\tconst inTree = this.doFind(this.treeRoot, valueToDelete);\n\t\tthis.cmd(act.setText, 0, 'Removing root, leaving left and right trees');\n\t\tthis.cmd(act.step);\n\t\tif (inTree) {\n\t\t\tif (this.treeRoot.right == null) {\n\t\t\t\tthis.cmd(act.delete, this.treeRoot.graphicID);\n\t\t\t\tthis.cmd(act.setText, 0, 'No right tree, make left tree the root.');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.treeRoot = this.treeRoot.left;\n\t\t\t\tthis.treeRoot.parent = null;\n\t\t\t\tthis.resizeTree();\n\t\t\t} else if (this.treeRoot.left == null) {\n\t\t\t\tthis.cmd(act.delete, this.treeRoot.graphicID);\n\t\t\t\tthis.cmd(act.setText, 0, 'No left tree, make right tree the root.');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.treeRoot = this.treeRoot.right;\n\t\t\t\tthis.treeRoot.parent = null;\n\t\t\t\tthis.resizeTree();\n\t\t\t} else {\n\t\t\t\tconst right = this.treeRoot.right;\n\t\t\t\tconst left = this.treeRoot.left;\n\t\t\t\tconst oldGraphicID = this.treeRoot.graphicID;\n\t\t\t\tthis.cmd(act.disconnect, this.treeRoot.graphicID, left.graphicID);\n\t\t\t\tthis.cmd(act.disconnect, this.treeRoot.graphicID, right.graphicID);\n\t\t\t\tthis.cmd(act.setAlpha, this.treeRoot.graphicID, 0);\n\t\t\t\tthis.cmd(act.setText, 0, 'Splay largest element in left tree to root');\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tleft.parent = null;\n\t\t\t\tconst largestLeft = this.findMax(left);\n\t\t\t\tthis.splayUp(largestLeft);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Left tree now has no right subtree, connect left and right trees',\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.connect, largestLeft.graphicID, right.graphicID, LINK_COLOR);\n\t\t\t\tlargestLeft.parent = null;\n\t\t\t\tlargestLeft.right = right;\n\t\t\t\tright.parent = largestLeft;\n\t\t\t\tthis.treeRoot = largestLeft;\n\t\t\t\tthis.cmd(act.delete, oldGraphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t}\n\t}\n\n\tsingleRotateRight(tree) {\n\t\tconst B = tree;\n\t\t// const t3 = B.right;\n\t\tconst A = tree.left;\n\t\t// const t1 = A.left;\n\t\tconst t2 = A.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig Right');\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, LINK_COLOR);\n\t\tA.parent = B.parent;\n\t\tif (B.parent == null) {\n\t\t\tthis.treeRoot = A;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, B.parent.graphicID, B.graphicID, LINK_COLOR);\n\t\t\tthis.cmd(act.connect, B.parent.graphicID, A.graphicID, LINK_COLOR);\n\t\t\tif (B.isLeftChild()) {\n\t\t\t\tB.parent.left = A;\n\t\t\t} else {\n\t\t\t\tB.parent.right = A;\n\t\t\t}\n\t\t}\n\t\tA.right = B;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tthis.resizeTree();\n\t}\n\n\tzigZigRight(tree) {\n\t\tconst C = tree;\n\t\tconst B = tree.left;\n\t\tconst A = tree.left.left;\n\t\t// const t1 = A.left;\n\t\tconst t2 = A.right;\n\t\tconst t3 = B.right;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig-Zig Right');\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, B.graphicID, 0);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 0);\n\n\t\tif (C.parent != null) {\n\t\t\tthis.cmd(act.disconnect, C.parent.graphicID, C.graphicID);\n\t\t\tthis.cmd(act.connect, C.parent.graphicID, A.graphicID, LINK_COLOR);\n\t\t\tif (C.isLeftChild()) {\n\t\t\t\tC.parent.left = A;\n\t\t\t} else {\n\t\t\t\tC.parent.right = A;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.treeRoot = A;\n\t\t}\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t3.graphicID);\n\t\t\tthis.cmd(act.connect, C.graphicID, t3.graphicID, LINK_COLOR);\n\t\t\tt3.parent = C;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.disconnect, C.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, C.graphicID, LINK_COLOR);\n\n\t\tA.right = B;\n\t\tA.parent = C.parent;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tB.right = C;\n\t\tC.parent = B;\n\t\tC.left = t3;\n\t\tthis.resizeTree();\n\t}\n\n\tzigZigLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\tconst C = tree.right.right;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\tconst t3 = C.left;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig-Zig Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, C.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 0);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, C.graphicID, 0);\n\n\t\tif (A.parent != null) {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, C.graphicID, LINK_COLOR);\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = C;\n\t\t\t} else {\n\t\t\t\tA.parent.right = C;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.treeRoot = C;\n\t\t}\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = A;\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, C.graphicID, t3.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t3.graphicID, LINK_COLOR);\n\t\t\tt3.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.disconnect, B.graphicID, C.graphicID);\n\t\tthis.cmd(act.connect, C.graphicID, B.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tC.parent = A.parent;\n\t\tA.right = t2;\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tB.right = t3;\n\t\tC.left = B;\n\t\tB.parent = C;\n\n\t\tthis.resizeTree();\n\t}\n\n\tsingleRotateLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\t// const t3 = B.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = A;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tB.parent = A.parent;\n\t\tif (A.parent == null) {\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID, LINK_COLOR);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, LINK_COLOR);\n\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t}\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tA.right = t2;\n\n\t\tthis.resizeTree();\n\t}\n\n\tsplayUp(tree) {\n\t\tif (tree.parent == null) {\n\t\t\treturn;\n\t\t} else if (tree.parent.parent == null) {\n\t\t\tif (tree.isLeftChild()) {\n\t\t\t\tthis.singleRotateRight(tree.parent);\n\t\t\t} else {\n\t\t\t\tthis.singleRotateLeft(tree.parent);\n\t\t\t}\n\t\t} else if (tree.isLeftChild() && !tree.parent.isLeftChild()) {\n\t\t\tthis.doubleRotateLeft(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t} else if (!tree.isLeftChild() && tree.parent.isLeftChild()) {\n\t\t\tthis.doubleRotateRight(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t} else if (tree.isLeftChild()) {\n\t\t\tthis.zigZigRight(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t} else {\n\t\t\tthis.zigZigLeft(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t}\n\t}\n\n\tfindMax(tree) {\n\t\tif (tree.right != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\ttree.x,\n\t\t\t\ttree.y,\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (tree.right != null) {\n\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\ttree = tree.right;\n\t\t\t}\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\treturn tree;\n\t\t} else {\n\t\t\treturn tree;\n\t\t}\n\t}\n\n\tdoubleRotateRight(tree) {\n\t\tthis.cmd(act.setText, 0, 'Zig-Zag Right');\n\t\tconst A = tree.left;\n\t\tconst B = tree.left.right;\n\t\tconst C = tree;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\tconst t3 = B.right;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tt2.parent = A;\n\t\t\tA.right = t2;\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t3.graphicID);\n\t\t\tt3.parent = C;\n\t\t\tC.left = t2;\n\t\t\tthis.cmd(act.connect, C.graphicID, t3.graphicID, LINK_COLOR);\n\t\t}\n\t\tif (C.parent == null) {\n\t\t\tB.parent = null;\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, C.parent.graphicID, C.graphicID);\n\t\t\tthis.cmd(act.connect, C.parent.graphicID, B.graphicID, LINK_COLOR);\n\t\t\tif (C.isLeftChild()) {\n\t\t\t\tC.parent.left = B;\n\t\t\t} else {\n\t\t\t\tC.parent.right = B;\n\t\t\t}\n\t\t\tB.parent = C.parent;\n\t\t\tC.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, C.graphicID, A.graphicID);\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.connect, B.graphicID, C.graphicID, LINK_COLOR);\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tB.right = C;\n\t\tC.parent = B;\n\t\tA.right = t2;\n\t\tC.left = t3;\n\n\t\tthis.resizeTree();\n\t}\n\n\tdoubleRotateLeft(tree) {\n\t\tthis.cmd(act.setText, 0, 'Zig-Zag Left');\n\t\tconst A = tree;\n\t\tconst B = tree.right.left;\n\t\tconst C = tree.right;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\tconst t3 = B.right;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, C.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, B.graphicID, 1);\n\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tt2.parent = A;\n\t\t\tA.right = t2;\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t3.graphicID);\n\t\t\tt3.parent = C;\n\t\t\tC.left = t2;\n\t\t\tthis.cmd(act.connect, C.graphicID, t3.graphicID, LINK_COLOR);\n\t\t}\n\n\t\tif (A.parent == null) {\n\t\t\tB.parent = null;\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, LINK_COLOR);\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t\tB.parent = A.parent;\n\t\t\tA.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, C.graphicID);\n\t\tthis.cmd(act.disconnect, C.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.connect, B.graphicID, C.graphicID, LINK_COLOR);\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tB.right = C;\n\t\tC.parent = B;\n\t\tA.right = t2;\n\t\tC.left = t3;\n\n\t\tthis.resizeTree();\n\t}\n\n\tresizeTree() {\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n\nclass BSTNode {\n\tconstructor(val, id, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n\n\tisLeftChild() {\n\t\tif (this.parent == null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.parent.left === this;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\nconst RESIZE_ARRAY_START_X = 100;\nconst RESIZE_ARRAY_START_Y = 300;\n\nconst ARRAY_ELEMS_PER_LINE = 14;\nconst ARRAY_LINE_SPACING = 130;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\nconst PUSH_RESIZE_LABEL_X = 60;\nconst PUSH_RESIZE_LABEL_Y = 60;\n\nconst SIZE = 7;\nconst MAX_SIZE = 30;\n\nexport default class StackArray extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.pushField = addControlToAlgorithmBar('Text', '');\n\t\tthis.pushField.onkeydown = this.returnSubmit(\n\t\t\tthis.pushField,\n\t\t\tthis.pushCallback.bind(this),\n\t\t\t4,\n\t\t);\n\n\t\tthis.pushButton = addControlToAlgorithmBar('Button', 'Push');\n\t\tthis.pushButton.onclick = this.pushCallback.bind(this);\n\t\tthis.controls.push(this.pushField);\n\t\tthis.controls.push(this.pushButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.popButton = addControlToAlgorithmBar('Button', 'Pop');\n\t\tthis.popButton.onclick = this.popCallback.bind(this);\n\t\tthis.controls.push(this.popButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.topID = this.nextIndex++;\n\t\tthis.topLabelID = this.nextIndex++;\n\n\t\tthis.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.createLabel, this.topLabelID, 'Size', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.topID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.highlight2ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = 0;\n\t\tthis.length = SIZE;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tthis.arrayData = new Array(SIZE);\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.nextIndex = this.nextIndex + 3;\n\t\t//^ To keep nextIndex in the same place relative to setup()\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.highlight2ID = this.nextIndex++;\n\t}\n\n\tpushCallback() {\n\t\tif (this.top < this.arrayData.length && this.pushField.value !== '') {\n\t\t\tconst pushVal = this.pushField.value;\n\t\t\tthis.pushField.value = '';\n\t\t\tthis.implementAction(this.push.bind(this), pushVal);\n\t\t} else if (this.top === this.arrayData.length && this.top * 2 < MAX_SIZE) {\n\t\t\tconst pushVal = this.pushField.value;\n\t\t\tthis.pushField.value = '';\n\t\t\tthis.implementAction(this.resize.bind(this), pushVal);\n\t\t}\n\t}\n\n\tpopCallback() {\n\t\tif (this.top > 0) {\n\t\t\tthis.implementAction(this.pop.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearData.bind(this));\n\t}\n\n\tclearData() {\n\t\tthis.commands = [];\n\t\tthis.clearAll();\n\t\treturn this.commands;\n\t}\n\n\tpush(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData[this.top] = elemToPush;\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, '#0000FF', TOP_POS_X, TOP_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.top % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.top / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[this.top], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top + 1;\n\t\tthis.cmd(act.setText, this.topID, this.top);\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.topID, 0);\n\n\t\tif (elemToPush != null) {\n\t\t\tthis.nextIndex = this.nextIndex - 2;\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tpop() {\n\t\tthis.commands = [];\n\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPopID, 'Popped Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top - 1;\n\n\t\tconst popVal = this.arrayData[this.top];\n\t\tthis.arrayData[this.top] = '';\n\n\t\tthis.cmd(act.setText, this.topID, this.top);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.topID, 0);\n\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, '#0000FF', TOP_POS_X, TOP_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.top % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.top / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.createLabel, labPopValID, popVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[this.top], '');\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Popped Value: ' + popVal);\n\t\tthis.cmd(act.delete, labPopValID);\n\n\t\tthis.nextIndex = this.nextIndex - 2;\n\n\t\treturn this.commands;\n\t}\n\n\tresize(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tconst labPushResizeID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPushResizeID,\n\t\t\t'(Resize Required)',\n\t\t\tPUSH_RESIZE_LABEL_X,\n\t\t\tPUSH_RESIZE_LABEL_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayIDNew = new Array(this.top * 2);\n\t\tthis.arrayLabelIDNew = new Array(this.top * 2);\n\t\tthis.arrayDataNew = new Array(this.top * 2);\n\n\t\tfor (let i = 0; i < this.top * 2; i++) {\n\t\t\tthis.arrayIDNew[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelIDNew[i] = this.nextIndex++;\n\t\t\tif (i < this.top) {\n\t\t\t\tthis.arrayDataNew[i] = this.arrayData[i];\n\t\t\t}\n\t\t}\n\t\tthis.arrayDataNew[this.top] = elemToPush;\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\t//Create new array\n\t\tfor (let i = 0; i < this.top * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayIDNew[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos,\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelIDNew[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelIDNew[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.arrayMoveID = new Array(this.top);\n\n\t\t//Move old array elements to the new array\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tconst xposinit = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yposinit =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\t\tconst ypos =\n\t\t\t\tMath.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + RESIZE_ARRAY_START_Y;\n\n\t\t\tthis.arrayMoveID[i] = this.nextIndex++;\n\n\t\t\t// const display = this.animationManager.objectManager.getText(this.arrayID[i]);\n\t\t\tconst display = this.arrayData[i];\n\n\t\t\tthis.cmd(act.createLabel, this.arrayMoveID[i], display, xposinit, yposinit);\n\t\t\tthis.cmd(act.move, this.arrayMoveID[i], xpos, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//delete movement id objects and set text\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\t// const display = this.animationManager.objectManager.getText(this.arrayID[i]);\n\t\t\tconst display = this.arrayData[i];\n\n\t\t\tthis.cmd(act.setText, this.arrayIDNew[i], display);\n\t\t\tthis.cmd(act.delete, this.arrayMoveID[i]);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t//Add elemToPush at the index\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\t'#0000FF',\n\t\t\tPUSH_ELEMENT_X,\n\t\t\tPUSH_ELEMENT_Y,\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos =\n\t\t\t(parseInt(this.top) % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + RESIZE_ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(parseInt(this.top) / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\tRESIZE_ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos);\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayIDNew[this.top], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t\tthis.cmd(act.delete, this.arrayLabelID[i]);\n\t\t}\n\n\t\tfor (let i = 0; i < this.top * 2; i++) {\n\t\t\tconst xpos = (i % ARRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\t\tthis.cmd(act.move, this.arrayIDNew[i], xpos, ypos);\n\t\t\tthis.cmd(act.move, this.arrayLabelIDNew[i], xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tthis.top = this.top + 1;\n\t\tthis.cmd(act.setText, this.topID, this.top);\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.delete, labPushResizeID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 0);\n\n\t\tthis.arrayID = this.arrayIDNew;\n\t\tthis.arrayLabelID = this.arrayLabelIDNew;\n\t\tthis.arrayData = this.arrayDataNew;\n\n\t\tthis.nextIndex = this.nextIndex - this.top + 1;\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.top = 0;\n\t\tthis.cmd(act.setText, this.topID, '0');\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 250;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst TOP_ELEM_WIDTH = 30;\nconst TOP_ELEM_HEIGHT = 30;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst CODE_START_X = 400;\nconst CODE_START_Y = 25;\nconst CODE_LINE_HEIGHT = 14;\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\nconst CODE_STANDARD_COLOR = '#000000';\n\nconst SIZE = 32;\n\nexport default class StackLL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.pushField = addControlToAlgorithmBar('Text', '');\n\t\tthis.pushField.onkeydown = this.returnSubmit(\n\t\t\tthis.pushField,\n\t\t\tthis.pushCallback.bind(this),\n\t\t\t4,\n\t\t);\n\n\t\tthis.pushButton = addControlToAlgorithmBar('Button', 'Push');\n\t\tthis.pushButton.onclick = this.pushCallback.bind(this);\n\t\tthis.controls.push(this.pushField);\n\t\tthis.controls.push(this.pushButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.popButton = addControlToAlgorithmBar('Button', 'Pop');\n\t\tthis.popButton.onclick = this.popCallback.bind(this);\n\t\tthis.controls.push(this.popButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.linkedListElemID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.topID = this.nextIndex++;\n\t\tthis.topLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.topLabelID, 'Head', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.topID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y,\n\t\t);\n\t\tthis.cmd(act.setNull, this.topID, 1);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.code = [\n\t\t\t['procedure push(data)'],\n\t\t\t['     head = new node(data, head)'],\n\t\t\t// ['     increment size'],\n\t\t\t['end procedure'],\n\n\t\t\t[],\n\t\t\t['procedure pop()'],\n\n\t\t\t['     result = head.data'],\n\t\t\t['     head = head.next'],\n\t\t\t// ['     decrement size'],\n\t\t\t// ['     return result'],\n\t\t\t['end procedure'],\n\t\t];\n\n\t\tthis.codeID = Array(this.code.length);\n\t\tlet i, j;\n\t\tfor (i = 0; i < this.code.length; i++) {\n\t\t\tthis.codeID[i] = new Array(this.code[i].length);\n\t\t\tfor (j = 0; j < this.code[i].length; j++) {\n\t\t\t\tthis.codeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.codeID[i][j],\n\t\t\t\t\tthis.code[i][j],\n\t\t\t\t\tCODE_START_X,\n\t\t\t\t\tCODE_START_Y + i * CODE_LINE_HEIGHT,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[i][j], CODE_STANDARD_COLOR);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, this.codeID[i][j], this.codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tresetLinkedListPositions() {\n\t\tfor (let i = this.top - 1; i >= 0; i--) {\n\t\t\tconst nextX =\n\t\t\t\t((this.top - 1 - i) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\tLINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor((this.top - 1 - i) / LINKED_LIST_ELEMS_PER_LINE) *\n\t\t\t\t\tLINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tpushCallback() {\n\t\tif (this.top < SIZE && this.pushField.value !== '') {\n\t\t\tconst pushVal = this.pushField.value;\n\t\t\tthis.pushField.value = '';\n\t\t\tthis.implementAction(this.push.bind(this), pushVal);\n\t\t}\n\t}\n\n\tpopCallback() {\n\t\tif (this.top > 0) {\n\t\t\tthis.implementAction(this.pop.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tpush(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tthis.arrayData[this.top] = elemToPush;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.highlight(1, 0);\n\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tthis.linkedListElemID[this.top],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[this.top], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (this.top === 0) {\n\t\t\tthis.cmd(act.setNull, this.topID, 0);\n\t\t\tthis.cmd(act.setNull, this.linkedListElemID[this.top], 1);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.linkedListElemID[this.top],\n\t\t\t\tthis.linkedListElemID[this.top - 1],\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[this.top - 1]);\n\t\t}\n\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[this.top]);\n\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top + 1;\n\t\tthis.resetLinkedListPositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(1, 0);\n\n\t\treturn this.commands;\n\t}\n\n\tpop() {\n\t\tthis.commands = [];\n\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPopID, 'Popped Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPopValID,\n\t\t\tthis.arrayData[this.top - 1],\n\t\t\tLINKED_LIST_START_X,\n\t\t\tLINKED_LIST_START_Y,\n\t\t);\n\n\t\tthis.highlight(5, 0);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[this.top - 1]);\n\t\tthis.unhighlight(5, 0);\n\n\t\tif (this.top === 1) {\n\t\t\tthis.cmd(act.setNull, this.topID, 1);\n\t\t} else {\n\t\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[this.top - 2]);\n\t\t}\n\t\tthis.highlight(6, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.unhighlight(6, 0);\n\t\tthis.cmd(act.delete, this.linkedListElemID[this.top - 1]);\n\t\tthis.highlight(7, 0);\n\t\tthis.top = this.top - 1;\n\t\tthis.resetLinkedListPositions();\n\t\tthis.unhighlight(7, 0);\n\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Popped Value: ' + this.arrayData[this.top]);\n\n\t\treturn this.commands;\n\t}\n\n\thighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\n\t}\n\n\tunhighlight(ind1, ind2) {\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.top = 0;\n\t\tthis.cmd(act.setNull, this.topID, 1);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, {\r\n\taddControlToAlgorithmBar,\r\n\taddDivisorToAlgorithmBar,\r\n\taddGroupToAlgorithmBar,\r\n\taddLabelToAlgorithmBar,\r\n} from './Algorithm.js';\r\nimport { act } from '../anim/AnimationMain';\r\n\r\nconst MAX_ARRAY_SIZE = 15;\r\n\r\nconst INFO_MSG_X = 20;\r\nconst INFO_MSG_Y = 150;\r\nconst CODE_START_X = 25;\r\nconst CODE_START_Y = 35;\r\nconst CODE_LINE_HEIGHT = 14;\r\nconst CODE_HIGHLIGHT_COLOR = '#FF0000';\r\nconst CODE_STANDARD_COLOR = '#000000';\r\n\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\nconst ARRAY_INITIAL_X = 400;\r\nconst ARRAY_INITIAL_Y = 50;\r\n\r\nconst HEAP_ARRAY_ELEM_WIDTH = 40;\r\nconst HEAP_ARRAY_ELEM_HEIGHT = 30;\r\nconst HEAP_INITIAL_X = 400;\r\nconst HEAP_INITIAL_Y = 150;\r\nconst HEAP_LABEL_Y_POS = 180;\r\n\r\nconst HEAP_X_POSITIONS = [\r\n\t0,\r\n\t450,\r\n\t250,\r\n\t650,\r\n\t150,\r\n\t350,\r\n\t550,\r\n\t750,\r\n\t100,\r\n\t200,\r\n\t300,\r\n\t400,\r\n\t500,\r\n\t600,\r\n\t700,\r\n\t800,\r\n\t75,\r\n\t125,\r\n\t175,\r\n\t225,\r\n\t275,\r\n\t325,\r\n\t375,\r\n\t425,\r\n\t475,\r\n\t525,\r\n\t575,\r\n\t625,\r\n\t675,\r\n\t725,\r\n\t775,\r\n\t825,\r\n];\r\n\r\nconst HEAP_Y_POSITIONS = [\r\n\t0,\r\n\t250,\r\n\t320,\r\n\t320,\r\n\t390,\r\n\t390,\r\n\t390,\r\n\t390,\r\n\t460,\r\n\t460,\r\n\t460,\r\n\t460,\r\n\t460,\r\n\t460,\r\n\t460,\r\n\t460,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n\t530,\r\n];\r\n\r\nexport default class HeapSort extends Algorithm {\r\n    constructor(am, w, h) {\r\n        super(am, w, h);\r\n        this.addControls();\r\n        this.nextIndex = 0;\r\n        this.setup();\r\n    }\r\n\r\n    addControls() {\r\n        this.controls = [];\r\n\r\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\r\n\r\n        addLabelToAlgorithmBar(\r\n\t\t\t'Comma seperated list (e.g. \"3,1,2\"). Max 15 elements & no elements > 999',\r\n\t\t\tverticalGroup\r\n\t\t);\r\n\r\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\r\n\r\n        // List text field\r\n\t\tthis.listField = addControlToAlgorithmBar('Text', '', horizontalGroup);\r\n\t\tthis.listField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.listField,\r\n\t\t\tthis.sortCallback.bind(this),\r\n\t\t\t60,\r\n\t\t\tfalse,\r\n\t\t);\r\n\t\tthis.controls.push(this.listField);\r\n\r\n\t\t// Sort button\r\n\t\tthis.sortButton = addControlToAlgorithmBar('Button', 'Sort', horizontalGroup);\r\n\t\tthis.sortButton.onclick = this.sortCallback.bind(this);\r\n\t\tthis.controls.push(this.sortButton);\r\n\r\n\t\taddDivisorToAlgorithmBar();\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n    }\r\n\r\n    setup() {\r\n        this.commands = [];\r\n\r\n        this.arrayData = [];\r\n        this.arrayID = [];\r\n        this.heapArrayData = [];\r\n        this.heapArrayID = [];\r\n        this.heapArrayLabelID = [];\r\n        this.heapTreeObj = [];\r\n\r\n        this.infoLabelID = this.nextIndex++;\r\n\r\n        this.infoLabelID = this.nextIndex++;\r\n\t\tthis.cmd(act.createLabel, this.infoLabelID, '', INFO_MSG_X, INFO_MSG_Y, 0);\r\n\r\n\t\tthis.code = [\r\n\t\t\t['procedure heapSort(array)'],\r\n\t\t\t['     heap <- create new PriorityQueue(array)'],\r\n\t\t\t['     for i <- 0, array.length - 1, loop:'],\r\n\t\t\t['          add ', 'heap.remove()', ' to data[i]'],\r\n\t\t\t['     end for'],\r\n\t\t\t['end procedure']\r\n\t\t];\r\n\r\n\t\tthis.codeID = Array(this.code.length);\r\n\t\tlet i, j;\r\n\t\tfor (i = 0; i < this.code.length; i++) {\r\n\t\t\tthis.codeID[i] = new Array(this.code[i].length);\r\n\t\t\tfor (j = 0; j < this.code[i].length; j++) {\r\n\t\t\t\tthis.codeID[i][j] = this.nextIndex++;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\tact.createLabel,\r\n\t\t\t\t\tthis.codeID[i][j],\r\n\t\t\t\t\tthis.code[i][j],\r\n\t\t\t\t\tCODE_START_X,\r\n\t\t\t\t\tCODE_START_Y + i * CODE_LINE_HEIGHT,\r\n\t\t\t\t\t0,\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[i][j], CODE_STANDARD_COLOR);\r\n\t\t\t\tif (j > 0) {\r\n\t\t\t\t\tthis.cmd(act.alignRight, this.codeID[i][j], this.codeID[i][j - 1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n        this.animationManager.startNewAnimation(this.commands);\r\n        this.animationManager.skipForward();\r\n        this.animationManager.clearHistory();\r\n    }\r\n\r\n    sort(list) {\r\n        this.commands = [];\r\n\r\n\t\tthis.highlight(0, 0);\r\n\r\n        this.arrayData = list\r\n\t\t\t.map(Number)\r\n\t\t\t.filter(x => !Number.isNaN(x))\r\n\t\t\t.slice(0, MAX_ARRAY_SIZE);\r\n        const length = this.arrayData.length;\r\n\t\tconst displayDataTemp = new Array(length);\r\n\t\tconst elemCounts = new Map();\r\n\t\tconst letterMap = new Map();\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\r\n\t\t\t}\r\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\r\n\t\t}\r\n\r\n        for (let i = 0; i < length; i++) {\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_INITIAL_X;\r\n\t\t\tconst ypos = ARRAY_INITIAL_Y;\r\n\r\n\t\t\tlet displayData = this.arrayData[i].toString();\r\n\t\t\tif (letterMap.has(this.arrayData[i])) {\r\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\r\n\t\t\t\tdisplayData += currChar;\r\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\r\n\t\t\t}\r\n\t\t\tdisplayDataTemp[i] = displayData;\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.createRectangle,\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\tdisplayData,\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos,\r\n\t\t\t);\r\n\t\t}\r\n        this.arrayData = displayDataTemp;\r\n        this.cmd(act.step);\r\n\t\tthis.unhighlight(0, 0);\r\n\r\n        //Create a new heap\r\n\t\tthis.highlight(1, 0);\r\n        this.createHeap(this.arrayData);\r\n        this.cmd(act.step);\r\n\r\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Buildheap the new array');\r\n        //Buildheap the new heap\r\n\t\tlet nextElem = Math.floor(this.currentHeapSize / 2);\r\n\t\twhile (nextElem > 0) {\r\n\t\t\tthis.pushDown(nextElem);\r\n\t\t\tnextElem = nextElem - 1;\r\n\t\t}\r\n        this.cmd(act.step);\r\n\r\n\t\tthis.unhighlight(1, 0);\r\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\r\n\t\t\r\n\r\n        //Remove all of the elements from the heap\r\n        while (this.currentHeapSize > 0) {\r\n\t\t\tthis.highlight(2, 0);\r\n\t\t\tthis.cmd(act.step);\r\n\t\t\tthis.unhighlight(2, 0);\r\n            this.remove();\r\n\t\t}\r\n\r\n\t\tthis.highlight(4, 0);\r\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\r\n\t\tthis.cmd(act.step);\r\n\r\n        for (let i = 0; i < length + 1; i++) {\r\n            this.cmd(act.delete, this.heapArrayID[i]);\r\n            this.cmd(act.delete, this.heapArrayLabelID[i]);\r\n        }\r\n\t\tthis.unhighlight(4, 0);\r\n\t\tthis.highlight(5, 0);\r\n\t\tthis.cmd(act.step);\r\n\t\r\n\t\tthis.unhighlight(5, 0);\r\n\r\n        return this.commands;\r\n    }\r\n\r\n    createHeap(arrayData) {\r\n        const length = arrayData.length + 1;\r\n\r\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Array-backed heap created');\r\n\r\n        this.heapArrayXPositions = new Array(length);\r\n        this.heapArrayData = arrayData.slice();\r\n        this.heapArrayData.unshift(null);\r\n        this.currentHeapSize = length - 1;\r\n\r\n        for (let i = 0; i < length; i++) {\r\n            //Create heap array\r\n\t\t\tthis.heapArrayXPositions[i] = HEAP_INITIAL_X + i * HEAP_ARRAY_ELEM_WIDTH;\r\n\t\t\tthis.heapArrayID[i] = this.nextIndex++;\r\n            this.heapArrayLabelID[i] = this.nextIndex++;\r\n\t\t\tthis.heapTreeObj[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.createRectangle,\r\n\t\t\t\tthis.heapArrayID[i],\r\n\t\t\t\tthis.heapArrayData[i],\r\n\t\t\t\tHEAP_ARRAY_ELEM_WIDTH,\r\n\t\t\t\tHEAP_ARRAY_ELEM_HEIGHT,\r\n\t\t\t\tthis.heapArrayXPositions[i],\r\n\t\t\t\tHEAP_INITIAL_Y,\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.createLabel,\r\n\t\t\t\tthis.heapArrayLabelID[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.heapArrayXPositions[i],\r\n                HEAP_LABEL_Y_POS,\r\n\t\t\t);\r\n\t\t\tthis.cmd(act.setForegroundColor, this.heapArrayLabelID[i], '#0000FF');\r\n\r\n            //Create heap tree\r\n            if (i > 0) {\r\n                this.cmd(\r\n                    act.createCircle,\r\n                    this.heapTreeObj[i],\r\n                    this.heapArrayData[i],\r\n                    HEAP_X_POSITIONS[i],\r\n                    HEAP_Y_POSITIONS[i],\r\n                );\r\n                this.cmd(act.setText, this.heapArrayID[i], this.heapArrayData[i]);\r\n                if (i > 1) {\r\n                    this.cmd(act.connect, this.heapTreeObj[Math.floor(i / 2)], this.heapTreeObj[i]);\r\n                }\r\n            }\r\n\t\t}\r\n\r\n        return this.commands;\r\n    }\r\n\r\n\tremove() {\r\n        const index = this.arrayData.length - this.currentHeapSize;\r\n        const remData = this.heapArrayData[1];\r\n        const removedElementID = this.nextIndex; //no ++ since 'removedElementID' is deleted before any other elements are created\r\n\r\n\t\tthis.cmd(act.setText, this.infoLabelID, '');\r\n\r\n\t\tthis.highlight(3, 0);\r\n\t\tthis.highlight(3, 1);\r\n\t\tthis.highlight(3, 2);\r\n\r\n\t\tthis.cmd(act.setText, this.heapArrayID[1], '');\r\n\r\n        this.cmd(\r\n\t\t\tact.createLabel,\r\n\t\t\tremovedElementID,\r\n\t\t\tremData,\r\n\t\t\tHEAP_X_POSITIONS[1],\r\n\t\t\tHEAP_Y_POSITIONS[1],\r\n\t\t\t0,\r\n\t\t);\r\n        this.cmd(act.setText, this.heapTreeObj[1], '');\r\n\t\tthis.cmd(act.setText, this.arrayID[index], '');\r\n        this.cmd(\r\n            act.move,\r\n            removedElementID,\r\n            index * ARRAY_ELEM_WIDTH + ARRAY_INITIAL_X - 5,\r\n            ARRAY_INITIAL_Y - 5\r\n        );\r\n        this.cmd(act.step);\r\n\r\n\t\tthis.arrayData[index] = remData;\r\n        this.cmd(act.setText, this.arrayID[index], remData);\r\n        this.cmd(act.delete, removedElementID);\r\n\t\tthis.cmd(act.step);\r\n\r\n\t\tthis.heapArrayData[1] = '';\r\n\t\t\r\n\t\tthis.unhighlight(3, 0);\r\n\t\tthis.unhighlight(3, 2);\r\n\t\tthis.cmd(act.setText, this.infoLabelID, 'Downheap to maintain order');\r\n\r\n\t\tif (this.currentHeapSize > 1) {\r\n\t\t\tthis.cmd(act.setHighlight, this.heapArrayID[1], 1);\r\n\t\t\tthis.cmd(act.setHighlight, this.heapArrayID[this.currentHeapSize], 1);\r\n\t\t\tthis.cmd(act.setHighlight, this.heapTreeObj[1], 1);\r\n\t\t\tthis.cmd(act.setHighlight, this.heapTreeObj[this.currentHeapSize], 1);\r\n\t\t\tthis.cmd(act.step);\r\n\t\t\t\r\n\t\t\tthis.cmd(act.setHighlight, this.heapArrayID[1], 0);\r\n\t\t\tthis.cmd(act.setHighlight, this.heapArrayID[this.currentHeapSize], 0);\r\n\t\t\tthis.cmd(act.setHighlight, this.heapTreeObj[1], 0);\r\n\t\t\tthis.cmd(act.setHighlight, this.heapTreeObj[this.currentHeapSize], 0);\r\n\t\t\tthis.swap(1, this.currentHeapSize);\r\n\t\t\t\r\n\t\t\tthis.cmd(act.delete, this.heapTreeObj[this.currentHeapSize]);\r\n\t\t\tthis.cmd(act.step);\r\n\r\n\t\t\tthis.currentHeapSize--;\r\n            if (this.currentHeapSize > 0) { this.pushDown(1); }\r\n\t\t} else {\r\n\t\t\tthis.cmd(act.setText, this.heapArrayID[1], '');\r\n\t\t\tthis.cmd(act.delete, this.heapTreeObj[this.currentHeapSize]);\r\n\t\t\tthis.cmd(act.step);\r\n\t\t\tthis.currentHeapSize--;\r\n\t\t}\r\n\t\tthis.unhighlight(3, 1);\r\n\t\tthis.cmd(act.step);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n    pushDown(index) {\r\n\t\tlet childIndex; // Used to keep track of smallest (in MinHeap) or largest (in MaxHeap) child\r\n\r\n\t\twhile (index * 2 <= this.currentHeapSize) {\r\n\t\t\tchildIndex = 2 * index;\r\n\r\n\t\t\tif (index * 2 + 1 <= this.currentHeapSize) {\r\n\t\t\t\tthis.setIndexHighlight(2 * index, 1);\r\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 1);\r\n\t\t\t\tthis.cmd(act.step);\r\n\t\t\t\tthis.setIndexHighlight(2 * index, 0);\r\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 0);\r\n\t\t\t\tif (this.downheapCheckRightChild(index)) {\r\n\t\t\t\t\tchildIndex = 2 * index + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.setIndexHighlight(index, 1);\r\n\t\t\tthis.setIndexHighlight(childIndex, 1);\r\n\t\t\tthis.cmd(act.step);\r\n\t\t\tthis.setIndexHighlight(index, 0);\r\n\t\t\tthis.setIndexHighlight(childIndex, 0);\r\n\r\n\t\t\tif (this.downheapCompare(childIndex, index)) {\r\n\t\t\t\tthis.swap(childIndex, index);\r\n\t\t\t\tindex = childIndex;\r\n\t\t\t} else {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdownheapCheckRightChild(index) {\r\n\t\t// Checks if the right child is smaller than left child\r\n\t\treturn this.compareWithLetters(this.heapArrayData[2 * index + 1], this.heapArrayData[2 * index]);\r\n\t}\r\n\r\n\tdownheapCompare(childIndex, index) {\r\n\t\t// Checks if smallest child is smaller than parent\r\n\t\treturn this.compareWithLetters(this.heapArrayData[childIndex], this.heapArrayData[index]);\r\n\t}\r\n\r\n\tcompareWithLetters(num1, num2) {\r\n\t\treturn parseInt(num1) < parseInt(num2);\r\n\t}\r\n\r\n    swap(index1, index2) {\r\n        const swapLabel1 = this.nextIndex++;\r\n        const swapLabel2 = this.nextIndex++;\r\n        const swapLabel3 = this.nextIndex++;\r\n        const swapLabel4 = this.nextIndex++;\r\n\t\tthis.cmd(act.setText, this.heapArrayID[index1], '');\r\n\t\tthis.cmd(act.setText, this.heapArrayID[index2], '');\r\n\t\tthis.cmd(act.setText, this.heapTreeObj[index1], '');\r\n\t\tthis.cmd(act.setText, this.heapTreeObj[index2], '');\r\n\t\tthis.cmd(\r\n\t\t\tact.createLabel,\r\n\t\t\tswapLabel1,\r\n\t\t\tthis.heapArrayData[index1],\r\n\t\t\tthis.heapArrayXPositions[index1],\r\n\t\t\tHEAP_INITIAL_Y,\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\tact.createLabel,\r\n\t\t\tswapLabel2,\r\n\t\t\tthis.heapArrayData[index2],\r\n\t\t\tthis.heapArrayXPositions[index2],\r\n\t\t\tHEAP_INITIAL_Y,\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\tact.createLabel,\r\n\t\t\tswapLabel3,\r\n\t\t\tthis.heapArrayData[index1],\r\n\t\t\tHEAP_X_POSITIONS[index1],\r\n\t\t\tHEAP_Y_POSITIONS[index1],\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\tact.createLabel,\r\n\t\t\tswapLabel4,\r\n\t\t\tthis.heapArrayData[index2],\r\n\t\t\tHEAP_X_POSITIONS[index2],\r\n\t\t\tHEAP_Y_POSITIONS[index2],\r\n\t\t);\r\n\t\tthis.cmd(act.move, swapLabel1, this.heapArrayXPositions[index2], HEAP_INITIAL_Y);\r\n\t\tthis.cmd(act.move, swapLabel2, this.heapArrayXPositions[index1], HEAP_INITIAL_Y);\r\n\t\tthis.cmd(act.move, swapLabel3, HEAP_X_POSITIONS[index2], HEAP_Y_POSITIONS[index2]);\r\n\t\tthis.cmd(act.move, swapLabel4, HEAP_X_POSITIONS[index1], HEAP_Y_POSITIONS[index1]);\r\n\t\tconst tmp = this.heapArrayData[index1];\r\n\t\tthis.heapArrayData[index1] = this.heapArrayData[index2];\r\n\t\tthis.heapArrayData[index2] = tmp;\r\n\t\tthis.cmd(act.step);\r\n\t\tthis.cmd(act.setText, this.heapArrayID[index1], this.heapArrayData[index1]);\r\n\t\tthis.cmd(act.setText, this.heapArrayID[index2], this.heapArrayData[index2]);\r\n\t\tthis.cmd(act.setText, this.heapTreeObj[index1], this.heapArrayData[index1]);\r\n\t\tthis.cmd(act.setText, this.heapTreeObj[index2], this.heapArrayData[index2]);\r\n\t\tthis.cmd(act.delete, swapLabel1);\r\n\t\tthis.cmd(act.delete, swapLabel2);\r\n\t\tthis.cmd(act.delete, swapLabel3);\r\n\t\tthis.cmd(act.delete, swapLabel4);\r\n        this.nextIndex -= 4;\r\n\t}\r\n\r\n    setIndexHighlight(index, highlightVal) {\r\n\t\tthis.cmd(act.setHighlight, this.heapTreeObj[index], highlightVal);\r\n\t\tthis.cmd(act.setHighlight, this.heapArrayID[index], highlightVal);\r\n\t}\r\n\r\n    clear() {\r\n        this.commands = [];\r\n\r\n        for (let i = 0; i < this.arrayID.length; i++) {\r\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\r\n\t\t}\r\n\r\n        this.arrayData = [];\r\n        this.arrayID = [];\r\n        this.heapArrayData = [];\r\n        this.heapArrayID = [];\r\n        this.heapArrayLabelID = [];\r\n\r\n        return this.commands;\r\n    }\r\n\r\n    reset() {\r\n        this.currentHeapSize = 0;\r\n    }\r\n\r\n    sortCallback() {\r\n\t\tconst list = this.listField.value.split(',').filter(x => x !== '');\r\n        if (\r\n\t\t\tthis.listField.value !== ''\r\n\t\t\t&& list.length <= MAX_ARRAY_SIZE\r\n\t\t\t&& list.map(Number).filter(x => x > 999 || Number.isNaN(x)).length <= 0\r\n\t\t\t) {\r\n            this.implementAction(this.clear.bind(this));\r\n            this.listField.value = '';\r\n            this.implementAction(this.sort.bind(this), list);\r\n        }\r\n    }\r\n\r\n    clearCallback() {\r\n        this.implementAction(this.clear.bind(this));\r\n    }\r\n\r\n\thighlight(ind1, ind2) {\r\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_HIGHLIGHT_COLOR);\r\n\t}\r\n\r\n\tunhighlight(ind1, ind2) {\r\n\t\tthis.cmd(act.setForegroundColor, this.codeID[ind1][ind2], CODE_STANDARD_COLOR);\r\n\t}\r\n\r\n    disableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport { \r\n    addControlToAlgorithmBar, \r\n    addDivisorToAlgorithmBar,\r\n    addLabelToAlgorithmBar\r\n } from '../algo/Algorithm.js';\r\nimport Hash from '../algo/Hash';\r\nimport { act } from '../anim/AnimationMain';\r\n\r\nconst ARRAY_ELEM_WIDTH = 60;\r\nconst ARRAY_ELEM_HEIGHT = 30;\r\nconst ARRAY_ELEM_START_Y = 200;\r\n\r\nconst CLOSED_HASH_TABLE_SIZE = 18;\r\n\r\nconst ARRAY_ELEM_START_X = 100;\r\n// If you want to center the array:\r\n// const ARRAY_ELEM_START_X = (window.screen.width - CLOSED_HASH_TABLE_SIZE * ARRAY_ELEM_WIDTH + ARRAY_ELEM_WIDTH) / 2;\r\nconst ELEMS_PER_ROW = 18;\r\n\r\nconst LOAD_LABEL_X = 100;\r\nconst LOAD_LABEL_Y = 20;\r\n\r\nconst HASH2_LABEL_X = 270;\r\nconst HASH2_LABEL_Y = 70;\r\n\r\nconst DEFAULT_LOAD_FACTOR = 0.67;\r\n\r\nconst INDEX_COLOR = '#0000FF';\r\n\r\nconst sin = (x) => -50 * Math.sin(x * Math.PI / 4)\r\nconst exponential = (x) => -1 * Math.pow(1.41, x) + 200\r\nconst quadratic = (x) => Math.pow((2.2 * x) - 18.7, 2) - 150\r\nconst logarithmic = (x) => -100 * Math.log(x + .4) + 170\r\nconst mult_inverse = (x) => 250 / (2.8 * x - 24.1)\r\n\r\nconst EQUATIONS = [\r\n    {\r\n        name: \"sin\",\r\n        equation: sin\r\n    },\r\n    {\r\n        name: \"exponential\",\r\n        equation: exponential\r\n    },\r\n    {\r\n        name: \"quadratic\",\r\n        equation: quadratic\r\n    },\r\n    {\r\n        name: \"logarithmic\",\r\n        equation: logarithmic\r\n    },\r\n    {\r\n        name: \"multaplicative inverse\",\r\n        equation: mult_inverse\r\n    }\r\n]\r\n\r\n\r\nexport default class NonLinearProbing extends Hash {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.elements_per_row = ELEMS_PER_ROW;\r\n\t\t//this.elements_per_row = Math.floor(w / ARRAY_ELEM_WIDTH) - 1;\r\n\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tsuper.addControls();\r\n\r\n\t\taddDivisorToAlgorithmBar();\r\n\r\n        this.fillButton = addControlToAlgorithmBar('Button', 'Fill HashMap');\r\n\t\tthis.fillButton.onclick = this.fillCallback.bind(this);\r\n\t\tthis.controls.push(this.fillButton);\r\n\r\n        addDivisorToAlgorithmBar();\r\n\r\n        addLabelToAlgorithmBar(\"Collision Strategy: h(elem) + i ???\")\r\n\t}\r\n\r\n    setup() {\r\n\t\tthis.resetIndex = this.nextIndex;\r\n\t\tthis.table_size = CLOSED_HASH_TABLE_SIZE;\r\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\r\n\t\tthis.skipDist = new Array(this.table_size);\r\n\t\tthis.hashTableVisual = new Array(this.table_size);\r\n\t\tthis.hashTableValues = new Array(this.table_size);\r\n\t\tthis.size = 0;\r\n\r\n\t\tthis.indexLabelID = new Array(this.table_size);\r\n\t\tthis.indexXPos = new Array(this.table_size);\r\n\t\tthis.indexYPos = new Array(this.table_size);\r\n        this.indexEqYPos = new Array(this.table_size);\r\n\r\n\t\tthis.empty = new Array(this.table_size);\r\n\t\tthis.deleted = new Array(this.table_size);\r\n\r\n\t\tthis.ExplainLabel = this.nextIndex++;\r\n\r\n\t\tthis.HashIndexID = this.nextIndex++;\r\n\r\n\t\t// stores deleted index\r\n\t\tthis.DelIndexLabel = this.nextIndex++;\r\n\r\n\t\t// stores the load factor\r\n\t\tthis.loadFactorID = this.nextIndex++;\r\n\r\n\t\tthis.commands = [];\r\n\r\n        this.equation = EQUATIONS[parseInt(Math.random() * (EQUATIONS.length))]\r\n        console.log(this.equation.name);\r\n\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tthis.skipDist[i] = i + 1; // Start with \"linear\" probing\r\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\r\n\t\t\tthis.empty[i] = true;\r\n\t\t\tthis.deleted[i] = false;\r\n\r\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\r\n\t\t\tconst nextYPos = ARRAY_ELEM_START_Y +\r\n\t\t\t\tMath.floor(i / this.elements_per_row);\r\n            const nextEqYPos = ARRAY_ELEM_START_Y + this.equation.equation(i);\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.createRectangle,\r\n\t\t\t\tthis.hashTableVisual[i],\r\n\t\t\t\t'',\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\tnextXPos,\r\n\t\t\t\tnextYPos,\r\n\t\t\t);\r\n\t\t\tthis.indexLabelID[i] = this.nextIndex++;\r\n\t\t\tthis.indexXPos[i] = nextXPos;\r\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\r\n            this.indexEqYPos[i] = nextEqYPos;\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.createLabel,\r\n\t\t\t\tthis.indexLabelID[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.indexXPos[i],\r\n\t\t\t\tthis.indexYPos[i],\r\n\t\t\t);\r\n\t\t\tthis.cmd(act.setForegroundColor, this.indexLabelID[i], INDEX_COLOR);\r\n\t\t}\r\n\t\tthis.cmd(act.createLabel, this.ExplainLabel, '', 10, 40, 0);\r\n\t\tthis.cmd(act.createLabel, this.HashIndexID, '', HASH2_LABEL_X + 300, HASH2_LABEL_Y + 5);\r\n\t\tthis.cmd(act.createLabel, this.DelIndexLabel, '', 10, 60, 0);\r\n\t\tthis.cmd(\r\n\t\t\tact.createLabel,\r\n\t\t\tthis.loadFactorID,\r\n\t\t\t`Load Factor: ${this.load_factor}`,\r\n\t\t\tLOAD_LABEL_X,\r\n\t\t\tLOAD_LABEL_Y,\r\n\t\t);\r\n\t\tthis.animationManager.startNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n    fillCallback() {\r\n        this.implementAction(this.fillMap.bind(this));\r\n\t}\r\n\r\n    fillMap() {\r\n        this.commands = [];\r\n        const emptySpaces = this.hashTableValues.length - this.size;\r\n        for (let i = 0; i < emptySpaces; i++) {\r\n            this.insertElement(i, \"val\");\r\n            // this.commandsTemp = this.commands;\r\n            // this.commandsTemp.push(this.insertElement(i, \"val\"));\r\n            // this.commands = this.commandsTemp;\r\n        }\r\n        return this.commands;\r\n    }\r\n\r\n\tinsertElement(key, value) {\r\n\t\tconst entry = new MapEntry(key, value);\r\n\t\tconst elem = entry.elem;\r\n\t\t// this.commands = [];\r\n\r\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting element: ' + elem);\r\n\t\tthis.cmd(act.step);\r\n\r\n\t\tlet index = this.doHash(key);\r\n\r\n\t\tindex = this.getEmptyIndex(index, key);\r\n\r\n\t\tif (index === -2) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.setText,\r\n\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t`Happy april fools!\r\n                  - Grant, Liam, William, and the TAs :)`,\r\n\t\t\t);\r\n\t\t\treturn this.commands;\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\tthis.hashTableValues[index] &&\r\n\t\t\tthis.hashTableValues[index].key === key &&\r\n\t\t\t!this.deleted[index]\r\n\t\t) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.setText,\r\n\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t'Key ' + key + ' is already in HashMap, updating value.',\r\n\t\t\t\t``,\r\n\t\t\t);\r\n\t\t\tthis.size--;\r\n\t\t}\r\n\r\n\t\tconst labID = this.nextIndex++;\r\n\t\tthis.cmd(act.createLabel, labID, elem, 20, 25);\r\n\t\tthis.cmd(act.move, labID, this.indexXPos[index], this.indexYPos[index] - ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd(act.step);\r\n\t\tthis.cmd(act.delete, labID);\r\n\t\tthis.cmd(act.setText, this.hashTableVisual[index], elem);\r\n\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\r\n        this.cmd(act.step);\r\n        \r\n        //fun stuff :)\r\n        this.cmd(act.move, this.hashTableVisual[index], this.indexXPos[index], this.indexEqYPos[index] - ARRAY_ELEM_HEIGHT);\r\n        this.cmd(act.move, this.indexLabelID[index], this.indexXPos[index], this.indexEqYPos[index]);\r\n        this.cmd(act.step);\r\n\r\n\t\tthis.hashTableValues[index] = entry;\r\n\t\tthis.empty[index] = false;\r\n\t\tthis.deleted[index] = false;\r\n\t\tthis.size++;\r\n\r\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\r\n\t\tthis.cmd(act.setText, this.DelIndexLabel, '');\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tgetEmptyIndex(index, key) {\r\n\t\tconst HashID = -1;\r\n\t\tlet skipVal = 1;\r\n        \r\n\t\tlet probes = 0;\r\n\t\tlet removedIndex = -1;\r\n\t\tconst start = index;\r\n\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 1);\r\n\t\twhile (\r\n\t\t\tprobes < this.table_size &&\r\n\t\t\t!this.empty[index] &&\r\n\t\t\t!(this.hashTableValues[index].key === key)\r\n\t\t) {\r\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, `Entry occupied, so probe forward`);\r\n\t\t\tthis.cmd(act.step);\r\n\t\t\t// storing removed index\r\n\t\t\tif (removedIndex === -1 && this.deleted[index]) {\r\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Storing index of first deleted element');\r\n\t\t\t\tthis.cmd(act.setText, this.DelIndexLabel, 'First Deleted Index: ' + index);\r\n\t\t\t\tremovedIndex = index;\r\n\t\t\t\tthis.cmd(act.step);\r\n\t\t\t}\r\n\r\n\t\t\t// increment index and clear labels\r\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\r\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, '');\r\n\r\n\t\t\tindex = (start + this.skipDist[probes]) % this.table_size;\r\n\r\n\t\t\tif (this.currentHashingTypeButtonState === this.quadraticProbingButton) {\r\n\t\t\t\tskipVal = probes + 1;\r\n\t\t\t}\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.setText,\r\n\t\t\t\tthis.HashIndexID,\r\n\t\t\t\t`Index to probe: (${start} + ${probes + 1}*${skipVal}) % ${this.table_size} =` +\r\n\t\t\t\t\t` ${(start + this.skipDist[probes]) % this.table_size}`,\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 1);\r\n\t\t\tif (this.empty[index]) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\tact.setText,\r\n\t\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t\t'Encountered null spot, so terminate loop',\r\n\t\t\t\t);\r\n\t\t\t} else if (this.hashTableValues[index].key === key) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\tact.setText,\r\n\t\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t\t`Encountered matching key, so terminate loop`,\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tprobes++;\r\n\t\t\tthis.cmd(act.step);\r\n\t\t}\r\n\r\n\t\tthis.cmd(act.setText, this.HashIndexID, '');\r\n\r\n\t\tif (HashID !== -1) {\r\n\t\t\tthis.cmd(act.delete, HashID);\r\n\t\t\tthis.nextIndex--;\r\n\t\t}\r\n\r\n\t\tif (!this.empty[index] && this.hashTableValues[index].key === key && !this.deleted[index]) {\r\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\r\n\t\t\treturn index;\r\n\t\t} else if (probes === this.table_size && removedIndex === -1) {\r\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\r\n\t\t\treturn -2;\r\n\t\t} else {\r\n\t\t\tif (removedIndex !== -1) {\r\n\t\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 0);\r\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting at earlier DEL spot');\r\n\t\t\t\tindex = removedIndex;\r\n\t\t\t} else if (this.hashTableValues[index] == null) {\r\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting at null spot');\r\n\t\t\t} else if (this.hashTableValues[index].key === key) {\r\n\t\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting at DEL spot with same key');\r\n\t\t\t}\r\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[index], 1);\r\n\t\t\tthis.cmd(act.step);\r\n\t\t\treturn removedIndex !== -1 ? removedIndex : index;\r\n\t\t}\r\n\t}\r\n\r\n\tgetElemIndex(index, key) {\r\n\t\tconst HashID = -1;\r\n\t\tlet skipVal = 1;\r\n\r\n\t\tconst start = index;\r\n\t\tlet foundIndex = -1;\r\n\t\tlet candidateIndex = index;\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 1);\r\n\t\t\tthis.cmd(act.step);\r\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 0);\r\n\t\t\tif (\r\n\t\t\t\t!this.empty[candidateIndex] &&\r\n\t\t\t\t!this.deleted[candidateIndex] &&\r\n\t\t\t\tthis.hashTableValues[candidateIndex].key === key\r\n\t\t\t) {\r\n\t\t\t\tfoundIndex = candidateIndex;\r\n\t\t\t\tbreak;\r\n\t\t\t} else if (\r\n\t\t\t\tthis.empty[candidateIndex] ||\r\n\t\t\t\t(this.deleted[candidateIndex] && this.hashTableValues[candidateIndex].key === key)\r\n\t\t\t) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.currentHashingTypeButtonState === this.quadraticProbingButton) {\r\n\t\t\t\tskipVal = i + 1;\r\n\t\t\t}\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.setText,\r\n\t\t\t\tthis.HashIndexID,\r\n\t\t\t\t`Index to probe: (${start} + ${i + 1}*${skipVal}) % ${this.table_size} =` +\r\n\t\t\t\t\t` ${(start + this.skipDist[i]) % this.table_size}`,\r\n\t\t\t);\r\n\t\t\tcandidateIndex = (index + this.skipDist[i]) % this.table_size;\r\n\t\t}\r\n\r\n\t\tthis.cmd(act.setText, this.HashIndexID, '');\r\n\t\tif (HashID !== -1) {\r\n\t\t\tthis.cmd(act.delete, HashID);\r\n\t\t\tthis.nextIndex--;\r\n\t\t}\r\n\r\n\t\treturn foundIndex;\r\n\t}\r\n\r\n\tdeleteElement(key) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Deleting element with key: ' + key);\r\n\t\tlet index = this.doHash(key);\r\n\r\n\t\tindex = this.getElemIndex(index, key);\r\n\r\n\t\tif (index >= 0) {\r\n\t\t\tconst elem = this.hashTableValues[index].elem;\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.setText,\r\n\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t'Deleting element: ' + elem + '  Element deleted',\r\n\t\t\t);\r\n\t\t\t// this.empty[index] = true;\r\n\t\t\tthis.deleted[index] = true;\r\n\t\t\tthis.cmd(act.setText, this.hashTableVisual[index], 'DEL');\r\n\t\t\tthis.size--;\r\n\t\t} else {\r\n\t\t\tthis.cmd(\r\n\t\t\t\tact.setText,\r\n\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t'Deleting element with key: ' + key + '  Key not in table',\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tfindElement(key) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Key: ' + key);\r\n\t\tconst index = this.doHash(key);\r\n\r\n\t\tconst found = this.getElemIndex(index, key) !== -1;\r\n\t\tif (found) {\r\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Found Key: ' + key + '  Value: ' + this.hashTableValues[index].val);\r\n\t\t} else {\r\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Key: ' + key + '  Not Found!');\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n    changeLoadFactor(LF) {\r\n\t\tthis.commands = [];\r\n\r\n        this.cmd(act.setText, this.loadFactorID, `Resizing? We don't do that here`);\r\n\t\tthis.cmd(act.step);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\r\n\tresetAll() {\r\n\t\tthis.commands = super.resetAll();\r\n\r\n\t\tthis.size = 0;\r\n\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tthis.empty[i] = true;\r\n\t\t\tthis.deleted[i] = false;\r\n\t\t\tthis.hashTableValues[i] = undefined;\r\n\t\t\tthis.cmd(act.setText, this.hashTableVisual[i], '');\r\n\t\t}\r\n\r\n\t\treturn this.commands;\r\n\t\t// Clear array, etc\r\n\t}\r\n\r\n\t// NEED TO OVERRIDE IN PARENT\r\n\treset() {\r\n\t\tthis.nextIndex = this.resetIndex;\r\n\t\tthis.table_size = CLOSED_HASH_TABLE_SIZE;\r\n\t\tthis.load_factor = DEFAULT_LOAD_FACTOR;\r\n\t\tthis.size = 0;\r\n\r\n\t\tthis.empty = new Array(this.table_size);\r\n\t\tthis.deleted = new Array(this.table_size);\r\n\t\tthis.hashTableVisual = new Array(this.table_size);\r\n\t\tthis.hashTableValues = new Array(this.table_size);\r\n\t\tthis.indexLabelID = new Array(this.table_size);\r\n\r\n\t\tthis.ExplainLabel = this.nextIndex++;\r\n\r\n\t\tthis.HashIndexID = this.nextIndex++;\r\n\r\n\t\t// stores deleted index\r\n\t\tthis.DelIndexLabel = this.nextIndex++;\r\n\r\n\t\t// stores the load factor\r\n\t\tthis.loadFactorID = this.nextIndex++;\r\n\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tthis.empty[i] = true;\r\n\t\t\tthis.deleted[i] = false;\r\n\t\t\tthis.hashTableVisual[i] = this.nextIndex++;\r\n\t\t\tthis.indexLabelID[i] = this.nextIndex++;\r\n\t\t}\r\n\r\n\t\tsuper.reset();\r\n\t}\r\n\r\n\tresetCallback() {}\r\n\r\n\tdisableUI() {\r\n\t\tsuper.disableUI();\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tsuper.enableUI();\r\n\t}\r\n}\r\n\r\nclass MapEntry {\r\n\tconstructor(key, val) {\r\n\t\tthis.key = key;\r\n\t\tthis.val = val;\r\n\t\tthis.elem = `<${key}, ${val}>`;\r\n\t}\r\n}\r\n","import * as algos from './algo';\nimport * as jokeAlgo from './joke-algo';\n\n// After adding the export in algos/index.js, add new algorithms in the following format:\n// AlgorithmName: ['Menu Display Name', algos.ClassName, 'Verbose Display Name (optional)']\nexport const algoMap = {\n\tArrayList: ['ArrayList', algos.ArrayList],\n\tLinkedList: ['Singly LinkedList', algos.LinkedList],\n\tDoublyLinkedList: ['Doubly LinkedList', algos.DoublyLinkedList],\n\tCircularlyLinkedList: ['Circularly LinkedList', algos.CircularlyLinkedList],\n\tStackArray: ['Stack (Array)', algos.StackArray],\n\tStackLL: ['Stack (LinkedList)', algos.StackLL],\n\tQueueArray: ['Queue (Array)', algos.QueueArray],\n\tQueueLL: ['Queue (LinkedList)', algos.QueueLL],\n\tDequeArray: ['Deque (Array)', algos.DequeArray],\n\tDequeLL: ['Deque (LinkedList)', algos.DequeLL],\n\tBST: ['Binary Search Tree', algos.BST],\n\tHeap: ['Heaps / PQs', algos.Heap],\n\tSkipList: ['SkipList', algos.SkipList],\n\tClosedHash: ['HashMap (Probing)', algos.ClosedHash],\n\tOpenHash: ['HashMap (Chaining)', algos.OpenHash],\n\tSplayTree: ['SplayTree', algos.SplayTree],\n\tAVL: ['AVL', algos.AVL],\n\tLVA: ['LVA', algos.LVA],\n\tBTree: ['2-4 Tree', algos.BTree],\n\tBogoSort: ['Bogo Sort', algos.BogoSort],\n\tBubbleSort: ['Bubble Sort', algos.BubbleSort],\n\tCocktailSort: ['Cocktail Shaker Sort', algos.CocktailSort],\n\tInsertionSort: ['Insertion Sort', algos.InsertionSort],\n\tSelectionSort: ['Selection Sort', algos.SelectionSort],\n\tQuickSort: ['QuickSort', algos.QuickSort],\n\tQuickSelect: ['QuickSelect / k Select', algos.QuickSelect],\n\tMergeSort: ['MergeSort', algos.MergeSort],\n\tLSDRadix: ['LSD Radix Sort', algos.LSDRadix],\n\tHeapSort: ['HeapSort', algos.HeapSort],\n\tBruteForce: ['Brute Force', algos.BruteForce],\n\tBoyerMoore: ['Boyer-Moore', algos.BoyerMoore],\n\tKMP: ['KMP', algos.KMP],\n\tRabinKarp: ['Rabin-Karp', algos.RabinKarp],\n\tBFS: ['Breadth-First Search', algos.BFS],\n\tDFS: ['Depth-First Search', algos.DFS],\n\tDijkstra: [\"Dijkstra's\", algos.Dijkstras],\n\tPrim: [\"Prim's\", algos.Prims],\n\tKruskal: [\"Kruskal's\", algos.Kruskals],\n\tLCS: ['LCS', algos.LCS, 'Longest Common Subsequence'],\n\tFloyd: ['Floyd-Warshall', algos.Floyd],\n\tNonLinearProbing: ['Non-Linear Probing', jokeAlgo.NonLinearProbing]\n};\n\nexport const algoList = [\n\t'Lists',\n\t'ArrayList',\n\t'LinkedList',\n\t'DoublyLinkedList',\n\t'CircularlyLinkedList',\n\t'Stacks, Queues and Deques',\n\t'StackArray',\n\t'StackLL',\n\t'QueueArray',\n\t'QueueLL',\n\t'DequeArray',\n\t'DequeLL',\n\t'Trees and SkipList',\n\t'BST',\n\t'Heap',\n\t'AVL',\n\t'LVA',\n\t'BTree',\n\t'SplayTree',\n\t'SkipList',\n\t'HashMaps',\n\t'ClosedHash',\n\t'OpenHash',\n\t'NonLinearProbing',\n\t'Sorting and QuickSelect',\n\t'BogoSort',\n\t'BubbleSort',\n\t'CocktailSort',\n\t'InsertionSort',\n\t'SelectionSort',\n\t'QuickSort',\n\t'QuickSelect',\n\t'MergeSort',\n\t'LSDRadix',\n\t'HeapSort',\n\t'String Searching',\n\t'BruteForce',\n\t'BoyerMoore',\n\t'KMP',\n\t'RabinKarp',\n\t'Graph Algorithms',\n\t'BFS',\n\t'DFS',\n\t'Dijkstra',\n\t'Prim',\n\t'Kruskal',\n\t'Dynamic Programming',\n\t'LCS',\n\t'Floyd'\n];\n","import React from 'react';\n\n// Include the ClassName of algorithms that should have an example modal\nexport default {\n\tAVL: (\n\t\t<ul>\n\t\t\t<li>To cause a left rotation, add 1, 2 and 3, in that order</li>\n\t\t\t<li>To cause a right rotation, add 3, 2 and 1, in that order</li>\n\t\t\t<li>To cause a left-right rotation, add 3, 1 and 2, in that order</li>\n\t\t\t<li>To cause a right-left rotation, add 1, 3 and 2, in that order</li>\n\t\t</ul>\n\t),\n\tBoyerMoore: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a text with only one letter and a pattern with that\n\t\t\t\tsame letter, but a different first letter (for example, &quot;aaaaaaaaa&quot; for\n\t\t\t\ttext and &quot;baaaa&quot; for pattern), since we will only mismatch on the last\n\t\t\t\tcomparison\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tWhen incorporating the Galil Rule, we can use logic similar to that of KMP to\n\t\t\t\toptimize our shifts. After finding a full match, instead of shifting by 1 we shift\n\t\t\t\tby the period <i>k</i>. After that shift, we don't need to compare the first{' '}\n\t\t\t\t<i>k</i> characters in the pattern because we've already compared them and know that\n\t\t\t\tthey match!\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tBruteForce: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a text with only one letter and a pattern with that\n\t\t\t\tsame letter, but a different last letter (for example, &quot;aaaaaaaaa&quot; for\n\t\t\t\ttext and &quot;aaaab&quot; for pattern), since we will only mismatch on the last\n\t\t\t\tcomparison\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tBST: (\n\t\t<ul>\n\t\t\t<li>To get a degenerate BST, you can add ascending data, such as 1, 2, 3, ...</li>\n\t\t\t<li>To get a full BST, you can add 2, 1, 4, 3, 5, in that order</li>\n\t\t\t<li>To get a complete BST, you can add 3, 2, 4, 1, in that order</li>\n\t\t\t<li>To get a full and complete BST, you can add 4, 2, 5, 1, 3, in that order</li>\n\t\t</ul>\n\t),\n\tBTree: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tTo cause overflow and trigger a promotion, add more than 3 data (for example 1, 2, 3\n\t\t\t\tand 4)\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tTo remove from a leaf node, add 1, 2, 3 and 4, in that order, then remove 3 or 4\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tTo remove from an inner node and use the predecessor, add 1, 3, 4, 5 and 2, in that\n\t\t\t\torder, then remove 3\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tTo cause underflow and trigger a rotation/transfer, add 1, 2, 3 and 4, in that\n\t\t\t\torder, then remove 1\n\t\t\t</li>\n\t\t\t<li>To cause underflow and trigger a fusion, follow the steps above then remove 2</li>\n\t\t</ul>\n\t),\n\tBubbleSort: (\n\t\t<ul>\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\n\t\t\t\t<p className=\"equation\">\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\n\t\t\t\t</p>\n\t\t\t\tcomparisons)\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tCocktailSort: (\n\t\t<ul>\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\n\t\t\t\t<p className=\"equation\">\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\n\t\t\t\t</p>\n\t\t\t\tcomparisons)\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tEven though Cocktail Shaker Sort has the same big-O as Bubble Sort, it is still\n\t\t\t\tfaster; one case where it significantly outperforms Bubble Sort is when we have a\n\t\t\t\tsorted array, except for the last element which is the smallest, for example [2, 3,\n\t\t\t\t4, 5, 6, 7, 8, 9, 1]\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tInsertionSort: (\n\t\t<ul>\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\n\t\t\t\t<p className=\"equation\">\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\n\t\t\t\t</p>\n\t\t\t\tcomparisons)\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tQuickSelect: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case occurs when we pick a bad pivot everytime (for example, the smallest\n\t\t\t\tor largest element), since we can no longer subvide the array\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tQuickSort: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case occurs when we pick a bad pivot everytime (for example, the smallest\n\t\t\t\tor largest element), since we can no longer subvide the array and the algorithms\n\t\t\t\tbecomes similar to Selection Sort\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tSkipList: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tYou can get a degenerate SkipList by always adding with a constant amount of heads,\n\t\t\t\tfor example 0 or 4.\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tNote that in a real SkipList, you would have an{' '}\n\t\t\t\t<span className=\"inline-eq\">O(log n) </span>\n\t\t\t\tcap to the number of levels, so we wouldn't be able to add the first element with 4\n\t\t\t\theads, for example.\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tBogoSort: (\n\t\t<ul style={{listStyle: \"none\", textAlign: \"center\"}}>\n\t\t\t<li>Ah, BogoSort</li>\n\t\t\t<li>Rejecting the tumultuous logic of QuickSort, Bogosort adopts the idea of a random pivot and expands it to an entirely randomized array</li>\n\t\t\t<li>This allows for a best case of O(1)! (probably idk)</li>\n\t\t\t<li>It can be a lot to take in at once, so if you have any questions please direct them to Liam Gones</li>\n\t\t\t<li><img src=\"https://tinyurl.com/bogomary\" alt=\"\" style={{width : \"40px\"}}></img></li>\n\t\t\t<li>p.s. Choose your array carefully. An array of length 9 has 9! (362,880) possible permutations <span role=\"img\" aria-label=\"shook\"></span></li>\n\t\t</ul>\n),\n\n};\n","import '../css/AlgoScreen.css';\nimport '../css/App.css';\nimport AnimationManager from '../anim/AnimationMain';\nimport Footer from '../components/Footer';\nimport Header from '../components/Header';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ReactGA from 'react-ga';\nimport { algoMap } from '../AlgoList';\nimport modals from '../examples/ExampleModals';\n\nclass AlgoScreen extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tconst algoName = props.location.pathname.slice(1);\n\t\tthis.canvasRef = React.createRef();\n\t\tthis.animBarRef = React.createRef();\n\n\t\tthis.state = {\n\t\t\talgoName: algoName,\n\t\t\texamplesEnabled: false,\n\t\t\twidth: 0,\n\t\t};\n\t\tReactGA.pageview(algoName);\n\t}\n\n\tcomponentDidMount() {\n\t\tif (algoMap[this.state.algoName]) {\n\t\t\tthis.animManag = new AnimationManager(this.canvasRef, this.animBarRef);\n\n\t\t\tthis.currentAlg = new algoMap[this.state.algoName][1](\n\t\t\t\tthis.animManag,\n\t\t\t\tthis.canvasRef.current.width,\n\t\t\t\tthis.canvasRef.current.height,\n\t\t\t);\n\t\t\twindow.addEventListener('resize', this.updateDimensions);\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener('resize', this.updateDimensions);\n\t}\n\n\tupdateDimensions = () => {\n\t\tthis.animManag.changeSize(document.body.clientWidth);\n\t};\n\n\trender() {\n\t\tconst algoName = this.state.algoName;\n\t\tif (!algoMap[algoName]) {\n\t\t\treturn (\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<Header />\n\t\t\t\t\t<div className=\"content\">\n\t\t\t\t\t\t<div className=\"four-o-four\">\n\t\t\t\t\t\t\t<h1>404!</h1>\n\t\t\t\t\t\t\t<h3>\n\t\t\t\t\t\t\t\tAlgorithm not found! Click <Link to=\"/\">here</Link> to return to the\n\t\t\t\t\t\t\t\thome screen and choose another algorithm.\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Footer />\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\tconst header = algoMap[algoName][2] ? algoMap[algoName][2] : algoMap[algoName][0];\n\t\treturn (\n\t\t\t<div className=\"VisualizationMainPage\">\n\t\t\t\t<div id=\"container\">\n\t\t\t\t\t<div id=\"header\">\n\t\t\t\t\t\t<h1>\n\t\t\t\t\t\t\t<Link to=\"/\">&#x3008;</Link>&nbsp;&nbsp;{header}\n\t\t\t\t\t\t</h1>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div id=\"mainContent\">\n\t\t\t\t\t\t<div id=\"algoControlSection\">\n\t\t\t\t\t\t\t<table id=\"AlgorithmSpecificControls\"></table>\n\t\t\t\t\t\t\t{modals[algoName] && (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={this.state.examplesEnabled ? 'selected' : ''}\n\t\t\t\t\t\t\t\t\tid=\"examplesButton\"\n\t\t\t\t\t\t\t\t\tonClick={this.toggleExamples}\n\t\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"viewport\">\n\t\t\t\t\t\t\t<canvas\n\t\t\t\t\t\t\t\tid=\"canvas\"\n\t\t\t\t\t\t\t\twidth={this.state.width}\n\t\t\t\t\t\t\t\theight=\"505\"\n\t\t\t\t\t\t\t\tref={this.canvasRef}\n\t\t\t\t\t\t\t></canvas>\n\t\t\t\t\t\t\t{this.state.examplesEnabled && (\n\t\t\t\t\t\t\t\t<div className=\"modal\">\n\t\t\t\t\t\t\t\t\t<div className=\"modal-content\">{modals[algoName]}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div id=\"generalAnimationControlSection\">\n\t\t\t\t\t\t\t<table id=\"GeneralAnimationControls\" ref={this.animBarRef}></table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div id=\"footer\">\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t<Link to=\"/\">Return to Home Page</Link>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\ttoggleExamples = () => this.setState(state => ({ examplesEnabled: !state.examplesEnabled }));\n}\n\nAlgoScreen.propTypes = {\n\tlocation: PropTypes.object,\n};\n\nexport default AlgoScreen;\n","import React from 'react';\n\nconst AboutScreen = () => (\n\t<div className=\"about\">\n\t\t<p>\n\t\t\tThis is a tool to help you visualize and understand the data structures and algorithms\n\t\t\tcovered in Georgia Tech's CS1332 course. It is based on the{' '}\n\t\t\t<a href=\"https://www.cs.usfca.edu/~galles/visualization/about.html\">\n\t\t\t\tData Structures Visualizations website\n\t\t\t</a>{' '}\n\t\t\tby David Gales.\n\t\t</p>\n\t\t<p>\n\t\t\tThe CS1332 Visualization Tool was adapted and expanded by{' '}\n\t\t\t<a href=\"https://rodrigodlpontes.github.io/website/\">Rodrigo Pontes</a>, under the\n\t\t\tsupervision of Prof. Mary Hudachek-Buswell, to include data structures and algorithms\n\t\t\tcovered in the course. It has since received many additions and revisions from{' '}\n\t\t\t<a href=\"https://github.com/RodrigoDLPontes/visualization-tool#contributors-\">\n\t\t\t\tmany other wonderful contributors\n\t\t\t</a>\n\t\t\t.\n\t\t</p>\n\t\t<p>\n\t\t\tIt also includes icons from{' '}\n\t\t\t<a href=\"https://material.io/resources/icons/?style=baseline\">\n\t\t\t\tGoogle&#39;s Material Icons\n\t\t\t</a>\n\t\t\t, and components from <a href=\"https://material-ui.com/\">Material UI</a>.\n\t\t</p>\n\t</div>\n);\n\nexport default AboutScreen;\n","import '../css/App.css';\nimport { Link, Route, Switch } from 'react-router-dom';\nimport { algoList, algoMap } from '../AlgoList';\nimport AboutScreen from './AboutScreen';\nimport Footer from '../components/Footer';\nimport Header from '../components/Header';\nimport React from 'react';\n\nconst HomeScreen = () => (\n\t<div className=\"container\">\n\t\t<Header />\n\t\t<div className=\"content\">\n\t\t\t<Switch>\n\t\t\t\t<Route exact path=\"/\">\n\t\t\t\t\t<div className=\"outer-flex\">\n\t\t\t\t\t\t<div className=\"inner-flex\">\n\t\t\t\t\t\t\t{algoList.map((name, idx) =>\n\t\t\t\t\t\t\t\talgoMap[name] ? (\n\t\t\t\t\t\t\t\t\t<Link to={`/${name}`} key={idx}>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"button\"\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\tvalue={algoMap[name][0]}\n\t\t\t\t\t\t\t\t\t\t\tstyle= {algoMap[name][0] === 'Bogo Sort' || algoMap[name][0] === 'LVA' || algoMap[name][0] === 'Non-Linear Probing' ? {color : \"red\"} : {}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<div key={idx} className=\"divider\">\n\t\t\t\t\t\t\t\t\t\t<span>{name}</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Route>\n\t\t\t\t<Route path=\"/about\">\n\t\t\t\t\t<AboutScreen />\n\t\t\t\t</Route>\n\t\t\t</Switch>\n\t\t</div>\n\t\t<Footer />\n\t</div>\n);\n\nexport default HomeScreen;\n","import './css/App.css';\nimport { Route, BrowserRouter as Router, Switch } from 'react-router-dom';\nimport AlgoScreen from './screens/AlgoScreen';\nimport HomeScreen from './screens/HomeScreen';\nimport React from 'react';\nimport ReactGA from 'react-ga';\n\nconst App = () => {\n\tReactGA.initialize('UA-164374852-1');\n\tReactGA.pageview('home');\n\n\treturn (\n\t\t<Router basename={process.env.PUBLIC_URL + '/'}>\n\t\t\t<Switch>\n\t\t\t\t<Route exact path={['/', '/about']} component={HomeScreen} />\n\t\t\t\t<Route component={AlgoScreen} />\n\t\t\t</Switch>\n\t\t</Router>\n\t);\n};\n\nexport default App;\n","import App from './App';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}